!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(function(){try{return require("binaryen")}catch(e){}}()):"function"==typeof define&&define.amd?define(["binaryen"],t):"object"==typeof exports?exports.assemblyscript=t(function(){try{return require("binaryen")}catch(e){}}()):e.assemblyscript=t(e.binaryen)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t,r){"use strict";function n(e){if(!e)return 0;for(var t=allocate_memory(e.length),r=t,n=0,i=e.length;n<i;++n)store(r++,e[n]);return t}function i(e){if(!e)return 0;for(var t=allocate_memory(e.length<<2),r=t,n=0,i=e.length;n<i;++n){var a=e[n];store(r,255&a),store(r+1,a>>8&255),store(r+2,a>>16&255),store(r+3,a>>>24),r+=4}return t}function a(e){for(var t=0,r=0,n=e.length;r<n;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&r+1<n&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return t}function s(e){if(null==e)return 0;for(var t=allocate_memory(a(e)+1),r=t,n=0,i=e.length;n<i;++n){var s=e.charCodeAt(n);s>=55296&&s<=57343&&n+1<i&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++n)),s<=127?store(r++,s):s<=2047?(store(r++,192|s>>>6),store(r++,128|63&s)):s<=65535?(store(r++,224|s>>>12),store(r++,128|s>>>6&63),store(r++,128|63&s)):s<=2097151?(store(r++,240|s>>>18),store(r++,128|s>>>12&63),store(r++,128|s>>>6&63),store(r++,128|63&s)):s<=67108863?(store(r++,248|s>>>24),store(r++,128|s>>>18&63),store(r++,128|s>>>12&63),store(r++,128|s>>>6&63),store(r++,128|63&s)):(store(r++,252|s>>>30),store(r++,128|s>>>24&63),store(r++,128|s>>>18&63),store(r++,128|s>>>12&63),store(r++,128|s>>>6&63),store(r++,128|63&s))}return store(r,0),t}function o(e){if(!e)return null;for(var t,r,n,i,a,s,o=new Array;t=load(e++);)128&t?(r=63&load(e++),192!=(224&t)?(n=63&load(e++),224==(240&t)?t=(15&t)<<12|r<<6|n:(i=63&load(e++),240==(248&t)?t=(7&t)<<18|r<<12|n<<6|i:(a=63&load(e++),248==(252&t)?t=(3&t)<<24|r<<18|n<<12|i<<6|a:(s=63&load(e++),t=(1&t)<<30|r<<24|n<<18|i<<12|a<<6|s)))):o.push((31&t)<<6|r)):o.push(t);return String.fromCodePoints(o)}Object.defineProperty(t,"__esModule",{value:!0});var c,p=r(2);!function(e){e[e.None=_BinaryenTypeNone()]="None",e[e.I32=_BinaryenTypeInt32()]="I32",e[e.I64=_BinaryenTypeInt64()]="I64",e[e.F32=_BinaryenTypeFloat32()]="F32",e[e.F64=_BinaryenTypeFloat64()]="F64",e[e.Unreachable=_BinaryenTypeUnreachable()]="Unreachable",e[e.Auto=_BinaryenTypeAuto()]="Auto"}(c=t.NativeType||(t.NativeType={}));var l;!function(e){e[e.Invalid=_BinaryenInvalidId()]="Invalid",e[e.Block=_BinaryenBlockId()]="Block",e[e.If=_BinaryenIfId()]="If",e[e.Loop=_BinaryenLoopId()]="Loop",e[e.Break=_BinaryenBreakId()]="Break",e[e.Switch=_BinaryenSwitchId()]="Switch",e[e.Call=_BinaryenCallId()]="Call",e[e.CallImport=_BinaryenCallImportId()]="CallImport",e[e.CallIndirect=_BinaryenCallIndirectId()]="CallIndirect",e[e.GetLocal=_BinaryenGetLocalId()]="GetLocal",e[e.SetLocal=_BinaryenSetLocalId()]="SetLocal",e[e.GetGlobal=_BinaryenGetGlobalId()]="GetGlobal",e[e.SetGlobal=_BinaryenSetGlobalId()]="SetGlobal",e[e.Load=_BinaryenLoadId()]="Load",e[e.Store=_BinaryenStoreId()]="Store",e[e.Const=_BinaryenConstId()]="Const",e[e.Unary=_BinaryenUnaryId()]="Unary",e[e.Binary=_BinaryenBinaryId()]="Binary",e[e.Select=_BinaryenSelectId()]="Select",e[e.Drop=_BinaryenDropId()]="Drop",e[e.Return=_BinaryenReturnId()]="Return",e[e.Host=_BinaryenHostId()]="Host",e[e.Nop=_BinaryenNopId()]="Nop",e[e.Unreachable=_BinaryenUnreachableId()]="Unreachable",e[e.AtomicCmpxchg=_BinaryenAtomicCmpxchgId()]="AtomicCmpxchg",e[e.AtomicRMW=_BinaryenAtomicRMWId()]="AtomicRMW",e[e.AtomicWait=_BinaryenAtomicWaitId()]="AtomicWait",e[e.AtomicWake=_BinaryenAtomicWakeId()]="AtomicWake"}(l=t.ExpressionId||(t.ExpressionId={}));!function(e){e[e.ClzI32=_BinaryenClzInt32()]="ClzI32",e[e.CtzI32=_BinaryenCtzInt32()]="CtzI32",e[e.PopcntI32=_BinaryenPopcntInt32()]="PopcntI32",e[e.NegF32=_BinaryenNegFloat32()]="NegF32",e[e.AbsF32=_BinaryenAbsFloat32()]="AbsF32",e[e.CeilF32=_BinaryenCeilFloat32()]="CeilF32",e[e.FloorF32=_BinaryenFloorFloat32()]="FloorF32",e[e.TruncF32=_BinaryenTruncFloat32()]="TruncF32",e[e.NearestF32=_BinaryenNearestFloat32()]="NearestF32",e[e.SqrtF32=_BinaryenSqrtFloat32()]="SqrtF32",e[e.EqzI32=_BinaryenEqZInt32()]="EqzI32",e[e.ClzI64=_BinaryenClzInt64()]="ClzI64",e[e.CtzI64=_BinaryenCtzInt64()]="CtzI64",e[e.PopcntI64=_BinaryenPopcntInt64()]="PopcntI64",e[e.NegF64=_BinaryenNegFloat64()]="NegF64",e[e.AbsF64=_BinaryenAbsFloat64()]="AbsF64",e[e.CeilF64=_BinaryenCeilFloat64()]="CeilF64",e[e.FloorF64=_BinaryenFloorFloat64()]="FloorF64",e[e.TruncF64=_BinaryenTruncFloat64()]="TruncF64",e[e.NearestF64=_BinaryenNearestFloat64()]="NearestF64",e[e.SqrtF64=_BinaryenSqrtFloat64()]="SqrtF64",e[e.EqzI64=_BinaryenEqZInt64()]="EqzI64",e[e.ExtendI32=_BinaryenExtendSInt32()]="ExtendI32",e[e.ExtendU32=_BinaryenExtendUInt32()]="ExtendU32",e[e.WrapI64=_BinaryenWrapInt64()]="WrapI64",e[e.TruncF32ToI32=_BinaryenTruncSFloat32ToInt32()]="TruncF32ToI32",e[e.TruncF32ToI64=_BinaryenTruncSFloat32ToInt64()]="TruncF32ToI64",e[e.TruncF32ToU32=_BinaryenTruncUFloat32ToInt32()]="TruncF32ToU32",e[e.TruncF32ToU64=_BinaryenTruncUFloat32ToInt64()]="TruncF32ToU64",e[e.TruncF64ToI32=_BinaryenTruncSFloat64ToInt32()]="TruncF64ToI32",e[e.TruncF64ToI64=_BinaryenTruncSFloat64ToInt64()]="TruncF64ToI64",e[e.TruncF64ToU32=_BinaryenTruncUFloat64ToInt32()]="TruncF64ToU32",e[e.TruncF64ToU64=_BinaryenTruncUFloat64ToInt64()]="TruncF64ToU64",e[e.ReinterpretF32=_BinaryenReinterpretFloat32()]="ReinterpretF32",e[e.ReinterpretF64=_BinaryenReinterpretFloat64()]="ReinterpretF64",e[e.ConvertI32ToF32=_BinaryenConvertSInt32ToFloat32()]="ConvertI32ToF32",e[e.ConvertI32ToF64=_BinaryenConvertSInt32ToFloat64()]="ConvertI32ToF64",e[e.ConvertU32ToF32=_BinaryenConvertUInt32ToFloat32()]="ConvertU32ToF32",e[e.ConvertU32ToF64=_BinaryenConvertUInt32ToFloat64()]="ConvertU32ToF64",e[e.ConvertI64ToF32=_BinaryenConvertSInt64ToFloat32()]="ConvertI64ToF32",e[e.ConvertI64ToF64=_BinaryenConvertSInt64ToFloat64()]="ConvertI64ToF64",e[e.ConvertU64ToF32=_BinaryenConvertUInt64ToFloat32()]="ConvertU64ToF32",e[e.ConvertU64ToF64=_BinaryenConvertUInt64ToFloat64()]="ConvertU64ToF64",e[e.PromoteF32=_BinaryenPromoteFloat32()]="PromoteF32",e[e.DemoteF64=_BinaryenDemoteFloat64()]="DemoteF64",e[e.ReinterpretI32=_BinaryenReinterpretInt32()]="ReinterpretI32",e[e.ReinterpretI64=_BinaryenReinterpretInt64()]="ReinterpretI64"}(t.UnaryOp||(t.UnaryOp={}));!function(e){e[e.AddI32=_BinaryenAddInt32()]="AddI32",e[e.SubI32=_BinaryenSubInt32()]="SubI32",e[e.MulI32=_BinaryenMulInt32()]="MulI32",e[e.DivI32=_BinaryenDivSInt32()]="DivI32",e[e.DivU32=_BinaryenDivUInt32()]="DivU32",e[e.RemI32=_BinaryenRemSInt32()]="RemI32",e[e.RemU32=_BinaryenRemUInt32()]="RemU32",e[e.AndI32=_BinaryenAndInt32()]="AndI32",e[e.OrI32=_BinaryenOrInt32()]="OrI32",e[e.XorI32=_BinaryenXorInt32()]="XorI32",e[e.ShlI32=_BinaryenShlInt32()]="ShlI32",e[e.ShrU32=_BinaryenShrUInt32()]="ShrU32",e[e.ShrI32=_BinaryenShrSInt32()]="ShrI32",e[e.RotlI32=_BinaryenRotLInt32()]="RotlI32",e[e.RotrI32=_BinaryenRotRInt32()]="RotrI32",e[e.EqI32=_BinaryenEqInt32()]="EqI32",e[e.NeI32=_BinaryenNeInt32()]="NeI32",e[e.LtI32=_BinaryenLtSInt32()]="LtI32",e[e.LtU32=_BinaryenLtUInt32()]="LtU32",e[e.LeI32=_BinaryenLeSInt32()]="LeI32",e[e.LeU32=_BinaryenLeUInt32()]="LeU32",e[e.GtI32=_BinaryenGtSInt32()]="GtI32",e[e.GtU32=_BinaryenGtUInt32()]="GtU32",e[e.GeI32=_BinaryenGeSInt32()]="GeI32",e[e.GeU32=_BinaryenGeUInt32()]="GeU32",e[e.AddI64=_BinaryenAddInt64()]="AddI64",e[e.SubI64=_BinaryenSubInt64()]="SubI64",e[e.MulI64=_BinaryenMulInt64()]="MulI64",e[e.DivI64=_BinaryenDivSInt64()]="DivI64",e[e.DivU64=_BinaryenDivUInt64()]="DivU64",e[e.RemI64=_BinaryenRemSInt64()]="RemI64",e[e.RemU64=_BinaryenRemUInt64()]="RemU64",e[e.AndI64=_BinaryenAndInt64()]="AndI64",e[e.OrI64=_BinaryenOrInt64()]="OrI64",e[e.XorI64=_BinaryenXorInt64()]="XorI64",e[e.ShlI64=_BinaryenShlInt64()]="ShlI64",e[e.ShrU64=_BinaryenShrUInt64()]="ShrU64",e[e.ShrI64=_BinaryenShrSInt64()]="ShrI64",e[e.RotlI64=_BinaryenRotLInt64()]="RotlI64",e[e.RotrI64=_BinaryenRotRInt64()]="RotrI64",e[e.EqI64=_BinaryenEqInt64()]="EqI64",e[e.NeI64=_BinaryenNeInt64()]="NeI64",e[e.LtI64=_BinaryenLtSInt64()]="LtI64",e[e.LtU64=_BinaryenLtUInt64()]="LtU64",e[e.LeI64=_BinaryenLeSInt64()]="LeI64",e[e.LeU64=_BinaryenLeUInt64()]="LeU64",e[e.GtI64=_BinaryenGtSInt64()]="GtI64",e[e.GtU64=_BinaryenGtUInt64()]="GtU64",e[e.GeI64=_BinaryenGeSInt64()]="GeI64",e[e.GeU64=_BinaryenGeUInt64()]="GeU64",e[e.AddF32=_BinaryenAddFloat32()]="AddF32",e[e.SubF32=_BinaryenSubFloat32()]="SubF32",e[e.MulF32=_BinaryenMulFloat32()]="MulF32",e[e.DivF32=_BinaryenDivFloat32()]="DivF32",e[e.CopysignF32=_BinaryenCopySignFloat32()]="CopysignF32",e[e.MinF32=_BinaryenMinFloat32()]="MinF32",e[e.MaxF32=_BinaryenMaxFloat32()]="MaxF32",e[e.EqF32=_BinaryenEqFloat32()]="EqF32",e[e.NeF32=_BinaryenNeFloat32()]="NeF32",e[e.LtF32=_BinaryenLtFloat32()]="LtF32",e[e.LeF32=_BinaryenLeFloat32()]="LeF32",e[e.GtF32=_BinaryenGtFloat32()]="GtF32",e[e.GeF32=_BinaryenGeFloat32()]="GeF32",e[e.AddF64=_BinaryenAddFloat64()]="AddF64",e[e.SubF64=_BinaryenSubFloat64()]="SubF64",e[e.MulF64=_BinaryenMulFloat64()]="MulF64",e[e.DivF64=_BinaryenDivFloat64()]="DivF64",e[e.CopysignF64=_BinaryenCopySignFloat64()]="CopysignF64",e[e.MinF64=_BinaryenMinFloat64()]="MinF64",e[e.MaxF64=_BinaryenMaxFloat64()]="MaxF64",e[e.EqF64=_BinaryenEqFloat64()]="EqF64",e[e.NeF64=_BinaryenNeFloat64()]="NeF64",e[e.LtF64=_BinaryenLtFloat64()]="LtF64",e[e.LeF64=_BinaryenLeFloat64()]="LeF64",e[e.GtF64=_BinaryenGtFloat64()]="GtF64",e[e.GeF64=_BinaryenGeFloat64()]="GeF64"}(t.BinaryOp||(t.BinaryOp={}));!function(e){e[e.PageSize=_BinaryenPageSize()]="PageSize",e[e.CurrentMemory=_BinaryenCurrentMemory()]="CurrentMemory",e[e.GrowMemory=_BinaryenGrowMemory()]="GrowMemory",e[e.HasFeature=_BinaryenHasFeature()]="HasFeature"}(t.HostOp||(t.HostOp={}));!function(e){e[e.Add=_BinaryenAtomicRMWAdd()]="Add",e[e.Sub=_BinaryenAtomicRMWSub()]="Sub",e[e.And=_BinaryenAtomicRMWAnd()]="And",e[e.Or=_BinaryenAtomicRMWOr()]="Or",e[e.Xor=_BinaryenAtomicRMWXor()]="Xor",e[e.Xchg=_BinaryenAtomicRMWXchg()]="Xchg"}(t.AtomicRMWOp||(t.AtomicRMWOp={}));var u=function(){function e(){}return e.create=function(t,r){var n=new e;return n.buffer=t,n.offset=r,n},e}();t.MemorySegment=u;var h=function(){function e(){}return e.create=function(){var t=new e;return t.ref=_BinaryenModuleCreate(),t.lit=changetype(allocate_memory(16)),t.noEmit=!1,t},e.createFrom=function(t){var r=n(t);try{var i=new e;return i.ref=_BinaryenModuleRead(r,t.length),i.lit=changetype(allocate_memory(16)),i.noEmit=!1,i}finally{free_memory(changetype(r))}},e.createStub=function(){var t=new e;return t.ref=0,t.lit=changetype(0),t.noEmit=!0,t},e.prototype.addFunctionType=function(e,t,r){if(this.noEmit)return 0;var n=s(e),a=i(r);try{return _BinaryenAddFunctionType(this.ref,n,t,a,r.length)}finally{free_memory(a),free_memory(n)}},e.prototype.getFunctionTypeBySignature=function(e,t){if(this.noEmit)return 0;var r=i(t);try{return _BinaryenGetFunctionTypeBySignature(this.ref,e,r,t.length)}finally{free_memory(r)}},e.prototype.createI32=function(e){return this.noEmit?0:(_BinaryenLiteralInt32(this.lit,e),_BinaryenConst(this.ref,this.lit))},e.prototype.createI64=function(e,t){return void 0===t&&(t=0),this.noEmit?0:(_BinaryenLiteralInt64(this.lit,e,t),_BinaryenConst(this.ref,this.lit))},e.prototype.createF32=function(e){return this.noEmit?0:(_BinaryenLiteralFloat32(this.lit,e),_BinaryenConst(this.ref,this.lit))},e.prototype.createF64=function(e){return this.noEmit?0:(_BinaryenLiteralFloat64(this.lit,e),_BinaryenConst(this.ref,this.lit))},e.prototype.createUnary=function(e,t){return this.noEmit?0:_BinaryenUnary(this.ref,e,t)},e.prototype.createBinary=function(e,t,r){return this.noEmit?0:_BinaryenBinary(this.ref,e,t,r)},e.prototype.createHost=function(e,t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),this.noEmit)return 0;var n=s(t),a=i(r);try{return _BinaryenHost(this.ref,e,n,a,r?r.length:0)}finally{free_memory(a),free_memory(n)}},e.prototype.createGetLocal=function(e,t){return this.noEmit?0:_BinaryenGetLocal(this.ref,e,t)},e.prototype.createTeeLocal=function(e,t){return this.noEmit?0:_BinaryenTeeLocal(this.ref,e,t)},e.prototype.createGetGlobal=function(e,t){if(this.noEmit)return 0;var r=s(e);try{return _BinaryenGetGlobal(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createLoad=function(e,t,r,n,i){return void 0===i&&(i=0),this.noEmit?0:_BinaryenLoad(this.ref,e,t?1:0,i,e,n,r)},e.prototype.createStore=function(e,t,r,n,i){return void 0===i&&(i=0),this.noEmit?0:_BinaryenStore(this.ref,e,i,e,t,r,n)},e.prototype.createAtomicLoad=function(e,t,r,n){return void 0===n&&(n=0),this.noEmit?0:_BinaryenAtomicLoad(this.ref,e,n,r,t)},e.prototype.createAtomicStore=function(e,t,r,n,i){return void 0===i&&(i=0),this.noEmit?0:_BinaryenAtomicStore(this.ref,e,i,t,r,n)},e.prototype.createAtomicRMW=function(e,t,r,n,i,a){return this.noEmit?0:_BinaryenAtomicRMW(this.ref,e,t,r,n,i,a)},e.prototype.createAtomicCmpxchg=function(e,t,r,n,i,a){return this.noEmit?0:_BinaryenAtomicCmpxchg(this.ref,e,t,r,n,i,a)},e.prototype.createAtomicWait=function(e,t,r,n){return this.noEmit?0:_BinaryenAtomicWait(this.ref,e,t,r,n)},e.prototype.createAtomicWake=function(e,t){return this.noEmit?0:_BinaryenAtomicWake(this.ref,e,t)},e.prototype.createSetLocal=function(e,t){return this.noEmit?0:_BinaryenSetLocal(this.ref,e,t)},e.prototype.createSetGlobal=function(e,t){if(this.noEmit)return 0;var r=s(e);try{return _BinaryenSetGlobal(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createBlock=function(e,t,r){if(void 0===r&&(r=c.Auto),this.noEmit)return 0;var n=s(e),a=i(t);try{return _BinaryenBlock(this.ref,n,a,t.length,r)}finally{free_memory(a),free_memory(n)}},e.prototype.createBreak=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),this.noEmit)return 0;var n=s(e);try{return _BinaryenBreak(this.ref,n,t,r)}finally{free_memory(n)}},e.prototype.createDrop=function(e){return this.noEmit?0:_BinaryenDrop(this.ref,e)},e.prototype.createLoop=function(e,t){if(this.noEmit)return 0;var r=s(e);try{return _BinaryenLoop(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createIf=function(e,t,r){return void 0===r&&(r=0),this.noEmit?0:_BinaryenIf(this.ref,e,t,r)},e.prototype.createNop=function(){return this.noEmit?0:_BinaryenNop(this.ref)},e.prototype.createReturn=function(e){return void 0===e&&(e=0),this.noEmit?0:_BinaryenReturn(this.ref,e)},e.prototype.createSelect=function(e,t,r){return this.noEmit?0:_BinaryenSelect(this.ref,r,e,t)},e.prototype.createSwitch=function(e,t,r,n){if(void 0===n&&(n=0),this.noEmit)return 0;for(var a=new Array(e.length),o=0,c=e.length;o<c;++o)a[o]=s(e[o]);var p=i(a),l=s(t);try{return _BinaryenSwitch(this.ref,p,c,l,r,n)}finally{for(free_memory(l),free_memory(p),o=c-1;o>=0;--o)free_memory(a[o])}},e.prototype.createCall=function(e,t,r){if(this.noEmit)return 0;var n=s(e),a=i(t);try{return _BinaryenCall(this.ref,n,a,t&&t.length||0,r)}finally{free_memory(a),free_memory(n)}},e.prototype.createCallImport=function(e,t,r){if(this.noEmit)return 0;var n=s(e),a=i(t);try{return _BinaryenCallImport(this.ref,n,a,t&&t.length||0,r)}finally{free_memory(a),free_memory(n)}},e.prototype.createUnreachable=function(){return this.noEmit?0:_BinaryenUnreachable(this.ref)},e.prototype.addGlobal=function(e,t,r,n){if(this.noEmit)return 0;var i=s(e);try{return _BinaryenAddGlobal(this.ref,i,t,r?1:0,n)}finally{free_memory(i)}},e.prototype.addFunction=function(e,t,r,n){if(this.noEmit)return 0;var a=s(e),o=i(r);try{return _BinaryenAddFunction(this.ref,a,t,o,r.length,n)}finally{free_memory(o),free_memory(a)}},e.prototype.removeFunction=function(e){var t=s(e);try{_BinaryenRemoveFunction(this.ref,t)}finally{free_memory(t)}},e.prototype.addFunctionExport=function(e,t){if(this.noEmit)return 0;var r=s(e),n=s(t);try{return _BinaryenAddFunctionExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addTableExport=function(e,t){if(this.noEmit)return 0;var r=s(e),n=s(t);try{return _BinaryenAddTableExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addMemoryExport=function(e,t){if(this.noEmit)return 0;var r=s(e),n=s(t);try{return _BinaryenAddMemoryExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addGlobalExport=function(e,t){if(this.noEmit)return 0;var r=s(e),n=s(t);try{return _BinaryenAddGlobalExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.removeExport=function(e){if(!this.noEmit){var t=s(e);try{_BinaryenRemoveExport(this.ref,t)}finally{free_memory(t)}}},e.prototype.addFunctionImport=function(e,t,r,n){if(this.noEmit)return 0;var i=s(e),a=s(t),o=s(r);try{return _BinaryenAddFunctionImport(this.ref,i,a,o,n)}finally{free_memory(o),free_memory(a),free_memory(i)}},e.prototype.addTableImport=function(e,t,r){if(this.noEmit)return 0;var n=s(e),i=s(t),a=s(r);try{return _BinaryenAddTableImport(this.ref,n,i,a)}finally{free_memory(a),free_memory(i),free_memory(n)}},e.prototype.addMemoryImport=function(e,t,r){if(this.noEmit)return 0;var n=s(e),i=s(t),a=s(r);try{return _BinaryenAddMemoryImport(this.ref,n,i,a)}finally{free_memory(a),free_memory(i),free_memory(n)}},e.prototype.addGlobalImport=function(e,t,r,n){if(this.noEmit)return 0;var i=s(e),a=s(t),o=s(r);try{return _BinaryenAddGlobalImport(this.ref,i,a,o,n)}finally{free_memory(o),free_memory(a),free_memory(i)}},e.prototype.removeImport=function(e){if(!this.noEmit){var t=s(e);try{_BinaryenRemoveImport(this.ref,t)}finally{free_memory(t)}}},e.prototype.setMemory=function(e,t,r,a,o){if(void 0===o&&(o=null),!this.noEmit){for(var c=s(o),l=r.length,u=new Array(l),h=new Array(l),d=new Array(l),y=0;y<l;++y){var _=r[y].buffer,m=r[y].offset;u[y]=n(_),h[y]=a==p.Target.WASM64?this.createI64(m.lo,m.hi):this.createI32(m.toI32()),d[y]=_.length}var f=i(u),E=i(h),T=i(d);try{_BinaryenSetMemory(this.ref,e,t,c,f,E,T,l)}finally{for(free_memory(T),free_memory(E),free_memory(f),y=l-1;y>=0;--y)free_memory(u[y]);free_memory(c)}}},e.prototype.setFunctionTable=function(e){if(!this.noEmit){var t=i(e);try{_BinaryenSetFunctionTable(this.ref,t,e.length)}finally{free_memory(t)}}},e.prototype.setStart=function(e){this.noEmit||_BinaryenSetStart(this.ref,e)},e.prototype.optimize=function(e){void 0===e&&(e=0),e?_BinaryenFunctionOptimize(e,this.ref):_BinaryenModuleOptimize(this.ref)},e.prototype.runPasses=function(e,t){void 0===t&&(t=0);for(var r=e.length,n=new Array(r),a=0;a<r;++a)n[a]=s(e[a]);var o=i(n);try{t?_BinaryenFunctionRunPasses(t,this.ref,o,r):_BinaryenModuleRunPasses(this.ref,o,r)}finally{for(free_memory(o);a>=0;--a)free_memory(n[a])}},e.prototype.validate=function(){return!this.noEmit&&1==_BinaryenModuleValidate(this.ref)},e.prototype.interpret=function(){_BinaryenModuleInterpret(this.ref)},e.prototype.write=function(e,t){return void 0===t&&(t=1048576),_BinaryenModuleWrite(this.ref,e,t)},e.prototype.print=function(){_BinaryenModulePrint(this.ref)},e.prototype.printAsmjs=function(){_BinaryenModulePrintAsmjs(this.ref)},e.prototype.toBinary=function(e){throw void 0===e&&(e=1048576),new Error("not implemented")},e.prototype.toText=function(){throw new Error("not implemented")},e.prototype.dispose=function(){this.ref&&(_BinaryenModuleDispose(this.ref),free_memory(changetype(this.lit)))},e.prototype.createRelooper=function(){return this.noEmit?d.createStub(this):d.create(this)},e.prototype.cloneExpression=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=i32.MAX_VALUE),this.noEmit||r<0)return 0;var n,i;switch(_BinaryenExpressionGetId(e)){case l.Const:switch(_BinaryenExpressionGetType(e)){case c.I32:return this.createI32(_BinaryenConstGetValueI32(e));case c.I64:return this.createI64(_BinaryenConstGetValueI64Low(e),_BinaryenConstGetValueI64High(e));case c.F32:return this.createF32(_BinaryenConstGetValueF32(e));case c.F64:return this.createF64(_BinaryenConstGetValueF64(e));default:throw new Error("concrete type expected")}case l.GetLocal:return _BinaryenGetLocal(this.ref,_BinaryenGetLocalGetIndex(e),_BinaryenExpressionGetType(e));case l.GetGlobal:var a=_BinaryenGetGlobalGetName(e);if(!a)break;return _BinaryenGetGlobal(this.ref,a,_BinaryenExpressionGetType(e));case l.Load:if(!(n=this.cloneExpression(_BinaryenLoadGetPtr(e),t,r-1)))break;return _BinaryenLoadIsAtomic(e)?_BinaryenAtomicLoad(this.ref,_BinaryenLoadGetBytes(e),_BinaryenLoadGetOffset(e),_BinaryenExpressionGetType(e),n):_BinaryenLoad(this.ref,_BinaryenLoadGetBytes(e),_BinaryenLoadIsSigned(e)?1:0,_BinaryenLoadGetOffset(e),_BinaryenLoadGetAlign(e),_BinaryenExpressionGetType(e),n);case l.Unary:if(!(n=this.cloneExpression(_BinaryenUnaryGetValue(e),t,r-1)))break;return _BinaryenUnary(this.ref,_BinaryenUnaryGetOp(e),n);case l.Binary:if(!(n=this.cloneExpression(_BinaryenBinaryGetLeft(e),t,r-1)))break;if(!(i=this.cloneExpression(_BinaryenBinaryGetRight(e),t,r-1)))break;return _BinaryenBinary(this.ref,_BinaryenBinaryGetOp(e),n,i)}return 0},e.MAX_MEMORY_WASM32=65535,e}();t.Module=h;var d=function(){function e(){}return e.create=function(t){var r=new e;return r.module=t,r.ref=_RelooperCreate(),r.noEmit=!1,r},e.createStub=function(t){var r=new e;return r.module=t,r.ref=0,r.noEmit=!0,r},e.prototype.addBlock=function(e){return this.noEmit?0:_RelooperAddBlock(this.ref,e)},e.prototype.addBranch=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this.noEmit||_RelooperAddBranch(e,t,r,n)},e.prototype.addBlockWithSwitch=function(e,t){return this.noEmit?0:_RelooperAddBlockWithSwitch(this.ref,e,t)},e.prototype.addBranchForSwitch=function(e,t,r,n){if(void 0===n&&(n=0),!this.noEmit){var a=i(r);try{_RelooperAddBranchForSwitch(e,t,a,r.length,n)}finally{free_memory(a)}}},e.prototype.renderAndDispose=function(e,t){return this.noEmit?0:_RelooperRenderAndDispose(this.ref,e,t,this.module.ref)},e}();t.Relooper=d,t.readString=o},function(e,t,r){"use strict";function n(e){switch(e){case u.INFO:return"INFO";case u.WARNING:return"WARNING";case u.ERROR:return"ERROR";default:return""}}function i(e){switch(e){case u.INFO:return h;case u.WARNING:return d;case u.ERROR:return y;default:return""}}function a(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var a="";if(e.range&&r&&(a=s(e.range,t)),p.sb.length=0,t&&p.sb.push(i(e.category)),p.sb.push(n(e.category)),t&&p.sb.push(_),p.sb.push(" AS"),p.sb.push(e.code.toString(10)),p.sb.push(": "),p.sb.push(e.message),e.range){var o=e.range,c=o.source.text;r&&(p.sb.push("\n"),p.sb.push(a)),p.sb.push("\n");for(var l=o.start,u=1,h=1;l-- >0;)10==c.charCodeAt(l)?u++:1==u&&h++;p.sb.push(" in "),p.sb.push(o.source.path),p.sb.push("("),p.sb.push(u.toString(10)),p.sb.push(","),p.sb.push(h.toString(10)),p.sb.push(")")}return p.sb.join("")}function s(e,t){void 0===t&&(t=!1);for(var r=e.source.text,n=r.length,i=e.start,a=e.end;i>0&&!c.isLineBreak(r.charCodeAt(i-1));)i--;for(;a<n&&!c.isLineBreak(r.charCodeAt(a));)a++;for(p.sb.length=0,p.sb.push("\n "),p.sb.push(r.substring(i,a)),p.sb.push("\n ");i<e.start;)p.sb.push(" "),i++;if(t&&p.sb.push(y),e.start==e.end)p.sb.push("^");else for(;i++<e.end;)p.sb.push("~");return t&&p.sb.push(_),p.sb.join("")}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),c=r(12),p=r(18),l=r(11);t.DiagnosticCode=l.DiagnosticCode,t.diagnosticCodeToString=l.diagnosticCodeToString;var u;!function(e){e[e.INFO=0]="INFO",e[e.WARNING=1]="WARNING",e[e.ERROR=2]="ERROR"}(u=t.DiagnosticCategory||(t.DiagnosticCategory={})),t.diagnosticCategoryToString=n;var h="[93m",d="[93m",y="[91m",_="[0m";t.diagnosticCategoryToColor=i;var m=function(){function e(e,t,r){this.range=null,this.code=e,this.category=t,this.message=r}return e.create=function(t,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var a=o.diagnosticCodeToString(t);return null!=n&&(a=a.replace("{0}",n)),null!=i&&(a=a.replace("{1}",i)),new e(t,r,a)},e.createInfo=function(t,r,n){return void 0===r&&(r=null),void 0===n&&(n=null),e.create(t,u.INFO,r,n)},e.createWarning=function(t,r,n){return void 0===r&&(r=null),void 0===n&&(n=null),e.create(t,u.WARNING,r,n)},e.createError=function(t,r,n){return void 0===r&&(r=null),void 0===n&&(n=null),e.create(t,u.ERROR,r,n)},e.prototype.withRange=function(e){return this.range=e,this},e.prototype.toString=function(){return this.range?n(this.category)+" "+this.code.toString(10)+': "'+this.message+'" in '+this.range.source.path+" @ "+this.range.start.toString(10)+","+this.range.end.toString(10):n(this.category)+" "+this.code.toString(10)+": "+this.message},e}();t.DiagnosticMessage=m,t.formatDiagnosticMessage=a,t.formatDiagnosticContext=s;var f=function(){function e(e){void 0===e&&(e=null),this.silentDiagnostics=!1,this.diagnostics=e||new Array}return e.prototype.emitDiagnostic=function(e,t,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var s=m.create(e,t,n,i).withRange(r);this.diagnostics.push(s),this.silentDiagnostics||(console.log(a(s,!0,!0)+"\n"),console.log(new Error("stack").stack))},e.prototype.error=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.emitDiagnostic(e,u.ERROR,t,r,n)},e.prototype.info=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.emitDiagnostic(e,u.INFO,t,r,n)},e.prototype.warning=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.emitDiagnostic(e,u.WARNING,t,r,n)},e}();t.DiagnosticEmitter=f},function(e,t,r){"use strict";function n(e,t){if(!e.isExported)return!1;var r=t.parent;if(!r)return!1;if(t.range.source.isEntry&&r.kind!=f.NodeKind.NAMESPACE)return!0;if(r.kind==f.NodeKind.VARIABLE&&!(r=r.parent))return!1;if(r.kind!=f.NodeKind.NAMESPACE&&r.kind!=f.NodeKind.CLASS)return!1;var i=e.program.elements.get(r.internalName);return!!i&&n(i,r)}function i(e,t){switch(assert(e.hasConstantValue),assert(null!=e.type),e.type.kind){case 0:case 1:var r=e.type.computeSmallIntegerShift(E.Type.i32);return t.createI32(e.constantIntegerValue?e.constantIntegerValue.toI32()<<r>>r:0);case 5:case 6:case 10:var n=e.type.computeSmallIntegerMask(E.Type.i32);return t.createI32(e.constantIntegerValue?e.constantIntegerValue.toI32()&n:0);case 2:case 7:return t.createI32(e.constantIntegerValue?e.constantIntegerValue.lo:0);case 4:case 9:if(e.program.target!=l.WASM64)return t.createI32(e.constantIntegerValue?e.constantIntegerValue.lo:0);case 3:case 8:return e.constantIntegerValue?t.createI64(e.constantIntegerValue.lo,e.constantIntegerValue.hi):t.createI64(0);case 11:return t.createF32(e.constantFloatValue);case 12:return t.createF64(e.constantFloatValue)}throw new Error("concrete type expected")}function a(e,t,r){switch(t.kind){case 0:e=r.createBinary(y.BinaryOp.ShrI32,r.createBinary(y.BinaryOp.ShlI32,e,r.createI32(24)),r.createI32(24));break;case 1:e=r.createBinary(y.BinaryOp.ShrI32,r.createBinary(y.BinaryOp.ShlI32,e,r.createI32(16)),r.createI32(16));break;case 5:e=r.createBinary(y.BinaryOp.AndI32,e,r.createI32(255));break;case 6:e=r.createBinary(y.BinaryOp.AndI32,e,r.createI32(65535));break;case 10:e=r.createBinary(y.BinaryOp.AndI32,e,r.createI32(1));break;case 13:throw new Error("concrete type expected")}return e}function s(e,t,r){switch(t.kind){default:e=r.createUnary(y.UnaryOp.EqzI32,e);break;case 3:case 8:e=r.createUnary(y.UnaryOp.EqzI64,e);break;case 9:case 4:e=r.createUnary(64==t.size?y.UnaryOp.EqzI64:y.UnaryOp.EqzI32,e);break;case 11:e=r.createBinary(y.BinaryOp.EqF32,e,r.createF32(0));break;case 12:e=r.createBinary(y.BinaryOp.EqF64,e,r.createF64(0));break;case 13:throw new Error("concrete type expected")}return e}function o(e,t,r){switch(t.kind){default:e=r.createBinary(y.BinaryOp.NeI32,e,r.createI32(0));break;case 3:case 8:e=r.createBinary(y.BinaryOp.NeI64,e,r.createI64(0));break;case 9:case 4:e=64==t.size?r.createBinary(y.BinaryOp.NeI64,e,r.createI64(0)):r.createBinary(y.BinaryOp.NeI32,e,r.createI32(0));break;case 11:e=r.createBinary(y.BinaryOp.NeF32,e,r.createF32(0));break;case 12:e=r.createBinary(y.BinaryOp.NeF64,e,r.createF64(0));break;case 13:throw new Error("concrete type expected")}return e}var c=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var l,u=r(10),h=r(7),d=r(1),y=r(0),_=r(6),m=r(4),f=r(8),E=r(5),T=r(3);!function(e){e[e.WASM32=0]="WASM32",e[e.WASM64=1]="WASM64"}(l=t.Target||(t.Target={}));var g=function(){function e(){this.target=l.WASM32,this.noEmit=!1,this.noTreeShaking=!1,this.noAssert=!1,this.noMemory=!1}return e}();t.Options=g;!function(e){e[e.NONE=0]="NONE",e[e.IMPLICIT=1]="IMPLICIT",e[e.EXPLICIT=2]="EXPLICIT"}(t.ConversionKind||(t.ConversionKind={}));var A=function(e){function t(t,r){void 0===r&&(r=null);var n=e.call(this,t.diagnostics)||this;n.startFunctionBody=new Array,n.currentType=E.Type.void,n.disallowContinue=!0,n.variableIsLocal=!1,n.memoryOffset=new T.U64(8,0),n.memorySegments=new Array,n.files=new Set,n.program=t,n.options=r||new g,n.memoryOffset=new T.U64(n.options.target==l.WASM64?8:4,0),n.module=n.options.noEmit?y.Module.createStub():y.Module.create();var i=new _.FunctionPrototype(t,"start","start",null),a=new _.Function(i,i.internalName,[],[],E.Type.void,null);return n.currentFunction=n.startFunction=a,n}return c(t,e),t.compile=function(e,r){return void 0===r&&(r=null),new t(e,r).compile()},t.prototype.compile=function(){this.program.initialize(this.options.target);for(var e=this.program.sources,t=0,r=e.length;t<r;++t)e[t].isEntry&&this.compileSource(e[t]);if(this.startFunctionBody.length){var n=this.module.getFunctionTypeBySignature(y.NativeType.None,[]);n||(n=this.module.addFunctionType("v",y.NativeType.None,[])),this.module.setStart(this.module.addFunction(this.startFunction.prototype.internalName,n,E.typesToNativeTypes(this.startFunction.additionalLocals),this.module.createBlock(null,this.startFunctionBody)))}if(!this.options.noMemory){var i=this.memoryOffset.clone();this.options.target==l.WASM64?this.module.addGlobal("HEAP_BASE",y.NativeType.I64,!1,this.module.createI64(i.lo,i.hi)):this.module.addGlobal("HEAP_BASE",y.NativeType.I32,!1,this.module.createI32(i.lo));var a=i.clone();a.and32(65535),a.isZero||(i.or32(65535),i.add32(1)),i.shru32(16),this.module.setMemory(i.toI32(),y.Module.MAX_MEMORY_WASM32,this.memorySegments,this.options.target,"memory")}return this.module},t.prototype.compileSourceByPath=function(e,t){for(var r=0,n=this.program.sources.length;r<n;++r){var i=this.program.sources[r];if(i.normalizedPath==e)return void this.compileSource(i)}this.error(d.DiagnosticCode.File_0_not_found,t.range,e)},t.prototype.compileSource=function(e){if(!this.files.has(e.normalizedPath)){this.files.add(e.normalizedPath);for(var t=this.options.noTreeShaking,r=0,n=e.statements.length;r<n;++r){var i=e.statements[r];switch(i.kind){case f.NodeKind.CLASS:(t||e.isEntry&&f.hasModifier(f.ModifierKind.EXPORT,i.modifiers))&&!i.typeParameters.length&&this.compileClassDeclaration(i,[]);break;case f.NodeKind.ENUM:(t||e.isEntry&&f.hasModifier(f.ModifierKind.EXPORT,i.modifiers))&&this.compileEnumDeclaration(i);break;case f.NodeKind.FUNCTION:(t||e.isEntry&&f.hasModifier(f.ModifierKind.EXPORT,i.modifiers))&&!i.typeParameters.length&&this.compileFunctionDeclaration(i,[]);break;case f.NodeKind.IMPORT:this.compileSourceByPath(i.normalizedPath,i.path);break;case f.NodeKind.NAMESPACE:(t||e.isEntry&&f.hasModifier(f.ModifierKind.EXPORT,i.modifiers))&&this.compileNamespaceDeclaration(i);break;case f.NodeKind.VARIABLE:this.compileVariableStatement(i);break;case f.NodeKind.EXPORT:null!=i.normalizedPath&&this.compileSourceByPath(i.normalizedPath,i.path),(t||e.isEntry)&&this.compileExportStatement(i);break;default:var a=this.currentFunction;this.currentFunction=this.startFunction;var s=this.compileStatement(i);this.module.noEmit||this.startFunctionBody.push(s),this.currentFunction=a}}}},t.prototype.compileGlobalDeclaration=function(e,t){var r=this.program.elements.get(e.internalName);if(!r||r.kind!=_.ElementKind.GLOBAL)throw new Error("global expected");return this.compileGlobal(r)?(n(r,e)&&(r.hasConstantValue?this.module.addGlobalExport(r.internalName,e.name.name):this.warning(d.DiagnosticCode.Cannot_export_a_mutable_global,e.range)),r):null},t.prototype.compileGlobal=function(e){if(e.isCompiled||e.isBuiltIn)return!0;var t=e.declaration,r=0;if(e.type==E.Type.void){if(!t)throw new Error("declaration expected");if(t.type){var n=this.program.resolveType(t.type);if(!n)return!1;if(n==E.Type.void)return this.error(d.DiagnosticCode.Type_0_is_not_assignable_to_type_1,t.range,"*",n.toString()),!1;e.type=n}else{if(!t.initializer)return this.error(d.DiagnosticCode.Type_expected,t.name.range.atEnd),!1;if(r=this.compileExpression(t.initializer,E.Type.void,0),this.currentType==E.Type.void)return this.error(d.DiagnosticCode.Type_0_is_not_assignable_to_type_1,t.range,this.currentType.toString(),"<auto>"),!1;e.type=this.currentType}}var a=e.type.toNativeType();if(e.isDeclared)return e.isConstant?(this.module.addGlobalImport(e.internalName,e.namespace?e.namespace.simpleName:"env",e.simpleName,a),e.isCompiled=!0,!0):(t&&this.error(d.DiagnosticCode.Operation_not_supported,t.range),!1);var s=!1;if(e.hasConstantValue)r=i(e,this.module);else{if(!t)throw new Error("declaration expected");t.initializer?(r||(r=this.compileExpression(t.initializer,e.type)),this.module.noEmit||_BinaryenExpressionGetId(r)==y.ExpressionId.Const||(e.isMutable?s=!0:(r=this.precomputeExpressionRef(r),_BinaryenExpressionGetId(r)!=y.ExpressionId.Const&&(this.warning(d.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,t.range),s=!0)))):r=e.type.toNativeZero(this.module)}var o=e.internalName;if(s){this.module.addGlobal(o,a,!0,e.type.toNativeZero(this.module));var c=this.module.createSetGlobal(o,r);this.module.noEmit||this.startFunctionBody.push(c)}else if(this.module.addGlobal(o,a,e.isMutable,r),!e.isMutable&&!this.module.noEmit){var p=_BinaryenExpressionGetType(r);switch(p){case y.NativeType.I32:e.constantIntegerValue=new T.I64(_BinaryenConstGetValueI32(r),0);break;case y.NativeType.I64:e.constantIntegerValue=new T.I64(_BinaryenConstGetValueI64Low(r),_BinaryenConstGetValueI64High(r));break;case y.NativeType.F32:e.constantFloatValue=_BinaryenConstGetValueF32(r);break;case y.NativeType.F64:e.constantFloatValue=_BinaryenConstGetValueF64(r);break;default:throw new Error("concrete type expected")}e.hasConstantValue=!0}return e.isCompiled=!0,!0},t.prototype.compileEnumDeclaration=function(e){var t=this.program.elements.get(e.internalName);if(!t||t.kind!=_.ElementKind.ENUM)throw new Error("enum expected");this.compileEnum(t)},t.prototype.compileEnum=function(e){if(e.isCompiled)return!0;e.isCompiled=!0;var t=null;if(e.members)try{for(var r=p(e.members.values()),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.kind==_.ElementKind.ENUMVALUE){var s=!1,o=a;if(o.hasConstantValue)this.module.addGlobal(o.internalName,y.NativeType.I32,!1,this.module.createI32(o.constantValue));else{if(!o.declaration)throw new Error("declaration expected");var c,l=o.declaration;if(l.value?(c=this.compileExpression(l.value,E.Type.i32),this.module.noEmit||_BinaryenExpressionGetId(c)==y.ExpressionId.Const||(c=this.precomputeExpressionRef(c),_BinaryenExpressionGetId(c)!=y.ExpressionId.Const&&(e.isConstant&&this.warning(d.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,l.range),s=!0))):null==t?c=this.module.createI32(0):t.hasConstantValue?c=this.module.createI32(t.constantValue+1):(c=this.module.createBinary(y.BinaryOp.AddI32,this.module.createGetGlobal(t.internalName,y.NativeType.I32),this.module.createI32(1)),e.isConstant&&this.warning(d.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,l.range),s=!0),s){this.module.addGlobal(o.internalName,y.NativeType.I32,!0,this.module.createI32(0));var u=this.module.createSetGlobal(o.internalName,c);this.module.noEmit||this.startFunctionBody.push(u)}else if(this.module.addGlobal(o.internalName,y.NativeType.I32,!1,c),!this.module.noEmit){if(_BinaryenExpressionGetType(c)!=y.NativeType.I32)throw new Error("i32 expected");o.constantValue=_BinaryenConstGetValueI32(c),o.hasConstantValue=!0}}e.declaration&&n(e,e.declaration)&&!s&&this.module.addGlobalExport(a.internalName,a.internalName),t=o}}}catch(e){h={error:e}}finally{try{i&&!i.done&&(m=r.return)&&m.call(r)}finally{if(h)throw h.error}}return!0;var h,m},t.prototype.compileFunctionDeclaration=function(e,t,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var a=e.internalName,s=this.program.elements.get(a);if(!s||s.kind!=_.ElementKind.FUNCTION_PROTOTYPE)throw new Error("function expected");var o=this.compileFunctionUsingTypeArguments(s,t,r,i);o&&n(o,e)&&this.module.addFunctionExport(o.internalName,e.name.name)},t.prototype.compileFunctionUsingTypeArguments=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.resolveInclTypeArguments(t,r,n);return i&&this.compileFunction(i)?i:null},t.prototype.compileFunction=function(e){if(e.isCompiled)return!0;var t=e.prototype.declaration;if(!t)throw new Error("declaration expected");if(e.isDeclared){if(t.statements)return this.error(d.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,t.name.range),!1}else if(!t.statements)return this.error(d.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,t.name.range),!1;e.isCompiled=!0;var r=null;if(!e.isDeclared){var n=this.currentFunction;this.currentFunction=e,r=this.compileStatements(t.statements),this.currentFunction=n}var i=e.parameters.length,a=e.instanceMethodOf?i+1:i,s=0,o=e.returnType.toNativeType(),c=new Array(a),p=new Array(a+1);e.instanceMethodOf&&(c[s]=this.options.target==l.WASM64?y.NativeType.I64:y.NativeType.I32,p[s++]=e.instanceMethodOf.type.toSignatureString());for(var u=0;u<i;++u)c[s]=e.parameters[u].type.toNativeType(),p[s++]=e.parameters[u].type.toSignatureString();p[s]=e.returnType.toSignatureString();var h=this.module.getFunctionTypeBySignature(o,c);return h||(h=this.module.addFunctionType(p.join(""),o,c)),e.isDeclared?this.module.addFunctionImport(e.internalName,e.prototype.namespace?e.prototype.namespace.simpleName:"env",t.name.name,h):this.module.addFunction(e.internalName,h,E.typesToNativeTypes(e.additionalLocals),this.module.createBlock(null,r,y.NativeType.None)),e.finalize(),!0},t.prototype.compileNamespaceDeclaration=function(e){for(var t=e.members,r=this.options.noTreeShaking,n=0,i=t.length;n<i;++n){var a=t[n];switch(a.kind){case f.NodeKind.CLASS:!r&&!f.hasModifier(f.ModifierKind.EXPORT,a.modifiers)||a.typeParameters.length||this.compileClassDeclaration(a,[]);break;case f.NodeKind.INTERFACE:!r&&!f.hasModifier(f.ModifierKind.EXPORT,a.modifiers)||a.typeParameters.length||this.compileInterfaceDeclaration(a,[]);break;case f.NodeKind.ENUM:(r||f.hasModifier(f.ModifierKind.EXPORT,a.modifiers))&&this.compileEnumDeclaration(a);break;case f.NodeKind.FUNCTION:!r&&!f.hasModifier(f.ModifierKind.EXPORT,a.modifiers)||a.typeParameters.length||this.compileFunctionDeclaration(a,[]);break;case f.NodeKind.NAMESPACE:(r||f.hasModifier(f.ModifierKind.EXPORT,a.modifiers))&&this.compileNamespaceDeclaration(a);break;case f.NodeKind.VARIABLE:(r||f.hasModifier(f.ModifierKind.EXPORT,a.modifiers))&&this.compileVariableStatement(a);break;default:throw new Error("namespace member expected")}}},t.prototype.compileNamespace=function(e){if(e.members){var t=this.options.noTreeShaking;try{for(var r=p(e.members.values()),n=r.next();!n.done;n=r.next()){var i=n.value;switch(i.kind){case _.ElementKind.CLASS_PROTOTYPE:!t&&!i.isExported||i.isGeneric||this.compileClassUsingTypeArguments(i,[]);break;case _.ElementKind.ENUM:this.compileEnum(i);break;case _.ElementKind.FUNCTION_PROTOTYPE:!t&&!i.isExported||i.isGeneric||this.compileFunctionUsingTypeArguments(i,[]);break;case _.ElementKind.GLOBAL:this.compileGlobal(i);break;case _.ElementKind.NAMESPACE:this.compileNamespace(i)}}}catch(e){a={error:e}}finally{try{n&&!n.done&&(s=r.return)&&s.call(r)}finally{if(a)throw a.error}}var a,s}},t.prototype.compileExportStatement=function(e){for(var t=e.members,r=0,n=t.length;r<n;++r){var i=t[r],a=e.range.source.internalPath+h.PATH_DELIMITER+i.externalIdentifier.name,s=this.program.exports.get(a);if(s)switch(s.kind){case _.ElementKind.CLASS_PROTOTYPE:s.isGeneric||this.compileClassUsingTypeArguments(s,[]);break;case _.ElementKind.ENUM:this.compileEnum(s);break;case _.ElementKind.FUNCTION_PROTOTYPE:if(!s.isGeneric){var o=this.compileFunctionUsingTypeArguments(s,[]);o&&e.range.source.isEntry&&this.module.addFunctionExport(o.internalName,i.externalIdentifier.name)}break;case _.ElementKind.GLOBAL:this.compileGlobal(s)&&e.range.source.isEntry&&(s.hasConstantValue?this.module.addGlobalExport(s.internalName,i.externalIdentifier.name):this.warning(d.DiagnosticCode.Cannot_export_a_mutable_global,i.range));break;case _.ElementKind.NAMESPACE:this.compileNamespace(s)}}},t.prototype.compileClassDeclaration=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.internalName,a=this.program.elements.get(i);if(!a||a.kind!=_.ElementKind.CLASS_PROTOTYPE)throw new Error("class expected");this.compileClassUsingTypeArguments(a,t,r,n)},t.prototype.compileClassUsingTypeArguments=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.resolveInclTypeArguments(t,r,n);i&&this.compileClass(i)},t.prototype.compileClass=function(e){return!!e.isCompiled||(e.isCompiled=!0)},t.prototype.compileInterfaceDeclaration=function(e,t,r,n){throw void 0===r&&(r=null),void 0===n&&(n=null),new Error("not implemented")},t.prototype.addMemorySegment=function(e){7&this.memoryOffset.lo&&(this.memoryOffset.or32(7),this.memoryOffset.add32(1));var t=y.MemorySegment.create(e,this.memoryOffset.clone());return this.memorySegments.push(t),this.memoryOffset.add32(e.length),t},t.prototype.compileStatement=function(e){switch(e.kind){case f.NodeKind.BLOCK:return this.compileBlockStatement(e);case f.NodeKind.BREAK:return this.compileBreakStatement(e);case f.NodeKind.CONTINUE:return this.compileContinueStatement(e);case f.NodeKind.DO:return this.compileDoStatement(e);case f.NodeKind.EMPTY:return this.compileEmptyStatement(e);case f.NodeKind.EXPRESSION:return this.compileExpressionStatement(e);case f.NodeKind.FOR:return this.compileForStatement(e);case f.NodeKind.IF:return this.compileIfStatement(e);case f.NodeKind.RETURN:return this.compileReturnStatement(e);case f.NodeKind.SWITCH:return this.compileSwitchStatement(e);case f.NodeKind.THROW:return this.compileThrowStatement(e);case f.NodeKind.TRY:return this.compileTryStatement(e);case f.NodeKind.VARIABLE:return this.compileVariableStatement(e);case f.NodeKind.WHILE:return this.compileWhileStatement(e);case f.NodeKind.TYPEDECLARATION:if(this.currentFunction==this.startFunction)return this.module.createNop();default:throw new Error("statement expected")}},t.prototype.compileStatements=function(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=this.compileStatement(e[n]);return r},t.prototype.compileBlockStatement=function(e){var t=e.statements;return 0==t.length?this.module.createNop():1==t.length?this.compileStatement(t[0]):this.module.createBlock(null,this.compileStatements(t),y.NativeType.None)},t.prototype.compileBreakStatement=function(e){if(e.label)return this.error(d.DiagnosticCode.Operation_not_supported,e.label.range),this.module.createUnreachable();var t=this.currentFunction.breakContext;return null!=t?this.module.createBreak("break|"+t):(this.error(d.DiagnosticCode.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement,e.range),this.module.createUnreachable())},t.prototype.compileContinueStatement=function(e){if(e.label)return this.error(d.DiagnosticCode.Operation_not_supported,e.label.range),this.module.createUnreachable();var t=this.currentFunction.breakContext;return t&&!this.disallowContinue?this.module.createBreak("continue|"+t):(this.error(d.DiagnosticCode.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement,e.range),this.module.createUnreachable())},t.prototype.compileDoStatement=function(e){var t=this.currentFunction.enterBreakContext(),r=this.compileStatement(e.statement),n=this.compileExpression(e.condition,E.Type.i32);this.currentFunction.leaveBreakContext();var i="break|"+t,a="continue|"+t;return this.module.createBlock(i,[this.module.createLoop(a,this.module.createBlock(null,[r,this.module.createBreak(a,n)],y.NativeType.None))],y.NativeType.None)},t.prototype.compileEmptyStatement=function(e){return this.module.createNop()},t.prototype.compileExpressionStatement=function(e){var t=this.compileExpression(e.expression,E.Type.void,0);return this.currentType!=E.Type.void&&(t=this.module.createDrop(t),this.currentType=E.Type.void),t},t.prototype.compileForStatement=function(e){var t=this.currentFunction.enterBreakContext(),r=this.variableIsLocal;this.currentFunction==this.startFunction&&(this.variableIsLocal=!0);var n=e.initializer?this.compileStatement(e.initializer):this.module.createNop();this.variableIsLocal=r;var i=e.condition?this.compileExpression(e.condition,E.Type.i32):this.module.createI32(1),a=e.incrementor?this.compileExpression(e.incrementor,E.Type.void):this.module.createNop(),s=this.compileStatement(e.statement);this.currentFunction.leaveBreakContext();var o="continue|"+t,c="break|"+t;return this.module.createBlock(c,[n,this.module.createLoop(o,this.module.createBlock(null,[this.module.createIf(i,this.module.createBlock(null,[s,a,this.module.createBreak(o)],y.NativeType.None))],y.NativeType.None))],y.NativeType.None)},t.prototype.compileIfStatement=function(e){var t=this.compileExpression(e.condition,E.Type.i32),r=this.compileStatement(e.ifTrue),n=e.ifFalse?this.compileStatement(e.ifFalse):0;return this.module.createIf(t,r,n)},t.prototype.compileReturnStatement=function(e){if(this.currentFunction){var t=e.value?this.compileExpression(e.value,this.currentFunction.returnType):0;return this.module.createReturn(t)}return this.module.createUnreachable()},t.prototype.compileSwitchStatement=function(e){var t=this.currentFunction.enterBreakContext(),r=this.disallowContinue;this.disallowContinue=!0;var n=this.currentFunction.getTempLocal(E.Type.i32),i=e.cases.length,a=new Array(1+i);a[0]=this.module.createSetLocal(n.index,this.compileExpression(e.condition,E.Type.i32));for(var s=1,o=-1,c=0;c<i;++c){var p=e.cases[c];p.label?a[s++]=this.module.createBreak("case"+c.toString(10)+"|"+t,this.module.createBinary(y.BinaryOp.EqI32,this.module.createGetLocal(n.index,y.NativeType.I32),this.compileExpression(p.label,E.Type.i32))):o=c}this.currentFunction.freeTempLocal(n),a[s]=this.module.createBreak((o>=0?"case"+o.toString(10):"break")+"|"+t);var l=this.module.createBlock("case0|"+t,a,y.NativeType.None);for(c=0;c<i;++c){p=e.cases[c];var u=c==i-1?"break|"+t:"case"+(c+1).toString(10)+"|"+t,h=p.statements.length,d=new Array(1+h);d[0]=l;for(var _=0;_<h;++_)d[_+1]=this.compileStatement(p.statements[_]);l=this.module.createBlock(u,d,y.NativeType.None)}return this.currentFunction.leaveBreakContext(),this.disallowContinue=r,l},t.prototype.compileThrowStatement=function(e){return this.module.createUnreachable()},t.prototype.compileTryStatement=function(e){throw new Error("not implemented")},t.prototype.compileVariableStatement=function(e){var t=e.declarations;if(this.currentFunction==this.startFunction&&!this.variableIsLocal){for(var r=f.hasModifier(f.ModifierKind.CONST,e.modifiers),n=0,i=t.length;n<i;++n)this.compileGlobalDeclaration(t[n],r);return this.module.createNop()}var a=new Array;for(n=0,i=t.length;n<i;++n){var s=t[n],o=s.name.name,c=null,p=0;if(s.type){if(!(c=this.program.resolveType(s.type,this.currentFunction.contextualTypeArguments,!0)))continue;s.initializer&&(p=this.compileExpression(s.initializer,c))}else{if(!s.initializer){this.error(d.DiagnosticCode.Type_expected,s.name.range.atEnd);continue}if(p=this.compileExpression(s.initializer,E.Type.void,0),this.currentType==E.Type.void){this.error(d.DiagnosticCode.Type_0_is_not_assignable_to_type_1,s.range,this.currentType.toString(),"<auto>");continue}c=this.currentType}if(this.currentFunction.locals.has(o))this.error(d.DiagnosticCode.Duplicate_identifier_0,s.name.range,o);else{if(f.hasModifier(f.ModifierKind.CONST,s.modifiers))if(p){if(p=this.precomputeExpressionRef(p),_BinaryenExpressionGetId(p)==y.ExpressionId.Const){var l=new _.Local(this.program,o,-1,c);switch(_BinaryenExpressionGetType(p)){case y.NativeType.I32:l=l.withConstantIntegerValue(_BinaryenConstGetValueI32(p),0);break;case y.NativeType.I64:l=l.withConstantIntegerValue(_BinaryenConstGetValueI64Low(p),_BinaryenConstGetValueI64High(p));break;case y.NativeType.F32:l=l.withConstantFloatValue(_BinaryenConstGetValueF32(p));break;case y.NativeType.F64:l=l.withConstantFloatValue(_BinaryenConstGetValueF64(p));break;default:throw new Error("concrete type expected")}this.currentFunction.locals.set(o,l);continue}this.warning(d.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,s.range)}else this.error(d.DiagnosticCode._const_declarations_must_be_initialized,s.range);this.currentFunction.addLocal(c,o),p&&a.push(this.compileAssignmentWithValue(s.name,p))}}return a.length?this.module.createBlock(null,a,y.NativeType.None):this.module.createNop()},t.prototype.compileWhileStatement=function(e){var t=this.currentFunction.enterBreakContext(),r=this.compileExpression(e.condition,E.Type.i32),n="break|"+t,i="continue|"+t,a=this.compileStatement(e.statement);return this.currentFunction.leaveBreakContext(),this.module.createBlock(n,[this.module.createLoop(i,this.module.createIf(r,this.module.createBlock(null,[a,this.module.createBreak(i)],y.NativeType.None)))],y.NativeType.None)},t.prototype.compileExpression=function(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!0),this.currentType=t;var i;switch(e.kind){case f.NodeKind.ASSERTION:i=this.compileAssertionExpression(e,t);break;case f.NodeKind.BINARY:i=this.compileBinaryExpression(e,t,n);break;case f.NodeKind.CALL:i=this.compileCallExpression(e,t);break;case f.NodeKind.COMMA:i=this.compileCommaExpression(e,t);break;case f.NodeKind.ELEMENTACCESS:i=this.compileElementAccessExpression(e,t);break;case f.NodeKind.IDENTIFIER:case f.NodeKind.FALSE:case f.NodeKind.NULL:case f.NodeKind.THIS:case f.NodeKind.TRUE:i=this.compileIdentifierExpression(e,t);break;case f.NodeKind.LITERAL:i=this.compileLiteralExpression(e,t);break;case f.NodeKind.NEW:i=this.compileNewExpression(e,t);break;case f.NodeKind.PARENTHESIZED:i=this.compileParenthesizedExpression(e,t);break;case f.NodeKind.PROPERTYACCESS:i=this.compilePropertyAccessExpression(e,t);break;case f.NodeKind.TERNARY:i=this.compileTernaryExpression(e,t);break;case f.NodeKind.UNARYPOSTFIX:i=this.compileUnaryPostfixExpression(e,t);break;case f.NodeKind.UNARYPREFIX:i=this.compileUnaryPrefixExpression(e,t,n);break;default:throw new Error("expression expected")}return 0!=r&&this.currentType!=t&&(i=this.convertExpression(i,this.currentType,t,r,e),this.currentType=t),i},t.prototype.precomputeExpression=function(e,t,r){return void 0===r&&(r=1),this.precomputeExpressionRef(this.compileExpression(e,t,r))},t.prototype.precomputeExpressionRef=function(e){var t=this.currentType.toNativeType(),r=this.module.getFunctionTypeBySignature(t,[]);r||(r=this.module.addFunctionType(this.currentType.toSignatureString(),t,[]));var n=this.module.addFunction("__precompute",r,[],e);this.module.runPasses(["precompute"],n);var i=_BinaryenFunctionGetBody(n);return this.module.removeFunction("__precompute"),i},t.prototype.convertExpression=function(e,t,r,n,i){if(0==n)return assert(!1),e;if(13==t.kind)return this.error(d.DiagnosticCode.Type_0_is_not_assignable_to_type_1,i.range,t.toString(),r.toString()),this.module.createUnreachable();if(13==r.kind)return this.module.createDrop(e);var s=this.module,o=!1;return t.is(8)?r.is(8)?11==t.kind?12==r.kind&&(e=s.createUnary(y.UnaryOp.PromoteF32,e)):11==r.kind&&(o=!0,e=s.createUnary(y.UnaryOp.DemoteF64,e)):r.is(4)?(o=!0,11==t.kind?r.is(1)?r.is(64)?e=s.createUnary(y.UnaryOp.TruncF32ToI64,e):(e=s.createUnary(y.UnaryOp.TruncF32ToI32,e),r.is(32)&&(e=a(e,r,this.module))):r.is(64)?e=s.createUnary(y.UnaryOp.TruncF32ToU64,e):(e=s.createUnary(y.UnaryOp.TruncF32ToU32,e),r.is(32)&&(e=a(e,r,this.module))):r.is(1)?r.is(64)?e=s.createUnary(y.UnaryOp.TruncF64ToI64,e):(e=s.createUnary(y.UnaryOp.TruncF64ToI32,e),r.is(32)&&(e=a(e,r,this.module))):r.is(64)?e=s.createUnary(y.UnaryOp.TruncF64ToU64,e):(e=s.createUnary(y.UnaryOp.TruncF64ToU32,e),r.is(32)&&(e=a(e,r,this.module)))):(assert(0==r.flags),e=this.module.createDrop(e)):t.is(4)&&r.is(8)?11==r.kind?t.is(64)?(o=!0,e=s.createUnary(t.is(1)?y.UnaryOp.ConvertI64ToF32:y.UnaryOp.ConvertU64ToF32,e)):(o=!t.is(32),e=s.createUnary(t.is(1)?y.UnaryOp.ConvertI32ToF32:y.UnaryOp.ConvertU32ToF32,e)):t.is(64)?(o=!0,e=s.createUnary(t.is(1)?y.UnaryOp.ConvertI64ToF64:y.UnaryOp.ConvertU64ToF64,e)):e=s.createUnary(t.is(1)?y.UnaryOp.ConvertI32ToF64:y.UnaryOp.ConvertU32ToF64,e):t.is(64)?r.is(64)||(o=!0,e=s.createUnary(y.UnaryOp.WrapI64,e),r.is(32)&&(e=a(e,r,this.module))):r.is(64)?e=s.createUnary(r.is(1)?y.UnaryOp.ExtendI32:y.UnaryOp.ExtendU32,e):r.is(32)&&(t.size>r.size||t.size==r.size&&t.is(1)!=r.is(1))&&(o=!0,e=a(e,r,this.module)),o&&1==n&&this.error(d.DiagnosticCode.Conversion_from_type_0_to_1_possibly_loses_information_and_thus_requires_an_explicit_cast,i.range,t.toString(),r.toString()),e},t.prototype.compileAssertionExpression=function(e,t){var r=this.program.resolveType(e.toType,this.currentFunction.contextualTypeArguments);return r?this.compileExpression(e.expression,r,2):this.module.createUnreachable()},t.prototype.compileBinaryExpression=function(e,t,r){void 0===r&&(r=!0);var n,i,s,c,p=!1,u=!1,h=null;switch(e.operator){case m.Token.LESSTHAN:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:c=this.module.createBinary(y.BinaryOp.LtI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.LtI64,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.LtI64:y.BinaryOp.LtI32,n,i);break;case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.LtU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.LtU64:y.BinaryOp.LtU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.LtU64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.LtF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.LtF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.GREATERTHAN:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:c=this.module.createBinary(y.BinaryOp.GtI32,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.GtI64:y.BinaryOp.GtI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.GtI64,n,i);break;case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.GtU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.GtU64:y.BinaryOp.GtU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.GtU64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.GtF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.GtF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.LESSTHAN_EQUALS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:c=this.module.createBinary(y.BinaryOp.LeI32,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.LeI64:y.BinaryOp.LeI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.LeI64,n,i);break;case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.LeU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.LeU64:y.BinaryOp.LeU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.LeU64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.LeF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.LeF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.GREATERTHAN_EQUALS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:c=this.module.createBinary(y.BinaryOp.GeI32,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.GeI64:y.BinaryOp.GeI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.GeI64,n,i);break;case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.GeU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.GeU64:y.BinaryOp.GeU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.GeU64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.GeF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.GeF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.EQUALS_EQUALS_EQUALS:case m.Token.EQUALS_EQUALS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.EqI32,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.EqI64:y.BinaryOp.EqI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.EqI64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.EqF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.EqF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.EXCLAMATION_EQUALS_EQUALS:case m.Token.EXCLAMATION_EQUALS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType),this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.NeI32,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.NeI64:y.BinaryOp.NeI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.NeI64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.NeF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.NeF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}this.currentType=E.Type.bool;break;case m.Token.EQUALS:return this.compileAssignment(e.left,e.right,t);case m.Token.PLUS_EQUALS:p=!0;case m.Token.PLUS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;case 2:case 7:c=this.module.createBinary(y.BinaryOp.AddI32,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.AddI64:y.BinaryOp.AddI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.AddI64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.AddF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.AddF64,n,i);break;default:throw new Error("concrete type expected")}break;case m.Token.MINUS_EQUALS:p=!0;case m.Token.MINUS:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;case 2:case 7:c=this.module.createBinary(y.BinaryOp.SubI32,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.SubI64:y.BinaryOp.SubI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.SubI64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.SubF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.SubF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.ASTERISK_EQUALS:p=!0;case m.Token.ASTERISK:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;case 2:case 7:c=this.module.createBinary(y.BinaryOp.MulI32,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.MulI64:y.BinaryOp.MulI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.MulI64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.MulF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.MulF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.SLASH_EQUALS:p=!0;case m.Token.SLASH:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType,1),this.currentType.kind){case 0:case 1:u=!0;case 2:c=this.module.createBinary(y.BinaryOp.DivI32,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.DivI64:y.BinaryOp.DivI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.DivI64,n,i);break;case 5:case 6:case 10:u=!0;case 7:c=this.module.createBinary(y.BinaryOp.DivU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.DivU64:y.BinaryOp.DivU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.DivU64,n,i);break;case 11:c=this.module.createBinary(y.BinaryOp.DivF32,n,i);break;case 12:c=this.module.createBinary(y.BinaryOp.DivF64,n,i);break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.PERCENT_EQUALS:p=!0;case m.Token.PERCENT:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType,1),this.currentType.kind){case 0:case 1:case 2:c=this.module.createBinary(y.BinaryOp.RemI32,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.RemI64:y.BinaryOp.RemI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.RemI64,n,i);break;case 5:case 6:case 7:case 10:c=this.module.createBinary(y.BinaryOp.RemU32,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.RemU64:y.BinaryOp.RemU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.RemU64,n,i);break;case 11:case 12:this.error(d.DiagnosticCode.Operation_not_supported,e.range),c=this.module.createUnreachable();break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.LESSTHAN_LESSTHAN_EQUALS:p=!0;case m.Token.LESSTHAN_LESSTHAN:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;default:c=this.module.createBinary(y.BinaryOp.ShlI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.ShlI64,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.ShlI64:y.BinaryOp.ShlI32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.GREATERTHAN_GREATERTHAN_EQUALS:p=!0;case m.Token.GREATERTHAN_GREATERTHAN:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,0),i=this.compileExpression(e.right,this.currentType,1),this.currentType.kind){default:c=this.module.createBinary(y.BinaryOp.ShrI32,n,i);break;case 3:c=this.module.createBinary(y.BinaryOp.ShrI64,n,i);break;case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.ShrI64:y.BinaryOp.ShrI32,n,i);break;case 5:case 6:case 10:case 7:c=this.module.createBinary(y.BinaryOp.ShrU32,n,i);break;case 8:c=this.module.createBinary(y.BinaryOp.ShrU64,n,i);break;case 9:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.ShrU64:y.BinaryOp.ShrU32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:p=!0;case m.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t==E.Type.void?E.Type.u64:t,0),i=this.compileExpression(e.right,this.currentType,1),this.currentType.kind){case 0:case 1:u=!0;default:c=this.module.createBinary(y.BinaryOp.ShrU32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.ShrU64,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.ShrU64:y.BinaryOp.ShrU32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.AMPERSAND_EQUALS:p=!0;case m.Token.AMPERSAND:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;default:c=this.module.createBinary(y.BinaryOp.AndI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.AndI64,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.AndI64:y.BinaryOp.AndI32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.BAR_EQUALS:p=!0;case m.Token.BAR:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;default:c=this.module.createBinary(y.BinaryOp.OrI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.OrI64,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.OrI64:y.BinaryOp.OrI32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.CARET_EQUALS:p=!0;case m.Token.CARET:switch(n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,0,!1),i=this.compileExpression(e.right,this.currentType,1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:u=!0;default:c=this.module.createBinary(y.BinaryOp.XorI32,n,i);break;case 3:case 8:c=this.module.createBinary(y.BinaryOp.XorI64,n,i);break;case 9:case 4:c=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.XorI64:y.BinaryOp.XorI32,n,i);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.AMPERSAND_AMPERSAND:n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType,1,!1),c=this.module.cloneExpression(n,!0,1),c||(h=this.currentFunction.getAndFreeTempLocal(this.currentType),n=this.module.createTeeLocal(h.index,n)),u=this.currentType.is(36),s=o(n,this.currentType,this.module),c?c=this.module.createIf(s,i,c):(assert(h),c=this.module.createIf(s,i,this.module.createGetLocal(h.index,this.currentType.toNativeType())));break;case m.Token.BAR_BAR:n=this.compileExpression(e.left,t==E.Type.void?E.Type.i32:t,0),i=this.compileExpression(e.right,this.currentType,1,!1),c=this.module.cloneExpression(n,!0,1),c||(h=this.currentFunction.getAndFreeTempLocal(this.currentType),n=this.module.createTeeLocal(h.index,n)),u=this.currentType.is(36),s=o(n,this.currentType,this.module),c?c=this.module.createIf(s,c,i):(assert(h),c=this.module.createIf(s,this.module.createGetLocal(h.index,this.currentType.toNativeType()),i));break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("not implemented")}return u&&r&&(assert(this.currentType.is(36)),c=a(c,this.currentType,this.module)),p?this.compileAssignmentWithValue(e.left,c,t!=E.Type.void):c},t.prototype.compileAssignment=function(e,t,r){var n=this.program.resolveExpression(e,this.currentFunction);if(!n)return this.module.createUnreachable();var i,a=n.element;switch(a.kind){case _.ElementKind.GLOBAL:if(!this.compileGlobal(a))return this.module.createUnreachable();assert(a.type!=E.Type.void);case _.ElementKind.LOCAL:case _.ElementKind.FIELD:i=a.type;break;case _.ElementKind.PROPERTY:var s=a.setterPrototype;if(s){var o=s.resolve();if(!o)return this.module.createUnreachable();i=o.parameters[0].type;break}return this.error(d.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,a.internalName),this.module.createUnreachable();case _.ElementKind.FUNCTION_PROTOTYPE:if(e.kind==f.NodeKind.ELEMENTACCESS){assert(n.target&&n.target.kind==_.ElementKind.CLASS&&a.simpleName==n.target.prototype.fnIndexedGet);var c=a.resolve(null);if(c){i=c.returnType;break}}default:return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}return this.currentType=i,this.compileAssignmentWithValue(e,this.compileExpression(t,i),r!=E.Type.void)},t.prototype.compileAssignmentWithValue=function(e,t,r){void 0===r&&(r=!1);var n=this.program.resolveExpression(e,this.currentFunction);if(!n)return this.module.createUnreachable();var i,a,s=n.element;switch(s.kind){case _.ElementKind.LOCAL:return this.currentType=r?s.type:E.Type.void,s.isConstant?(this.error(d.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,s.internalName),this.module.createUnreachable()):r?this.module.createTeeLocal(s.index,t):this.module.createSetLocal(s.index,t);case _.ElementKind.GLOBAL:if(!this.compileGlobal(s))return this.module.createUnreachable();if(assert(s.type!=E.Type.void),this.currentType=r?s.type:E.Type.void,s.isConstant)return this.error(d.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,s.internalName),this.module.createUnreachable();if(!r)return this.module.createSetGlobal(s.internalName,t);var o=s.type.toNativeType();return this.module.createBlock(null,[this.module.createSetGlobal(s.internalName,t),this.module.createGetGlobal(s.internalName,o)],o);case _.ElementKind.FIELD:if(s.prototype.isReadonly)return this.error(d.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,s.internalName),this.module.createUnreachable();assert(null!=n.targetExpression),a=this.compileExpression(n.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,0),assert(this.currentType.classType),this.currentType=r?s.type:E.Type.void;var c=s.type.toNativeType();return r?(i=this.currentFunction.getAndFreeTempLocal(s.type),this.module.createBlock(null,[this.module.createSetLocal(i.index,t),this.module.createStore(s.type.size>>3,a,this.module.createGetLocal(i.index,c),c,s.memoryOffset),this.module.createGetLocal(i.index,c)],c)):this.module.createStore(s.type.size>>3,a,t,c,s.memoryOffset);case _.ElementKind.PROPERTY:var p=s.setterPrototype;if(p){var u=p.resolve();if(u){if(assert(1==u.parameters.length),!r)return u.isInstance?(assert(null!=n.targetExpression),a=this.compileExpression(n.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,0),assert(this.currentType.classType),this.currentType=E.Type.void,this.makeCall(u,[a,t])):(this.currentType=E.Type.void,this.makeCall(u,[t]));var h=s.getterPrototype;assert(null!=h);var y=h.resolve();if(y)return assert(0==y.parameters.length),u.isInstance?(assert(null!=n.targetExpression),a=this.compileExpression(n.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,0),assert(this.currentType.classType),i=this.currentFunction.getAndFreeTempLocal(y.returnType),this.module.createBlock(null,[this.makeCall(u,[this.module.createTeeLocal(i.index,a),t]),this.makeCall(y,[this.module.createGetLocal(i.index,i.type.toNativeType())])],(this.currentType=y.returnType).toNativeType())):this.module.createBlock(null,[this.makeCall(u,[t]),this.makeCall(y)],(this.currentType=y.returnType).toNativeType())}}else this.error(d.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,s.internalName);return this.module.createUnreachable();case _.ElementKind.FUNCTION_PROTOTYPE:if(e.kind==f.NodeKind.ELEMENTACCESS){assert(n.target&&n.target.kind==_.ElementKind.CLASS);var m=s.resolve();if(!m)return this.module.createUnreachable();var T,g=n.target.prototype.fnIndexedSet;if(null!=g&&n.target.members&&(T=n.target.members.get(g))&&T.kind==_.ElementKind.FUNCTION_PROTOTYPE){var A=T.resolve();if(!A)return this.module.createUnreachable();a=this.compileExpression(n.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,0),assert(this.currentType.classType);var I=this.compileExpression(e.elementExpression,E.Type.i32);return r?(this.currentType=m.returnType,i=this.currentFunction.getAndFreeTempLocal(this.currentType),this.module.createBlock(null,[this.makeCall(A,[a,I,this.module.createTeeLocal(i.index,t)]),this.module.createGetLocal(i.index,i.type.toNativeType())],this.currentType.toNativeType())):(this.currentType=A.returnType,this.makeCall(A,[a,I,t]))}return this.error(d.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,n.target.internalName),this.module.createUnreachable()}}return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileCallExpression=function(e,t){var r=this.program.resolveExpression(e.expression,this.currentFunction);if(!r)return this.module.createUnreachable();var n=r.element;if(n.kind==_.ElementKind.FUNCTION_PROTOTYPE){var i=n,a=null;if(i.isBuiltIn){var s=null;if(e.typeArguments){var o=e.typeArguments.length;s=new Array(o);for(var c=new Array(o),p=0;p<o;++p){var l=this.program.resolveType(e.typeArguments[p],this.currentFunction.contextualTypeArguments,!0);if(!l)return this.module.createUnreachable();s[p]=l,c[p]=l.toString()}a=i.instances.get(c.join(","))}else a=i.instances.get("");if(!a){var h=u.compileCall(this,i,s,e.arguments,t,e);return h||(this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable())}}else a=n.resolveInclTypeArguments(e.typeArguments,this.currentFunction.contextualTypeArguments,e);if(!a)return this.module.createUnreachable();var y=e.arguments.length,m=null!=a.instanceMethodOf?y+1:y,f=0,E=new Array(m);for(a.instanceMethodOf&&(assert(null!=r.targetExpression),E[f++]=r.targetExpression),p=0;p<y;++p)E[f++]=e.arguments[p];return this.compileCall(a,E,e)}return this.error(d.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,n.internalName),this.module.createUnreachable()},t.prototype.compileCall=function(e,t,r){var n=e.parameters,i=n.length,a=null!=e.instanceMethodOf?i+1:i,s=t.length,o=null!=e.instanceMethodOf?s-1:s;if(s>a)return this.error(d.DiagnosticCode.Expected_0_arguments_but_got_1,r.range,i.toString(10),o.toString(10)),this.module.createUnreachable();var c=new Array(a),p=0;for(e.instanceMethodOf&&(c[p++]=this.compileExpression(t[0],e.instanceMethodOf.type));p<a;++p)if(s>p)c[p]=this.compileExpression(t[p],n[p+i-a].type);else{var l=n[p+i-a].initializer;if(!l)return this.error(d.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,r.range,(p+a-i).toString(10),o.toString(10)),this.module.createUnreachable();c[p]=this.compileExpression(l,n[p+i-a].type)}return this.currentType=e.returnType,this.makeCall(e,c)},t.prototype.makeCall=function(e,t){return void 0===t&&(t=null),e.isCompiled||this.compileFunction(e)?e.isDeclared?this.module.createCallImport(e.internalName,t,e.returnType.toNativeType()):this.module.createCall(e.internalName,t,e.returnType.toNativeType()):this.module.createUnreachable()},t.prototype.compileCommaExpression=function(e,t){for(var r=e.expressions,n=r.length,i=new Array(n--),a=0;a<n;++a)i[a]=this.compileExpression(r[a],E.Type.void);return i[a]=this.compileExpression(r[a],t),this.module.createBlock(null,i,this.currentType.toNativeType())},t.prototype.compileElementAccessExpression=function(e,t){var r=this.program.resolveElementAccess(e,this.currentFunction);if(!r)return this.module.createUnreachable();assert(r.element.kind==_.ElementKind.FUNCTION_PROTOTYPE&&r.target&&r.target.kind==_.ElementKind.CLASS);var n=r.element.resolve(null,r.target.contextualTypeArguments);return n?this.compileCall(n,[e.expression,e.elementExpression],e):this.module.createUnreachable()},t.prototype.compileIdentifierExpression=function(e,t){switch(e.kind){case f.NodeKind.NULL:return this.options.target==l.WASM64?(t.classType||(assert(9==t.kind),this.currentType=E.Type.usize64),this.module.createI64(0)):(t.classType||(assert(9==t.kind),this.currentType=E.Type.usize32),this.module.createI32(0));case f.NodeKind.TRUE:return this.currentType=E.Type.bool,this.module.createI32(1);case f.NodeKind.FALSE:return this.currentType=E.Type.bool,this.module.createI32(0);case f.NodeKind.THIS:return this.currentFunction.instanceMethodOf?(this.currentType=this.currentFunction.instanceMethodOf.type,this.module.createGetLocal(0,this.currentType.toNativeType())):(this.error(d.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),this.currentType=this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,this.module.createUnreachable());case f.NodeKind.SUPER:return this.currentFunction.instanceMethodOf&&this.currentFunction.instanceMethodOf.base?(this.currentType=this.currentFunction.instanceMethodOf.base.type,this.module.createGetLocal(0,this.currentType.toNativeType())):(this.error(d.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),this.currentType=this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32,this.module.createUnreachable())}var r=this.program.resolveIdentifier(e,this.currentFunction);if(!r)return this.module.createUnreachable();var n=r.element;switch(n.kind){case _.ElementKind.LOCAL:return this.currentType=n.type,n.hasConstantValue?i(n,this.module):(assert(n.index>=0),this.module.createGetLocal(n.index,this.currentType.toNativeType()));case _.ElementKind.GLOBAL:return n.isBuiltIn?u.compileGetConstant(this,n,e):this.compileGlobal(n)?(assert(n.type!=E.Type.void),this.currentType=n.type,n.hasConstantValue?i(n,this.module):this.module.createGetGlobal(n.internalName,this.currentType.toNativeType())):this.module.createUnreachable()}return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileLiteralExpression=function(e,t){switch(e.literalKind){case 0:var r=e.value;return t==E.Type.f32?this.module.createF32(r):(this.currentType=E.Type.f64,this.module.createF64(r));case 1:var n=e.value;if(t==E.Type.bool&&(n.isZero||n.isOne))return this.module.createI32(n.isZero?0:1);if(t==E.Type.f64)return this.module.createF64(n.toF64());if(t==E.Type.f32)return this.module.createF32(n.toF64());if(t.is(68))return this.module.createI64(n.lo,n.hi);if(!n.fitsInI32)return this.currentType=t.is(1)?E.Type.i64:E.Type.u64,this.module.createI64(n.lo,n.hi);if(t.is(36)){var i=t.computeSmallIntegerShift(E.Type.i32),a=t.computeSmallIntegerMask(E.Type.i32);return this.module.createI32(t.is(1)?n.lo<<i>>i:n.lo&a)}return t!=E.Type.void||n.fitsInI32?(this.currentType=t.is(1)?E.Type.i32:E.Type.u32,this.module.createI32(n.toI32())):(this.currentType=E.Type.i64,this.module.createI64(n.lo,n.hi))}throw new Error("not implemented")},t.prototype.compileNewExpression=function(e,t){throw new Error("not implemented")},t.prototype.compileParenthesizedExpression=function(e,t){return this.compileExpression(e.expression,t,0)},t.prototype.compilePropertyAccessExpression=function(e,t){var r=this.program.resolvePropertyAccess(e,this.currentFunction);if(!r)return this.module.createUnreachable();var n,a=r.element;switch(a.kind){case _.ElementKind.GLOBAL:return a.isBuiltIn?u.compileGetConstant(this,a,e):this.compileGlobal(a)?(assert(a.type!=E.Type.void),this.currentType=a.type,a.hasConstantValue?i(a,this.module):this.module.createGetGlobal(a.internalName,this.currentType.toNativeType())):this.module.createUnreachable();case _.ElementKind.ENUMVALUE:return this.compileEnum(a.enum)?(this.currentType=E.Type.i32,a.hasConstantValue?this.module.createI32(a.constantValue):this.module.createGetGlobal(a.internalName,y.NativeType.I32)):this.module.createUnreachable();case _.ElementKind.FIELD:return assert(null!=r.target),assert(null!=r.targetExpression),assert(a.memoryOffset>=0),n=this.compileExpression(r.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32),this.currentType=a.type,this.module.createLoad(a.type.size>>3,a.type.is(5),n,a.type.toNativeType(),a.memoryOffset);case _.ElementKind.PROPERTY:var s=a.getterPrototype;assert(null!=s);var o=s.resolve();if(!o)return this.module.createUnreachable();if(assert(0==o.parameters.length),this.currentType=o.returnType,o.isInstance){var n=this.compileExpression(r.targetExpression,this.options.target==l.WASM64?E.Type.usize64:E.Type.usize32);return this.makeCall(o,[n])}return this.makeCall(o)}return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileTernaryExpression=function(e,t){var r=this.compileExpression(e.condition,E.Type.i32),n=this.compileExpression(e.ifThen,t),i=this.compileExpression(e.ifElse,t);return this.module.createIf(r,n,i)},t.prototype.compileUnaryPostfixExpression=function(e,t){var r,n,i,s=(e.operator,this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0,!1)),o=!1;switch(e.operator){case m.Token.PLUS_PLUS:switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:o=!0;default:r=y.BinaryOp.AddI32,n=y.NativeType.I32,i=this.module.createI32(1);break;case 9:case 4:r=this.options.target==l.WASM64?y.BinaryOp.AddI64:y.BinaryOp.AddI32,n=this.options.target==l.WASM64?y.NativeType.I64:y.NativeType.I32,i=this.currentType.toNativeOne(this.module);break;case 3:case 8:r=y.BinaryOp.AddI64,n=y.NativeType.I64,i=this.module.createI64(1);break;case 11:r=y.BinaryOp.AddF32,n=y.NativeType.F32,i=this.module.createF32(1);break;case 12:r=y.BinaryOp.AddF64,n=y.NativeType.F64,i=this.module.createF64(1);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;case m.Token.MINUS_MINUS:switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:o=!0;default:r=y.BinaryOp.SubI32,n=y.NativeType.I32,i=this.module.createI32(1);break;case 9:case 4:r=this.options.target==l.WASM64?y.BinaryOp.SubI64:y.BinaryOp.SubI32,n=this.options.target==l.WASM64?y.NativeType.I64:y.NativeType.I32,i=this.currentType.toNativeOne(this.module);break;case 3:case 8:r=y.BinaryOp.SubI64,n=y.NativeType.I64,i=this.module.createI64(1);break;case 11:r=y.BinaryOp.SubF32,n=y.NativeType.F32,i=this.module.createF32(1);break;case 12:r=y.BinaryOp.SubF64,n=y.NativeType.F64,i=this.module.createF64(1);break;case 13:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("concrete type expected")}break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("unary postfix operator expected")}if(t==E.Type.void)return this.compileAssignmentWithValue(e.operand,this.module.createBinary(r,s,i),!1);var c=this.currentFunction.getTempLocal(this.currentType),p=this.module.createBinary(r,this.module.createGetLocal(c.index,n),i);return o&&(assert(this.currentType.is(36)),p=a(p,this.currentType,this.module)),p=this.compileAssignmentWithValue(e.operand,p,!1),this.currentType=c.type,this.currentFunction.freeTempLocal(c),this.module.createBlock(null,[this.module.createSetLocal(c.index,s),p,this.module.createGetLocal(c.index,n)],n)},t.prototype.compileUnaryPrefixExpression=function(e,t,r){void 0===r&&(r=!0);var n,i=!1,o=!1;switch(e.operator){case m.Token.PLUS:if(this.currentType.isReference)return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0,!1),i=this.currentType.is(36);break;case m.Token.MINUS:switch(n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:i=!0;default:n=this.module.createBinary(y.BinaryOp.SubI32,this.module.createI32(0),n);break;case 9:if(this.currentType.isReference)return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();case 4:n=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.SubI64:y.BinaryOp.SubI32,this.currentType.toNativeZero(this.module),n);break;case 3:case 8:n=this.module.createBinary(y.BinaryOp.SubI64,this.module.createI64(0),n);break;case 11:n=this.module.createUnary(y.UnaryOp.NegF32,n);break;case 12:n=this.module.createUnary(y.UnaryOp.NegF64,n)}break;case m.Token.PLUS_PLUS:switch(o=!0,n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:i=!0;default:n=this.module.createBinary(y.BinaryOp.AddI32,n,this.module.createI32(1));break;case 9:if(this.currentType.isReference)return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();case 4:n=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.AddI64:y.BinaryOp.AddI32,n,this.currentType.toNativeOne(this.module));break;case 3:case 8:n=this.module.createBinary(y.BinaryOp.AddI64,n,this.module.createI64(1));break;case 11:n=this.module.createBinary(y.BinaryOp.AddF32,n,this.module.createF32(1));break;case 12:n=this.module.createBinary(y.BinaryOp.AddF64,n,this.module.createF64(1))}break;case m.Token.MINUS_MINUS:switch(o=!0,n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:i=!0;default:n=this.module.createBinary(y.BinaryOp.SubI32,n,this.module.createI32(1));break;case 9:if(this.currentType.isReference)return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();case 4:n=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.SubI64:y.BinaryOp.SubI32,n,this.currentType.toNativeOne(this.module));break;case 3:case 8:n=this.module.createBinary(y.BinaryOp.SubI64,n,this.module.createI64(1));break;case 11:n=this.module.createBinary(y.BinaryOp.SubF32,n,this.module.createF32(1));break;case 12:n=this.module.createBinary(y.BinaryOp.SubF64,n,this.module.createF64(1))}break;case m.Token.EXCLAMATION:n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t,0),n=s(n,this.currentType,this.module),this.currentType=E.Type.bool;break;case m.Token.TILDE:switch(n=this.compileExpression(e.operand,t==E.Type.void?E.Type.i32:t.is(8)?E.Type.i64:t,t==E.Type.void?0:1,!1),this.currentType.kind){case 0:case 1:case 5:case 6:case 10:i=!0;default:n=this.module.createBinary(y.BinaryOp.XorI32,n,this.module.createI32(-1));break;case 9:if(this.currentType.isReference)return this.error(d.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();case 4:n=this.module.createBinary(this.options.target==l.WASM64?y.BinaryOp.XorI64:y.BinaryOp.XorI32,n,this.currentType.toNativeNegOne(this.module));break;case 3:case 8:n=this.module.createBinary(y.BinaryOp.XorI64,n,this.module.createI64(-1,-1))}break;default:throw this.error(d.DiagnosticCode.Operation_not_supported,e.range),new Error("unary operator expected")}return i&&r&&(assert(this.currentType.is(36)),n=a(n,this.currentType,this.module)),o?this.compileAssignmentWithValue(e.operand,n,t!=E.Type.void):n},t}(d.DiagnosticEmitter);t.Compiler=A,t.makeSmallIntegerWrap=a,t.makeIsFalseish=s,t.makeIsTrueish=o},function(e,t,r){"use strict";function n(e,t,r,n){var i=t>>>16,a=65535&t,s=e>>>16,o=65535&e,l=n>>>16,u=65535&n,h=r>>>16,d=65535&r,y=0,_=0,m=0,f=0;f+=o+d,m+=f>>>16,f&=65535,m+=s+h,_+=m>>>16,m&=65535,_+=a+u,y+=_>>>16,_&=65535,y+=i+l,y&=65535,c=m<<16|f,p=y<<16|_}function i(e,t,r,n){var i=t>>>16,a=65535&t,s=e>>>16,o=65535&e,l=n>>>16,u=65535&n,h=r>>>16,d=65535&r,y=0,_=0,m=0,f=0;f+=o*d,m+=f>>>16,f&=65535,m+=s*d,_+=m>>>16,m&=65535,m+=o*h,_+=m>>>16,m&=65535,_+=a*d,y+=_>>>16,_&=65535,_+=s*h,y+=_>>>16,_&=65535,_+=o*u,y+=_>>>16,_&=65535,y+=i*d+a*h+s*u+o*l,y&=65535,c=m<<16|f,p=y<<16|_}function a(e,t,r,n){throw new Error("not implemented")}var s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.lo=e,this.hi=t}return e.fromI32=function(t){return new e(t,t<0?-1:0)},Object.defineProperty(e.prototype,"isZero",{get:function(){return 0==this.lo&&0==this.hi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOne",{get:function(){return 1==this.lo&&0==this.hi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPositive",{get:function(){return this.hi>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNegative",{get:function(){return this.hi<0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOdd",{get:function(){return 1==(1&this.lo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEven",{get:function(){return 0==(1&this.lo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fitsInI32",{get:function(){return 0==this.hi||-1==this.hi&&this.lo<0},enumerable:!0,configurable:!0}),e.prototype.toI32=function(){return this.lo},e.prototype.toF64=function(){return 4294967296*this.hi+(this.lo>>>0)},e.prototype.eq=function(e){return this.eq32(e.lo,e.hi)},e.prototype.eq32=function(e,t){return void 0===t&&(t=0),this.lo==e&&this.hi==t},e.prototype.ne=function(e){return this.ne32(e.lo,e.hi)},e.prototype.ne32=function(e,t){return void 0===t&&(t=0),this.lo!=e||this.hi!=t},e.prototype.neg=function(){this.lo=~this.lo,this.hi=~this.hi,this.add32(1,0)},e.prototype.add=function(e){this.add32(e.lo,e.hi)},e.prototype.add32=function(e,t){void 0===t&&(t=0),n(this.lo,this.hi,e,t),this.lo=c,this.hi=p},e.prototype.sub=function(e){this.sub32(e.lo,e.hi)},e.prototype.sub32=function(e,t){void 0===t&&(t=0),n(~e,~t,1,0),this.add32(c,p)},e.prototype.comp=function(e){return this.comp32(e.lo,e.hi)},e.prototype.comp32=function(e,t){return void 0===t&&(t=0),this.lo==e&&this.hi==t?0:this.hi<0&&t>=0?-1:this.hi>=0&&t<0?1:(n(~e,~t,1,0),n(this.lo,this.hi,c,p),p<0?-1:1)},e.prototype.lt=function(e){return this.lt32(e.lo,e.hi)},e.prototype.lt32=function(e,t){return void 0===t&&(t=0),this.comp32(e,t)<0},e.prototype.lte=function(e){return this.lte32(e.lo,e.hi)},e.prototype.lte32=function(e,t){return void 0===t&&(t=0),this.comp32(e,t)<=0},e.prototype.gt=function(e){return this.gt32(e.lo,e.hi)},e.prototype.gt32=function(e,t){return void 0===t&&(t=0),this.comp32(e,t)>0},e.prototype.gte=function(e){return this.gte32(e.lo,e.hi)},e.prototype.gte32=function(e,t){return void 0===t&&(t=0),this.comp32(e,t)>=0},e.prototype.mul=function(e){this.mul32(e.lo,e.hi)},e.prototype.mul32=function(e,t){if(void 0===t&&(t=0),0!=this.lo||0!=this.hi){if(0==e&&0==t)return this.lo=0,void(this.hi=0);if(0==this.lo&&-2147483648==this.hi)return this.lo=0,void(this.hi=1&e?-2147483648:0);if(0==e&&-2147483648==t)return this.hi=1&this.lo?-2147483648:0,void(this.lo=0);if(this.hi<0)return this.neg(),void(t<0?(n(~e,~t,1,0),i(this.lo,this.hi,c,p),this.lo=c,this.hi=p):(i(this.lo,this.hi,e,t),this.lo=c,this.hi=p,this.neg()));if(t<0)return n(~e,~t,1,0),i(this.lo,this.hi,c,p),this.lo=c,this.hi=p,void this.neg();i(this.lo,this.hi,e,t),this.lo=c,this.hi=p}},e.prototype.div=function(e){this.div32(e.lo,e.hi)},e.prototype.div32=function(e,t){if(void 0===t&&(t=0),0==e&&0==t)throw new Error("division by zero");if(0!=this.lo||0!=this.hi){if(0==this.lo&&-2147483648==this.hi){if(1==e&&0==t||-1==e&&-1==t)return;if(0==e&&-2147483648==t)return this.lo=1,void(this.hi=0);var r=this.lo,s=this.hi;return this.shr32(1,0),(this.div32(e,t),this.shl32(1,0),0==this.lo&&0==this.hi)?void(t<0?(this.lo=1,this.hi=0):(this.lo=-1,this.hi=-1)):(i(e,t,this.lo,this.hi),this.lo=r,this.hi=s,r=c,s=p,this.div32(e,t),this.sub32(c,p),n(r,s,this.lo,this.hi),this.lo=c,void(this.hi=p))}if(this.hi<0)return this.neg(),void(t<0?(n(~e,~t,1,0),a(this.lo,this.hi,c,p),this.lo=c,this.hi=p):(a(this.lo,this.hi,e,t),this.lo=c,this.hi=p,this.neg()));if(t<0)return n(~e,~t,1,0),a(this.lo,this.hi,c,p),this.lo=c,this.hi=p,void this.neg();a(this.lo,this.hi,e,t),this.lo=c,this.hi=p}},e.prototype.mod=function(e){this.mod32(e.lo,e.hi)},e.prototype.mod32=function(e,t){void 0===t&&(t=0);var r=this.lo,n=this.hi;this.div32(e,t),this.mul32(e,t);var i=this.lo,a=this.hi;this.lo=r,this.hi=n,this.sub32(i,a)},e.prototype.not=function(){this.lo=~this.lo,this.hi=~this.hi},e.prototype.and=function(e){this.and32(e.lo,e.hi)},e.prototype.and32=function(e,t){void 0===t&&(t=0),this.lo&=e,this.hi&=t},e.prototype.or=function(e){this.or32(e.lo,e.hi)},e.prototype.or32=function(e,t){void 0===t&&(t=0),this.lo|=e,this.hi|=t},e.prototype.xor=function(e){this.xor32(e.lo,e.hi)},e.prototype.xor32=function(e,t){void 0===t&&(t=0),this.lo^=e,this.hi^=t},e.prototype.shl=function(e){this.shl32(e.lo,e.hi)},e.prototype.shl32=function(e,t){void 0===t&&(t=0),0!=(e&=63)&&(e<32?(this.hi=this.hi<<e|this.lo>>>32-e,this.lo=this.lo<<e):(this.hi=this.lo<<e-32,this.lo=0))},e.prototype.shr=function(e){this.shr32(e.lo,e.hi)},e.prototype.shr32=function(e,t){void 0===t&&(t=0),0!=(e&=63)&&(e<32?(this.lo=this.lo>>>e|this.hi<<32-e,this.hi=this.hi>>e):(this.lo=this.hi>>e-32,this.hi=this.hi>=0?0:-1))},e.prototype.shru=function(e){this.shru32(e.lo,e.hi)},e.prototype.shru32=function(e,t){void 0===t&&(t=0),0!=(e&=63)&&(e<32?(this.lo=this.lo>>>e|this.hi<<32-e,this.hi=this.hi>>>e|0):32==e?(this.lo=this.hi,this.hi=0):(this.lo=this.hi>>>e-32|0,this.hi=0))},e.prototype.clone=function(){return new e(this.lo,this.hi)},e.prototype.toString=function(){var e=!1;if(this.hi<0?(n(~this.lo,~this.hi,1,0),e=!0):(c=this.lo,p=this.hi),p){for(var t=(c>>>0).toString(16);t.length<8;)t="0"+t;return(e?"-0x":"0x")+(p>>>0).toString(16)+t}return e?"-"+c.toString(10):c.toString(10)},e}();t.I64=o;var c=0,p=0,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.fromI32=function(e){return new t(e,0)},Object.defineProperty(t.prototype,"isPositive",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isNegative",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitsInU32",{get:function(){return 0==this.hi},enumerable:!0,configurable:!0}),t.prototype.comp32=function(e,t){return t>>>0>this.hi>>>0||t==this.hi&&e>>>0>this.lo>>>0?-1:1},t.prototype.neg=function(){this.lo=~this.lo,this.hi=~this.hi,this.add32(1,0)},t.prototype.clone=function(){return new t(this.lo,this.hi)},t}(o);t.U64=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,a=r(1),s=r(12),o=r(3);!function(e){e[e.ABSTRACT=0]="ABSTRACT",e[e.AS=1]="AS",e[e.ASYNC=2]="ASYNC",e[e.AWAIT=3]="AWAIT",e[e.BREAK=4]="BREAK",e[e.CASE=5]="CASE",e[e.CATCH=6]="CATCH",e[e.CLASS=7]="CLASS",e[e.CONST=8]="CONST",e[e.CONTINUE=9]="CONTINUE",e[e.CONSTRUCTOR=10]="CONSTRUCTOR",e[e.DEBUGGER=11]="DEBUGGER",e[e.DECLARE=12]="DECLARE",e[e.DEFAULT=13]="DEFAULT",e[e.DELETE=14]="DELETE",e[e.DO=15]="DO",e[e.ELSE=16]="ELSE",e[e.ENUM=17]="ENUM",e[e.EXPORT=18]="EXPORT",e[e.EXTENDS=19]="EXTENDS",e[e.FALSE=20]="FALSE",e[e.FINALLY=21]="FINALLY",e[e.FOR=22]="FOR",e[e.FROM=23]="FROM",e[e.FUNCTION=24]="FUNCTION",e[e.GET=25]="GET",e[e.IF=26]="IF",e[e.IMPLEMENTS=27]="IMPLEMENTS",e[e.IMPORT=28]="IMPORT",e[e.IN=29]="IN",e[e.INSTANCEOF=30]="INSTANCEOF",e[e.INTERFACE=31]="INTERFACE",e[e.IS=32]="IS",e[e.KEYOF=33]="KEYOF",e[e.LET=34]="LET",e[e.MODULE=35]="MODULE",e[e.NAMESPACE=36]="NAMESPACE",e[e.NEW=37]="NEW",e[e.NULL=38]="NULL",e[e.OF=39]="OF",e[e.PACKAGE=40]="PACKAGE",e[e.PRIVATE=41]="PRIVATE",e[e.PROTECTED=42]="PROTECTED",e[e.PUBLIC=43]="PUBLIC",e[e.READONLY=44]="READONLY",e[e.RETURN=45]="RETURN",e[e.SET=46]="SET",e[e.STATIC=47]="STATIC",e[e.SUPER=48]="SUPER",e[e.SWITCH=49]="SWITCH",e[e.THIS=50]="THIS",e[e.THROW=51]="THROW",e[e.TRUE=52]="TRUE",e[e.TRY=53]="TRY",e[e.TYPE=54]="TYPE",e[e.TYPEOF=55]="TYPEOF",e[e.VAR=56]="VAR",e[e.VOID=57]="VOID",e[e.WHILE=58]="WHILE",e[e.WITH=59]="WITH",e[e.YIELD=60]="YIELD",e[e.OPENBRACE=61]="OPENBRACE",e[e.CLOSEBRACE=62]="CLOSEBRACE",e[e.OPENPAREN=63]="OPENPAREN",e[e.CLOSEPAREN=64]="CLOSEPAREN",e[e.OPENBRACKET=65]="OPENBRACKET",e[e.CLOSEBRACKET=66]="CLOSEBRACKET",e[e.DOT=67]="DOT",e[e.DOT_DOT_DOT=68]="DOT_DOT_DOT",e[e.SEMICOLON=69]="SEMICOLON",e[e.COMMA=70]="COMMA",e[e.LESSTHAN=71]="LESSTHAN",e[e.GREATERTHAN=72]="GREATERTHAN",e[e.LESSTHAN_EQUALS=73]="LESSTHAN_EQUALS",e[e.GREATERTHAN_EQUALS=74]="GREATERTHAN_EQUALS",e[e.EQUALS_EQUALS=75]="EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS=76]="EXCLAMATION_EQUALS",e[e.EQUALS_EQUALS_EQUALS=77]="EQUALS_EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS_EQUALS=78]="EXCLAMATION_EQUALS_EQUALS",e[e.EQUALS_GREATERTHAN=79]="EQUALS_GREATERTHAN",e[e.PLUS=80]="PLUS",e[e.MINUS=81]="MINUS",e[e.ASTERISK_ASTERISK=82]="ASTERISK_ASTERISK",e[e.ASTERISK=83]="ASTERISK",e[e.SLASH=84]="SLASH",e[e.PERCENT=85]="PERCENT",e[e.PLUS_PLUS=86]="PLUS_PLUS",e[e.MINUS_MINUS=87]="MINUS_MINUS",e[e.LESSTHAN_LESSTHAN=88]="LESSTHAN_LESSTHAN",e[e.GREATERTHAN_GREATERTHAN=89]="GREATERTHAN_GREATERTHAN",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN=90]="GREATERTHAN_GREATERTHAN_GREATERTHAN",e[e.AMPERSAND=91]="AMPERSAND",e[e.BAR=92]="BAR",e[e.CARET=93]="CARET",e[e.EXCLAMATION=94]="EXCLAMATION",e[e.TILDE=95]="TILDE",e[e.AMPERSAND_AMPERSAND=96]="AMPERSAND_AMPERSAND",e[e.BAR_BAR=97]="BAR_BAR",e[e.QUESTION=98]="QUESTION",e[e.COLON=99]="COLON",e[e.EQUALS=100]="EQUALS",e[e.PLUS_EQUALS=101]="PLUS_EQUALS",e[e.MINUS_EQUALS=102]="MINUS_EQUALS",e[e.ASTERISK_EQUALS=103]="ASTERISK_EQUALS",e[e.ASTERISK_ASTERISK_EQUALS=104]="ASTERISK_ASTERISK_EQUALS",e[e.SLASH_EQUALS=105]="SLASH_EQUALS",e[e.PERCENT_EQUALS=106]="PERCENT_EQUALS",e[e.LESSTHAN_LESSTHAN_EQUALS=107]="LESSTHAN_LESSTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_EQUALS=108]="GREATERTHAN_GREATERTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS=109]="GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS",e[e.AMPERSAND_EQUALS=110]="AMPERSAND_EQUALS",e[e.BAR_EQUALS=111]="BAR_EQUALS",e[e.CARET_EQUALS=112]="CARET_EQUALS",e[e.AT=113]="AT",e[e.IDENTIFIER=114]="IDENTIFIER",e[e.STRINGLITERAL=115]="STRINGLITERAL",e[e.INTEGERLITERAL=116]="INTEGERLITERAL",e[e.FLOATLITERAL=117]="FLOATLITERAL",e[e.INVALID=118]="INVALID",e[e.ENDOFFILE=119]="ENDOFFILE"}(i=t.Token||(t.Token={})),function(e){function t(t){switch(t){case"abstract":return e.ABSTRACT;case"as":return e.AS;case"async":return e.ASYNC;case"await":return e.AWAIT;case"break":return e.BREAK;case"case":return e.CASE;case"catch":return e.CATCH;case"class":return e.CLASS;case"continue":return e.CONTINUE;case"const":return e.CONST;case"constructor":return e.CONSTRUCTOR;case"debugger":return e.DEBUGGER;case"declare":return e.DECLARE;case"default":return e.DEFAULT;case"delete":return e.DELETE;case"do":return e.DO;case"else":return e.ELSE;case"enum":return e.ENUM;case"export":return e.EXPORT;case"extends":return e.EXTENDS;case"false":return e.FALSE;case"finally":return e.FINALLY;case"for":return e.FOR;case"from":return e.FROM;case"function":return e.FUNCTION;case"get":return e.GET;case"if":return e.IF;case"implements":return e.IMPLEMENTS;case"import":return e.IMPORT;case"in":return e.IN;case"instanceof":return e.INSTANCEOF;case"interface":return e.INTERFACE;case"is":return e.IS;case"keyof":return e.KEYOF;case"let":return e.LET;case"module":return e.MODULE;case"namespace":return e.NAMESPACE;case"new":return e.NEW;case"null":return e.NULL;case"of":return e.OF;case"package":return e.PACKAGE;case"private":return e.PRIVATE;case"protected":return e.PROTECTED;case"public":return e.PUBLIC;case"readonly":return e.READONLY;case"return":return e.RETURN;case"set":return e.SET;case"static":return e.STATIC;case"super":return e.SUPER;case"switch":return e.SWITCH;case"this":return e.THIS;case"throw":return e.THROW;case"true":return e.TRUE;case"try":return e.TRY;case"type":return e.TYPE;case"typeof":return e.TYPEOF;case"var":return e.VAR;case"void":return e.VOID;case"while":return e.WHILE;case"with":return e.WITH;case"yield":return e.YIELD;default:return e.INVALID}}function r(t){switch(t){case e.DELETE:return"delete";case e.IN:return"in";case e.INSTANCEOF:return"instanceof";case e.NEW:return"new";case e.TYPEOF:return"typeof";case e.VOID:return"void";case e.YIELD:return"yield";case e.DOT_DOT_DOT:return"...";case e.COMMA:return",";case e.LESSTHAN:return"<";case e.GREATERTHAN:return">";case e.LESSTHAN_EQUALS:return"<=";case e.GREATERTHAN_EQUALS:return">=";case e.EQUALS_EQUALS:return"==";case e.EXCLAMATION_EQUALS:return"!=";case e.EQUALS_EQUALS_EQUALS:return"===";case e.EXCLAMATION_EQUALS_EQUALS:return"!==";case e.PLUS:return"+";case e.MINUS:return"-";case e.ASTERISK_ASTERISK:return"**";case e.ASTERISK:return"*";case e.SLASH:return"/";case e.PERCENT:return"%";case e.PLUS_PLUS:return"++";case e.MINUS_MINUS:return"--";case e.LESSTHAN_LESSTHAN:return"<<";case e.GREATERTHAN_GREATERTHAN:return">>";case e.GREATERTHAN_GREATERTHAN_GREATERTHAN:return">>>";case e.AMPERSAND:return"&";case e.BAR:return"|";case e.CARET:return"^";case e.EXCLAMATION:return"!";case e.TILDE:return"~";case e.AMPERSAND_AMPERSAND:return"&&";case e.BAR_BAR:return"||";case e.EQUALS:return"=";case e.PLUS_EQUALS:return"+=";case e.MINUS_EQUALS:return"-=";case e.ASTERISK_EQUALS:return"*=";case e.ASTERISK_ASTERISK_EQUALS:return"**=";case e.SLASH_EQUALS:return"/=";case e.PERCENT_EQUALS:return"%=";case e.LESSTHAN_LESSTHAN_EQUALS:return"<<=";case e.GREATERTHAN_GREATERTHAN_EQUALS:return">>=";case e.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:return">>>=";case e.AMPERSAND_EQUALS:return"&=";case e.BAR_EQUALS:return"|=";case e.CARET_EQUALS:return"^=";default:return assert(!1),""}}function n(t){switch(t){case e.ABSTRACT:case e.AS:case e.CONSTRUCTOR:case e.DECLARE:case e.FROM:case e.GET:case e.IS:case e.KEYOF:case e.MODULE:case e.NAMESPACE:case e.READONLY:case e.SET:case e.TYPE:return!0;default:return!1}}e.fromKeyword=t,e.operatorToString=r,e.isAlsoIdentifier=n}(i=t.Token||(t.Token={}));var c=function(){function e(e,t,r){this.source=e,this.start=t,this.end=r}return e.join=function(t,r){if(t.source!=r.source)throw new Error("source mismatch");return new e(t.source,t.start<r.start?t.start:r.start,t.end>r.end?t.end:r.end)},Object.defineProperty(e.prototype,"atStart",{get:function(){return new e(this.source,this.start,this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atEnd",{get:function(){return new e(this.source,this.end,this.end)},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.source.text.substring(this.start,this.end)},e}();t.Range=c;var p=function(e){function t(t,r){void 0===r&&(r=null);var n=e.call(this,r)||this;n.end=0,n.pos=0,n.token=-1,n.tokenPos=0,n.markedPos=0,n.markedToken=-1,n.markedTokenPos=0,n.nextToken=-1,n.nextTokenOnNewLine=!1,n.source=t,n.pos=0,n.end=t.text.length,n.diagnostics=r||new Array;var i=t.text;if(n.pos<n.end&&65279==i.charCodeAt(n.pos)&&++n.pos,n.pos+1<n.end&&35==i.charCodeAt(n.pos)&&33==i.charCodeAt(n.pos+1))for(n.pos+=2;n.pos<n.end&&10!=i.charCodeAt(n.pos);)++n.pos;return n}return n(t,e),t.prototype.next=function(e){return void 0===e&&(e=!1),this.nextToken=-1,this.token=this.unsafeNext(e)},t.prototype.unsafeNext=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=i32.MAX_VALUE);for(var r=this.source.text;;){if(this.pos>=this.end)return i.ENDOFFILE;this.tokenPos=this.pos;var n=r.charCodeAt(this.pos);switch(n){case 13:++this.pos<this.end&&10==r.charCodeAt(this.pos)&&++this.pos;break;case 10:case 9:case 11:case 12:case 32:++this.pos;break;case 33:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.EXCLAMATION_EQUALS_EQUALS):i.EXCLAMATION_EQUALS):i.EXCLAMATION;case 34:case 39:case 96:return i.STRINGLITERAL;case 37:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.PERCENT_EQUALS):i.PERCENT;case 38:if(++this.pos,t>1&&this.pos<this.end){if(38==r.charCodeAt(this.pos))return++this.pos,i.AMPERSAND_AMPERSAND;if(61==r.charCodeAt(this.pos))return++this.pos,i.AMPERSAND_EQUALS}return i.AMPERSAND;case 40:return++this.pos,i.OPENPAREN;case 41:return++this.pos,i.CLOSEPAREN;case 42:if(++this.pos,t>1&&this.pos<this.end){if(61==r.charCodeAt(this.pos))return++this.pos,i.ASTERISK_EQUALS;if(42==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.ASTERISK_ASTERISK_EQUALS):i.ASTERISK_ASTERISK}return i.ASTERISK;case 43:if(++this.pos,t>1&&this.pos<this.end){if(43==r.charCodeAt(this.pos))return++this.pos,i.PLUS_PLUS;if(61==r.charCodeAt(this.pos))return++this.pos,i.PLUS_EQUALS}return i.PLUS;case 44:return++this.pos,i.COMMA;case 45:if(++this.pos,t>1&&this.pos<this.end){if(45==r.charCodeAt(this.pos))return++this.pos,i.MINUS_MINUS;if(61==r.charCodeAt(this.pos))return++this.pos,i.MINUS_EQUALS}return i.MINUS;case 46:if(++this.pos,t>1&&this.pos<this.end){if(s.isDecimalDigit(r.charCodeAt(this.pos)))return--this.pos,i.FLOATLITERAL;if(t>2&&46==r.charCodeAt(this.pos)&&this.pos+1<this.end&&46==r.charCodeAt(this.pos+1))return this.pos+=2,i.DOT_DOT_DOT}return i.DOT;case 47:if(++this.pos,t>1&&this.pos<this.end){if(47==r.charCodeAt(this.pos)){for(this.pos+1<this.end&&r.charCodeAt(this.pos+1);++this.pos<this.end&&!s.isLineBreak(r.charCodeAt(this.pos)););continue}if(42==r.charCodeAt(this.pos)){for(var o=!1;++this.pos<this.end;)if(42==(n=r.charCodeAt(this.pos))&&this.pos+1<this.end&&47==r.charCodeAt(this.pos+1)){this.pos+=2,o=!0;break}o||this.error(a.DiagnosticCode._0_expected,this.range(this.pos),"*/");continue}if(61==r.charCodeAt(this.pos))return++this.pos,i.SLASH_EQUALS}return i.SLASH;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.testInteger()?i.INTEGERLITERAL:i.FLOATLITERAL;case 58:return++this.pos,i.COLON;case 59:return++this.pos,i.SEMICOLON;case 60:if(++this.pos,t>1&&this.pos<this.end){if(60==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.LESSTHAN_LESSTHAN_EQUALS):i.LESSTHAN_LESSTHAN;if(61==r.charCodeAt(this.pos))return++this.pos,i.LESSTHAN_EQUALS}return i.LESSTHAN;case 61:if(++this.pos,t>1&&this.pos<this.end){if(61==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.EQUALS_EQUALS_EQUALS):i.EQUALS_EQUALS;if(62==r.charCodeAt(this.pos))return++this.pos,i.EQUALS_GREATERTHAN}return i.EQUALS;case 62:if(++this.pos,t>1&&this.pos<this.end){if(62==r.charCodeAt(this.pos)){if(++this.pos,t>2&&this.pos<this.end){if(62==r.charCodeAt(this.pos))return++this.pos,t>3&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS):i.GREATERTHAN_GREATERTHAN_GREATERTHAN;if(61==r.charCodeAt(this.pos))return++this.pos,i.GREATERTHAN_GREATERTHAN_EQUALS}return i.GREATERTHAN_GREATERTHAN}if(61==r.charCodeAt(this.pos))return++this.pos,i.GREATERTHAN_EQUALS}return i.GREATERTHAN;case 63:return++this.pos,i.QUESTION;case 91:return++this.pos,i.OPENBRACKET;case 93:return++this.pos,i.CLOSEBRACKET;case 94:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.CARET_EQUALS):i.CARET;case 123:return++this.pos,i.OPENBRACE;case 124:if(++this.pos,t>1&&this.pos<this.end){if(124==r.charCodeAt(this.pos))return++this.pos,i.BAR_BAR;if(61==r.charCodeAt(this.pos))return++this.pos,i.BAR_EQUALS}return i.BAR;case 125:return++this.pos,i.CLOSEBRACE;case 126:return++this.pos,i.TILDE;case 64:return++this.pos,i.AT;default:if(s.isIdentifierStart(n)){if(s.isKeywordCharacter(n)){for(var c=this.pos;++this.pos<this.end&&s.isIdentifierPart(n=r.charCodeAt(this.pos));)if(!s.isKeywordCharacter(n))return this.pos=c,i.IDENTIFIER;var p=r.substring(c,this.pos),l=i.fromKeyword(p);if(!(l==i.INVALID||e&&i.isAlsoIdentifier(l)))return l;this.pos=c}return i.IDENTIFIER}if(s.isWhiteSpace(n)){++this.pos;break}return this.error(a.DiagnosticCode.Invalid_character,this.range(this.pos,this.pos+1)),++this.pos,i.INVALID}}},t.prototype.peek=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=i32.MAX_VALUE);var n=this.source.text;if(this.nextToken<0){var i=this.pos,a=this.token,o=this.tokenPos;if(this.nextToken=this.unsafeNext(t,r),e)for(this.nextTokenOnNewLine=!1;--this.tokenPos>i;)if(s.isLineBreak(n.charCodeAt(this.tokenPos))){this.nextTokenOnNewLine=!0;break}this.pos=i,this.token=a,this.tokenPos=o}return this.nextToken},t.prototype.skip=function(e){var t=this.pos,r=this.token,n=this.tokenPos,a=i32.MAX_VALUE;switch(e){case i.GREATERTHAN:a=1}return(this.token=this.unsafeNext(e==i.IDENTIFIER,a))==e?(this.nextToken=-1,!0):(this.pos=t,this.token=r,this.tokenPos=n,!1)},t.prototype.mark=function(){this.markedPos=this.pos,this.markedToken=this.token,this.markedTokenPos=this.tokenPos},t.prototype.reset=function(){this.pos=this.markedPos,this.token=this.markedToken,this.tokenPos=this.markedTokenPos,this.nextToken=-1},t.prototype.range=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),e<0?(e=this.tokenPos,t=this.pos):t<0&&(t=e),new c(this.source,e,t)},t.prototype.readIdentifier=function(){for(var e=this.source.text,t=this.pos;++this.pos<this.end&&s.isIdentifierPart(e.charCodeAt(this.pos)););return e.substring(t,this.pos)},t.prototype.readString=function(){for(var e=this.source.text,t=e.charCodeAt(this.pos++),r=this.pos,n="";;){if(this.pos>=this.end){n+=e.substring(r,this.pos),this.error(a.DiagnosticCode.Unterminated_string_literal,this.range(r-1,this.end));break}var i=e.charCodeAt(this.pos);if(i==t){n+=e.substring(r,this.pos++);break}if(92!=i){if(s.isLineBreak(i)){n+=e.substring(r,this.pos),this.error(a.DiagnosticCode.Unterminated_string_literal,this.range(r-1,this.pos));break}++this.pos}else n+=e.substring(r,this.pos),n+=this.readEscapeSequence(),r=this.pos}return n},t.prototype.readEscapeSequence=function(){if(++this.pos>=this.end)return this.error(a.DiagnosticCode.Unexpected_end_of_text,this.range(this.end)),"";var e=this.source.text,t=e.charCodeAt(this.pos++);switch(t){case 48:return"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return this.pos<this.end&&123==e.charCodeAt(this.pos)?(++this.pos,this.readExtendedUnicodeEscape()):this.readUnicodeEscape();case 13:this.pos<this.end&&10==e.charCodeAt(this.pos)&&++this.pos;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(t)}},t.prototype.readRegexpPattern=function(){for(var e=this.source.text,t=this.pos,r=!1;;){if(this.pos>=this.end){this.error(a.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,this.end));break}if(92!=e.charCodeAt(this.pos)){var n=e.charCodeAt(this.pos);if(47==n&&!r)break;if(s.isLineBreak(n)){this.error(a.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,this.pos));break}++this.pos,r=!1}else++this.pos,r=!0}return e.substring(t,this.pos)},t.prototype.readRegexpFlags=function(){for(var e=this.source.text,t=this.pos,r=0;this.pos<this.end;){var n=e.charCodeAt(this.pos);if(!s.isIdentifierPart(n))break;switch(++this.pos,n){case 103:r|=1&r?-1:1;break;case 105:r|=2&r?-1:2;break;case 109:r|=4&r?-1:4;break;default:r=-1}}return-1==r&&this.error(a.DiagnosticCode.Invalid_regular_expression_flags,this.range(t,this.pos)),e.substring(t,this.pos)},t.prototype.testInteger=function(){var e=this.source.text;if(48==e.charCodeAt(this.pos)&&this.pos+1<this.end)switch(e.charCodeAt(this.pos+2)){case 88:case 120:case 66:case 98:case 79:case 111:return!0}for(var t=this.pos;t<this.end;){var r=e.charCodeAt(t);if(46==r||69==r||101==r)return!1;if(r<48||r>57)break;t++}return!0},t.prototype.readInteger=function(){var e=this.source.text;if(48==e.charCodeAt(this.pos)&&this.pos+2<this.end){switch(e.charCodeAt(this.pos+1)){case 88:case 120:return this.pos+=2,this.readHexInteger();case 66:case 98:return this.pos+=2,this.readBinaryInteger();case 79:case 111:return this.pos+=2,this.readOctalInteger()}if(s.isOctalDigit(e.charCodeAt(this.pos+1))){var t=this.pos;++this.pos;var r=this.readOctalInteger();return this.error(a.DiagnosticCode.Octal_literals_are_not_allowed_in_strict_mode,this.range(t,this.pos)),r}}return this.readDecimalInteger()},t.prototype.readHexInteger=function(){for(var e=this.source.text,t=this.pos,r=new o.I64(0,0);this.pos<this.end;){var n=e.charCodeAt(this.pos);if(n>=48&&n<=57)r.mul32(16),r.add32(n-48);else if(n>=65&&n<=70)r.mul32(16),r.add32(10+n-65);else{if(!(n>=97&&n<=102))break;r.mul32(16),r.add32(10+n-97)}++this.pos}return this.pos==t&&this.error(a.DiagnosticCode.Hexadecimal_digit_expected,this.range(t)),r},t.prototype.readDecimalInteger=function(){for(var e=this.source.text,t=this.pos,r=new o.I64(0,0);this.pos<this.end;){var n=e.charCodeAt(this.pos);if(!(n>=48&&n<=57))break;r.mul32(10),r.add32(n-48),++this.pos}return this.pos==t&&this.error(a.DiagnosticCode.Digit_expected,this.range(t)),r},t.prototype.readOctalInteger=function(){for(var e=this.source.text,t=this.pos,r=new o.I64(0,0);this.pos<this.end;){var n=e.charCodeAt(this.pos);if(!(n>=48&&n<=55))break;r.mul32(8),r.add32(n-48),++this.pos}return this.pos==t&&this.error(a.DiagnosticCode.Octal_digit_expected,this.range(t)),r},t.prototype.readBinaryInteger=function(){for(var e=this.source.text,t=this.pos,r=new o.I64;this.pos<this.end;){var n=e.charCodeAt(this.pos);if(48==n)r.mul32(2);else{if(49!=n)break;r.mul32(2),r.add32(1)}++this.pos}return this.pos==t&&this.error(a.DiagnosticCode.Binary_digit_expected,this.range(t)),r},t.prototype.readFloat=function(){for(var e=this.pos,t=this.source.text;this.pos<this.end&&s.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos;if(this.pos<this.end&&46==t.charCodeAt(this.pos))for(++this.pos;this.pos<this.end&&s.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos;if(this.pos<this.end){var r=t.charCodeAt(this.pos);if(69==r||101==r)for(++this.pos<this.end&&(45==t.charCodeAt(this.pos)||43==t.charCodeAt(this.pos))&&s.isDecimalDigit(t.charCodeAt(this.pos+1))&&++this.pos;this.pos<this.end&&s.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos}return parseFloat(t.substring(e,this.pos))},t.prototype.readUnicodeEscape=function(){for(var e=4,t=0,r=this.source.text;this.pos<this.end;){var n=r.charCodeAt(this.pos++);if(n>=48&&n<=57)t=16*t+n-48;else if(n>=65&&n<=70)t=16*t+10+n-65;else{if(!(n>=97&&n<=102))return this.error(a.DiagnosticCode.Hexadecimal_digit_expected,this.range(this.pos-1,this.pos)),"";t=16*t+10+n-97}if(0==--e)break}return e?(this.error(a.DiagnosticCode.Unexpected_end_of_text,this.range(this.pos)),""):String.fromCharCode(t)},t.prototype.readExtendedUnicodeEscape=function(){var e=this.pos,t=this.readHexInteger(),r=!1;t.gt32(1114111)&&(this.error(a.DiagnosticCode.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive,this.range(e,this.pos)),r=!0);var n=t.toI32(),i=this.source.text;return this.pos>=this.end?(this.error(a.DiagnosticCode.Unexpected_end_of_text,this.range(e,this.end)),r=!0):125==i.charCodeAt(this.pos)?++this.pos:(this.error(a.DiagnosticCode.Unterminated_Unicode_escape_sequence,this.range(e,this.pos)),r=!0),r?"":n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-65536)/1024|0),(n-65536)%1024+56320)},t}(a.DiagnosticEmitter);t.Tokenizer=p},function(e,t,r){"use strict";function n(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=e[n].toNativeType();return r}function i(e){var t=e.length;if(!t)return"";for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n].toString();return r.join(", ")}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0);!function(e){e[e.I8=0]="I8",e[e.I16=1]="I16",e[e.I32=2]="I32",e[e.I64=3]="I64",e[e.ISIZE=4]="ISIZE",e[e.U8=5]="U8",e[e.U16=6]="U16",e[e.U32=7]="U32",e[e.U64=8]="U64",e[e.USIZE=9]="USIZE",e[e.BOOL=10]="BOOL",e[e.F32=11]="F32",e[e.F64=12]="F64",e[e.VOID=13]="VOID"}(t.TypeKind||(t.TypeKind={}));!function(e){e[e.NONE=0]="NONE",e[e.SIGNED=1]="SIGNED",e[e.UNSIGNED=2]="UNSIGNED",e[e.INTEGER=4]="INTEGER",e[e.FLOAT=8]="FLOAT",e[e.SIZE=16]="SIZE",e[e.SMALL=32]="SMALL",e[e.LONG=64]="LONG",e[e.VALUE=128]="VALUE",e[e.REFERENCE=256]="REFERENCE",e[e.NULLABLE=512]="NULLABLE"}(t.TypeFlags||(t.TypeFlags={}));var s=function(){function e(e,t,r){this.nullableType=null,this.kind=e,this.flags=t,this.size=r,this.byteSize=ceil(r/8),this.classType=null,this.nonNullableType=this}return e.prototype.computeSmallIntegerShift=function(e){return e.size-this.size},e.prototype.computeSmallIntegerMask=function(e){return-1>>>e.size-this.size},e.prototype.is=function(e){return(this.flags&e)==e},Object.defineProperty(e.prototype,"isClass",{get:function(){return null!=this.classType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFunction",{get:function(){return null!=this.functionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReference",{get:function(){return null!=this.classType||null!=this.functionType},enumerable:!0,configurable:!0}),e.prototype.asClass=function(t){assert(9==this.kind);var r=new e(this.kind,-129&this.flags|256,this.size);return r.classType=t,r},e.prototype.asFunction=function(t){assert(9==this.kind&&!this.isReference);var r=new e(this.kind,-129&this.flags|256,this.size);return r.functionType=t,r},e.prototype.asNullable=function(){return assert(9==this.kind),this.nullableType||(assert(!this.is(512)&&this.isReference),this.nullableType=new e(this.kind,512|this.flags,this.size),this.nullableType.classType=this.classType,this.nullableType.functionType=this.functionType),this.nullableType},e.prototype.toString=function(e){switch(void 0===e&&(e=!1),this.kind){case 0:return"i8";case 1:return"i16";case 2:return"i32";case 3:return"i64";case 4:return"isize";case 5:return"u8";case 6:return"u16";case 7:return"u32";case 8:return"u64";case 9:return e?"usize":this.classType?this.classType.toString():this.functionType?this.functionType.toTypeString():"usize";case 10:return"bool";case 11:return"f32";case 12:return"f64";case 13:return"void";default:return assert(!1),""}},e.prototype.toNativeType=function(){switch(this.kind){default:return a.NativeType.I32;case 3:case 8:return a.NativeType.I64;case 4:case 9:return 64==this.size?a.NativeType.I64:a.NativeType.I32;case 11:return a.NativeType.F32;case 12:return a.NativeType.F64;case 13:return a.NativeType.None}},e.prototype.toNativeZero=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(0);case 4:case 9:if(64!=this.size)return e.createI32(0);case 3:case 8:return e.createI64(0);case 11:return e.createF32(0);case 12:return e.createF64(0)}},e.prototype.toNativeOne=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(1);case 4:case 9:if(64!=this.size)return e.createI32(1);case 3:case 8:return e.createI64(1);case 11:return e.createF32(1);case 12:return e.createF64(1)}},e.prototype.toNativeNegOne=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(-1);case 4:case 9:if(64!=this.size)return e.createI32(-1);case 3:case 8:return e.createI64(-1,-1);case 11:return e.createF32(-1);case 12:return e.createF64(-1)}},e.prototype.toSignatureString=function(){switch(this.kind){default:return"i";case 3:case 8:return"I";case 4:case 9:return 64==this.size?"I":"i";case 11:return"f";case 12:return"F";case 13:return"v"}},e.i8=new e(0,165,8),e.i16=new e(1,165,16),e.i32=new e(2,133,32),e.i64=new e(3,197,64),e.isize32=new e(4,149,32),e.isize64=new e(4,213,64),e.u8=new e(5,166,8),e.u16=new e(6,166,16),e.u32=new e(7,134,32),e.u64=new e(8,198,64),e.usize32=new e(9,150,32),e.usize64=new e(9,214,64),e.bool=new e(10,166,1),e.f32=new e(11,137,32),e.f64=new e(12,201,64),e.void=new e(13,0,0),e}();t.Type=s,t.typesToNativeTypes=n,t.typesToString=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var s=r(10),o=r(2),c=r(7),p=r(1),l=r(5),u=r(3),h=r(8),d=r(0),y=function(){function e(){}return e}(),_=function(){function e(){}return e}(),m=new Map,f=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this,t)||this;return r.diagnosticsOffset=0,r.target=o.Target.WASM32,r.elements=new Map,r.types=m,r.typeAliases=new Map,r.exports=new Map,r.sources=[],r}return n(t,e),t.prototype.initialize=function(e){void 0===e&&(e=o.Target.WASM32),this.target=e,this.types=new Map([["i8",l.Type.i8],["i16",l.Type.i16],["i32",l.Type.i32],["i64",l.Type.i64],["isize",e==o.Target.WASM64?l.Type.isize64:l.Type.isize32],["u8",l.Type.u8],["u16",l.Type.u16],["u32",l.Type.u32],["u64",l.Type.u64],["usize",e==o.Target.WASM64?l.Type.usize64:l.Type.usize32],["bool",l.Type.bool],["f32",l.Type.f32],["f64",l.Type.f64],["void",l.Type.void],["number",l.Type.f64],["boolean",l.Type.bool]]),s.initialize(this);for(var t=new Map,r=new Array,n=new Array,c=0,u=this.sources.length;c<u;++c)for(var d=this.sources[c],y=d.statements,_=0,m=y.length;_<m;++_){var f=y[_];switch(f.kind){case h.NodeKind.CLASS:this.initializeClass(f,n);break;case h.NodeKind.ENUM:this.initializeEnum(f);break;case h.NodeKind.EXPORT:this.initializeExports(f,t);break;case h.NodeKind.FUNCTION:this.initializeFunction(f);break;case h.NodeKind.IMPORT:this.initializeImports(f,t,r);break;case h.NodeKind.INTERFACE:this.initializeInterface(f);break;case h.NodeKind.NAMESPACE:this.initializeNamespace(f,n,null);break;case h.NodeKind.TYPEDECLARATION:this.initializeTypeAlias(f);break;case h.NodeKind.VARIABLE:this.initializeVariables(f)}}var E;for(c=0;c<r.length;){var T=r[c];E=this.tryResolveImport(T.referencedName,t),E?(this.elements.set(T.internalName,E),r.splice(c,1)):(this.error(p.DiagnosticCode.Module_0_has_no_exported_member_1,T.declaration.range,T.declaration.parent.path.value,T.declaration.externalIdentifier.name),++c)}try{for(var A=i(t),I=A.next();!I.done;I=A.next()){var S=a(I.value,2),v=S[0],N=S[1],b=N;do{if(!b.isReExport){E=this.elements.get(b.referencedName),E?this.exports.set(v,E):this.error(p.DiagnosticCode.Cannot_find_name_0,N.member.range,N.member.identifier.name);break}if(E=this.exports.get(b.referencedName)){this.exports.set(v,E);break}(b=t.get(b.referencedName))||this.error(p.DiagnosticCode.Module_0_has_no_exported_member_1,N.member.externalIdentifier.range,N.member.parent.path.value,N.member.externalIdentifier.name)}while(b)}}catch(e){x={error:e}}finally{try{I&&!I.done&&(L=A.return)&&L.call(A)}finally{if(x)throw x.error}}for(c=0,u=n.length;c<u;++c){var C=n[c].declaration;assert(null!=C);var k=C.extendsType;assert(null!=k);var O=this.resolveIdentifier(k.identifier,null);if(O){if(O.element.kind!=g.CLASS_PROTOTYPE){this.error(p.DiagnosticCode.A_class_may_only_extend_another_class,k.range);continue}n[c].basePrototype=O.element}}var x,L},t.prototype.tryResolveImport=function(e,t){for(var r;;){if(r=this.exports.get(e))return r;var n=t.get(e);if(!n)return null;if(!n.isReExport)return this.elements.get(n.referencedName);e=n.referencedName}},t.prototype.checkGlobalAlias=function(e,t){(h.hasDecorator("global",t.decorators)||t.range.source.isStdlib&&assert(t.parent).kind==h.NodeKind.SOURCE&&e.isExported)&&(this.elements.has(t.name.name)?this.error(p.DiagnosticCode.Duplicate_identifier_0,t.name.range,e.internalName):this.elements.set(t.name.name,e))},t.prototype.initializeClass=function(e,t,r){void 0===r&&(r=null);var n=e.internalName;if(this.elements.has(n))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,n);var i=new F(this,e.name.name,n,e);if(i.namespace=r,this.elements.set(n,i),this.checkGlobalAlias(i,e),h.hasDecorator("explicit",e.decorators))i.isExplicit=!0,e.implementsTypes&&e.implementsTypes.length&&this.error(p.DiagnosticCode.Structs_cannot_implement_interfaces,h.Range.join(e.name.range,e.implementsTypes[e.implementsTypes.length-1].range));else if(e.implementsTypes.length)throw new Error("not implemented");if(e.extendsType&&t.push(i),r){if(r.members){if(r.members.has(e.name.name))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else r.members=new Map;r.members.set(e.name.name,i)}else if(i.isExported){if(this.exports.has(n))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,n);this.exports.set(n,i)}for(var a=e.members,s=0,o=a.length;s<o;++s){var c=a[s];switch(c.kind){case h.NodeKind.FIELD:this.initializeField(c,i);break;case h.NodeKind.METHOD:var l;(l=h.hasModifier(h.ModifierKind.GET,c.modifiers))||h.hasModifier(h.ModifierKind.SET,c.modifiers)?this.initializeAccessor(c,i,l):this.initializeMethod(c,i);break;default:throw new Error("class member expected")}}},t.prototype.initializeField=function(e,t){var r=e.name.name,n=e.internalName;if(h.hasModifier(h.ModifierKind.STATIC,e.modifiers)){if(this.elements.has(n))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName);if(t.members){if(t.members.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName)}else t.members=new Map;var i=new C(this,r,n,e,l.Type.void);t.members.set(r,i),this.elements.set(n,i)}else{if(t.instanceMembers){if(t.instanceMembers.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName)}else t.instanceMembers=new Map;var a=new B(t,r,n,e);t.instanceMembers.set(r,a)}},t.prototype.initializeMethod=function(e,t){var r=e.name.name,n=e.internalName,i=null;if(h.hasModifier(h.ModifierKind.STATIC,e.modifiers)){if(this.elements.has(n))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName);if(t.members){if(t.members.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName)}else t.members=new Map;var a=new x(this,r,n,e,null);t.members.set(r,a),this.elements.set(n,a)}else{if(t.instanceMembers){if(t.instanceMembers.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName)}else t.instanceMembers=new Map;i=new x(this,r,n,e,t),t.instanceMembers.set(r,i)}if(e.decorators)for(var s=0,o=e.decorators.length;s<o;++s){var c=e.decorators[s];if(2==c.decoratorKind){if(!i){this.error(p.DiagnosticCode.Operation_not_supported,c.range);continue}var l=c.arguments&&c.arguments.length||0;if(1==l){var u=c.arguments[0];if(u.kind==h.NodeKind.LITERAL&&2==u.literalKind)switch(u.value){case"[]":t.fnIndexedGet=i.simpleName;break;case"[]=":t.fnIndexedSet=i.simpleName;break;case"+":t.fnConcat=i.simpleName;break;case"==":t.fnEquals=i.simpleName;break;default:this.error(p.DiagnosticCode.Operation_not_supported,u.range)}else this.error(p.DiagnosticCode.String_literal_expected,u.range)}else this.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,c.range,"1",l.toString(0))}else 0!=c.decoratorKind&&this.error(p.DiagnosticCode.Operation_not_supported,c.range)}},t.prototype.initializeAccessor=function(e,t,r){var n=e.name.name,i=e.internalName,a=this.elements.get(i);if(a){if(a.kind!=g.PROPERTY||(r?a.getterPrototype:a.setterPrototype))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,i)}else a=new U(this,n,i,t);var s=(r?c.GETTER_PREFIX:c.SETTER_PREFIX)+n;if(h.hasModifier(h.ModifierKind.STATIC,e.modifiers)){var o=t.internalName+c.STATIC_DELIMITER+s;if(this.elements.has(o))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,o);var l=new x(this,s,o,e,null);r?a.getterPrototype=l:a.setterPrototype=l,t.members||(t.members=new Map),t.members.set(n,a),this.elements.set(i,a)}else{var u=t.internalName+c.INSTANCE_DELIMITER+s;if(t.instanceMembers){if(t.instanceMembers.has(s))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,e.internalName)}else t.instanceMembers=new Map;var d=new x(this,s,u,e,t);r?a.getterPrototype=d:a.setterPrototype=d,t.instanceMembers.set(s,a),this.elements.set(i,a)}},t.prototype.initializeEnum=function(e,t){void 0===t&&(t=null);var r=e.internalName;if(this.elements.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);var n=new v(this,e.name.name,r,e);if(n.namespace=t,this.elements.set(r,n),this.checkGlobalAlias(n,e),t){if(t.members){if(t.members.has(e.name.name))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(e.name.name,n)}else if(n.isExported){if(this.exports.has(r))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);this.exports.set(r,n)}for(var i=e.values,a=0,s=i.length;a<s;++a)this.initializeEnumValue(i[a],n)},t.prototype.initializeEnumValue=function(e,t){var r=e.name.name,n=e.internalName;if(t.members){if(t.members.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.members=new Map;var i=new N(t,this,r,n,e);t.members.set(r,i)},t.prototype.initializeExports=function(e,t){for(var r=e.members,n=0,i=r.length;n<i;++n)this.initializeExport(r[n],e.internalPath,t)},t.prototype.initializeExport=function(e,t,r){var n=e.range.source.internalPath+c.PATH_DELIMITER+e.externalIdentifier.name;if(this.exports.has(n))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalIdentifier.range,n);var i,a;if(null==t){if(i=e.range.source.internalPath+c.PATH_DELIMITER+e.identifier.name,this.elements.has(i))return void this.exports.set(n,this.elements.get(i));if(r.has(n))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalIdentifier.range,n);a=new y,a.isReExport=!1,a.referencedName=i,a.member=e,r.set(n,a)}else{if(i=t+c.PATH_DELIMITER+e.identifier.name,this.exports.has(i))return void this.exports.set(n,this.exports.get(i));for(var s=new Set;a=r.get(i);){if(!a.isReExport){if(this.elements.has(a.referencedName))return void this.exports.set(n,this.elements.get(i));break}if(this.exports.has(a.referencedName))return void this.exports.set(n,this.exports.get(i));if(i=a.referencedName,s.has(a))break;s.add(a)}if(r.has(n))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalIdentifier.range,n);a=new y,a.isReExport=!0,a.referencedName=i,a.member=e,r.set(n,a)}},t.prototype.initializeFunction=function(e,t){void 0===t&&(t=null);var r=e.internalName;if(this.elements.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);var n=new x(this,e.name.name,r,e,null);if(n.namespace=t,this.elements.set(r,n),this.checkGlobalAlias(n,e),t){if(t.members){if(t.members.has(e.name.name))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(e.name.name,n)}else if(n.isExported){if(this.exports.has(r))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);this.exports.set(r,n)}},t.prototype.initializeImports=function(e,t,r){var n=e.declarations;if(n)for(var i=0,a=n.length;i<a;++i)this.initializeImport(n[i],e.internalPath,t,r);else if(e.namespaceName){var s=e.range.source.internalPath+"/"+e.namespaceName.name;if(this.elements.has(s))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.namespaceName.range,s);this.error(p.DiagnosticCode.Operation_not_supported,e.range)}},t.prototype.initializeImport=function(e,t,r,n){var i=e.internalName;if(this.elements.has(i))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,i);var a=t+c.PATH_DELIMITER+e.externalIdentifier.name;if(this.exports.has(a))return void this.elements.set(i,this.exports.get(a));for(var s,o=new Set;s=r.get(a);){if(!s.isReExport){if(this.elements.has(s.referencedName))return void this.elements.set(i,this.elements.get(a));break}if(this.exports.has(s.referencedName))return void this.elements.set(i,this.exports.get(a));if(a=s.referencedName,o.has(s))break;o.add(s)}var l=new _;l.internalName=i,l.referencedName=a,l.declaration=e,n.push(l)},t.prototype.initializeInterface=function(e,t){void 0===t&&(t=null);var r=e.internalName;if(this.elements.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);var n=new M(this,e.name.name,r,e);if(n.namespace=t,this.elements.set(r,n),this.checkGlobalAlias(n,e),t){if(t.members){if(t.members.has(n.internalName))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(n.internalName,n)}else if(n.isExported){if(this.exports.has(r))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);this.exports.set(r,n)}for(var i=e.members,a=0,s=i.length;a<s;++a){var o=i[a];switch(o.kind){case h.NodeKind.FIELD:this.initializeField(o,n);break;case h.NodeKind.METHOD:var c;(c=h.hasModifier(h.ModifierKind.GET,o.modifiers))||h.hasModifier(h.ModifierKind.SET,o.modifiers)?this.initializeAccessor(o,n,c):this.initializeMethod(o,n);break;default:throw new Error("interface member expected")}}},t.prototype.initializeNamespace=function(e,t,r){void 0===r&&(r=null);var n=e.internalName,i=this.elements.get(n);if(i||(i=new S(this,e.name.name,n,e),i.namespace=r,this.elements.set(n,i),this.checkGlobalAlias(i,e)),r){if(r.members){if(r.members.has(e.name.name))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else r.members=new Map;r.members.set(e.name.name,i)}else if(i.isExported){if(this.exports.has(n))return void this.error(p.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,n);this.exports.set(n,i)}for(var a=e.members,s=0,o=a.length;s<o;++s)switch(a[s].kind){case h.NodeKind.CLASS:this.initializeClass(a[s],t,i);break;case h.NodeKind.ENUM:this.initializeEnum(a[s],i);break;case h.NodeKind.FUNCTION:this.initializeFunction(a[s],i);break;case h.NodeKind.INTERFACE:this.initializeInterface(a[s],i);break;case h.NodeKind.NAMESPACE:this.initializeNamespace(a[s],t,i);break;case h.NodeKind.TYPEDECLARATION:this.error(p.DiagnosticCode.Operation_not_supported,a[s].range);break;case h.NodeKind.VARIABLE:this.initializeVariables(a[s],i);break;default:throw new Error("namespace member expected")}},t.prototype.initializeTypeAlias=function(e,t){void 0===t&&(t=null);var r=e.name.name;if(this.types.has(r)||this.typeAliases.has(r))return void this.error(p.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);this.typeAliases.set(r,e.alias)},t.prototype.initializeVariables=function(e,t){void 0===t&&(t=null);for(var r=e.declarations,n=0,i=r.length;n<i;++n){var a=r[n],s=a.internalName;if(this.elements.has(s))this.error(p.DiagnosticCode.Duplicate_identifier_0,a.name.range,s);else{var o=new C(this,a.name.name,s,a,l.Type.void);if(o.namespace=t,this.elements.set(s,o),(h.hasDecorator("global",a.decorators)||a.range.source.isStdlib&&assert(e.parent).kind==h.NodeKind.SOURCE&&o.isExported)&&(this.elements.has(a.name.name)?this.error(p.DiagnosticCode.Duplicate_identifier_0,a.name.range,s):this.elements.set(a.name.name,o)),t){if(t.members){if(t.members.has(a.name.name)){this.error(p.DiagnosticCode.Duplicate_identifier_0,a.name.range,s);continue}}else t.members=new Map;t.members.set(a.name.name,o)}else o.isExported&&(this.exports.has(s)?this.error(p.DiagnosticCode.Duplicate_identifier_0,a.name.range,s):this.exports.set(s,o))}}},t.prototype.resolveType=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=!0);var n,i=e.identifier.name,a=e.range.source.internalPath+c.PATH_DELIMITER+e.identifier.name;if((n=this.elements.get(a))||(n=this.elements.get(i)))switch(n.kind){case g.CLASS_PROTOTYPE:var s=n.resolveInclTypeArguments(e.typeArguments,t,null);return s?s.type:null}for(var o=e.typeArguments.length,u=new Array(o),h=0;h<o;++h){var d=this.resolveType(e.typeArguments[h],t,r);if(!d)return null;u[h]=d}if(o){var y=l.typesToString(u);y.length&&(a+="<"+y+">",i+="<"+y+">")}else if(t){var _=t.get(i);if(_)return _}var m;if((m=this.types.get(a))||(m=this.types.get(i)))return m;var f=this.typeAliases.get(i);return f&&(m=this.resolveType(f,null,r))?m:(r&&this.error(p.DiagnosticCode.Cannot_find_name_0,e.identifier.range,i),null)},t.prototype.resolveTypeArguments=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.length,a=t?t.length:0;if(i!=a)return a?this.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,h.Range.join(t[0].range,t[a-1].range),i.toString(10),a.toString(10)):n&&this.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,n.range.atEnd,i.toString(10),"0"),null;for(var s=new Array(i),o=0;o<i;++o){var c=this.resolveType(t[o],r,!0);if(!c)return null;s[o]=c}return s},t.prototype.resolveIdentifier=function(e,t){var r,n,i=e.name;if(t){var a=t.locals.get(i);if(a)return(T||(T=new E)).set(a);if(n=t.prototype.namespace)do{if(r=this.elements.get(n.internalName+c.STATIC_DELIMITER+i))return(T||(T=new E)).set(r)}while(n=n.namespace)}return(r=this.elements.get(e.range.source.internalPath+c.PATH_DELIMITER+i))?(T||(T=new E)).set(r):(r=this.elements.get(i))?(T||(T=new E)).set(r):(this.error(p.DiagnosticCode.Cannot_find_name_0,e.range,i),null)},t.prototype.resolvePropertyAccess=function(e,t){var r=e.expression;if(!(T=this.resolveExpression(r,t)))return null;var n,i,a=T.element,s=e.property.name;switch(a.kind){case g.GLOBAL:case g.LOCAL:case g.FIELD:if(!(n=a.type).classType)break;a=n.classType;case g.CLASS_PROTOTYPE:case g.CLASS:for(;;){if(a.members&&(i=a.members.get(s)))return T.set(i).withTarget(a,r);if(a.kind==g.CLASS_PROTOTYPE){if(!a.basePrototype)break;a=a.basePrototype}else{if(a.kind!=g.CLASS)break;if(!a.base)break;a=a.base}}break;default:if(a.members&&(i=a.members.get(s)))return T.set(i).withTarget(a,r)}return this.error(p.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,s,a.internalName),null},t.prototype.resolveElementAccess=function(e,t){var r=e.expression;if(!(T=this.resolveExpression(r,t)))return null;var n=T.element;switch(n.kind){case g.GLOBAL:case g.LOCAL:case g.FIELD:var i=n.type;if(i.classType){var a,s=(n=i.classType).prototype.fnIndexedGet;if(null!=s&&n.members&&(a=n.members.get(s))&&a.kind==g.FUNCTION_PROTOTYPE)return T.set(a).withTarget(i.classType,r)}}return this.error(p.DiagnosticCode.Index_signature_is_missing_in_type_0,r.range,n.internalName),null},t.prototype.resolveExpression=function(e,t){var r;switch(e.kind){case h.NodeKind.THIS:return(r=t.instanceMethodOf)?(T||(T=new E)).set(r):(this.error(p.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),null);case h.NodeKind.SUPER:return(r=t.instanceMethodOf)&&(r=r.base)?(T||(T=new E)).set(r):(this.error(p.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),null);case h.NodeKind.IDENTIFIER:return this.resolveIdentifier(e,t);case h.NodeKind.PROPERTYACCESS:return this.resolvePropertyAccess(e,t);case h.NodeKind.ELEMENTACCESS:return this.resolveElementAccess(e,t)}return this.error(p.DiagnosticCode.Operation_not_supported,e.range),null},t}(p.DiagnosticEmitter);t.Program=f;var E=function(){function e(){}return e.prototype.set=function(e){return this.target=null,this.targetExpression=null,this.element=e,this},e.prototype.withTarget=function(e,t){return this.target=e,this.targetExpression=t,this},e}();t.ResolvedElement=E;var T,g;!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.LOCAL=1]="LOCAL",e[e.ENUM=2]="ENUM",e[e.ENUMVALUE=3]="ENUMVALUE",e[e.FUNCTION_PROTOTYPE=4]="FUNCTION_PROTOTYPE",e[e.FUNCTION=5]="FUNCTION",e[e.CLASS_PROTOTYPE=6]="CLASS_PROTOTYPE",e[e.CLASS=7]="CLASS",e[e.INTERFACE_PROTOTYPE=8]="INTERFACE_PROTOTYPE",e[e.INTERFACE=9]="INTERFACE",e[e.FIELD_PROTOTYPE=10]="FIELD_PROTOTYPE",e[e.FIELD=11]="FIELD",e[e.PROPERTY=12]="PROPERTY",e[e.NAMESPACE=13]="NAMESPACE"}(g=t.ElementKind||(t.ElementKind={}));var A;!function(e){e[e.NONE=0]="NONE",e[e.COMPILED=1]="COMPILED",e[e.IMPORTED=2]="IMPORTED",e[e.EXPORTED=4]="EXPORTED",e[e.BUILTIN=8]="BUILTIN",e[e.DECLARED=16]="DECLARED",e[e.GENERIC=32]="GENERIC",e[e.CONSTANT=64]="CONSTANT",e[e.CONSTANT_VALUE=128]="CONSTANT_VALUE",e[e.INSTANCE=256]="INSTANCE",e[e.GETTER=512]="GETTER",e[e.SETTER=1024]="SETTER",e[e.GLOBAL=2048]="GLOBAL",e[e.READONLY=4096]="READONLY",e[e.PUBLIC=8192]="PUBLIC",e[e.PROTECTED=16384]="PROTECTED",e[e.PRIVATE=32768]="PRIVATE",e[e.ABSTRACT=65536]="ABSTRACT",e[e.EXPLICIT=131072]="EXPLICIT",e[e.HAS_STATIC_BASE_MEMBERS=262144]="HAS_STATIC_BASE_MEMBERS"}(A=t.ElementFlags||(t.ElementFlags={}));var I=function(){function e(e,t,r){this.flags=A.NONE,this.members=null,this.namespace=null,this.program=e,this.simpleName=t,this.internalName=r}return Object.defineProperty(e.prototype,"isCompiled",{get:function(){return 0!=(this.flags&A.COMPILED)},set:function(e){e?this.flags|=A.COMPILED:this.flags&=~A.COMPILED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isImported",{get:function(){return 0!=(this.flags&A.IMPORTED)},set:function(e){e?this.flags|=A.IMPORTED:this.flags&=~A.IMPORTED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExported",{get:function(){return 0!=(this.flags&A.EXPORTED)},set:function(e){e?this.flags|=A.EXPORTED:this.flags&=~A.EXPORTED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return 0!=(this.flags&A.BUILTIN)},set:function(e){e?this.flags|=A.BUILTIN:this.flags&=~A.BUILTIN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeclared",{get:function(){return 0!=(this.flags&A.DECLARED)},set:function(e){e?this.flags|=A.DECLARED:this.flags&=~A.DECLARED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGeneric",{get:function(){return 0!=(this.flags&A.GENERIC)},set:function(e){e?this.flags|=A.GENERIC:this.flags&=~A.GENERIC},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isConstant",{get:function(){return 0!=(this.flags&A.CONSTANT)},set:function(e){e?this.flags|=A.CONSTANT:this.flags&=~A.CONSTANT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMutable",{get:function(){return!(this.flags&A.CONSTANT)},set:function(e){e?this.flags&=~A.CONSTANT:this.flags|=A.CONSTANT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasConstantValue",{get:function(){return 0!=(this.flags&A.CONSTANT_VALUE)},set:function(e){e?this.flags|=A.CONSTANT_VALUE:this.flags&=~A.CONSTANT_VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInstance",{get:function(){return 0!=(this.flags&A.INSTANCE)},set:function(e){e?this.flags|=A.INSTANCE:this.flags&=~A.INSTANCE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGlobal",{get:function(){return 0!=(this.flags&A.GLOBAL)},set:function(e){e?this.flags|=A.GLOBAL:this.flags&=~A.GLOBAL},enumerable:!0,configurable:!0}),e}();t.Element=I;var S=function(e){function t(t,r,n,i){void 0===i&&(i=null);var a=e.call(this,t,r,n)||this;if(a.kind=g.NAMESPACE,(a.declaration=i)&&a.declaration.modifiers)for(var s=0,o=a.declaration.modifiers.length;s<o;++s)switch(a.declaration.modifiers[s].modifierKind){case h.ModifierKind.IMPORT:a.isImported=!0;break;case h.ModifierKind.EXPORT:a.isExported=!0;break;case h.ModifierKind.DECLARE:a.isDeclared=!0;break;default:throw new Error("unexpected modifier")}return a}return n(t,e),t}(I);t.Namespace=S;var v=function(e){function t(t,r,n,i){void 0===i&&(i=null);var a=e.call(this,t,r,n)||this;if(a.kind=g.ENUM,(a.declaration=i)&&a.declaration.modifiers)for(var s=0,o=a.declaration.modifiers.length;s<o;++s)switch(a.declaration.modifiers[s].modifierKind){case h.ModifierKind.EXPORT:a.isExported=!0;break;case h.ModifierKind.IMPORT:a.isImported=!0;break;case h.ModifierKind.DECLARE:a.isDeclared=!0;break;case h.ModifierKind.CONST:a.isConstant=!0;break;default:throw new Error("unexpected modifier")}return a}return n(t,e),t}(I);t.Enum=v;var N=function(e){function t(t,r,n,i,a){void 0===a&&(a=null);var s=e.call(this,r,n,i)||this;return s.kind=g.ENUMVALUE,s.constantValue=0,s.enum=t,s.declaration=a,s}return n(t,e),t}(I);t.EnumValue=N;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.constantIntegerValue=null,t.constantFloatValue=0,t}return n(t,e),t.prototype.withConstantIntegerValue=function(e,t){return this.constantIntegerValue=new u.I64(e,t),this.hasConstantValue=!0,this.isMutable=!1,this},t.prototype.withConstantFloatValue=function(e){return this.constantFloatValue=e,this.hasConstantValue=!0,this.isMutable=!1,this},t}(I);t.VariableLikeElement=b;var C=function(e){function t(t,r,n,i,a){void 0===i&&(i=null);var s=e.call(this,t,r,n)||this;if(s.kind=g.GLOBAL,s.declaration=i){if(s.declaration.modifiers)for(var o=0,c=s.declaration.modifiers.length;o<c;++o)switch(s.declaration.modifiers[o].modifierKind){case h.ModifierKind.IMPORT:s.isImported=!0;break;case h.ModifierKind.EXPORT:s.isExported=!0;break;case h.ModifierKind.CONST:s.isConstant=!0;break;case h.ModifierKind.DECLARE:s.isDeclared=!0;break;case h.ModifierKind.STATIC:break;default:throw new Error("unexpected modifier")}}else s.hasConstantValue=!0;return s.type=a,s}return n(t,e),t}(b);t.Global=C;var k=function(){function e(e,t,r){void 0===r&&(r=null),this.name=e,this.type=t,this.initializer=r}return e}();t.Parameter=k;var O=function(e){function t(t,r,n,i){var a=e.call(this,t,r,r)||this;return a.kind=g.LOCAL,a.index=n,a.type=i,a}return n(t,e),t}(b);t.Local=O;var x=function(e){function t(t,r,n,i,a){void 0===a&&(a=null);var s=e.call(this,t,r,n)||this;if(s.kind=g.FUNCTION_PROTOTYPE,s.instances=new Map,s.classTypeArguments=null,s.declaration=i){if(s.declaration.modifiers)for(var o=0,c=s.declaration.modifiers.length;o<c;++o)switch(s.declaration.modifiers[o].modifierKind){case h.ModifierKind.IMPORT:s.isImported=!0;break;case h.ModifierKind.EXPORT:s.isExported=!0;break;case h.ModifierKind.DECLARE:s.isDeclared=!0;break;case h.ModifierKind.GET:s.isGetter=!0;break;case h.ModifierKind.SET:s.isSetter=!0;break;case h.ModifierKind.STATIC:case h.ModifierKind.ABSTRACT:case h.ModifierKind.PRIVATE:case h.ModifierKind.PROTECTED:case h.ModifierKind.PUBLIC:break;default:throw new Error("unexpected modifier")}s.declaration.typeParameters.length&&(s.isGeneric=!0)}return(s.classPrototype=a)&&(s.isInstance=!0),s}return n(t,e),Object.defineProperty(t.prototype,"isGetter",{get:function(){return 0!=(this.flags&A.GETTER)},set:function(e){e?this.flags|=A.GETTER:this.flags&=~A.GETTER},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSetter",{get:function(){return 0!=(this.flags&A.SETTER)},set:function(e){e?this.flags|=A.SETTER:this.flags&=~A.SETTER},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAccessor",{get:function(){return 0!=(this.flags&(A.GETTER|A.SETTER))},enumerable:!0,configurable:!0}),t.prototype.resolve=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var r=e?l.typesToString(e):"",n=this.instances.get(r);if(n)return n;var s=this.declaration;if(!s)throw new Error("cannot resolve built-ins");var o=t;if(t=new Map,o)try{for(var c=i(o),p=c.next();!p.done;p=c.next()){var u=a(p.value,2),h=u[0],d=u[1];t.set(h,d)}}catch(e){C={error:e}}finally{try{p&&!p.done&&(O=c.return)&&O.call(c)}finally{if(C)throw C.error}}var y,_;if(this.classTypeArguments){if(!this.classPrototype)throw new Error("partially resolved instance method must reference its class prototype");var m=this.classPrototype.declaration;if(!m)throw new Error("cannot resolve built-ins");var f=m.typeParameters;if((_=this.classTypeArguments.length)!=f.length)throw new Error("type argument count mismatch");for(y=0;y<_;++y)t.set(f[y].identifier.name,this.classTypeArguments[y])}var E=s.typeParameters;if(e&&(_=e.length)){if(_!=E.length)throw new Error("type argument count mismatch");for(y=0;y<_;++y)t.set(E[y].identifier.name,e[y])}_=s.parameters.length;var T,g=new Array(_),A=new Array(_);for(y=0;y<_;++y){if(!(T=s.parameters[y].type))return null;var I=this.program.resolveType(T,t,!0);if(!I)return null;g[y]=new k(s.parameters[y].name.name,I),A[y]=I}var S;if(this.isSetter)S=l.Type.void;else{if(!(T=s.returnType))return null;var v=this.program.resolveType(T,t,!0);if(!v)return null;S=v}var N=this.internalName;r.length&&(N+="<"+r+">");var b=null;return this.classPrototype&&!(b=this.classPrototype.resolve(this.classTypeArguments,t))?null:(n=new L(this,N,e,g,S,b),n.contextualTypeArguments=t,this.instances.set(r,n),n);var C,O},t.prototype.resolveInclTypeArguments=function(e,t,r){var n=null;if(this.isGeneric){if(assert(null!=e&&0!=e.length),!this.declaration)throw new Error("cannot resolve built-ins");if(!(n=this.program.resolveTypeArguments(this.declaration.typeParameters,e,t,r)))return null}return this.resolve(n,t)},t.prototype.resolvePartial=function(e){if(!this.classPrototype)throw new Error("partially resolved instance method must reference its class prototype");if(e&&e.length){var r=new t(this.program,this.simpleName,this.internalName,this.declaration,this.classPrototype);return r.flags=this.flags,r.classTypeArguments=e,r}return this},t.prototype.toString=function(){return this.simpleName},t}(I);t.FunctionPrototype=x;var L=function(e){function t(t,r,n,s,o,c){var p=e.call(this,t.program,t.simpleName,r)||this;p.kind=g.FUNCTION,p.locals=new Map,p.additionalLocals=[],p.breakContext=null,p.nextBreakId=0,p.breakStack=null,p.tempI32s=null,p.tempI64s=null,p.tempF32s=null,p.tempF64s=null,p.prototype=t,p.typeArguments=n,p.parameters=s,p.returnType=o,p.instanceMethodOf=c,p.flags=t.flags;var l=0;if(c){if(assert(p.isInstance),p.locals.set("this",new O(t.program,"this",l++,c.type)),c.contextualTypeArguments){p.contextualTypeArguments||(p.contextualTypeArguments=new Map);try{for(var u=i(c.contextualTypeArguments),h=u.next();!h.done;h=u.next()){var d=a(h.value,2),y=d[0],_=d[1];p.contextualTypeArguments.set(y,_)}}catch(e){T={error:e}}finally{try{h&&!h.done&&(A=u.return)&&A.call(u)}finally{if(T)throw T.error}}}}else assert(!p.isInstance);for(var m=0,f=s.length;m<f;++m){var E=s[m];p.locals.set(E.name,new O(t.program,E.name,l++,E.type))}return p;var T,A}return n(t,e),t.prototype.addLocal=function(e,t){void 0===t&&(t=null);var r=this.parameters.length+this.additionalLocals.length;this.isInstance&&r++;var n=new O(this.prototype.program,t||"anonymous$"+r.toString(10),r,e);if(t){if(this.locals.has(t))throw new Error("duplicate local name");this.locals.set(t,n)}return this.additionalLocals.push(e),n},t.prototype.getTempLocal=function(e){var t;switch(e.toNativeType()){case d.NativeType.I32:t=this.tempI32s;break;case d.NativeType.I64:t=this.tempI64s;break;case d.NativeType.F32:t=this.tempF32s;break;case d.NativeType.F64:t=this.tempF64s;break;default:throw new Error("concrete type expected")}return t&&t.length>0?t.pop():this.addLocal(e)},t.prototype.freeTempLocal=function(e){var t;switch(assert(null!=e.type),e.type.toNativeType()){case d.NativeType.I32:t=this.tempI32s||(this.tempI32s=[]);break;case d.NativeType.I64:t=this.tempI64s||(this.tempI64s=[]);break;case d.NativeType.F32:t=this.tempF32s||(this.tempF32s=[]);break;case d.NativeType.F64:t=this.tempF64s||(this.tempF64s=[]);break;default:throw new Error("concrete type expected")}t.push(e)},t.prototype.getAndFreeTempLocal=function(e){var t;switch(e.toNativeType()){case d.NativeType.I32:t=this.tempI32s||(this.tempI32s=[]);break;case d.NativeType.I64:t=this.tempI64s||(this.tempI64s=[]);break;case d.NativeType.F32:t=this.tempF32s||(this.tempF32s=[]);break;case d.NativeType.F64:t=this.tempF64s||(this.tempF64s=[]);break;default:throw new Error("concrete type expected")}if(t.length>0)return t[t.length-1];var r=this.addLocal(e);return t.push(r),r},t.prototype.enterBreakContext=function(){var e=this.nextBreakId++;return this.breakStack?this.breakStack.push(e):this.breakStack=[e],this.breakContext=e.toString(10)},t.prototype.leaveBreakContext=function(){assert(null!=this.breakStack);var e=this.breakStack.length;assert(e>0),this.breakStack.pop(),e>1?this.breakContext=this.breakStack[e-2].toString(10):(this.breakContext=null,this.breakStack=null)},t.prototype.finalize=function(){assert(!this.breakStack||!this.breakStack.length),this.breakStack=null,this.breakContext=null,this.tempI32s=this.tempI64s=this.tempF32s=this.tempF64s=null},t.prototype.toString=function(){return this.prototype.simpleName},t.prototype.toTypeString=function(){throw new Error("not implemented")},t}(I);t.Function=L;var B=function(e){function t(t,r,n,i){void 0===i&&(i=null);var a=e.call(this,t.program,r,n)||this;if(a.kind=g.FIELD_PROTOTYPE,a.classPrototype=t,(a.declaration=i)&&a.declaration.modifiers)for(var s=0,o=a.declaration.modifiers.length;s<o;++s)switch(a.declaration.modifiers[s].modifierKind){case h.ModifierKind.EXPORT:a.isExported=!0;break;case h.ModifierKind.READONLY:a.isReadonly=!0;break;case h.ModifierKind.PRIVATE:case h.ModifierKind.PROTECTED:case h.ModifierKind.PUBLIC:case h.ModifierKind.STATIC:break;default:throw new Error("unexpected modifier")}return a}return n(t,e),Object.defineProperty(t.prototype,"isReadonly",{get:function(){return 0!=(this.flags&A.READONLY)},set:function(e){e?this.flags|=A.READONLY:this.flags&=~A.READONLY},enumerable:!0,configurable:!0}),t}(b);t.FieldPrototype=B;var R=function(e){function t(t,r,n){var i=e.call(this,t.program,t.simpleName,r)||this;return i.kind=g.FIELD,i.constantIntegerValue=null,i.constantFloatValue=0,i.memoryOffset=-1,i.prototype=t,i.flags=t.flags,i.type=n,i}return n(t,e),t}(I);t.Field=R;var U=function(e){function t(t,r,n,i){var a=e.call(this,t,r,n)||this;return a.kind=g.PROPERTY,a.getterPrototype=null,a.setterPrototype=null,a.parent=i,a}return n(t,e),t}(I);t.Property=U;var F=function(e){function t(t,r,n,i){void 0===i&&(i=null);var a=e.call(this,t,r,n)||this;if(a.kind=g.CLASS_PROTOTYPE,a.instances=new Map,a.instanceMembers=null,a.basePrototype=null,a.fnIndexedGet=null,a.fnIndexedSet=null,a.fnConcat=null,a.fnEquals=null,a.declaration=i){if(a.declaration.modifiers)for(var s=0,o=a.declaration.modifiers.length;s<o;++s)switch(a.declaration.modifiers[s].modifierKind){case h.ModifierKind.IMPORT:a.isImported=!0;break;case h.ModifierKind.EXPORT:a.isExported=!0;break;case h.ModifierKind.DECLARE:a.isDeclared=!0;break;default:throw new Error("unexpected modifier")}a.declaration.typeParameters.length&&(a.isGeneric=!0)}return a}return n(t,e),Object.defineProperty(t.prototype,"isExplicit",{get:function(){return 0!=(this.flags&A.EXPLICIT)},set:function(e){e?this.flags|=A.EXPLICIT:this.flags&=~A.EXPLICIT},enumerable:!0,configurable:!0}),t.prototype.resolve=function(e,t){void 0===t&&(t=null);var r=e?l.typesToString(e):"",n=this.instances.get(r);if(n)return n;var s=this.declaration;if(!s)throw new Error("cannot resolve built-ins");var o=t;if(t=new Map,o)try{for(var c=i(o),u=c.next();!u.done;u=c.next()){var d=a(u.value,2),y=d[0],_=d[1];t.set(y,_)}}catch(e){F={error:e}}finally{try{u&&!u.done&&(M=c.return)&&M.call(c)}finally{if(F)throw F.error}}var m=null;if(s.extendsType){var f=this.program.resolveType(s.extendsType,null);if(!f)return null;if(!(m=f.classType))return this.program.error(p.DiagnosticCode.A_class_may_only_extend_another_class,s.extendsType.range),null;if(m.prototype.isExplicit!=this.isExplicit)return this.program.error(p.DiagnosticCode.Structs_cannot_extend_classes_and_vice_versa,h.Range.join(s.name.range,s.extendsType.range)),null}else this.flags|=A.HAS_STATIC_BASE_MEMBERS;var E,T;if(e){if((T=e.length)!=s.typeParameters.length)throw new Error("type argument count mismatch");for(var E=0;E<T;++E)t.set(s.typeParameters[E].identifier.name,e[E])}else if(s.typeParameters.length)throw new Error("type argument count mismatch");var I=this.internalName;r.length&&(I+="<"+r+">"),n=new D(this,I,e,m),n.contextualTypeArguments=t,this.instances.set(r,n);var S=0;if(m&&(S=m.currentMemoryOffset,m.members)){n.members||(n.members=new Map);try{for(var v=i(m.members.values()),N=v.next();!N.done;N=v.next()){var b=N.value;n.members.set(b.simpleName,b)}}catch(e){P={error:e}}finally{try{N&&!N.done&&(w=v.return)&&w.call(v)}finally{if(P)throw P.error}}}if(this.instanceMembers)try{for(var C=i(this.instanceMembers.values()),k=C.next();!k.done;k=C.next()){var O=k.value;switch(O.kind){case g.FIELD_PROTOTYPE:n.members||(n.members=new Map);var x=O.declaration;if(!x)throw new Error("cannot resolve built-ins");if(!x.type)throw new Error("type expected");var L=this.program.resolveType(x.type,n.contextualTypeArguments);if(L){var B=new R(O,O.internalName,L);switch(L.byteSize){case 1:break;case 2:1&S&&++S;break;case 4:3&S&&(S=1+(3|S));break;case 8:7&S&&(S=1+(7|S));break;default:assert(!1)}B.memoryOffset=S,S+=L.byteSize,n.members.set(O.simpleName,B)}break;case g.FUNCTION_PROTOTYPE:n.members||(n.members=new Map);var U=O.resolvePartial(e);U&&n.members.set(O.simpleName,U);break;case g.PROPERTY:n.members||(n.members=new Map),n.members.set(O.simpleName,O);break;default:throw new Error("instance member expected: "+O.kind)}}}catch(e){G={error:e}}finally{try{k&&!k.done&&(z=C.return)&&z.call(C)}finally{if(G)throw G.error}}return n.currentMemoryOffset=S,n;var F,M,P,w,G,z},t.prototype.resolveInclTypeArguments=function(e,t,r){var n=null;if(this.isGeneric){if(assert(null!=e&&0!=e.length),!this.declaration)throw new Error("cannot resolve built-ins");if(!(n=this.program.resolveTypeArguments(this.declaration.typeParameters,e,t,r)))return null}else assert(null==e||!e.length);return this.resolve(n,t)},t.prototype.toString=function(){return this.simpleName},t}(I);t.ClassPrototype=F;var D=function(e){function t(t,r,n,s){void 0===n&&(n=null),void 0===s&&(s=null);var c=e.call(this,t.program,t.simpleName,r)||this;if(c.kind=g.CLASS,c.contextualTypeArguments=null,c.currentMemoryOffset=0,c.prototype=t,c.flags=t.flags,c.typeArguments=n,c.type=(t.program.target==o.Target.WASM64?l.Type.usize64:l.Type.usize32).asClass(c),c.base=s,s&&s.contextualTypeArguments){c.contextualTypeArguments||(c.contextualTypeArguments=new Map);try{for(var p=i(s.contextualTypeArguments),u=p.next();!u.done;u=p.next()){var h=a(u.value,2),d=h[0],y=h[1];c.contextualTypeArguments.set(d,y)}}catch(e){T={error:e}}finally{try{u&&!u.done&&(A=p.return)&&A.call(p)}finally{if(T)throw T.error}}}var _,m,f=c.prototype.declaration;if(f){var E=f.typeParameters;if(n){if((m=n.length)!=E.length)throw new Error("type argument count mismatch");if(m)for(c.contextualTypeArguments||(c.contextualTypeArguments=new Map),_=0;_<m;++_)c.contextualTypeArguments.set(E[_].identifier.name,n[_])}else if(E.length)throw new Error("type argument count mismatch")}return c;var T,A}return n(t,e),t.prototype.toString=function(){return this.prototype.simpleName},t}(I);t.Class=D;var M=function(e){function t(t,r,n,i){void 0===i&&(i=null);var a=e.call(this,t,r,n,i)||this;return a.kind=g.INTERFACE_PROTOTYPE,a}return n(t,e),t}(F);t.InterfacePrototype=M;var P=function(e){function t(t,r,n,i){void 0===n&&(n=[]),void 0===i&&(i=null);var a=e.call(this,t,r,n,i)||this;return a.kind=g.INTERFACE,a}return n(t,e),t}(D);t.Interface=P},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PATH_DELIMITER="/",t.PARENT_SUBST="..",t.GETTER_PREFIX="get:",t.SETTER_PREFIX="set:",t.INSTANCE_DELIMITER="#",t.STATIC_DELIMITER="."},function(e,t,r){"use strict";function n(e){Fe=e}function i(){var e;return null!=Fe?(e=Fe,Fe=null):e=new Array(1),e.length=0,e}function a(e,t){return null==t&&(t=i()),t.push(e),t}function s(e,t){if(t)for(var r=0,n=t.length;r<n;++r)if(t[r].modifierKind==e)return t[r];return null}function o(e,t){return null!=s(e,t)}function c(e,t){if(t)for(var r=0,n=t.length;r<n;++r){var i=t[r],a=i.name;if(a.kind==g.IDENTIFIER&&a.name==e)return i}return null}function p(e,t){return null!=c(e,t)}function l(e){var t=new Array;return e.serialize(t),t.join("")}function u(e){return e}function h(e){var t=e.name.name,r=e.parent;return r&&(e.kind!=g.VARIABLEDECLARATION||r.kind!=g.VARIABLE||(r=r.parent))?r.kind==g.CLASS?r.internalName+(o(q.STATIC,e.modifiers)?m.STATIC_DELIMITER:m.INSTANCE_DELIMITER)+t:r.kind==g.NAMESPACE||r.kind==g.ENUM?r.internalName+m.STATIC_DELIMITER+t:e.range.source.internalPath+m.PATH_DELIMITER+t:t}function d(e,t){if(e.length){var r=e[e.length-1];return r.length>0&&r.charCodeAt(r.length-1)==t}return!1}function y(e,t){void 0===t&&(t=!1);for(var r=new Array,n=0,i=0,a=e.length;i<a;)switch(e.charCodeAt(i)){case 0:i>n&&r.push(e.substring(n,n=i+1)),r.push("\\0"),n=++i;break;case 8:i>n&&r.push(e.substring(n,i)),n=++i,r.push("\\b");break;case 9:i>n&&r.push(e.substring(n,i)),n=++i,r.push("\\t");break;case 10:i>n&&r.push(e.substring(n,i)),n=++i,r.push("\\n");break;case 11:i>n&&r.push(e.substring(n,i)),n=++i,r.push("\\v");break;case 12:i>n&&r.push(e.substring(n,i)),n=++i,r.push("\\f");break;case 13:i>n&&r.push(e.substring(n,i)),r.push("\\r"),n=++i;break;case 34:i>n&&r.push(e.substring(n,i)),r.push('\\"'),n=++i;break;case 39:i>n&&r.push(e.substring(n,i)),r.push("\\'"),n=++i;break;case 92:i>n&&r.push(e.substring(n,i)),r.push("\\\\"),n=++i;break;default:++i}var s=t?"'":'"';return 0==n?(assert(0==r.length),s+e+s):(i>n&&r.push(e.substring(n,i)),s+r.join("")+s)}var _=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var m=r(7),f=r(4),E=r(13),T=r(4);t.Range=T.Range;var g;!function(e){e[e.SOURCE=0]="SOURCE",e[e.TYPE=1]="TYPE",e[e.TYPEPARAMETER=2]="TYPEPARAMETER",e[e.IDENTIFIER=3]="IDENTIFIER",e[e.ASSERTION=4]="ASSERTION",e[e.BINARY=5]="BINARY",e[e.CALL=6]="CALL",e[e.COMMA=7]="COMMA",e[e.ELEMENTACCESS=8]="ELEMENTACCESS",e[e.FALSE=9]="FALSE",e[e.LITERAL=10]="LITERAL",e[e.NEW=11]="NEW",e[e.NULL=12]="NULL",e[e.PARENTHESIZED=13]="PARENTHESIZED",e[e.PROPERTYACCESS=14]="PROPERTYACCESS",e[e.TERNARY=15]="TERNARY",e[e.SUPER=16]="SUPER",e[e.THIS=17]="THIS",e[e.TRUE=18]="TRUE",e[e.CONSTRUCTOR=19]="CONSTRUCTOR",e[e.UNARYPOSTFIX=20]="UNARYPOSTFIX",e[e.UNARYPREFIX=21]="UNARYPREFIX",e[e.BLOCK=22]="BLOCK",e[e.BREAK=23]="BREAK",e[e.CASE=24]="CASE",e[e.CLASS=25]="CLASS",e[e.CONTINUE=26]="CONTINUE",e[e.DO=27]="DO",e[e.EMPTY=28]="EMPTY",e[e.ENUM=29]="ENUM",e[e.ENUMVALUE=30]="ENUMVALUE",e[e.EXPORT=31]="EXPORT",e[e.EXPORTIMPORT=32]="EXPORTIMPORT",e[e.EXPORTMEMBER=33]="EXPORTMEMBER",e[e.EXPRESSION=34]="EXPRESSION",e[e.INTERFACE=35]="INTERFACE",e[e.FOR=36]="FOR",e[e.FUNCTION=37]="FUNCTION",e[e.IF=38]="IF",e[e.IMPORT=39]="IMPORT",e[e.IMPORTDECLARATION=40]="IMPORTDECLARATION",e[e.METHOD=41]="METHOD",e[e.NAMESPACE=42]="NAMESPACE",e[e.FIELD=43]="FIELD",e[e.RETURN=44]="RETURN",e[e.SWITCH=45]="SWITCH",e[e.THROW=46]="THROW",e[e.TRY=47]="TRY",e[e.TYPEDECLARATION=48]="TYPEDECLARATION",e[e.VARIABLE=49]="VARIABLE",e[e.VARIABLEDECLARATION=50]="VARIABLEDECLARATION",e[e.WHILE=51]="WHILE",e[e.DECORATOR=52]="DECORATOR",e[e.MODIFIER=53]="MODIFIER",e[e.PARAMETER=54]="PARAMETER"}(g=t.NodeKind||(t.NodeKind={}));var A=function(){function e(){this.parent=null}return e.createType=function(e,t,r,n){var i=new I;return i.range=n,i.identifier=e,i.typeArguments=t,i.isNullable=r,i},e.createIdentifierExpression=function(e,t){var r=new N;return r.range=t,r.name=e,r},e.createArrayLiteralExpression=function(e,t){var r=new C;r.range=t;for(var n=0,i=(r.elementExpressions=e).length;n<i;++n)e[n]&&(e[n].parent=r);return r},e.createAssertionExpression=function(e,t,r,n){var i=new k;return i.range=n,i.assertionKind=e,(i.expression=t).parent=i,(i.toType=r).parent=i,i},e.createBinaryExpression=function(e,t,r,n){var i=new O;return i.range=n,i.operator=e,(i.left=t).parent=i,(i.right=r).parent=i,i},e.createCallExpression=function(e,t,r,n){var i=new x;if(i.range=n,(i.expression=e).parent=i,i.typeArguments=t)for(var a=0,s=t.length;a<s;++a)t[a].parent=i;for(a=0,s=(i.arguments=r).length;a<s;++a)r[a].parent=i;return i},e.createCommaExpression=function(e,t){var r=new L;r.range=t;for(var n=0,i=(r.expressions=e).length;n<i;++n)e[n].parent=r;return r},e.createConstructorExpression=function(e){var t=new B;return t.range=e,t},e.createElementAccessExpression=function(e,t,r){var n=new R;return n.range=r,(n.expression=e).parent=n,(n.elementExpression=t).parent=n,n},e.createFalseExpression=function(e){var t=new X;return t.range=e,t},e.createFloatLiteralExpression=function(e,t){var r=new U;return r.range=t,r.value=e,r},e.createIntegerLiteralExpression=function(e,t){var r=new F;return r.range=t,r.value=e,r},e.createNewExpression=function(e,t,r,n){var i=new D;if(i.range=n,(i.expression=e).parent=i,i.typeArguments=t)for(var a=0,s=t.length;a<s;++a)t[a].parent=i;for(a=0,s=(i.arguments=r).length;a<s;++a)r[a].parent=i;return i},e.createNullExpression=function(e){var t=new M;return t.range=e,t},e.createParenthesizedExpression=function(e,t){var r=new P;return r.range=t,(r.expression=e).parent=r,r},e.createPropertyAccessExpression=function(e,t,r){var n=new w;return n.range=r,(n.expression=e).parent=n,(n.property=t).parent=n,n},e.createRegexpLiteralExpression=function(e,t,r){var n=new G;return n.range=r,n.pattern=e,n.patternFlags=t,n},e.createTernaryExpression=function(e,t,r,n){var i=new z;return i.range=n,(i.condition=e).parent=i,(i.ifThen=t).parent=i,(i.ifElse=r).parent=i,i},e.createStringLiteralExpression=function(e,t){var r=new K;return r.range=t,r.value=e,r},e.createSuperExpression=function(e){var t=new V;return t.range=e,t},e.createThisExpression=function(e){var t=new H;return t.range=e,t},e.createTrueExpression=function(e){var t=new W;return t.range=e,t},e.createUnaryPostfixExpression=function(e,t,r){var n=new Y;return n.range=r,n.operator=e,(n.operand=t).parent=n,n},e.createUnaryPrefixExpression=function(e,t,r){var n=new j;return n.range=r,n.operator=e,(n.operand=t).parent=n,n},e.createBlockStatement=function(e,t){var r=new re;r.range=t;for(var n=0,i=(r.statements=e).length;n<i;++n)e[n].parent=r;return r},e.createBreakStatement=function(e,t){var r=new ne;return r.range=t,(r.label=e)&&(e.parent=r),r},e.createClassDeclaration=function(e,t,r,n,i,a,s,o){var c=new ie;c.range=o,(c.name=e).parent=c;for(var p=0,l=(c.typeParameters=t).length;p<l;++p)t[p].parent=c;for((c.extendsType=r)&&(r.parent=c),p=0,l=(c.implementsTypes=n).length;p<l;++p)n[p].parent=c;for(p=0,l=(c.members=i).length;p<l;++p)i[p].parent=c;if(c.modifiers=a)for(p=0,l=a.length;p<l;++p)a[p].parent=c;if(c.decorators=s)for(p=0,l=s.length;p<l;++p)s[p].parent=c;return c},e.createContinueStatement=function(e,t){var r=new ae;return r.range=t,(r.label=e)&&(e.parent=r),r},e.createDecorator=function(e,t,r){var n=new se;if(n.range=r,(n.name=e).parent=n,n.arguments=t)for(var i=0,a=t.length;i<a;++i)t[i].parent=n;if(e.kind==g.IDENTIFIER)switch(e.name){case"global":n.decoratorKind=1;break;case"operator":n.decoratorKind=2;break;case"explicit":n.decoratorKind=3;break;case"offset":n.decoratorKind=4;break;default:n.decoratorKind=0}else n.decoratorKind=0;return n},e.createDoStatement=function(e,t,r){var n=new oe;return n.range=r,(n.statement=e).parent=n,(n.condition=t).parent=n,n},e.createEmptyStatement=function(e){var t=new ce;return t.range=e,t},e.createEnumDeclaration=function(e,t,r,n,i){var a=new pe;a.range=i,(a.name=e).parent=a;for(var s=0,o=(a.values=t).length;s<o;++s)t[s].parent=a;if(a.modifiers=r)for(s=0,o=r.length;s<o;++s)r[s].parent=a;if(a.decorators=n)for(s=0,o=n.length;s<o;++s)n[s].parent=a;return a},e.createEnumValueDeclaration=function(e,t,r){var n=new le;return n.range=r,(n.name=e).parent=n,(n.value=t)&&(t.parent=n),n},e.createExportStatement=function(e,t,r,n){var i=new de;i.range=n;for(var a=0,s=(i.members=e).length;a<s;++a)e[a].parent=i;if(i.path=t,i.normalizedPath=t?E.resolve(E.normalize(t.value),n.source.normalizedPath):null,i.internalPath=i.normalizedPath?u(i.normalizedPath):null,i.modifiers=r)for(a=0,s=r.length;a<s;++a)r[a].parent=i;return i},e.createExportImportStatement=function(e,t,r){var n=new ue;return n.range=r,(n.identifier=e).parent=n,(n.externalIdentifier=t).parent=n,n},e.createExportMember=function(e,t,r){var n=new he;return n.range=r,(n.identifier=e).parent=n,(n.externalIdentifier=t||e).parent=n,n},e.createExpressionStatement=function(e){var t=new ye;return t.range=e.range,(t.expression=e).parent=t,t},e.createIfStatement=function(e,t,r,n){var i=new Ee;return i.range=n,(i.condition=e).parent=i,(i.ifTrue=t).parent=i,(i.ifFalse=r)&&(r.parent=i),i},e.createImportStatement=function(e,t,r){var n=new ge;if(n.range=r,n.declarations=e)for(var i=0,a=e.length;i<a;++i)e[i].parent=n;return n.namespaceName=null,n.path=t,n.normalizedPath=E.resolve(E.normalize(t.value),r.source.normalizedPath),n.internalPath=u(n.normalizedPath),n},e.createImportStatementWithWildcard=function(e,t,r){var n=new ge;return n.range=r,n.declarations=null,n.namespaceName=e,n.path=t,n.normalizedPath=E.resolve(E.normalize(t.value),r.source.normalizedPath),n.internalPath=u(n.normalizedPath),n},e.createImportDeclaration=function(e,t,r){var n=new Te;return n.range=r,(n.name=t||e).parent=n,(n.externalIdentifier=e).parent=n,n},e.createInterfaceDeclaration=function(e,t,r,n,i){var a=new Ae;a.range=i,(a.name=e).parent=a,(a.extendsType=t)&&(t.parent=a);for(var s=0,o=(a.members=r).length;s<o;++s)r[s].parent=a;if(a.modifiers=n)for(s=0,o=n.length;s<o;++s)n[s].parent=a;return a},e.createFieldDeclaration=function(e,t,r,n,i,a){var s=new _e;if(s.range=a,(s.name=e).parent=s,(s.type=t)&&(t.parent=s),(s.initializer=r)&&(r.parent=s),s.modifiers=n)for(var o=0,c=n.length;o<c;++o)n[o].parent=s;if(s.decorators=i)for(o=0,c=i.length;o<c;++o)i[o].parent=s;return s},e.createForStatement=function(e,t,r,n,i){var a=new me;return a.range=i,(a.initializer=e)&&(e.parent=a),(a.condition=t)&&(t.parent=a),(a.incrementor=r)&&(r.parent=a),(a.statement=n).parent=a,a},e.createTypeParameter=function(e,t,r){var n=new S;return n.range=r,(n.identifier=e).parent=n,(n.extendsType=t)&&(t.parent=n),n},e.createParameter=function(e,t,r,n,i){var a=new ve;return a.range=i,(a.name=e).parent=a,(a.type=t)&&(t.parent=a),(a.initializer=r)&&(r.parent=a),a.isRest=n,a},e.createFunctionDeclaration=function(e,t,r,n,i,a,s,o){var c=new fe;c.range=o,(c.name=e).parent=c;for(var p=0,l=(c.typeParameters=t).length;p<l;++p)t[p].parent=c;for(p=0,l=(c.parameters=r).length;p<l;++p)r[p].parent=c;if((c.returnType=n)&&(n.parent=c),c.statements=i)for(p=0,l=i.length;p<l;++p)i[p].parent=c;if(c.modifiers=a)for(p=0,l=a.length;p<l;++p)a[p].parent=c;if(c.decorators=s)for(p=0,l=s.length;p<l;++p)s[p].parent=c;return c},e.createMethodDeclaration=function(e,t,r,n,i,a,s,o){var c=new Ie;c.range=o,(c.name=e).parent=c;for(var p=0,l=(c.typeParameters=t).length;p<l;++p)t[p].parent=c;for(p=0,l=(c.parameters=r).length;p<l;++p)r[p].parent=c;if((c.returnType=n)&&(n.parent=c),c.statements=i)for(p=0,l=i.length;p<l;++p)i[p].parent=c;if(c.modifiers=a)for(p=0,l=a.length;p<l;++p)a[p].parent=c;if(c.decorators=s)for(p=0,l=s.length;p<l;++p)s[p].parent=c;return c},e.createModifier=function(e,t){var r=new Ne;return r.range=t,r.modifierKind=e,r},e.createNamespaceDeclaration=function(e,t,r,n,i){var a=new Se;a.range=i,(a.name=e).parent=a;for(var s=0,o=(a.members=t).length;s<o;++s)t[s].parent=a;if(a.modifiers=r)for(s=0,o=r.length;s<o;++s)r[s].parent=a;if(a.decorators=n)for(s=0,o=n.length;s<o;++s)n[s].parent=a;return a},e.createReturnStatement=function(e,t){var r=new be;return r.range=t,(r.value=e)&&(e.parent=r),r},e.createSwitchStatement=function(e,t,r){var n=new ke;n.range=r,(n.condition=e).parent=n;for(var i=0,a=(n.cases=t).length;i<a;++i)t[i].parent=n;return n},e.createSwitchCase=function(e,t,r){var n=new Ce;n.range=r,(n.label=e)&&(e.parent=n);for(var i=0,a=(n.statements=t).length;i<a;++i)t[i].parent=n;return n},e.createThrowStatement=function(e,t){var r=new Oe;return r.range=t,(r.value=e).parent=r,r},e.createTryStatement=function(e,t,r,n,i){var a=new xe;a.range=i;for(var s=0,o=(a.statements=e).length;s<o;++s)e[s].parent=a;if((a.catchVariable=t)&&(t.parent=a),a.catchStatements=r)for(s=0,o=r.length;s<o;++s)r[s].parent=a;if(a.finallyStatements=n)for(s=0,o=n.length;s<o;++s)n[s].parent=a;return a},e.createTypeDeclaration=function(e,t,r,n,i){var a=new Le;if(a.range=i,(a.name=e).parent=a,(a.alias=t).parent=a,a.modifiers=r)for(var s=0,o=r.length;s<o;++s)r[s].parent=a;if(a.decorators=n)for(s=0,o=n.length;s<o;++s)n[s].parent=a;return a},e.createVariableStatement=function(e,t,r,n){var i=new Re;i.range=n;for(var a=0,s=(i.declarations=e).length;a<s;++a)e[a].parent=i;if(i.modifiers=t)for(a=0,s=t.length;a<s;++a)t[a].parent=i;if(i.decorators=r)for(a=0,s=r.length;a<s;++a)r[a].parent=i;return i},e.createVariableDeclaration=function(e,t,r,n,i,a){var s=new Be;return s.range=a,(s.name=e).parent=s,(s.type=t)&&(t.parent=s),(s.initializer=r)&&(r.parent=s),s.modifiers=n,s.decorators=i,s},e.createWhileStatement=function(e,t,r){var n=new Ue;return n.range=r,(n.condition=e).parent=n,(n.statement=t).parent=n,n},e}();t.Node=A;var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TYPE,t}return _(t,e),t.prototype.serialize=function(e){if(this.identifier.serialize(e),this.typeArguments.length){e.push("<");for(var t=0,r=this.typeArguments.length;t<r;++t)t>0&&e.push(", "),this.typeArguments[t].serialize(e);e.push(">")}this.isNullable&&e.push(" | null")},t}(A);t.TypeNode=I;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TYPEPARAMETER,t}return _(t,e),t.prototype.serialize=function(e){this.identifier.serialize(e),this.extendsType&&(e.push(" extends "),this.extendsType.serialize(e))},t}(A);t.TypeParameter=S;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(A);t.Expression=v;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.IDENTIFIER,t}return _(t,e),t.prototype.serialize=function(e){e.push(this.name)},t}(v);t.IdentifierExpression=N;!function(e){e[e.FLOAT=0]="FLOAT",e[e.INTEGER=1]="INTEGER",e[e.STRING=2]="STRING",e[e.REGEXP=3]="REGEXP",e[e.ARRAY=4]="ARRAY",e[e.OBJECT=5]="OBJECT"}(t.LiteralKind||(t.LiteralKind={}));var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.LITERAL,t}return _(t,e),t}(v);t.LiteralExpression=b;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=4,t}return _(t,e),t.prototype.serialize=function(e){e.push("[");for(var t=0,r=this.elementExpressions.length;t<r;++t)t>0&&e.push(", "),this.elementExpressions[t]&&this.elementExpressions[t].serialize(e);e.push("]")},t}(b);t.ArrayLiteralExpression=C;!function(e){e[e.PREFIX=0]="PREFIX",e[e.AS=1]="AS"}(t.AssertionKind||(t.AssertionKind={}));var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.ASSERTION,t}return _(t,e),t.prototype.serialize=function(e){0==this.assertionKind?(e.push("<"),this.toType.serialize(e),e.push(">"),this.expression.serialize(e)):(this.expression.serialize(e),e.push(" as "),this.toType.serialize(e))},t}(v);t.AssertionExpression=k;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.BINARY,t}return _(t,e),t.prototype.serialize=function(e){this.left.serialize(e),e.push(" "),e.push(f.Token.operatorToString(this.operator)),e.push(" "),this.right.serialize(e)},t}(v);t.BinaryExpression=O;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.CALL,t}return _(t,e),t.prototype.serialize=function(e){this.expression.serialize(e);var t;if(this.typeArguments&&(t=this.typeArguments.length)){e.push("<");for(var r=0;r<t;++r)r>0&&e.push(", "),this.typeArguments[r].serialize(e);e.push(">(")}else e.push("(");for(r=0,t=this.arguments.length;r<t;++r)r>0&&e.push(", "),this.arguments[r].serialize(e);e.push(")")},t}(v);t.CallExpression=x;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.COMMA,t}return _(t,e),t.prototype.serialize=function(e){this.expressions[0].serialize(e);for(var t=1,r=this.expressions.length;t<r;++t)e.push(","),this.expressions[t].serialize(e)},t}(v);t.CommaExpression=L;var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.CONSTRUCTOR,t.name="this",t}return _(t,e),t}(N);t.ConstructorExpression=B;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.ELEMENTACCESS,t}return _(t,e),t.prototype.serialize=function(e){this.expression.serialize(e),e.push("["),this.elementExpression.serialize(e),e.push("]")},t}(v);t.ElementAccessExpression=R;var U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=0,t}return _(t,e),t.prototype.serialize=function(e){e.push(this.value.toString(10))},t}(b);t.FloatLiteralExpression=U;var F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=1,t}return _(t,e),t.prototype.serialize=function(e){e.push(this.value.toString())},t}(b);t.IntegerLiteralExpression=F;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.NEW,t}return _(t,e),t.prototype.serialize=function(t){t.push("new "),e.prototype.serialize.call(this,t)},t}(x);t.NewExpression=D;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.NULL,t.name="null",t}return _(t,e),t}(N);t.NullExpression=M;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.PARENTHESIZED,t}return _(t,e),t.prototype.serialize=function(e){e.push("("),this.expression.serialize(e),e.push(")")},t}(v);t.ParenthesizedExpression=P;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.PROPERTYACCESS,t}return _(t,e),t.prototype.serialize=function(e){this.expression.serialize(e),e.push("."),this.property.serialize(e)},t}(v);t.PropertyAccessExpression=w;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=3,t}return _(t,e),t.prototype.serialize=function(e){e.push("/"),e.push(this.pattern),e.push("/"),e.push(this.patternFlags)},t}(b);t.RegexpLiteralExpression=G;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TERNARY,t}return _(t,e),t.prototype.serialize=function(e){this.condition.serialize(e),e.push(" ? "),this.ifThen.serialize(e),e.push(" : "),this.ifElse.serialize(e)},t}(v);t.TernaryExpression=z;var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=2,t}return _(t,e),t.prototype.serialize=function(e){e.push(y(this.value))},t}(b);t.StringLiteralExpression=K;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.SUPER,t.name="super",t}return _(t,e),t}(N);t.SuperExpression=V;var H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.THIS,t.name="this",t}return _(t,e),t}(N);t.ThisExpression=H;var W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TRUE,t.name="true",t}return _(t,e),t}(N);t.TrueExpression=W;var X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.FALSE,t.name="false",t}return _(t,e),t}(N);t.FalseExpression=X;var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(v);t.UnaryExpression=Q;var Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.UNARYPOSTFIX,t}return _(t,e),t.prototype.serialize=function(e){switch(this.operand.serialize(e),this.operator){case f.Token.PLUS_PLUS:e.push("++");break;case f.Token.MINUS_MINUS:e.push("--");break;default:e.push("INVALID")}},t}(Q);t.UnaryPostfixExpression=Y;var j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.UNARYPREFIX,t}return _(t,e),t.prototype.serialize=function(e){e.push(f.Token.operatorToString(this.operator)),this.operand.serialize(e)},t}(Q);t.UnaryPrefixExpression=j;var q;!function(e){e[e.ASYNC=0]="ASYNC",e[e.CONST=1]="CONST",e[e.DECLARE=2]="DECLARE",e[e.EXPORT=3]="EXPORT",e[e.IMPORT=4]="IMPORT",e[e.STATIC=5]="STATIC",e[e.ABSTRACT=6]="ABSTRACT",e[e.PUBLIC=7]="PUBLIC",e[e.PRIVATE=8]="PRIVATE",e[e.PROTECTED=9]="PROTECTED",e[e.READONLY=10]="READONLY",e[e.GET=11]="GET",e[e.SET=12]="SET"}(q=t.ModifierKind||(t.ModifierKind={}));var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(A);t.Statement=Z;var $;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ENTRY=1]="ENTRY",e[e.STDLIB=2]="STDLIB"}($=t.SourceKind||(t.SourceKind={}));var J=function(e){function t(t,r,n){void 0===n&&(n=$.DEFAULT);var i=e.call(this)||this;return i.kind=g.SOURCE,i.parent=null,i.tokenizer=null,i.sourceKind=n,i.path=t,i.normalizedPath=E.normalize(t,!0),i.internalPath=u(i.normalizedPath),i.statements=new Array,i.range=new f.Range(i,0,r.length),i.text=r,i}return _(t,e),Object.defineProperty(t.prototype,"isEntry",{get:function(){return this.sourceKind==$.ENTRY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStdlib",{get:function(){return this.sourceKind==$.STDLIB},enumerable:!0,configurable:!0}),t.prototype.serialize=function(e){for(var t=0,r=this.statements.length;t<r;++t)this.statements[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n")},t}(A);t.Source=J;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.decorators=null,t._cachedInternalName=null,t}return _(t,e),Object.defineProperty(t.prototype,"internalName",{get:function(){return null===this._cachedInternalName?this._cachedInternalName=h(this):this._cachedInternalName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTopLevel",{get:function(){return null!=this.parent&&this.parent.kind==g.SOURCE},enumerable:!0,configurable:!0}),t}(Z);t.DeclarationStatement=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(ee);t.VariableLikeDeclarationStatement=te;var re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.BLOCK,t}return _(t,e),t.prototype.serialize=function(e){e.push("{\n");for(var t=0,r=this.statements.length;t<r;++t)this.statements[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n");e.push("}")},t}(Z);t.BlockStatement=re;var ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.BREAK,t}return _(t,e),t.prototype.serialize=function(e){this.label?(e.push("break "),this.label.serialize(e)):e.push("break")},t}(Z);t.BreakStatement=ne;var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.CLASS,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");if(e.push("class "),e.push(this.name.name),this.typeParameters.length){for(e.push("<"),t=0,r=this.typeParameters.length;t<r;++t)t>0&&e.push(", "),this.typeParameters[t].serialize(e);e.push(">")}if(this.extendsType&&(e.push(" extends "),this.extendsType.serialize(e)),this.implementsTypes.length)for(e.push(" implements "),t=0,r=this.implementsTypes.length;t<r;++t)t>0&&e.push(", "),this.implementsTypes[t].serialize(e);for(e.push(" {\n"),t=0,r=this.members.length;t<r;++t)this.members[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n");e.push("}")},t}(ee);t.ClassDeclaration=ie;var ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.CONTINUE,t}return _(t,e),t.prototype.serialize=function(e){this.label?(e.push("continue "),this.label.serialize(e)):e.push("continue")},t}(Z);t.ContinueStatement=ae;!function(e){e[e.CUSTOM=0]="CUSTOM",e[e.GLOBAL=1]="GLOBAL",e[e.OPERATOR=2]="OPERATOR",e[e.EXPLICIT=3]="EXPLICIT",e[e.OFFSET=4]="OFFSET"}(t.DecoratorKind||(t.DecoratorKind={}));var se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.DECORATOR,t}return _(t,e),t.prototype.serialize=function(e){if(e.push("@"),this.name.serialize(e),this.arguments){e.push("(");for(var t=0,r=this.arguments.length;t<r;++t)t>0&&e.push(", "),this.arguments[t].serialize(e);e.push(")")}},t}(Z);t.Decorator=se;var oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.DO,t}return _(t,e),t.prototype.serialize=function(e){e.push("do "),this.statement.serialize(e),this.statement.kind==g.BLOCK?e.push(" while ("):e.push(";\nwhile ("),this.condition.serialize(e),e.push(")")},t}(Z);t.DoStatement=oe;var ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.EMPTY,t}return _(t,e),t.prototype.serialize=function(e){},t}(Z);t.EmptyStatement=ce;var pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.ENUM,t}return _(t,e),t.prototype.serialize=function(e){if(this.modifiers)for(var t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");for(e.push("enum "),this.name.serialize(e),e.push(" {\n"),t=0,r=this.values.length;t<r;++t)t>0&&e.push(",\n"),this.values[t].serialize(e);e.push("\n}")},t}(ee);t.EnumDeclaration=pe;var le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.ENUMVALUE,t.modifiers=null,t}return _(t,e),t.prototype.serialize=function(e){this.name.serialize(e),this.value&&(e.push(" = "),this.value.serialize(e))},t}(ee);t.EnumValueDeclaration=le;var ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.EXPORTIMPORT,t}return _(t,e),t.prototype.serialize=function(e){e.push("export import "),this.externalIdentifier.serialize(e),e.push(" = "),this.identifier.serialize(e)},t}(A);t.ExportImportStatement=ue;var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.EXPORTMEMBER,t}return _(t,e),t.prototype.serialize=function(e){this.identifier.serialize(e),this.externalIdentifier.name!=this.identifier.name&&(e.push(" as "),this.externalIdentifier.serialize(e))},t}(A);t.ExportMember=he;var de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.EXPORT,t}return _(t,e),t.prototype.serialize=function(e){if(this.modifiers)for(var t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");for(e.push("export {\n"),t=0,r=this.members.length;t<r;++t)t>0&&e.push(",\n"),this.members[t].serialize(e);this.path?(e.push("\n} from "),this.path.serialize(e)):e.push("\n}")},t}(Z);t.ExportStatement=de;var ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.EXPRESSION,t}return _(t,e),t.prototype.serialize=function(e){this.expression.serialize(e)},t}(Z);t.ExpressionStatement=ye;var _e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.FIELD,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");this.name.serialize(e),this.type&&(e.push(": "),this.type.serialize(e)),this.initializer&&(e.push(" = "),this.initializer.serialize(e))},t}(te);t.FieldDeclaration=_e;var me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.FOR,t}return _(t,e),t.prototype.serialize=function(e){e.push("for ("),this.initializer&&this.initializer.serialize(e),this.condition?(e.push("; "),this.condition.serialize(e)):e.push(";"),this.incrementor?(e.push("; "),this.incrementor.serialize(e)):e.push(";"),e.push(") "),this.statement.serialize(e)},t}(Z);t.ForStatement=me;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.FUNCTION,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");e.push("function "),this.serializeCommon(e)},t.prototype.serializeCommon=function(e){if(this.name.serialize(e),this.typeParameters.length){e.push("<");for(var t=0,r=this.typeParameters.length;t<r;++t)t>0&&e.push(", "),this.typeParameters[t].serialize(e);e.push(">")}for(e.push("("),t=0,r=this.parameters.length;t<r;++t)t>0&&e.push(", "),this.parameters[t].serialize(e);if(this.returnType&&!o(q.SET,this.modifiers)?(e.push("): "),this.returnType.serialize(e)):e.push(")"),this.statements){for(e.push(" {\n"),t=0,r=this.statements.length;t<r;++t){this.statements[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n")}e.push("}")}},t}(ee);t.FunctionDeclaration=fe;var Ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.IF,t}return _(t,e),t.prototype.serialize=function(e){e.push("if ("),this.condition.serialize(e),e.push(") "),this.ifTrue.serialize(e),this.ifTrue.kind!=g.BLOCK&&e.push(";\n"),this.ifFalse&&(this.ifTrue.kind==g.BLOCK?e.push(" else "):e.push("else "),this.ifFalse.serialize(e))},t}(Z);t.IfStatement=Ee;var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.IMPORTDECLARATION,t.modifiers=null,t}return _(t,e),t.prototype.serialize=function(e){this.externalIdentifier.serialize(e),this.externalIdentifier!=this.name&&(e.push(" as "),this.name.serialize(e))},t}(ee);t.ImportDeclaration=Te;var ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.IMPORT,t}return _(t,e),t.prototype.serialize=function(e){if(e.push("import "),this.declarations){e.push("{\n");for(var t=0,r=this.declarations.length;t<r;++t)t>0&&e.push(",\n"),this.declarations[t].serialize(e);e.push("\n} from ")}else this.namespaceName&&(e.push("* as "),this.namespaceName.serialize(e),e.push(" from "));this.path.serialize(e)},t}(Z);t.ImportStatement=ge;var Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.INTERFACE,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");if(e.push("interface "),this.name.serialize(e),this.typeParameters.length){for(e.push("<"),t=0,r=this.typeParameters.length;t<r;++t)t>0&&e.push(", "),this.typeParameters[t].serialize(e);e.push(">")}for(this.extendsType&&(e.push(" extends "),this.extendsType.serialize(e)),e.push(" {\n"),t=0,r=this.members.length;t<r;++t)this.members[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n");e.push("}")},t}(ie);t.InterfaceDeclaration=Ae;var Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.METHOD,t}return _(t,e),t.prototype.serialize=function(t){if(this.decorators)for(var r=0,n=this.decorators.length;r<n;++r)this.decorators[r].serialize(t),t.push("\n");if(this.modifiers)for(r=0,n=this.modifiers.length;r<n;++r)this.modifiers[r].serialize(t),t.push(" ");e.prototype.serializeCommon.call(this,t)},t}(fe);t.MethodDeclaration=Ie;var Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.NAMESPACE,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");for(e.push("namespace "),this.name.serialize(e),e.push(" {\n"),t=0,r=this.members.length;t<r;++t)this.members[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n");e.push("}")},t}(ee);t.NamespaceDeclaration=Se;var ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.PARAMETER,t}return _(t,e),t.prototype.serialize=function(e){this.isRest&&e.push("..."),this.name.serialize(e),this.type&&(e.push(": "),this.type.serialize(e)),this.initializer&&(e.push(" = "),this.initializer.serialize(e))},t}(A);t.Parameter=ve;var Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.MODIFIER,t}return _(t,e),t.prototype.serialize=function(e){e.push(this.toString())},t.prototype.toString=function(){switch(this.modifierKind){case q.ABSTRACT:return"abstract";case q.ASYNC:return"async";case q.CONST:return"const";case q.DECLARE:return"declare";case q.EXPORT:return"export";case q.GET:return"get";case q.IMPORT:return"import";case q.PRIVATE:return"private";case q.PROTECTED:return"protected";case q.PUBLIC:return"public";case q.READONLY:return"readonly";case q.SET:return"set";case q.STATIC:return"static";default:return assert(!1),""}},t}(A);t.Modifier=Ne;var be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.RETURN,t}return _(t,e),t.prototype.serialize=function(e){this.value?(e.push("return "),this.value.serialize(e)):e.push("return")},t}(Z);t.ReturnStatement=be;var Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.CASE,t}return _(t,e),t.prototype.serialize=function(e){this.label?(e.push("case "),this.label.serialize(e),e.push(":\n")):e.push("default:\n");for(var t=0,r=this.statements.length;t<r;++t)t>0&&e.push("\n"),this.statements[t].serialize(e),d(e,125)?e.push("\n"):e.push(";\n")},t}(A);t.SwitchCase=Ce;var ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.SWITCH,t}return _(t,e),t.prototype.serialize=function(e){e.push("switch ("),this.condition.serialize(e),e.push(") {\n");for(var t=0,r=this.cases.length;t<r;++t)this.cases[t].serialize(e),e.push("\n");e.push("}")},t}(Z);t.SwitchStatement=ke;var Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.THROW,t}return _(t,e),t.prototype.serialize=function(e){e.push("throw "),this.value.serialize(e),e.push(";")},t}(Z);t.ThrowStatement=Oe;var xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TRY,t}return _(t,e),t.prototype.serialize=function(e){e.push("try {\n");for(var t=0,r=this.statements.length;t<r;++t)this.statements[t].serialize(e),e.push(";\n");if(this.catchVariable&&(e.push("} catch ("),this.catchVariable.serialize(e),e.push(") {\n"),this.catchStatements))for(t=0,r=this.catchStatements.length;t<r;++t)this.catchStatements[t].serialize(e),e.push(";\n");if(this.finallyStatements)for(e.push("} finally {\n"),t=0,r=this.finallyStatements.length;t<r;++t)this.finallyStatements[t].serialize(e),e.push(";\n");e.push("}")},t}(Z);t.TryStatement=xe;var Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.TYPEDECLARATION,t}return _(t,e),t.prototype.serialize=function(e){if(this.decorators)for(var t=0,r=this.decorators.length;t<r;++t)this.decorators[t].serialize(e),e.push("\n");if(this.modifiers)for(t=0,r=this.modifiers.length;t<r;++t)this.modifiers[t].serialize(e),e.push(" ");e.push("type "),this.name.serialize(e),e.push(" = "),this.alias.serialize(e)},t}(ee);t.TypeDeclaration=Le;var Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.VARIABLEDECLARATION,t}return _(t,e),t.prototype.serialize=function(e){this.name.serialize(e),this.type&&(e.push(": "),this.type.serialize(e)),this.initializer&&(e.push(" = "),this.initializer.serialize(e))},t}(te);t.VariableDeclaration=Be;var Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.VARIABLE,t}return _(t,e),t.prototype.serialize=function(e){var t=!1;if(this.decorators)for(var r=0,n=this.decorators.length;r<n;++r)this.decorators[r].serialize(e),e.push("\n");if(this.modifiers)for(r=0,n=this.modifiers.length;r<n;++r)this.modifiers[r].serialize(e),e.push(" "),this.modifiers[r].modifierKind==q.CONST&&(t=!0);for(t||e.push("let "),r=0,n=this.declarations.length;r<n;++r)r>0&&e.push(", "),this.declarations[r].serialize(e)},t}(Z);t.VariableStatement=Re;var Ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=g.WHILE,t}return _(t,e),t.prototype.serialize=function(e){e.push("while ("),this.condition.serialize(e),e.push(") "),this.statement.serialize(e)},t}(Z);t.WhileStatement=Ue;var Fe=null;t.setReusableModifiers=n,t.createModifiers=i,t.addModifier=a,t.getModifier=s,t.hasModifier=o,t.getFirstDecorator=c,t.hasDecorator=p,t.serialize=l,t.mangleInternalPath=u,t.mangleInternalName=h,t.stringToLiteral=y},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e){i(e,"NaN",l.Type.f64),i(e,"Infinity",l.Type.f64),a(e,"isNaN",!0),a(e,"isFinite",!0),a(e,"clz",!0),a(e,"ctz",!0),a(e,"popcnt",!0),a(e,"rotl",!0),a(e,"rotr",!0),a(e,"abs",!0),a(e,"max",!0),a(e,"min",!0),a(e,"ceil",!0),a(e,"floor",!0),a(e,"copysign",!0),a(e,"nearest",!0),a(e,"reinterpret",!0),a(e,"sqrt",!0),a(e,"trunc",!0),a(e,"load",!0),a(e,"store",!0),a(e,"sizeof",!0),a(e,"select",!0),a(e,"unreachable"),a(e,"current_memory"),a(e,"grow_memory"),a(e,"changetype",!0),a(e,"assert");var t,r,n,s;a(e,"i8").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","i8.MIN_VALUE",null,l.Type.i8).withConstantIntegerValue(-128,-1)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","i8.MAX_VALUE",null,l.Type.i8).withConstantIntegerValue(127,0)]]),a(e,"i16").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","i16.MIN_VALUE",null,l.Type.i16).withConstantIntegerValue(-32768,-1)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","i16.MAX_VALUE",null,l.Type.i16).withConstantIntegerValue(32767,0)]]),(t=a(e,"i32")).members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","i32.MIN_VALUE",null,l.Type.i32).withConstantIntegerValue(-2147483648,-1)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","i32.MAX_VALUE",null,l.Type.i32).withConstantIntegerValue(2147483647,0)]]),(n=a(e,"i64")).members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","i64.MIN_VALUE",null,l.Type.i64).withConstantIntegerValue(0,-2147483648)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","i64.MAX_VALUE",null,l.Type.i64).withConstantIntegerValue(-1,2147483647)]]),a(e,"u8").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","u8.MIN_VALUE",null,l.Type.u8).withConstantIntegerValue(0,0)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","u8.MAX_VALUE",null,l.Type.u8).withConstantIntegerValue(255,0)]]),a(e,"u16").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","u16.MIN_VALUE",null,l.Type.u16).withConstantIntegerValue(0,0)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","u16.MAX_VALUE",null,l.Type.u16).withConstantIntegerValue(65535,0)]]),(r=a(e,"u32")).members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","u32.MIN_VALUE",null,l.Type.u32).withConstantIntegerValue(0,0)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","u32.MAX_VALUE",null,l.Type.u32).withConstantIntegerValue(-1,0)]]),(s=a(e,"u64")).members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","u64.MIN_VALUE",null,l.Type.u64).withConstantIntegerValue(0,0)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","u64.MAX_VALUE",null,l.Type.i64).withConstantIntegerValue(-1,-1)]]),a(e,"bool").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","bool.MIN_VALUE",null,l.Type.bool).withConstantIntegerValue(0,0)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","bool.MAX_VALUE",null,l.Type.bool).withConstantIntegerValue(1,0)]]),a(e,"f32").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","f32.MIN_VALUE",null,l.Type.f32).withConstantFloatValue(-3.40282347e38)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","f32.MAX_VALUE",null,l.Type.f32).withConstantFloatValue(3.40282347e38)],["MIN_SAFE_INTEGER",new h.Global(e,"MIN_SAFE_INTEGER","f32.MIN_SAFE_INTEGER",null,l.Type.f32).withConstantFloatValue(-16777215)],["MAX_SAFE_INTEGER",new h.Global(e,"MAX_SAFE_INTEGER","f32.MAX_SAFE_INTEGER",null,l.Type.f32).withConstantFloatValue(16777215)],["EPSILON",new h.Global(e,"EPSILON","f32.EPSILON",null,l.Type.f32).withConstantFloatValue(1.1920929e-7)]]),a(e,"f64").members=new Map([["MIN_VALUE",new h.Global(e,"MIN_VALUE","f64.MIN_VALUE",null,l.Type.f64).withConstantFloatValue(-1.7976931348623157e308)],["MAX_VALUE",new h.Global(e,"MAX_VALUE","f64.MAX_VALUE",null,l.Type.f64).withConstantFloatValue(1.7976931348623157e308)],["MIN_SAFE_INTEGER",new h.Global(e,"MIN_SAFE_INTEGER","f64.MIN_SAFE_INTEGER",null,l.Type.f64).withConstantFloatValue(-9007199254740991)],["MAX_SAFE_INTEGER",new h.Global(e,"MAX_SAFE_INTEGER","f64.MAX_SAFE_INTEGER",null,l.Type.f64).withConstantFloatValue(9007199254740991)],["EPSILON",new h.Global(e,"EPSILON","f64.EPSILON",null,l.Type.f64).withConstantFloatValue(2.220446049250313e-16)]]),e.target==c.Target.WASM64?(e.elements.set("isize",n),e.elements.set("usize",s),i(e,"HEAP_BASE",l.Type.usize64)):(e.elements.set("isize",t),e.elements.set("usize",r),i(e,"HEAP_BASE",l.Type.usize32))}function i(e,t,r){var n=new h.Global(e,t,t,null,r);return n.isBuiltIn=!0,n.isConstant=!0,e.elements.set(t,n),n}function a(e,t,r){void 0===r&&(r=!1);var n=new h.FunctionPrototype(e,t,t,null,null);return n.isBuiltIn=!0,r&&(n.isGeneric=!0),e.elements.set(t,n),n}function s(e,t,r){switch(t.internalName){case"NaN":return e.currentType==l.Type.f32?e.module.createF32(NaN):(e.currentType=l.Type.f64,e.module.createF64(NaN));case"Infinity":return e.currentType==l.Type.f32?e.module.createF32(1/0):(e.currentType=l.Type.f64,e.module.createF64(1/0));case"HEAP_BASE":return e.module.createGetGlobal("HEAP_BASE",(e.currentType=t.type).toNativeType())}return e.error(p.DiagnosticCode.Operation_not_supported,r.range),e.module.createUnreachable()}function o(e,t,r,n,i,a){var s,o,h,d,y,_,m,f=e.module,E=e.options.target==c.Target.WASM64?l.Type.usize64:l.Type.usize32,T=e.options.target==c.Target.WASM64?u.NativeType.I64:u.NativeType.I32;switch(t.internalName){case"isNaN":if(e.currentType=l.Type.bool,1!=n.length)return r&&1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 11:y=e.currentFunction.getAndFreeTempLocal(l.Type.f32),d=f.createBinary(u.BinaryOp.NeF32,f.createTeeLocal(y.index,s),f.createGetLocal(y.index,u.NativeType.F32));break;case 12:y=e.currentFunction.getAndFreeTempLocal(l.Type.f64),d=f.createBinary(u.BinaryOp.NeF64,f.createTeeLocal(y.index,s),f.createGetLocal(y.index,u.NativeType.F64));break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break;default:d=f.createI32(0)}return e.currentType=l.Type.bool,d;case"isFinite":if(e.currentType=l.Type.bool,1!=n.length)return r&&1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 11:y=e.currentFunction.getAndFreeTempLocal(l.Type.f32),d=f.createSelect(f.createBinary(u.BinaryOp.NeF32,f.createUnary(u.UnaryOp.AbsF32,f.createTeeLocal(y.index,s)),f.createF32(1/0)),f.createI32(0),f.createBinary(u.BinaryOp.EqF32,f.createGetLocal(y.index,u.NativeType.F32),f.createGetLocal(y.index,u.NativeType.F32)));break;case 12:y=e.currentFunction.getAndFreeTempLocal(l.Type.f64),d=f.createSelect(f.createBinary(u.BinaryOp.NeF64,f.createUnary(u.UnaryOp.AbsF64,f.createTeeLocal(y.index,s)),f.createF64(1/0)),f.createI32(0),f.createBinary(u.BinaryOp.EqF64,f.createGetLocal(y.index,u.NativeType.F64),f.createGetLocal(y.index,u.NativeType.F64)));break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break;default:d=f.createI32(1)}return e.currentType=l.Type.bool,d;case"clz":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(e.currentType.kind){default:d=f.createUnary(u.UnaryOp.ClzI32,s);break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 4:d=f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.ClzI64:u.UnaryOp.ClzI32,s);break;case 3:case 8:d=f.createUnary(u.UnaryOp.ClzI64,s);break;case 11:case 12:case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"ctz":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(e.currentType.kind){default:d=f.createUnary(u.UnaryOp.CtzI32,s);break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 4:d=f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.CtzI64:u.UnaryOp.CtzI32,s);break;case 3:case 8:d=f.createUnary(u.UnaryOp.CtzI64,s);break;case 11:case 12:case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"popcnt":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(e.currentType.kind){default:d=f.createUnary(u.UnaryOp.PopcntI32,s);break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 4:d=f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.PopcntI64:u.UnaryOp.PopcntI32,s);break;case 3:case 8:d=f.createUnary(u.UnaryOp.PopcntI64,s);break;case 11:case 12:case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"rotl":if(2!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(o=e.compileExpression(n[1],e.currentType),e.currentType.kind){case 0:case 1:case 5:case 6:case 10:d=c.makeSmallIntegerWrap(f.createBinary(u.BinaryOp.RotlI32,s,o),e.currentType,f);case 2:case 7:d=f.createBinary(u.BinaryOp.RotlI32,s,o);break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 4:d=f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.RotlI64:u.BinaryOp.RotlI32,s,o);break;case 3:case 8:d=f.createBinary(u.BinaryOp.RotlI64,s,o);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"rotr":if(2!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(o=e.compileExpression(n[1],e.currentType),e.currentType.kind){case 0:case 1:case 5:case 6:case 10:d=c.makeSmallIntegerWrap(f.createBinary(u.BinaryOp.RotrI32,s,o),e.currentType,f);break;case 2:case 7:d=f.createBinary(u.BinaryOp.RotrI32,s,o);break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 4:d=f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.RotrI64:u.BinaryOp.RotrI32,s,o);break;case 3:case 8:d=f.createBinary(u.BinaryOp.RotrI64,s,o);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"abs":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 0:case 1:case 2:y=e.currentFunction.getAndFreeTempLocal(l.Type.i32),d=f.createSelect(f.createTeeLocal(y.index,s),f.createBinary(u.BinaryOp.SubI32,f.createI32(0),f.createGetLocal(y.index,u.NativeType.I32)),f.createBinary(u.BinaryOp.GtI32,f.createGetLocal(y.index,u.NativeType.I32),f.createI32(0)));break;case 4:y=e.currentFunction.getAndFreeTempLocal(E),d=f.createSelect(f.createTeeLocal(y.index,s),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.SubI64:u.BinaryOp.SubI32,E.toNativeZero(f),f.createGetLocal(y.index,T)),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.GtI64:u.BinaryOp.GtI32,f.createGetLocal(y.index,T),E.toNativeZero(f)));break;case 3:y=e.currentFunction.getAndFreeTempLocal(l.Type.i64),d=f.createSelect(f.createTeeLocal(y.index,s),f.createBinary(u.BinaryOp.SubI64,f.createI64(0,0),f.createGetLocal(y.index,u.NativeType.I64)),f.createBinary(u.BinaryOp.GtI64,f.createGetLocal(y.index,u.NativeType.I64),f.createI64(0,0)));break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}case 5:case 6:case 7:case 8:case 10:d=s;break;case 11:d=f.createUnary(u.UnaryOp.AbsF32,s);break;case 12:d=f.createUnary(u.UnaryOp.AbsF64,s);break;case 13:d=f.createUnreachable();break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"max":if(2!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(o=e.compileExpression(n[1],e.currentType),e.currentType.kind){case 0:case 1:case 2:y=e.currentFunction.getTempLocal(l.Type.i32),_=e.currentFunction.getAndFreeTempLocal(l.Type.i32),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.GtI32,f.createGetLocal(y.index,u.NativeType.I32),f.createGetLocal(_.index,u.NativeType.I32)));break;case 5:case 6:case 7:case 10:y=e.currentFunction.getTempLocal(l.Type.i32),_=e.currentFunction.getAndFreeTempLocal(l.Type.i32),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.GtU32,f.createGetLocal(y.index,u.NativeType.I32),f.createGetLocal(_.index,u.NativeType.I32)));break;case 3:y=e.currentFunction.getTempLocal(l.Type.i64),_=e.currentFunction.getAndFreeTempLocal(l.Type.i64),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.GtI64,f.createGetLocal(y.index,u.NativeType.I64),f.createGetLocal(_.index,u.NativeType.I64)));break;case 8:y=e.currentFunction.getTempLocal(l.Type.i64),_=e.currentFunction.getAndFreeTempLocal(l.Type.i64),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.GtU64,f.createGetLocal(y.index,u.NativeType.I64),f.createGetLocal(_.index,u.NativeType.I64)));break;case 4:y=e.currentFunction.getTempLocal(E),_=e.currentFunction.getAndFreeTempLocal(E),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.GtI64:u.BinaryOp.GtI32,f.createGetLocal(y.index,T),f.createGetLocal(_.index,T)));break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}y=e.currentFunction.getTempLocal(E),_=e.currentFunction.getAndFreeTempLocal(E),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.GtU64:u.BinaryOp.GtU32,f.createGetLocal(y.index,T),f.createGetLocal(_.index,T)));break;case 11:d=f.createBinary(u.BinaryOp.MaxF32,s,o);break;case 12:d=f.createBinary(u.BinaryOp.MaxF64,s,o);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"min":if(2!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(o=e.compileExpression(n[1],e.currentType),e.currentType.kind){case 0:case 1:case 2:y=e.currentFunction.getTempLocal(l.Type.i32),_=e.currentFunction.getAndFreeTempLocal(l.Type.i32),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.LtI32,f.createGetLocal(y.index,u.NativeType.I32),f.createGetLocal(_.index,u.NativeType.I32)));break;case 5:case 6:case 7:case 10:y=e.currentFunction.getTempLocal(l.Type.i32),_=e.currentFunction.getAndFreeTempLocal(l.Type.i32),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.LtU32,f.createGetLocal(y.index,u.NativeType.I32),f.createGetLocal(_.index,u.NativeType.I32)));break;case 3:y=e.currentFunction.getTempLocal(l.Type.i64),_=e.currentFunction.getAndFreeTempLocal(l.Type.i64),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.LtI64,f.createGetLocal(y.index,u.NativeType.I64),f.createGetLocal(_.index,u.NativeType.I64)));break;case 8:y=e.currentFunction.getTempLocal(l.Type.i64),_=e.currentFunction.getAndFreeTempLocal(l.Type.i64),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(u.BinaryOp.LtU64,f.createGetLocal(y.index,u.NativeType.I64),f.createGetLocal(_.index,u.NativeType.I64)));break;case 4:y=e.currentFunction.getTempLocal(E),_=e.currentFunction.getAndFreeTempLocal(E),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.LtI64:u.BinaryOp.LtI32,f.createGetLocal(y.index,T),f.createGetLocal(_.index,T)));break;case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}y=e.currentFunction.getTempLocal(E),_=e.currentFunction.getAndFreeTempLocal(E),e.currentFunction.freeTempLocal(y),d=f.createSelect(f.createTeeLocal(y.index,s),f.createTeeLocal(_.index,o),f.createBinary(e.options.target==c.Target.WASM64?u.BinaryOp.LtU64:u.BinaryOp.LtU32,f.createGetLocal(y.index,T),f.createGetLocal(_.index,T)));break;case 11:d=f.createBinary(u.BinaryOp.MinF32,s,o);break;case 12:d=f.createBinary(u.BinaryOp.MinF64,s,o);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"ceil":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}default:d=s;break;case 11:d=f.createUnary(u.UnaryOp.CeilF32,s);break;case 12:d=f.createUnary(u.UnaryOp.CeilF64,s);break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"floor":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}default:d=s;break;case 11:d=f.createUnary(u.UnaryOp.FloorF32,s);break;case 12:d=f.createUnary(u.UnaryOp.FloorF64,s);break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"copysign":if(2!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(o=e.compileExpression(n[1],e.currentType),e.currentType.kind){case 11:d=f.createBinary(u.BinaryOp.CopysignF32,s,o);break;case 12:d=f.createBinary(u.BinaryOp.CopysignF64,s,o);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"nearest":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}default:d=s;break;case 11:d=f.createUnary(u.UnaryOp.NearestF32,s);break;case 12:d=f.createUnary(u.UnaryOp.NearestF64,s);break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"reinterpret":if(1!=n.length)return r&&1==r.length||(r&&r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0")),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(!r||1!=r.length)return r&&r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0"),f.createUnreachable();switch(r[0].kind){case 2:case 7:s=e.compileExpression(n[0],l.Type.f32),d=f.createUnary(u.UnaryOp.ReinterpretF32,s);break;case 3:case 8:s=e.compileExpression(n[0],l.Type.f64),d=f.createUnary(u.UnaryOp.ReinterpretF64,s);break;case 9:if(r[0].isReference)return e.error(p.DiagnosticCode.Operation_not_supported,a.range),e.currentType=r[0],f.createUnreachable();case 4:s=e.compileExpression(n[0],e.options.target==c.Target.WASM64?l.Type.f64:l.Type.f32),d=f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.ReinterpretF64:u.UnaryOp.ReinterpretF32,s);break;case 11:s=e.compileExpression(n[0],l.Type.u32),d=f.createUnary(u.UnaryOp.ReinterpretI32,s);break;case 12:s=e.compileExpression(n[0],l.Type.u64),d=f.createUnary(u.UnaryOp.ReinterpretI64,s);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return e.currentType=r[0],d;case"sqrt":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 11:d=f.createUnary(u.UnaryOp.SqrtF32,s);break;case 12:d=f.createUnary(u.UnaryOp.SqrtF64,s);break;default:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"trunc":if(1!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable();if(r&&r.length){if(e.currentType=r[0],1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.f64,0);switch(e.currentType.kind){case 9:if(e.currentType.isReference){e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable();break}default:d=s;break;case 11:d=f.createUnary(u.UnaryOp.TruncF32,s);break;case 12:d=f.createUnary(u.UnaryOp.TruncF64,s);break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"load":return 1!=n.length?(r&&1==r.length||e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0"),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),f.createUnreachable()):r&&1==r.length?(s=e.compileExpression(n[0],E),e.currentType=r[0],f.createLoad(r[0].byteSize,r[0].is(5),s,r[0].toNativeType())):(r&&r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0"),f.createUnreachable());case"store":if(e.currentType=l.Type.void,2!=n.length)return r&&1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],E),o=e.compileExpression(n[1],r[0])}else s=e.compileExpression(n[0],E),o=e.compileExpression(n[1],l.Type.i32,0);return m=e.currentType,e.currentType=l.Type.void,f.createStore(m.byteSize,s,o,m.toNativeType());case"sizeof":return e.currentType=E,0!=n.length?(r&&1==r.length||e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0"),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"0",n.length.toString(10)),f.createUnreachable()):r?1!=r.length?(e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable()):d=64==E.size?f.createI64(r[0].byteSize,0):f.createI32(r[0].byteSize):(e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1","0"),f.createUnreachable());case"select":if(3!=n.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"3",n.length.toString(10)),f.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);switch(o=e.compileExpression(n[1],m=e.currentType),h=e.compileExpression(n[2],l.Type.bool),e.currentType=m,e.currentType.kind){default:d=f.createSelect(s,o,h);break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"unreachable":return 0!=n.length&&e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"0",n.length.toString(10)),r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),f.createUnreachable();case"current_memory":return e.currentType=l.Type.i32,0!=n.length&&e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"0",n.length.toString(10)),r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),f.createHost(u.HostOp.CurrentMemory);case"grow_memory":return e.currentType=l.Type.i32,1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"0",n.length.toString(10)),s=f.createUnreachable()):s=e.compileExpression(n[0],l.Type.i32),r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),f.createHost(u.HostOp.GrowMemory,null,[s]);case"move_memory":if(r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),3!=n.length)return e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"3",n.length.toString(10)),e.currentType=l.Type.void,f.createUnreachable();throw s=e.compileExpression(n[0],E),o=e.compileExpression(n[1],E),h=e.compileExpression(n[2],E),e.currentType=l.Type.void,new Error("not implemented");case"set_memory":if(r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),3!=n.length)return e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"3",n.length.toString(10)),e.currentType=l.Type.void,f.createUnreachable();throw s=e.compileExpression(n[0],E),o=e.compileExpression(n[1],l.Type.u32),h=e.compileExpression(n[2],E),e.currentType=l.Type.void,new Error("not implemented");case"changetype":return r&&1==r.length?9!=r[0].kind?(e.error(p.DiagnosticCode.Operation_not_supported,a.range),e.currentType=r[0],f.createUnreachable()):1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=r[0],f.createUnreachable()):(s=e.compileExpression(n[0],E,0),e.currentType=r[0],9!=e.currentType.kind?(e.error(p.DiagnosticCode.Operation_not_supported,a.range),f.createUnreachable()):s):(r&&r.length&&(e.currentType=r[0]),e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r?r.length.toString(10):"0"),f.createUnreachable());case"assert":if(n.length<1||n.length>2)return r&&(r.length&&(e.currentType=r[0].nonNullableType),1!=r.length&&e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10))),n.length<1?e.error(p.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,a.range,"1",n.length.toString(10)):n.length>2&&e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"2",n.length.toString(10)),f.createUnreachable();if(r){if(r.length&&(e.currentType=r[0].nonNullableType),1!=r.length)return e.error(p.DiagnosticCode.Expected_0_type_arguments_but_got_1,a.range,"1",r.length.toString(10)),f.createUnreachable();s=e.compileExpression(n[0],r[0])}else s=e.compileExpression(n[0],l.Type.i32,0);if(m=e.currentType,e.currentType=m.nonNullableType,e.options.noAssert)return i==l.Type.void?(e.currentType=l.Type.void,f.createNop()):s;if(i==l.Type.void){switch(e.currentType.kind){default:d=f.createIf(f.createUnary(u.UnaryOp.EqzI32,s),f.createUnreachable());break;case 3:case 8:d=f.createIf(f.createUnary(u.UnaryOp.EqzI64,s),f.createUnreachable());break;case 4:case 9:d=f.createIf(f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.EqzI64:u.UnaryOp.EqzI32,s),f.createUnreachable());break;case 11:d=f.createIf(f.createBinary(u.BinaryOp.EqF32,s,f.createF32(0)),f.createUnreachable());break;case 12:d=f.createIf(f.createBinary(u.BinaryOp.EqF64,s,f.createF64(0)),f.createUnreachable());break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}e.currentType=l.Type.void}else switch(e.currentType.kind){default:y=e.currentFunction.getAndFreeTempLocal(l.Type.i32),d=f.createIf(f.createUnary(u.UnaryOp.EqzI32,f.createTeeLocal(y.index,s)),f.createUnreachable(),f.createGetLocal(y.index,u.NativeType.I32));break;case 3:case 8:y=e.currentFunction.getAndFreeTempLocal(l.Type.i64),d=f.createIf(f.createUnary(u.UnaryOp.EqzI64,f.createTeeLocal(y.index,s)),f.createUnreachable(),f.createGetLocal(y.index,u.NativeType.I64));break;case 4:case 9:y=e.currentFunction.getAndFreeTempLocal(E),d=f.createIf(f.createUnary(e.options.target==c.Target.WASM64?u.UnaryOp.EqzI64:u.UnaryOp.EqzI32,f.createTeeLocal(y.index,s)),f.createUnreachable(),f.createGetLocal(y.index,T));break;case 11:y=e.currentFunction.getAndFreeTempLocal(l.Type.f32),d=f.createIf(f.createBinary(u.BinaryOp.EqF32,f.createTeeLocal(y.index,s),f.createF32(0)),f.createUnreachable(),f.createGetLocal(y.index,u.NativeType.F32));break;case 12:y=e.currentFunction.getAndFreeTempLocal(l.Type.f64),d=f.createIf(f.createBinary(u.BinaryOp.EqF64,f.createTeeLocal(y.index,s),f.createF64(0)),f.createUnreachable(),f.createGetLocal(y.index,u.NativeType.F64));break;case 13:e.error(p.DiagnosticCode.Operation_not_supported,a.range),d=f.createUnreachable()}return d;case"i8":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.i8,f.createUnreachable()):e.compileExpression(n[0],l.Type.i8,2);case"i16":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.i16,f.createUnreachable()):e.compileExpression(n[0],l.Type.i16,2);case"i32":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.i32,f.createUnreachable()):e.compileExpression(n[0],l.Type.i32,2);case"i64":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.i64,f.createUnreachable()):e.compileExpression(n[0],l.Type.i64,2);case"isize":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=e.options.target==c.Target.WASM64?l.Type.isize64:l.Type.isize32,f.createUnreachable()):e.compileExpression(n[0],e.options.target==c.Target.WASM64?l.Type.isize64:l.Type.isize32,2);case"u8":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.u8,f.createUnreachable()):e.compileExpression(n[0],l.Type.u8,2);case"u16":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.u16,f.createUnreachable()):e.compileExpression(n[0],l.Type.u16,2);case"u32":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.u32,f.createUnreachable()):e.compileExpression(n[0],l.Type.u32,2);case"u64":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.u64,f.createUnreachable()):e.compileExpression(n[0],l.Type.u64,2);case"usize":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=E,f.createUnreachable()):e.compileExpression(n[0],E,2);case"bool":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.bool,f.createUnreachable()):e.compileExpression(n[0],l.Type.bool,2);case"f32":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.f32,f.createUnreachable()):e.compileExpression(n[0],l.Type.f32,2);case"f64":return r&&e.error(p.DiagnosticCode.Type_0_is_not_generic,a.range,t.internalName),1!=n.length?(e.error(p.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",n.length.toString(10)),e.currentType=l.Type.f64,f.createUnreachable()):e.compileExpression(n[0],l.Type.f64,2)}return e.error(p.DiagnosticCode.Operation_not_supported,a.range),f.createUnreachable()}Object.defineProperty(t,"__esModule",{value:!0});var c=r(2),p=r(1),l=r(5),u=r(0),h=r(6);t.initialize=n,t.compileGetConstant=s,t.compileCall=o},function(e,t,r){"use strict";function n(e){switch(e){case 100:return"Conversion from type '{0}' to '{1}' possibly loses information and thus requires an explicit cast.";case 101:return"Basic type '{0}' cannot be nullable.";case 102:return"Operation not supported.";case 103:return"Operation is unsafe.";case 104:return"Cannot export a mutable global.";case 105:return"Compiling constant with non-constant initializer as mutable.";case 106:return"Type '{0}' cannot be changed to type '{1}'.";case 107:return"Structs cannot extend classes and vice-versa.";case 108:return"Structs cannot implement interfaces.";case 109:return"Invalid regular expression flags.";case 110:return"Type '{0}' cannot be reinterpreted as type '{1}'.";case 1002:return"Unterminated string literal.";case 1003:return"Identifier expected.";case 1005:return"'{0}' expected.";case 1006:return"A file cannot have a reference to itself.";case 1009:return"Trailing comma not allowed.";case 1012:return"Unexpected token.";case 1014:return"A rest parameter must be last in a parameter list.";case 1016:return"A required parameter cannot follow an optional parameter.";case 1061:return"Enum member must have initializer.";case 1036:return"Statements are not allowed in ambient contexts.";case 1039:return"Initializers are not allowed in ambient contexts.";case 1042:return"'{0}' modifier cannot be used here.";case 1049:return"A 'set' accessor must have exactly one parameter.";case 1052:return"A 'set' accessor parameter cannot have an initializer.";case 1054:return"A 'get' accessor cannot have parameters.";case 1092:return"Type parameters cannot appear on a constructor declaration.";case 1093:return"Type annotation cannot appear on a constructor declaration.";case 1094:return"An accessor cannot have type parameters.";case 1095:return"A 'set' accessor cannot have a return type annotation.";case 1098:return"Type parameter list cannot be empty.";case 1104:return"A 'continue' statement can only be used within an enclosing iteration statement.";case 1105:return"A 'break' statement can only be used within an enclosing iteration or switch statement.";case 1108:return"A 'return' statement can only be used within a function body.";case 1109:return"Expression expected.";case 1110:return"Type expected.";case 1113:return"A 'default' clause cannot appear more than once in a 'switch' statement.";case 1114:return"Duplicate label '{0}'.";case 1121:return"Octal literals are not allowed in strict mode.";case 1124:return"Digit expected.";case 1125:return"Hexadecimal digit expected.";case 1126:return"Unexpected end of text.";case 1127:return"Invalid character.";case 1130:return"'case' or 'default' expected.";case 1140:return"Type argument expected.";case 1141:return"String literal expected.";case 1142:return"Line break not permitted here.";case 1146:return"Declaration expected.";case 1155:return"'const' declarations must be initialized.";case 1161:return"Unterminated regular expression literal.";case 1177:return"Binary digit expected.";case 1178:return"Octal digit expected.";case 1183:return"An implementation cannot be declared in ambient contexts.";case 1198:return"An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive.";case 1199:return"Unterminated Unicode escape sequence.";case 1206:return"Decorators are not valid here.";case 1242:return"'abstract' modifier can only appear on a class, method, or property declaration.";case 1311:return"A class may only extend another class.";case 2300:return"Duplicate identifier '{0}'.";case 2304:return"Cannot find name '{0}'.";case 2305:return"Module '{0}' has no exported member '{1}'.";case 2314:return"Generic type '{0}' requires {1} type argument(s).";case 2315:return"Type '{0}' is not generic.";case 2322:return"Type '{0}' is not assignable to type '{1}'.";case 2329:return"Index signature is missing in type '{0}'.";case 2332:return"'this' cannot be referenced in current location.";case 2335:return"'super' can only be referenced in a derived class.";case 2339:return"Property '{0}' does not exist on type '{1}'.";case 2349:return"Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures.";case 2357:return"The operand of an increment or decrement operator must be a variable or a property access.";case 2364:return"The left-hand side of an assignment expression must be a variable or a property access.";case 2380:return"'get' and 'set' accessor must have the same type.";case 2390:return"Constructor implementation is missing.";case 2391:return"Function implementation is missing or not immediately following the declaration.";case 2393:return"Duplicate function implementation.";case 2484:return"Export declaration conflicts with exported declaration of '{0}'.";case 2540:return"Cannot assign to '{0}' because it is a constant or a read-only property.";case 2541:return"The target of an assignment must be a variable or a property access.";case 2542:return"Index signature in type '{0}' only permits reading.";case 2554:return"Expected {0} arguments, but got {1}.";case 2555:return"Expected at least {0} arguments, but got {1}.";case 2558:return"Expected {0} type arguments, but got {1}.";case 2694:return"Namespace '{0}' has no exported member '{1}'.";case 6054:return"File '{0}' not found.";default:return""}}Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Conversion_from_type_0_to_1_possibly_loses_information_and_thus_requires_an_explicit_cast=100]="Conversion_from_type_0_to_1_possibly_loses_information_and_thus_requires_an_explicit_cast",e[e.Basic_type_0_cannot_be_nullable=101]="Basic_type_0_cannot_be_nullable",e[e.Operation_not_supported=102]="Operation_not_supported",e[e.Operation_is_unsafe=103]="Operation_is_unsafe",e[e.Cannot_export_a_mutable_global=104]="Cannot_export_a_mutable_global",e[e.Compiling_constant_with_non_constant_initializer_as_mutable=105]="Compiling_constant_with_non_constant_initializer_as_mutable",e[e.Type_0_cannot_be_changed_to_type_1=106]="Type_0_cannot_be_changed_to_type_1",e[e.Structs_cannot_extend_classes_and_vice_versa=107]="Structs_cannot_extend_classes_and_vice_versa",e[e.Structs_cannot_implement_interfaces=108]="Structs_cannot_implement_interfaces",e[e.Invalid_regular_expression_flags=109]="Invalid_regular_expression_flags",e[e.Type_0_cannot_be_reinterpreted_as_type_1=110]="Type_0_cannot_be_reinterpreted_as_type_1",e[e.Unterminated_string_literal=1002]="Unterminated_string_literal",e[e.Identifier_expected=1003]="Identifier_expected",e[e._0_expected=1005]="_0_expected",e[e.A_file_cannot_have_a_reference_to_itself=1006]="A_file_cannot_have_a_reference_to_itself",e[e.Trailing_comma_not_allowed=1009]="Trailing_comma_not_allowed",e[e.Unexpected_token=1012]="Unexpected_token",e[e.A_rest_parameter_must_be_last_in_a_parameter_list=1014]="A_rest_parameter_must_be_last_in_a_parameter_list",e[e.A_required_parameter_cannot_follow_an_optional_parameter=1016]="A_required_parameter_cannot_follow_an_optional_parameter",e[e.Enum_member_must_have_initializer=1061]="Enum_member_must_have_initializer",e[e.Statements_are_not_allowed_in_ambient_contexts=1036]="Statements_are_not_allowed_in_ambient_contexts",e[e.Initializers_are_not_allowed_in_ambient_contexts=1039]="Initializers_are_not_allowed_in_ambient_contexts",e[e._0_modifier_cannot_be_used_here=1042]="_0_modifier_cannot_be_used_here",e[e.A_set_accessor_must_have_exactly_one_parameter=1049]="A_set_accessor_must_have_exactly_one_parameter",e[e.A_set_accessor_parameter_cannot_have_an_initializer=1052]="A_set_accessor_parameter_cannot_have_an_initializer",e[e.A_get_accessor_cannot_have_parameters=1054]="A_get_accessor_cannot_have_parameters",e[e.Type_parameters_cannot_appear_on_a_constructor_declaration=1092]="Type_parameters_cannot_appear_on_a_constructor_declaration",e[e.Type_annotation_cannot_appear_on_a_constructor_declaration=1093]="Type_annotation_cannot_appear_on_a_constructor_declaration",e[e.An_accessor_cannot_have_type_parameters=1094]="An_accessor_cannot_have_type_parameters",e[e.A_set_accessor_cannot_have_a_return_type_annotation=1095]="A_set_accessor_cannot_have_a_return_type_annotation",e[e.Type_parameter_list_cannot_be_empty=1098]="Type_parameter_list_cannot_be_empty",e[e.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement=1104]="A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement",e[e.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement=1105]="A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement",e[e.A_return_statement_can_only_be_used_within_a_function_body=1108]="A_return_statement_can_only_be_used_within_a_function_body",e[e.Expression_expected=1109]="Expression_expected",e[e.Type_expected=1110]="Type_expected",e[e.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement=1113]="A_default_clause_cannot_appear_more_than_once_in_a_switch_statement",e[e.Duplicate_label_0=1114]="Duplicate_label_0",e[e.Octal_literals_are_not_allowed_in_strict_mode=1121]="Octal_literals_are_not_allowed_in_strict_mode",e[e.Digit_expected=1124]="Digit_expected",e[e.Hexadecimal_digit_expected=1125]="Hexadecimal_digit_expected",e[e.Unexpected_end_of_text=1126]="Unexpected_end_of_text",e[e.Invalid_character=1127]="Invalid_character",e[e._case_or_default_expected=1130]="_case_or_default_expected",e[e.Type_argument_expected=1140]="Type_argument_expected",e[e.String_literal_expected=1141]="String_literal_expected",e[e.Line_break_not_permitted_here=1142]="Line_break_not_permitted_here",e[e.Declaration_expected=1146]="Declaration_expected",e[e._const_declarations_must_be_initialized=1155]="_const_declarations_must_be_initialized",e[e.Unterminated_regular_expression_literal=1161]="Unterminated_regular_expression_literal",e[e.Binary_digit_expected=1177]="Binary_digit_expected",e[e.Octal_digit_expected=1178]="Octal_digit_expected",e[e.An_implementation_cannot_be_declared_in_ambient_contexts=1183]="An_implementation_cannot_be_declared_in_ambient_contexts",e[e.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive=1198]="An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive",e[e.Unterminated_Unicode_escape_sequence=1199]="Unterminated_Unicode_escape_sequence",e[e.Decorators_are_not_valid_here=1206]="Decorators_are_not_valid_here",e[e._abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration=1242]="_abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration",e[e.A_class_may_only_extend_another_class=1311]="A_class_may_only_extend_another_class",e[e.Duplicate_identifier_0=2300]="Duplicate_identifier_0",e[e.Cannot_find_name_0=2304]="Cannot_find_name_0",e[e.Module_0_has_no_exported_member_1=2305]="Module_0_has_no_exported_member_1",e[e.Generic_type_0_requires_1_type_argument_s=2314]="Generic_type_0_requires_1_type_argument_s",e[e.Type_0_is_not_generic=2315]="Type_0_is_not_generic",e[e.Type_0_is_not_assignable_to_type_1=2322]="Type_0_is_not_assignable_to_type_1",e[e.Index_signature_is_missing_in_type_0=2329]="Index_signature_is_missing_in_type_0",e[e._this_cannot_be_referenced_in_current_location=2332]="_this_cannot_be_referenced_in_current_location",e[e._super_can_only_be_referenced_in_a_derived_class=2335]="_super_can_only_be_referenced_in_a_derived_class",e[e.Property_0_does_not_exist_on_type_1=2339]="Property_0_does_not_exist_on_type_1",e[e.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures=2349]="Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures",e[e.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access=2357]="The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access",e[e.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access=2364]="The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access",e[e._get_and_set_accessor_must_have_the_same_type=2380]="_get_and_set_accessor_must_have_the_same_type",e[e.Constructor_implementation_is_missing=2390]="Constructor_implementation_is_missing",e[e.Function_implementation_is_missing_or_not_immediately_following_the_declaration=2391]="Function_implementation_is_missing_or_not_immediately_following_the_declaration",e[e.Duplicate_function_implementation=2393]="Duplicate_function_implementation",e[e.Export_declaration_conflicts_with_exported_declaration_of_0=2484]="Export_declaration_conflicts_with_exported_declaration_of_0",e[e.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property=2540]="Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property",e[e.The_target_of_an_assignment_must_be_a_variable_or_a_property_access=2541]="The_target_of_an_assignment_must_be_a_variable_or_a_property_access",e[e.Index_signature_in_type_0_only_permits_reading=2542]="Index_signature_in_type_0_only_permits_reading",e[e.Expected_0_arguments_but_got_1=2554]="Expected_0_arguments_but_got_1",e[e.Expected_at_least_0_arguments_but_got_1=2555]="Expected_at_least_0_arguments_but_got_1",e[e.Expected_0_type_arguments_but_got_1=2558]="Expected_0_type_arguments_but_got_1",e[e.Namespace_0_has_no_exported_member_1=2694]="Namespace_0_has_no_exported_member_1",e[e.File_0_not_found=6054]="File_0_not_found"}(t.DiagnosticCode||(t.DiagnosticCode={})),t.diagnosticCodeToString=n},function(e,t,r){"use strict";function n(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}function i(e){switch(e){case 32:case 9:case 11:case 12:case 160:case 133:case 5760:case 8239:case 8287:case 12288:case 65279:return!0;default:return e>=8192&&e<=8203}}function a(e){return e>=48&&e<=57}function s(e){return e>=48&&e<=55}function o(e){return e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>127&&u(e)}function c(e){return e>=97&&e<=122}function p(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36==e||95==e||e>127&&h(e)}function l(e,t){if(e<t[0])return!1;for(var r,n=0,i=t.length;n+1<i;){if(r=n+(i-n)/2,r-=r%2,t[r]<=e&&e<=t[r+1])return!0;e<t[r]?i=r:n=r+2}return!1}function u(e){return!(e<0||e>65535)&&l(e,d)}function h(e){return!(e<0||e>65535)&&l(e,y)}Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NULL=0]="NULL",e[e.LINEFEED=10]="LINEFEED",e[e.CARRIAGERETURN=13]="CARRIAGERETURN",e[e.LINESEPARATOR=8232]="LINESEPARATOR",e[e.PARAGRAPHSEPARATOR=8233]="PARAGRAPHSEPARATOR",e[e.NEXTLINE=133]="NEXTLINE",e[e.SPACE=32]="SPACE",e[e.NONBREAKINGSPACE=160]="NONBREAKINGSPACE",e[e.ENQUAD=8192]="ENQUAD",e[e.EMQUAD=8193]="EMQUAD",e[e.ENSPACE=8194]="ENSPACE",e[e.EMSPACE=8195]="EMSPACE",e[e.THREEPEREMSPACE=8196]="THREEPEREMSPACE",e[e.FOURPEREMSPACE=8197]="FOURPEREMSPACE",e[e.SIXPEREMSPACE=8198]="SIXPEREMSPACE",e[e.FIGURESPACE=8199]="FIGURESPACE",e[e.PUNCTUATIONSPACE=8200]="PUNCTUATIONSPACE",e[e.THINSPACE=8201]="THINSPACE",e[e.HAIRSPACE=8202]="HAIRSPACE",e[e.ZEROWIDTHSPACE=8203]="ZEROWIDTHSPACE",e[e.NARROWNOBREAKSPACE=8239]="NARROWNOBREAKSPACE",e[e.IDEOGRAPHICSPACE=12288]="IDEOGRAPHICSPACE",e[e.MATHEMATICALSPACE=8287]="MATHEMATICALSPACE",e[e.OGHAM=5760]="OGHAM",e[e._=95]="_",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.AMPERSAND=38]="AMPERSAND",e[e.ASTERISK=42]="ASTERISK",e[e.AT=64]="AT",e[e.BACKSLASH=92]="BACKSLASH",e[e.BACKTICK=96]="BACKTICK",e[e.BAR=124]="BAR",e[e.CARET=94]="CARET",e[e.CLOSEBRACE=125]="CLOSEBRACE",e[e.CLOSEBRACKET=93]="CLOSEBRACKET",e[e.CLOSEPAREN=41]="CLOSEPAREN",e[e.COLON=58]="COLON",e[e.COMMA=44]="COMMA",e[e.DOLLAR=36]="DOLLAR",e[e.DOT=46]="DOT",e[e.DOUBLEQUOTE=34]="DOUBLEQUOTE",e[e.EQUALS=61]="EQUALS",e[e.EXCLAMATION=33]="EXCLAMATION",e[e.GREATERTHAN=62]="GREATERTHAN",e[e.HASH=35]="HASH",e[e.LESSTHAN=60]="LESSTHAN",e[e.MINUS=45]="MINUS",e[e.OPENBRACE=123]="OPENBRACE",e[e.OPENBRACKET=91]="OPENBRACKET",e[e.OPENPAREN=40]="OPENPAREN",e[e.PERCENT=37]="PERCENT",e[e.PLUS=43]="PLUS",e[e.QUESTION=63]="QUESTION",e[e.SEMICOLON=59]="SEMICOLON",e[e.SINGLEQUOTE=39]="SINGLEQUOTE",e[e.SLASH=47]="SLASH",e[e.TILDE=126]="TILDE",e[e.BACKSPACE=8]="BACKSPACE",e[e.FORMFEED=12]="FORMFEED",e[e.BYTEORDERMARK=65279]="BYTEORDERMARK",e[e.TAB=9]="TAB",e[e.VERTICALTAB=11]="VERTICALTAB"}(t.CharCode||(t.CharCode={})),t.isLineBreak=n,t.isWhiteSpace=i,t.isDecimalDigit=a,t.isOctalDigit=s,t.isIdentifierStart=o,t.isKeywordCharacter=c,t.isIdentifierPart=p;var d=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],y=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500]},function(e,t,r){"use strict";function n(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=47);for(var n=0,i=e.length;n+1<i&&46==e.charCodeAt(n)&&e.charCodeAt(n+1)==r;)n+=2;t&&i>n+3&&46==e.charCodeAt(i-3)&&(116==e.charCodeAt(i-2)||97==e.charCodeAt(i-2))&&115==e.charCodeAt(i-1)&&(i-=3),(n>0||i<e.length)&&(e=e.substring(n,i),i-=n,n=0);for(var a;n+1<i;){if(a=!1,e.charCodeAt(n)==r&&46==e.charCodeAt(n+1)){if((a=n+2==i)||n+2<i&&e.charCodeAt(n+2)==r){e=a?e.substring(0,n):e.substring(0,n)+e.substring(n+2),i-=2;continue}if((a=n+3==i)&&46==e.charCodeAt(n+2)||n+3<i&&46==e.charCodeAt(n+2)&&e.charCodeAt(n+3)==r){for(var s=n;--s>=0;)if(e.charCodeAt(s)==r){n-s==3&&46==e.charCodeAt(s+1)&&46==e.charCodeAt(s+2)||(e=a?e.substring(0,s):e.substring(0,s)+e.substring(n+3),i-=n+3-s,n=s-1);break}if(s<0&&n>0&&(2!=n||46!=e.charCodeAt(0)||46!=e.charCodeAt(1))){e=e.substring(n+4),i=e.length;continue}}}n++}return i>0?e:"."}function i(e,t,r){return void 0===r&&(r=47),n(a(t,r)+String.fromCharCode(r)+e)}function a(e,t){void 0===t&&(t=47);for(var r=e.length;--r>0;)if(e.charCodeAt(r)==t)return e.substring(0,r);return"."}Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=n,t.resolve=i,t.dirname=a},function(e,t,r){r(15),e.exports=r(19)},function(e,t,r){(function(e){r(16);var t="undefined"!=typeof window&&window||void 0!==e&&e||self,n=t.Binaryen;if(!n)try{n=r(17)}catch(e){n=t.Binaryen}for(var i in n)/^_(?:Binaryen|Relooper)/.test(i)&&(t[i]=n[i]);t.allocate_memory=function(e){return e?n._malloc(e):0},t.free_memory=function(e){e&&n._free(e)},t.move_memory=function(e,t,r){return n._memmove(e,t,r)},t.store=function(e,t){n.HEAPU8[e]=t},t.load=function(e){return n.HEAPU8[e]};var a=r(0).Module;a.prototype.toBinary=function(e){e||(e=1048576);var t=allocate_memory(e),r=this.write(t,e),i=new Uint8Array(r);return i.set(n.HEAPU8.subarray(t,t+r)),free_memory(t),i},a.prototype.toText=function(){var e=n.print,t="";return n.print=function(e){t+=e+"\n"},this.print(),n.print=e,t},a.prototype.toAsmjs=function(){var e=n.print,t="";return n.print=function(e){t+=e+"\n"},this.printAsmjs(),n.print=e,t}}).call(t,r(9))},function(e,t,r){(function(e){function t(){Error.captureStackTrace?Error.captureStackTrace(this,t):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}function r(e){this.message=e||"assertion failed",Error.captureStackTrace?Error.captureStackTrace(this,r):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}var n="undefined"!=typeof window&&window||void 0!==e&&e||self;Object.defineProperties(n.i8=function(e){return e<<24>>24},{MIN_VALUE:{value:-128,writable:!1},MAX_VALUE:{value:127,writable:!1}}),Object.defineProperties(n.i16=function(e){return e<<16>>16},{MIN_VALUE:{value:-32768,writable:!1},MAX_VALUE:{value:32767,writable:!1}}),Object.defineProperties(n.i32=n.isize=function(e){return 0|e},{MIN_VALUE:{value:-2147483648,writable:!1},MAX_VALUE:{value:2147483647,writable:!1}}),Object.defineProperties(n.u8=function(e){return 255&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:255,writable:!1}}),Object.defineProperties(n.u16=function(e){return 65535&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:65535,writable:!1}}),Object.defineProperties(n.u32=n.usize=function(e){return e>>>0},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:4294967295,writable:!1}}),Object.defineProperties(n.bool=function(e){return!!e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:1,writable:!1}}),Object.defineProperties(n.f32=function(e){return Math.fround(e)},{MIN_VALUE:{value:Math.fround(-3.40282347e38),writable:!1},MAX_VALUE:{value:Math.fround(3.40282347e38),writable:!1},MIN_SAFE_INTEGER:{value:-16777215,writable:!1},MAX_SAFE_INTEGER:{value:16777215,writable:!1},EPSILON:{value:Math.fround(1.1920929e-7),writable:!1}}),Object.defineProperties(n.f64=function(e){return+e},{MIN_VALUE:{value:-1.7976931348623157e308,writable:!1},MAX_VALUE:{value:1.7976931348623157e308,writable:!1},MIN_SAFE_INTEGER:{value:-9007199254740991,writable:!1},MAX_SAFE_INTEGER:{value:9007199254740991,writable:!1},EPSILON:{value:2.220446049250313e-16,writable:!1}}),n.clz=Math.clz32,n.abs=Math.abs,n.max=Math.max,n.min=Math.min,n.ceil=Math.ceil,n.floor=Math.floor,n.select=function(e,t,r){return r?e:t},n.sqrt=Math.sqrt,n.trunc=Math.trunc,t.prototype=Object.create(Error.prototype),t.prototype.name="UnreachableError",t.prototype.message="unreachable",n.unreachable=function(){throw new t},r.prototype=Object.create(Error.prototype),r.prototype.name="AssertionError",n.assert=function(e,t){if(e)return e;throw new r(t)},n.changetype=function(e){return e},String.fromCharCodes=function(e){return String.fromCharCode.apply(String,e)},String.fromCodePoints=function(e){return String.fromCodePoint.apply(String,e)}}).call(t,r(9))},function(t,r){if(void 0===e){var n=new Error('Cannot find module "binaryen"');throw n.code="MODULE_NOT_FOUND",n}t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sb=new Array},function(e,t,r){"use strict";function n(e,t,r,n){return void 0===r&&(r=null),void 0===n&&(n=!1),r||(r=new T.Parser,n=!0),r.parseFile(e,t,n),r}function i(e){return e.nextFile()}function a(e){var t=e.program;return t.diagnosticsOffset<t.diagnostics.length?t.diagnostics[t.diagnosticsOffset++]:null}function s(e,t,r){return E.formatDiagnosticMessage(e,t,r)}function o(e){return e.category==E.DiagnosticCategory.INFO}function c(e){return e.category==E.DiagnosticCategory.WARNING}function p(e){return e.category==E.DiagnosticCategory.ERROR}function l(){return new f.Options}function u(e,t){e.target=t}function h(e,t){e.noTreeShaking=t}function d(e,t){e.noAssert=t}function y(e,t){e.noMemory=t}function _(e,t){void 0===t&&(t=null);var r=e.finish();return new f.Compiler(r,t).compile()}function m(e){var t=new g.Decompiler;return t.decompile(e),t.finish()}Object.defineProperty(t,"__esModule",{value:!0});var f=r(2),E=r(1),T=r(20),g=r(21);t.parseFile=n,t.nextFile=i,t.nextDiagnostic=a,t.formatDiagnostic=s,t.isInfo=o,t.isWarning=c,t.isError=p,t.createOptions=l,t.setTarget=u,t.setNoTreeShaking=h,t.setNoAssert=d,t.setNoMemory=y,t.compile=_,t.decompile=m},function(e,t,r){"use strict";function n(e){switch(e){case c.Token.DOT_DOT_DOT:return 1;case c.Token.YIELD:return 2;case c.Token.EXCLAMATION:case c.Token.TILDE:case c.Token.PLUS:case c.Token.MINUS:case c.Token.PLUS_PLUS:case c.Token.MINUS_MINUS:case c.Token.TYPEOF:case c.Token.VOID:case c.Token.DELETE:return 16;case c.Token.NEW:return 19;default:return-1}}function i(e){switch(e){case c.Token.COMMA:return 0;case c.Token.EQUALS:case c.Token.PLUS_EQUALS:case c.Token.MINUS_EQUALS:case c.Token.ASTERISK_ASTERISK_EQUALS:case c.Token.ASTERISK_EQUALS:case c.Token.SLASH_EQUALS:case c.Token.PERCENT_EQUALS:case c.Token.LESSTHAN_LESSTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.AMPERSAND_EQUALS:case c.Token.CARET_EQUALS:case c.Token.BAR_EQUALS:return 3;case c.Token.QUESTION:return 4;case c.Token.BAR_BAR:return 5;case c.Token.AMPERSAND_AMPERSAND:return 6;case c.Token.BAR:return 7;case c.Token.CARET:return 8;case c.Token.AMPERSAND:return 9;case c.Token.EQUALS_EQUALS:case c.Token.EXCLAMATION_EQUALS:case c.Token.EQUALS_EQUALS_EQUALS:case c.Token.EXCLAMATION_EQUALS_EQUALS:return 10;case c.Token.AS:case c.Token.IN:case c.Token.INSTANCEOF:case c.Token.LESSTHAN:case c.Token.GREATERTHAN:case c.Token.LESSTHAN_EQUALS:case c.Token.GREATERTHAN_EQUALS:return 11;case c.Token.LESSTHAN_LESSTHAN:case c.Token.GREATERTHAN_GREATERTHAN:case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:return 12;case c.Token.PLUS:case c.Token.MINUS:return 13;case c.Token.ASTERISK:case c.Token.SLASH:case c.Token.PERCENT:return 14;case c.Token.ASTERISK_ASTERISK:return 15;case c.Token.PLUS_PLUS:case c.Token.MINUS_MINUS:return 17;case c.Token.DOT:case c.Token.NEW:return 19;default:return-1}}function a(e){switch(e){case c.Token.EQUALS:case c.Token.PLUS_EQUALS:case c.Token.MINUS_EQUALS:case c.Token.ASTERISK_ASTERISK_EQUALS:case c.Token.ASTERISK_EQUALS:case c.Token.SLASH_EQUALS:case c.Token.PERCENT_EQUALS:case c.Token.LESSTHAN_LESSTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case c.Token.AMPERSAND_EQUALS:case c.Token.CARET_EQUALS:case c.Token.BAR_EQUALS:case c.Token.QUESTION:case c.Token.ASTERISK_ASTERISK:return!0;default:return!1}}var s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),c=r(4),p=r(1),l=r(13),u=r(8),h=function(e){function t(){var t=e.call(this)||this;return t.backlog=new Array,t.seenlog=new Set,t.program=new o.Program(t.diagnostics),t}return s(t,e),t.prototype.parseFile=function(e,t,r){for(var n=l.normalize(t),i=0,a=this.program.sources.length;i<a;++i)if(this.program.sources[i].normalizedPath==n)return;this.seenlog.add(n);var s=new u.Source(t,e,r?u.SourceKind.ENTRY:t.startsWith("std:")?u.SourceKind.STDLIB:u.SourceKind.DEFAULT);this.program.sources.push(s);var o=new c.Tokenizer(s,this.program.diagnostics);for(o.silentDiagnostics=this.silentDiagnostics,s.tokenizer=o;!o.skip(c.Token.ENDOFFILE);){var p=this.parseTopLevelStatement(o);p&&(p.parent=s,s.statements.push(p))}},t.prototype.parseTopLevelStatement=function(e,t){void 0===t&&(t=!1);for(var r=null;e.skip(c.Token.AT);){var n=this.parseDecorator(e);if(!n)break;r||(r=new Array),r.push(n)}var i=null;e.skip(c.Token.EXPORT)&&(i=u.addModifier(u.Node.createModifier(u.ModifierKind.EXPORT,e.range()),i)),e.skip(c.Token.DECLARE)&&(i=u.addModifier(u.Node.createModifier(u.ModifierKind.DECLARE,e.range()),i),e.peek(!0),e.nextTokenOnNewLine&&this.error(p.DiagnosticCode.Line_break_not_permitted_here,e.range(e.pos))),e.mark();var a,s=null;switch(e.next()){case c.Token.CONST:if(i=u.addModifier(u.Node.createModifier(u.ModifierKind.CONST,e.range()),i),e.skip(c.Token.ENUM)){s=this.parseEnum(e,i,r);break}case c.Token.VAR:case c.Token.LET:s=this.parseVariable(e,i,r),r=null;break;case c.Token.ENUM:s=this.parseEnum(e,i,r),r=null;break;case c.Token.FUNCTION:s=this.parseFunction(e,i,r),r=null;break;case c.Token.ABSTRACT:if(!e.skip(c.Token.CLASS)){this.error(p.DiagnosticCode._0_expected,e.range(e.pos),"class");break}i=u.addModifier(u.Node.createModifier(u.ModifierKind.ABSTRACT,e.range()),i);case c.Token.CLASS:s=this.parseClass(e,i,r),r=null;break;case c.Token.NAMESPACE:s=this.parseNamespace(e,i,r),r=null;break;case c.Token.IMPORT:s=(a=u.getModifier(u.ModifierKind.EXPORT,i))?this.parseExportImport(e,a.range):this.parseImport(e),i&&u.setReusableModifiers(i);break;case c.Token.TYPE:s=this.parseTypeDeclaration(e,i,r),r=null;break;default:u.hasModifier(u.ModifierKind.EXPORT,i)?(e.reset(),s=this.parseExport(e,i)):(i&&((a=u.getModifier(u.ModifierKind.DECLARE,i))&&this.error(p.DiagnosticCode._0_modifier_cannot_be_used_here,a.range,"declare"),u.setReusableModifiers(i)),e.reset(),t||(s=this.parseStatement(e,!0)))}if(r)for(var o=0,l=r.length;o<l;++o)this.error(p.DiagnosticCode.Decorators_are_not_valid_here,r[o].range);return s},t.prototype.nextFile=function(){if(this.backlog.length){for(var e=this.backlog[0],t=0,r=this.backlog.length-1;t<r;++t)this.backlog[t]=this.backlog[t+1];return this.backlog.length--,e}return null},t.prototype.finish=function(){if(this.backlog.length)throw new Error("backlog is not empty");return this.backlog=[],this.seenlog.clear(),this.program},t.prototype.parseType=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1);var n=e.next(),i=e.tokenPos;if(n==c.Token.VOID)return u.Node.createType(u.Node.createIdentifierExpression("void",e.range()),[],!1,e.range(i,e.pos));var a;if(t&&n==c.Token.OPENPAREN){var s=this.parseType(e,!1,r);if(!s)return null;if(!e.skip(c.Token.CLOSEPAREN))return r||this.error(p.DiagnosticCode._0_expected,e.range(e.pos),"}"),null;a=s,a.range.start=i,a.range.end=e.pos}else if(n==c.Token.THIS)a=u.Node.createType(u.Node.createThisExpression(e.range()),[],!1,e.range(i,e.pos));else if(n==c.Token.TRUE||n==c.Token.FALSE)a=u.Node.createType(u.Node.createIdentifierExpression("bool",e.range()),[],!1,e.range(i,e.pos));else if(n==c.Token.STRINGLITERAL)e.readString(),a=u.Node.createType(u.Node.createIdentifierExpression("string",e.range()),[],!1,e.range(i,e.pos));else{if(n!=c.Token.IDENTIFIER)return r||this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;var o=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),l=new Array,h=!1;if(e.skip(c.Token.LESSTHAN)){do{var d=this.parseType(e,!0,r);if(!d)return null;l.push(d)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.GREATERTHAN))return r||this.error(p.DiagnosticCode._0_expected,e.range(e.pos),">"),null}if(e.skip(c.Token.BAR)){if(!e.skip(c.Token.NULL))return r||this.error(p.DiagnosticCode._0_expected,e.range(e.pos),"null"),null;h=!0}a=u.Node.createType(o,l,h,e.range(i,e.pos))}for(;e.skip(c.Token.OPENBRACKET);){var y=e.tokenPos;if(!e.skip(c.Token.CLOSEBRACKET))return r||this.error(p.DiagnosticCode._0_expected,e.range(),"]"),null;var _=e.range(y,e.pos);if(h=!1,e.skip(c.Token.BAR)){if(!e.skip(c.Token.NULL))return r||this.error(p.DiagnosticCode._0_expected,e.range(),"null"),null;h=!0}if(a=u.Node.createType(u.Node.createIdentifierExpression("Array",_),[a],h,e.range(i,e.pos)),h)break}return a},t.prototype.parseDecorator=function(e){var t=e.tokenPos;if(e.skip(c.Token.IDENTIFIER)){for(var r=e.readIdentifier(),n=u.Node.createIdentifierExpression(r,e.range(t,e.pos));e.skip(c.Token.DOT);){if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;r=e.readIdentifier(),n=u.Node.createPropertyAccessExpression(n,u.Node.createIdentifierExpression(r,e.range()),e.range(t,e.pos))}var i;if(!e.skip(c.Token.OPENPAREN))return u.Node.createDecorator(n,null,e.range(t,e.pos));if(i=this.parseArguments(e))return u.Node.createDecorator(n,i,e.range(t,e.pos))}else this.error(p.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseVariable=function(e,t,r){var n=t&&t.length?t[0].range.start:e.tokenPos,i=new Array,a=u.hasModifier(u.ModifierKind.DECLARE,t);do{var s=this.parseVariableDeclaration(e,a,t,r);if(!s)return null;i.push(s)}while(e.skip(c.Token.COMMA));var o=u.Node.createVariableStatement(i,t,r,e.range(n,e.pos));return e.skip(c.Token.SEMICOLON),o},t.prototype.parseVariableDeclaration=function(e,t,r,n){if(void 0===t&&(t=!1),!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;var i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),a=null;e.skip(c.Token.COLON)&&(a=this.parseType(e));var s=null;if(e.skip(c.Token.EQUALS)){if(t&&this.error(p.DiagnosticCode.Initializers_are_not_allowed_in_ambient_contexts,e.range()),!(s=this.parseExpression(e,1)))return null}else u.hasModifier(u.ModifierKind.CONST,r)?u.hasModifier(u.ModifierKind.DECLARE,r)||this.error(p.DiagnosticCode._const_declarations_must_be_initialized,i.range):a||this.error(p.DiagnosticCode.Type_expected,e.range(e.pos));return u.Node.createVariableDeclaration(i,a,s,r,n,c.Range.join(i.range,e.range()))},t.prototype.parseEnum=function(e,t,r){var n=t&&t.length?t[0].range.start:e.tokenPos;if(e.next()!=c.Token.IDENTIFIER)return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;var i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.next()!=c.Token.OPENBRACE)return this.error(p.DiagnosticCode._0_expected,e.range(),"{"),null;var a=new Array;if(!e.skip(c.Token.CLOSEBRACE)){do{var s=this.parseEnumValue(e);if(!s)return null;a.push(s)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.CLOSEBRACE))return this.error(p.DiagnosticCode._0_expected,e.range(),"}"),null}var o=u.Node.createEnumDeclaration(i,a,t,r,e.range(n,e.pos));return e.skip(c.Token.SEMICOLON),o},t.prototype.parseEnumValue=function(e){if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;var t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;return e.skip(c.Token.EQUALS)&&!(r=this.parseExpression(e,1))?null:u.Node.createEnumValueDeclaration(t,r,c.Range.join(t.range,e.range()))},t.prototype.parseReturn=function(e){var t=null;if(e.peek(!0)!=c.Token.SEMICOLON&&e.nextToken!=c.Token.CLOSEBRACE&&!e.nextTokenOnNewLine&&!(t=this.parseExpression(e)))return null;var r=u.Node.createReturnStatement(t,e.range());return e.skip(c.Token.SEMICOLON),r},t.prototype.parseTypeParameters=function(e){var t=new Array;if(e.skip(c.Token.GREATERTHAN))this.error(p.DiagnosticCode.Type_parameter_list_cannot_be_empty,e.range());else{do{var r=this.parseTypeParameter(e);if(!r)return null;t.push(r)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.GREATERTHAN))return this.error(p.DiagnosticCode._0_expected,e.range(),">"),null}return t},t.prototype.parseTypeParameter=function(e){if(e.next()==c.Token.IDENTIFIER){var t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;return e.skip(c.Token.EXTENDS)&&!(r=this.parseType(e))?null:u.Node.createTypeParameter(t,r,c.Range.join(t.range,e.range()))}return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseParameters=function(e){var t=new Array;if(e.peek()!=c.Token.CLOSEPAREN)do{var r=this.parseParameter(e);if(!r)return null;t.push(r)}while(e.skip(c.Token.COMMA));return e.skip(c.Token.CLOSEPAREN)?t:(this.error(p.DiagnosticCode._0_expected,e.range(),")"),null)},t.prototype.parseParameter=function(e){var t=!1,r=null;if(e.skip(c.Token.DOT_DOT_DOT)&&(t=!0,r=e.range()),e.skip(c.Token.IDENTIFIER)){t||(r=e.range());var n=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),i=null;if(e.skip(c.Token.COLON)&&!(i=this.parseType(e)))return null;var a=null;return e.skip(c.Token.EQUALS)&&!(a=this.parseExpression(e))?null:u.Node.createParameter(n,i,a,t,c.Range.join(r,e.range()))}return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseFunction=function(e,t,r){var n=t&&t.length?t[0].range.start:e.tokenPos;if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range(e.pos)),null;var i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),a=null;if(e.skip(c.Token.LESSTHAN)){if(!(a=this.parseTypeParameters(e)))return null}else a=[];if(!e.skip(c.Token.OPENPAREN))return this.error(p.DiagnosticCode._0_expected,e.range(e.pos),"("),null;var s=this.parseParameters(e);if(!s)return null;var o=u.hasModifier(u.ModifierKind.SET,t);o&&(1!=s.length&&this.error(p.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,i.range),s.length&&s[0].initializer&&this.error(p.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,i.range)),u.hasModifier(u.ModifierKind.GET,t)&&s.length&&this.error(p.DiagnosticCode.A_get_accessor_cannot_have_parameters,i.range);var l=null;if(e.skip(c.Token.COLON)){if(!(l=this.parseType(e,o)))return null}else o||this.error(p.DiagnosticCode.Type_expected,e.range(e.pos));var h=u.hasModifier(u.ModifierKind.DECLARE,t),d=null;if(e.skip(c.Token.OPENBRACE))for(d=new Array,h&&this.error(p.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range());!e.skip(c.Token.CLOSEBRACE);){var y=this.parseStatement(e);if(!y)return null;d.push(y)}else h||this.error(p.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range(e.pos));var _=u.Node.createFunctionDeclaration(i,a,s,l,d,t,r,e.range(n,e.pos));return e.skip(c.Token.SEMICOLON),_},t.prototype.parseClass=function(e,t,r){var n=r&&r.length?r[0].range.start:t&&t.length?t[0].range.start:e.tokenPos;if(e.skip(c.Token.IDENTIFIER)){var i,a=u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(c.Token.LESSTHAN)){if(!(i=this.parseTypeParameters(e)))return null}else i=[];var s=null;if(e.skip(c.Token.EXTENDS)&&!(s=this.parseType(e)))return null;var o=new Array;if(e.skip(c.Token.IMPLEMENTS))do{var l=this.parseType(e);if(!l)return null;o.push(l)}while(e.skip(c.Token.COMMA));if(e.skip(c.Token.OPENBRACE)){var h=new Array;if(!e.skip(c.Token.CLOSEBRACE)){var d=u.hasModifier(u.ModifierKind.DECLARE,t);do{var y=this.parseClassMember(e,d);if(!y)return null;h.push(y)}while(!e.skip(c.Token.CLOSEBRACE))}return u.Node.createClassDeclaration(a,i,s,o,h,t,r,e.range(n,e.pos))}this.error(p.DiagnosticCode._0_expected,e.range(),"{")}else this.error(p.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseClassMember=function(e,t){for(var r=e.pos,n=new Array;e.skip(c.Token.AT);){var i=this.parseDecorator(e);if(!i)break;n.push(i)}var a=null;e.skip(c.Token.PUBLIC)?a=u.addModifier(u.Node.createModifier(u.ModifierKind.PUBLIC,e.range()),a):e.skip(c.Token.PRIVATE)?a=u.addModifier(u.Node.createModifier(u.ModifierKind.PRIVATE,e.range()),a):e.skip(c.Token.PROTECTED)&&(a=u.addModifier(u.Node.createModifier(u.ModifierKind.PROTECTED,e.range()),a)),e.skip(c.Token.STATIC)?a=u.addModifier(u.Node.createModifier(u.ModifierKind.STATIC,e.range()),a):e.skip(c.Token.ABSTRACT)&&(a=u.addModifier(u.Node.createModifier(u.ModifierKind.ABSTRACT,e.range()),a)),e.skip(c.Token.READONLY)&&(a=u.addModifier(u.Node.createModifier(u.ModifierKind.READONLY,e.range()),a)),e.mark();var s=!1,o=!1;if((s=e.skip(c.Token.GET))?e.peek(!0,!0)!=c.Token.IDENTIFIER||e.nextTokenOnNewLine?(e.reset(),s=!1):a=u.addModifier(u.Node.createModifier(u.ModifierKind.GET,e.range()),a):(o=e.skip(c.Token.SET))&&(e.peek(!0,!0)!=c.Token.IDENTIFIER||e.nextTokenOnNewLine?(e.reset(),o=!1):a=u.addModifier(u.Node.createModifier(u.ModifierKind.SET,e.range()),a)),e.skip(c.Token.CONSTRUCTOR)||e.skip(c.Token.IDENTIFIER)){var l,h=e.token==c.Token.CONSTRUCTOR?u.Node.createConstructorExpression(e.range()):u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(c.Token.LESSTHAN)){if(h.kind==u.NodeKind.CONSTRUCTOR&&this.error(p.DiagnosticCode.Type_parameters_cannot_appear_on_a_constructor_declaration,e.range()),!(l=this.parseTypeParameters(e)))return null}else l=[];if(h.kind==u.NodeKind.CONSTRUCTOR&&e.peek()!=c.Token.OPENPAREN&&this.error(p.DiagnosticCode.Constructor_implementation_is_missing,e.range()),e.skip(c.Token.OPENPAREN)){var d=this.parseParameters(e);if(!d)return null;s&&d.length&&this.error(p.DiagnosticCode.A_get_accessor_cannot_have_parameters,h.range),o&&(1!=d.length&&this.error(p.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,h.range),d.length&&d[0].initializer&&this.error(p.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,h.range));var y=null;if(e.skip(c.Token.COLON)){if(h.kind==u.NodeKind.CONSTRUCTOR?this.error(p.DiagnosticCode.Type_annotation_cannot_appear_on_a_constructor_declaration,e.range()):o&&this.error(p.DiagnosticCode.A_set_accessor_cannot_have_a_return_type_annotation,e.range()),!(y=this.parseType(e,h.kind==u.NodeKind.CONSTRUCTOR||o)))return null}else o||h.kind==u.NodeKind.CONSTRUCTOR||this.error(p.DiagnosticCode.Type_expected,e.range());var _=null;if(e.skip(c.Token.OPENBRACE))for(t&&this.error(p.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range()),_=new Array;!e.skip(c.Token.CLOSEBRACE);){var m=this.parseStatement(e);if(!m)return null;_.push(m)}else t||this.error(p.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range());var f=u.Node.createMethodDeclaration(h,l,d,y,_,a,n,e.range(r,e.pos));return e.skip(c.Token.SEMICOLON),f}var E;(E=u.getModifier(u.ModifierKind.ABSTRACT,a))&&this.error(p.DiagnosticCode._0_modifier_cannot_be_used_here,E.range,"abstract"),(E=u.getModifier(u.ModifierKind.GET,a))&&this.error(p.DiagnosticCode._0_modifier_cannot_be_used_here,E.range,"get"),(E=u.getModifier(u.ModifierKind.SET,a))&&this.error(p.DiagnosticCode._0_modifier_cannot_be_used_here,E.range,"set");var T=null;if(e.skip(c.Token.COLON)){if(!(T=this.parseType(e)))return null}else this.error(p.DiagnosticCode.Type_expected,e.range());var g=null;if(e.skip(c.Token.EQUALS)&&!(g=this.parseExpression(e)))return null;var A=u.Node.createFieldDeclaration(h,T,g,a,n,e.range(r,e.pos));return e.skip(c.Token.SEMICOLON),A}return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseNamespace=function(e,t,r){var n=t&&t.length?t[0].range.start:e.tokenPos;if(e.skip(c.Token.IDENTIFIER)){var i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(c.Token.OPENBRACE)){for(var a=new Array;!e.skip(c.Token.CLOSEBRACE);){var s=this.parseTopLevelStatement(e,!0);if(!s)return null;a.push(s)}var o=u.Node.createNamespaceDeclaration(i,a,t,r,e.range(n,e.pos));return e.skip(c.Token.SEMICOLON),o}this.error(p.DiagnosticCode._0_expected,e.range(),"{")}else this.error(p.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseExport=function(e,t){var r=t&&t.length?t[0].range.start:e.tokenPos;if(e.skip(c.Token.OPENBRACE)){var n=new Array;if(!e.skip(c.Token.CLOSEBRACE)){do{var i=this.parseExportMember(e);if(!i)return null;n.push(i)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.CLOSEBRACE))return this.error(p.DiagnosticCode._0_expected,e.range(),"}"),null}var a=null;if(e.skip(c.Token.FROM)){if(!e.skip(c.Token.STRINGLITERAL))return this.error(p.DiagnosticCode.String_literal_expected,e.range()),null;a=u.Node.createStringLiteralExpression(e.readString(),e.range())}var s=u.Node.createExportStatement(n,a,t,e.range(r,e.pos));return s.normalizedPath&&!this.seenlog.has(s.normalizedPath)&&(this.backlog.push(s.normalizedPath),this.seenlog.add(s.normalizedPath)),e.skip(c.Token.SEMICOLON),s}return this.error(p.DiagnosticCode._0_expected,e.range(),"{"),null},t.prototype.parseExportMember=function(e){if(e.skip(c.Token.IDENTIFIER)){var t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(c.Token.AS)){if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;r=u.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return u.Node.createExportMember(t,r,r?c.Range.join(t.range,r.range):t.range)}return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseImport=function(e){var t=e.tokenPos,r=null,n=null,i=!1;if(e.skip(c.Token.OPENBRACE)){if(r=new Array,!e.skip(c.Token.CLOSEBRACE)){do{var a=this.parseImportDeclaration(e);if(!a)return null;r.push(a)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.CLOSEBRACE))return this.error(p.DiagnosticCode._0_expected,e.range(),"}"),null}}else if(e.skip(c.Token.ASTERISK)){if(!e.skip(c.Token.AS))return this.error(p.DiagnosticCode._0_expected,e.range(),"as"),null;if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;n=u.Node.createIdentifierExpression(e.readIdentifier(),e.range())}else i=!0;if(i||e.skip(c.Token.FROM)){if(e.skip(c.Token.STRINGLITERAL)){var s,o=u.Node.createStringLiteralExpression(e.readString(),e.range());return n?(assert(!r),s=u.Node.createImportStatementWithWildcard(n,o,e.range(t,e.pos))):s=u.Node.createImportStatement(r,o,e.range(t,e.pos)),this.seenlog.has(s.normalizedPath)||(this.backlog.push(s.normalizedPath),this.seenlog.add(s.normalizedPath)),e.skip(c.Token.SEMICOLON),s}this.error(p.DiagnosticCode.String_literal_expected,e.range())}else this.error(p.DiagnosticCode._0_expected,e.range(),"from");return null},t.prototype.parseImportDeclaration=function(e){if(e.skip(c.Token.IDENTIFIER)){var t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(c.Token.AS)){if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;r=u.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return u.Node.createImportDeclaration(t,r,r?c.Range.join(t.range,r.range):t.range)}return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseExportImport=function(e,t){if(e.skip(c.Token.IDENTIFIER)){var r=u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(c.Token.EQUALS)){if(e.skip(c.Token.IDENTIFIER)){var n=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),i=u.Node.createExportImportStatement(n,r,c.Range.join(t,e.range()));return e.skip(c.Token.SEMICOLON),i}this.error(p.DiagnosticCode.Identifier_expected,e.range())}else this.error(p.DiagnosticCode._0_expected,e.range(),"=")}else this.error(p.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseStatement=function(e,t){switch(void 0===t&&(t=!1),e.mark(),e.next()){case c.Token.BREAK:return this.parseBreak(e);case c.Token.CONST:return this.parseVariable(e,[u.Node.createModifier(u.ModifierKind.CONST,e.range())],null);case c.Token.CONTINUE:return this.parseContinue(e);case c.Token.DO:return this.parseDoStatement(e);case c.Token.FOR:return this.parseForStatement(e);case c.Token.IF:return this.parseIfStatement(e);case c.Token.LET:case c.Token.VAR:return this.parseVariable(e,null,null);case c.Token.OPENBRACE:return this.parseBlockStatement(e,t);case c.Token.RETURN:return t&&this.error(p.DiagnosticCode.A_return_statement_can_only_be_used_within_a_function_body,e.range()),this.parseReturn(e);case c.Token.SEMICOLON:return u.Node.createEmptyStatement(e.range(e.tokenPos));case c.Token.SWITCH:return this.parseSwitchStatement(e);case c.Token.THROW:return this.parseThrowStatement(e);case c.Token.TRY:return this.parseTryStatement(e);case c.Token.TYPE:return this.parseTypeDeclaration(e,null);case c.Token.WHILE:return this.parseWhileStatement(e);default:return e.reset(),this.parseExpressionStatement(e)}},t.prototype.parseBlockStatement=function(e,t){for(var r=e.tokenPos,n=new Array;!e.skip(c.Token.CLOSEBRACE);){var i=this.parseStatement(e,t);if(!i)return null;n.push(i)}var a=u.Node.createBlockStatement(n,e.range(r,e.pos));return e.skip(c.Token.SEMICOLON),a},t.prototype.parseBreak=function(e){var t=null;e.peek(!0)!=c.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(!0),t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=u.Node.createBreakStatement(t,e.range());return e.skip(c.Token.SEMICOLON),r},t.prototype.parseContinue=function(e){var t=null;e.peek(!0)!=c.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(!0),t=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=u.Node.createContinueStatement(t,e.range());return e.skip(c.Token.SEMICOLON),r},t.prototype.parseDoStatement=function(e){var t=e.tokenPos,r=this.parseStatement(e);if(!r)return null;if(e.skip(c.Token.WHILE))if(e.skip(c.Token.OPENPAREN)){var n=this.parseExpression(e);if(!n)return null;if(e.skip(c.Token.CLOSEPAREN)){var i=u.Node.createDoStatement(r,n,e.range(t,e.pos));return e.skip(c.Token.SEMICOLON),i}this.error(p.DiagnosticCode._0_expected,e.range(),")")}else this.error(p.DiagnosticCode._0_expected,e.range(),"(");else this.error(p.DiagnosticCode._0_expected,e.range(),"while");return null},t.prototype.parseExpressionStatement=function(e){var t=this.parseExpression(e);if(!t)return null;var r=u.Node.createExpressionStatement(t);return e.skip(c.Token.SEMICOLON),r},t.prototype.parseForStatement=function(e){var t=e.tokenPos;if(e.skip(c.Token.OPENPAREN)){var r=null;if(e.skip(c.Token.LET)||e.skip(c.Token.CONST)||e.skip(c.Token.VAR))r=this.parseVariable(e,null,null);else if(!e.skip(c.Token.SEMICOLON)&&!(r=this.parseExpressionStatement(e)))return null;if(e.token==c.Token.SEMICOLON){var n=null;if(!e.skip(c.Token.SEMICOLON)&&!(n=this.parseExpressionStatement(e)))return null;if(e.token==c.Token.SEMICOLON){var i=null;if(!e.skip(c.Token.CLOSEPAREN)){if(!(i=this.parseExpression(e)))return null;if(!e.skip(c.Token.CLOSEPAREN))return this.error(p.DiagnosticCode._0_expected,e.range(),")"),null}var a=this.parseStatement(e);return a?u.Node.createForStatement(r,n?n.expression:null,i,a,e.range(t,e.pos)):null}this.error(p.DiagnosticCode._0_expected,e.range(),";")}else this.error(p.DiagnosticCode._0_expected,e.range(),";")}else this.error(p.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseIfStatement=function(e){var t=e.tokenPos;if(e.skip(c.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(c.Token.CLOSEPAREN)){var n=this.parseStatement(e);if(!n)return null;var i=null;return e.skip(c.Token.ELSE)&&!(i=this.parseStatement(e))?null:u.Node.createIfStatement(r,n,i,e.range(t,e.pos))}this.error(p.DiagnosticCode._0_expected,e.range(),")")}else this.error(p.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseSwitchStatement=function(e){var t=e.tokenPos;if(e.skip(c.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(c.Token.CLOSEPAREN)){if(e.skip(c.Token.OPENBRACE)){for(var n=new Array;!e.skip(c.Token.CLOSEBRACE);){var i=this.parseSwitchCase(e);if(!i)return null;n.push(i)}var a=u.Node.createSwitchStatement(r,n,e.range(t,e.pos));return e.skip(c.Token.SEMICOLON),a}this.error(p.DiagnosticCode._0_expected,e.range(),"{")}else this.error(p.DiagnosticCode._0_expected,e.range(),")")}else this.error(p.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseSwitchCase=function(e){var t,r,n=e.tokenPos;if(e.skip(c.Token.CASE)){var i=this.parseExpression(e);if(!i)return null;if(e.skip(c.Token.COLON)){for(t=new Array;e.peek()!=c.Token.CASE&&e.nextToken!=c.Token.DEFAULT&&e.nextToken!=c.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return u.Node.createSwitchCase(i,t,e.range(n,e.pos))}this.error(p.DiagnosticCode._0_expected,e.range(),":")}else if(e.skip(c.Token.DEFAULT)){if(e.skip(c.Token.COLON)){for(t=new Array;e.peek()!=c.Token.CASE&&e.nextToken!=c.Token.DEFAULT&&e.nextToken!=c.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return u.Node.createSwitchCase(null,t,e.range(n,e.pos))}this.error(p.DiagnosticCode._0_expected,e.range(),":")}else this.error(p.DiagnosticCode._case_or_default_expected,e.range());return null},t.prototype.parseThrowStatement=function(e){var t=e.tokenPos,r=this.parseExpression(e);if(!r)return null;var n=u.Node.createThrowStatement(r,e.range(t,e.pos));return e.skip(c.Token.SEMICOLON),n},t.prototype.parseTryStatement=function(e){var t,r=e.tokenPos;if(e.skip(c.Token.OPENBRACE)){for(var n=new Array;!e.skip(c.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;n.push(t)}var i=null,a=null,s=null;if(e.skip(c.Token.CATCH)){if(!e.skip(c.Token.OPENPAREN))return this.error(p.DiagnosticCode._0_expected,e.range(),"("),null;if(!e.skip(c.Token.IDENTIFIER))return this.error(p.DiagnosticCode.Identifier_expected,e.range()),null;if(i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range()),!e.skip(c.Token.CLOSEPAREN))return this.error(p.DiagnosticCode._0_expected,e.range(),")"),null;if(!e.skip(c.Token.OPENBRACE))return this.error(p.DiagnosticCode._0_expected,e.range(),"{"),null;for(a=new Array;!e.skip(c.Token.CLOSEBRACE);){var t=this.parseStatement(e);if(!t)return null;a.push(t)}}if(e.skip(c.Token.FINALLY)){if(!e.skip(c.Token.OPENBRACE))return this.error(p.DiagnosticCode._0_expected,e.range(),"{"),null;for(s=new Array;!e.skip(c.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;s.push(t)}}if(!a&&!s)return this.error(p.DiagnosticCode._0_expected,e.range(),"catch"),null;var o=u.Node.createTryStatement(n,i,a,s,e.range(r,e.pos));return e.skip(c.Token.SEMICOLON),o}return this.error(p.DiagnosticCode._0_expected,e.range(),"{"),null},t.prototype.parseTypeDeclaration=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=r&&r.length?r[0].range.start:t&&t.length?t[0].range.start:e.tokenPos;if(e.skip(c.Token.IDENTIFIER)){var i=u.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(c.Token.EQUALS)){var a=this.parseType(e);if(!a)return null;var s=u.Node.createTypeDeclaration(i,a,t,r,e.range(n,e.pos));return e.skip(c.Token.SEMICOLON),s}this.error(p.DiagnosticCode._0_expected,e.range(),"=")}else this.error(p.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseWhileStatement=function(e){var t=e.tokenPos;if(e.skip(c.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(c.Token.CLOSEPAREN)){var n=this.parseStatement(e);if(!n)return null;var i=u.Node.createWhileStatement(r,n,e.range(t,e.pos));return e.skip(c.Token.SEMICOLON),i}this.error(p.DiagnosticCode._0_expected,e.range(),")")}else this.error(p.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseExpressionStart=function(e){var t=e.next(!0),r=e.tokenPos,i=null;if(t==c.Token.NULL)return u.Node.createNullExpression(e.range());if(t==c.Token.TRUE)return u.Node.createTrueExpression(e.range());if(t==c.Token.FALSE)return u.Node.createFalseExpression(e.range());var a=n(t);if(-1!=a){var s;return t==c.Token.NEW?(s=this.parseExpression(e,18))?s.kind==u.NodeKind.CALL?u.Node.createNewExpression(s.expression,s.typeArguments,s.arguments,e.range(r,e.pos)):(this.error(p.DiagnosticCode.Operation_not_supported,e.range()),null):null:(s=this.parseExpression(e,a))?(t!=c.Token.PLUS_PLUS&&t!=c.Token.MINUS_MINUS||s.kind!=u.NodeKind.IDENTIFIER&&s.kind!=u.NodeKind.ELEMENTACCESS&&s.kind!=u.NodeKind.PROPERTYACCESS&&this.error(p.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,s.range),u.Node.createUnaryPrefixExpression(t,s,e.range(r,e.pos))):null}switch(t){case c.Token.OPENPAREN:return i=this.parseExpression(e),i?e.skip(c.Token.CLOSEPAREN)?u.Node.createParenthesizedExpression(i,e.range(r,e.pos)):(this.error(p.DiagnosticCode._0_expected,e.range(),")"),null):null;case c.Token.OPENBRACKET:var o=new Array;if(!e.skip(c.Token.CLOSEBRACKET)){do{if(e.peek()==c.Token.COMMA||e.peek()==c.Token.CLOSEBRACKET)i=null;else if(!(i=this.parseExpression(e,1)))return null;o.push(i)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.CLOSEBRACKET))return this.error(p.DiagnosticCode._0_expected,e.range(),"]"),null}return u.Node.createArrayLiteralExpression(o,e.range(r,e.pos));case c.Token.LESSTHAN:var l=this.parseType(e);return l?e.skip(c.Token.GREATERTHAN)?(i=this.parseExpression(e,18),i?u.Node.createAssertionExpression(0,i,l,e.range(r,e.pos)):null):(this.error(p.DiagnosticCode._0_expected,e.range(),">"),null):null;case c.Token.IDENTIFIER:return u.Node.createIdentifierExpression(e.readIdentifier(),e.range(r,e.pos));case c.Token.THIS:return u.Node.createThisExpression(e.range(r,e.pos));case c.Token.CONSTRUCTOR:return u.Node.createConstructorExpression(e.range(r,e.pos));case c.Token.SUPER:return u.Node.createSuperExpression(e.range(r,e.pos));case c.Token.STRINGLITERAL:return u.Node.createStringLiteralExpression(e.readString(),e.range(r,e.pos));case c.Token.INTEGERLITERAL:return u.Node.createIntegerLiteralExpression(e.readInteger(),e.range(r,e.pos));case c.Token.FLOATLITERAL:return u.Node.createFloatLiteralExpression(e.readFloat(),e.range(r,e.pos));case c.Token.SLASH:var h=e.readRegexpPattern();return e.skip(c.Token.SLASH)?u.Node.createRegexpLiteralExpression(h,e.readRegexpFlags(),e.range(r,e.pos)):(this.error(p.DiagnosticCode._0_expected,e.range(),"/"),null);default:return this.error(p.DiagnosticCode.Expression_expected,e.range()),null}},t.prototype.tryParseTypeArgumentsBeforeArguments=function(e){if(e.mark(),!e.skip(c.Token.LESSTHAN))return null;var t=new Array;do{var r=this.parseType(e,!0,!0);if(!r)return e.reset(),null;t.push(r)}while(e.skip(c.Token.COMMA));return e.skip(c.Token.GREATERTHAN)&&e.skip(c.Token.OPENPAREN)?t:(e.reset(),null)},t.prototype.parseArguments=function(e){var t=new Array;if(!e.skip(c.Token.CLOSEPAREN)){do{var r=this.parseExpression(e,1);if(!r)return null;t.push(r)}while(e.skip(c.Token.COMMA));if(!e.skip(c.Token.CLOSEPAREN))return this.error(p.DiagnosticCode._0_expected,e.range(),")"),null}return t},t.prototype.parseExpression=function(e,t){void 0===t&&(t=0);var r=this.parseExpressionStart(e);if(!r)return null;var n=r.range.start;if(e.skip(c.Token.OPENBRACKET)){if(!(d=this.parseExpression(e)))return null;if(!e.skip(c.Token.CLOSEBRACKET))return this.error(p.DiagnosticCode._0_expected,e.range(),"]"),null;r=u.Node.createElementAccessExpression(r,d,e.range(n,e.pos))}var s=this.tryParseTypeArgumentsBeforeArguments(e);if(s||e.skip(c.Token.OPENPAREN)){var o=this.parseArguments(e);if(!o)return null;r=u.Node.createCallExpression(r,s,o,e.range(n,e.pos))}for(var l,h,d=null;(h=i(l=e.peek()))>=t;)if(e.next(),l==c.Token.AS){var y=this.parseType(e);if(!y)return null;r=u.Node.createAssertionExpression(1,r,y,e.range(n,e.pos))}else if(l==c.Token.PLUS_PLUS||l==c.Token.MINUS_MINUS)r.kind!=u.NodeKind.IDENTIFIER&&r.kind!=u.NodeKind.ELEMENTACCESS&&r.kind!=u.NodeKind.PROPERTYACCESS&&this.error(p.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,r.range),r=u.Node.createUnaryPostfixExpression(l,r,e.range(n,e.pos));else if(l==c.Token.QUESTION){var _=this.parseExpression(e);if(!_)return null;if(!e.skip(c.Token.COLON))return this.error(p.DiagnosticCode._0_expected,e.range(),":"),null;var m=this.parseExpression(e);if(!m)return null;r=u.Node.createTernaryExpression(r,_,m,e.range(n,e.pos))}else if(l==c.Token.COMMA){var f=new Array(1);f[0]=r;do{if(!(r=this.parseExpression(e,1)))return null;f.push(r)}while(e.skip(c.Token.COMMA));r=u.Node.createCommaExpression(f,e.range(n,e.pos))}else{if(!(d=this.parseExpression(e,a(l)?h:1+h)))return null;if(l==c.Token.DOT)if(d.kind==u.NodeKind.IDENTIFIER)r=u.Node.createPropertyAccessExpression(r,d,e.range(n,e.pos));else{if(d.kind!=u.NodeKind.CALL)return this.error(p.DiagnosticCode.Identifier_expected,d.range),null;var E=d;if(E.expression.kind!=u.NodeKind.IDENTIFIER)throw new Error("unexpected expression kind");E.expression=u.Node.createPropertyAccessExpression(r,E.expression,e.range(n,e.pos)),r=E}else r=u.Node.createBinaryExpression(l,r,d,e.range(n,e.pos))}return r},t}(p.DiagnosticEmitter);t.Parser=h;!function(e){e[e.COMMA=0]="COMMA",e[e.SPREAD=1]="SPREAD",e[e.YIELD=2]="YIELD",e[e.ASSIGNMENT=3]="ASSIGNMENT",e[e.CONDITIONAL=4]="CONDITIONAL",e[e.LOGICAL_OR=5]="LOGICAL_OR",e[e.LOGICAL_AND=6]="LOGICAL_AND",e[e.BITWISE_OR=7]="BITWISE_OR",e[e.BITWISE_XOR=8]="BITWISE_XOR",e[e.BITWISE_AND=9]="BITWISE_AND",e[e.EQUALITY=10]="EQUALITY",e[e.RELATIONAL=11]="RELATIONAL",e[e.SHIFT=12]="SHIFT",e[e.ADDITIVE=13]="ADDITIVE",e[e.MULTIPLICATIVE=14]="MULTIPLICATIVE",e[e.EXPONENTIATED=15]="EXPONENTIATED",e[e.UNARY_PREFIX=16]="UNARY_PREFIX",e[e.UNARY_POSTFIX=17]="UNARY_POSTFIX",e[e.CALL=18]="CALL",e[e.MEMBERACCESS=19]="MEMBERACCESS",e[e.GROUPING=20]="GROUPING",e[e.INVALID=-1]="INVALID"}(t.Precedence||(t.Precedence={}))},function(e,t,r){"use strict";function n(e){switch(e){case i.NativeType.None:return"void";case i.NativeType.I32:return"i32";case i.NativeType.I64:return"i64";case i.NativeType.F32:return"f32";case i.NativeType.F64:return"f64";case i.NativeType.Unreachable:throw new Error("unreachable type");case i.NativeType.Auto:throw new Error("auto type");default:throw new Error("unexpected type")}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(3),s=function(){function e(){this.text=[],this.functionId=0,this.tempI64=new a.I64}return e.decompile=function(t){var r=new e;return r.decompile(t),r.finish()},e.prototype.decompile=function(e){throw new Error("not implemented")},e.prototype.decompileFunction=function(e){var t=i.readString(_BinaryenFunctionGetName(e))||"$"+this.functionId.toString(10),r=_BinaryenFunctionGetBody(e);this.push("function "),this.push(t),this.push("(");for(var a=0,s=_BinaryenFunctionGetNumParams(e);a<s;++a)a>0&&this.push(", "),this.push("$"),this.push(a.toString(10)),this.push(": "),this.push(n(_BinaryenFunctionGetParam(e,a)));this.push("): "),this.push(n(_BinaryenFunctionGetResult(e))),this.push(" "),_BinaryenExpressionGetId(r)!=i.ExpressionId.Block&&this.push("{\n"),this.decompileExpression(r),_BinaryenExpressionGetId(r)!=i.ExpressionId.Block&&this.push("\n}\n"),++this.functionId},e.prototype.decompileExpression=function(e){var t,r,a,s,o=_BinaryenExpressionGetId(e),c=_BinaryenExpressionGetType(e);switch(o){case i.ExpressionId.Block:for(null!=(r=i.readString(_BinaryenBlockGetName(e)))&&(this.push(r),this.push(": ")),this.push("{\n"),s=_BinaryenBlockGetNumChildren(e),a=0;a<s;++a)this.decompileExpression(_BinaryenBlockGetChild(e,a));return void this.push("}\n");case i.ExpressionId.If:return void(c==i.NativeType.None?(this.push("if ("),this.decompileExpression(_BinaryenIfGetCondition(e)),this.push(") "),this.decompileExpression(_BinaryenIfGetIfTrue(e)),(t=_BinaryenIfGetIfFalse(e))&&(this.push(" else "),this.decompileExpression(t))):(this.decompileExpression(_BinaryenIfGetCondition(e)),this.push(" ? "),this.decompileExpression(_BinaryenIfGetIfTrue(e)),this.push(" : "),this.decompileExpression(_BinaryenIfGetIfFalse(e))));case i.ExpressionId.Loop:null!=(r=i.readString(_BinaryenLoopGetName(e)))&&(this.push(r),this.push(": ")),this.push("do "),this.decompileExpression(_BinaryenLoopGetBody(e)),this.push("while (0);\n");case i.ExpressionId.Break:return(t=_BinaryenBreakGetCondition(e))&&(this.push("if ("),this.decompileExpression(t),this.push(") ")),void(null!=(r=i.readString(_BinaryenBreakGetName(e)))?(this.push("break "),this.push(r),this.push(";\n")):this.push("break;\n"));case i.ExpressionId.Switch:case i.ExpressionId.Call:case i.ExpressionId.CallImport:case i.ExpressionId.CallIndirect:case i.ExpressionId.GetLocal:return this.push("$"),void this.push(_BinaryenGetLocalGetIndex(e).toString(10));case i.ExpressionId.SetLocal:return this.push("$"),this.push(_BinaryenSetLocalGetIndex(e).toString(10)),this.push(" = "),void this.decompileExpression(_BinaryenSetLocalGetValue(e));case i.ExpressionId.GetGlobal:case i.ExpressionId.SetGlobal:case i.ExpressionId.Load:return this.push("load<"),this.push(n(c)),this.push(">("),this.push(_BinaryenLoadGetOffset(e).toString(10)),this.push(" + "),this.decompileExpression(_BinaryenLoadGetPtr(e)),void this.push(")");case i.ExpressionId.Store:return this.push("store<"),this.push(n(c)),this.push(">("),this.push(_BinaryenStoreGetOffset(e).toString(10)),this.push(" + "),this.decompileExpression(_BinaryenStoreGetPtr(e)),this.push(", "),this.decompileExpression(_BinaryenStoreGetValue(e)),void this.push(")");case i.ExpressionId.Const:switch(c){case i.NativeType.I32:return void this.push(_BinaryenConstGetValueI32(e).toString(10));case i.NativeType.I64:return this.tempI64.lo=_BinaryenConstGetValueI64Low(e),this.tempI64.hi=_BinaryenConstGetValueI64High(e),void this.push(this.tempI64.toString());case i.NativeType.F32:return void this.push(_BinaryenConstGetValueF32(e).toString(10));case i.NativeType.F64:return void this.push(_BinaryenConstGetValueF64(e).toString(10))}break;case i.ExpressionId.Unary:switch(_BinaryenUnaryGetOp(e)){case i.UnaryOp.ClzI32:return this.push("clz<i32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.CtzI32:return this.push("ctz<i32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.PopcntI32:return this.push("popcnt<i32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.NegF32:case i.UnaryOp.NegF64:return this.push("-"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.AbsF32:return this.push("abs<f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.CeilF32:return this.push("ceil<f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.FloorF32:return this.push("floor<f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.TruncF32:return this.push("trunc<f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.NearestF32:return this.push("nearest<i32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.SqrtF32:return this.push("sqrt<f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.EqzI32:case i.UnaryOp.EqzI64:return this.push("!"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ClzI64:return this.push("clz<i64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.CtzI64:return this.push("ctz<i64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.PopcntI64:return this.push("popcnt<i64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.AbsF64:return this.push("abs<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.CeilF64:return this.push("ceil<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.FloorF64:return this.push("floor<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.TruncF64:return this.push("trunc<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.NearestF64:return this.push("nearest<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.SqrtF64:return this.push("sqrt<f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.ExtendI32:return this.push("<i64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ExtendU32:return this.push("<i64><u64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.WrapI64:case i.UnaryOp.TruncF32ToI32:return this.push("<i32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF32ToI64:return this.push("<i64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF32ToU32:return this.push("<i32><u32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF32ToU64:return this.push("<i64><u64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF64ToI32:return this.push("<i32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF64ToI64:return this.push("<i64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF64ToU32:return this.push("<i32><u32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.TruncF64ToU64:return this.push("<i64><u64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ReinterpretF32:return this.push("reinterpret<f32,i32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.ReinterpretF64:return this.push("reinterpret<f64,i64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.ConvertI32ToF32:return this.push("<f32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertI32ToF64:return this.push("<f64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertU32ToF32:return this.push("<f32><u32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertU32ToF64:return this.push("<f64><u32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertI64ToF32:return this.push("<f32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertI64ToF64:return this.push("<f64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertU64ToF32:return this.push("<f32><u64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ConvertU64ToF64:return this.push("<f64><u64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.PromoteF32:return this.push("<f64>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.DemoteF64:return this.push("<f32>"),void this.decompileExpression(_BinaryenUnaryGetValue(e));case i.UnaryOp.ReinterpretI32:return this.push("reinterpret<i32,f32>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")");case i.UnaryOp.ReinterpretI64:return this.push("reinterpret<i64,f64>("),this.decompileExpression(_BinaryenUnaryGetValue(e)),void this.push(")")}break;case i.ExpressionId.Binary:switch(_BinaryenBinaryGetOp(e)){case i.BinaryOp.AddI32:case i.BinaryOp.AddI64:case i.BinaryOp.AddF32:case i.BinaryOp.AddF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" + "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.SubI32:case i.BinaryOp.SubI64:case i.BinaryOp.SubF32:case i.BinaryOp.SubF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" - "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.MulI32:case i.BinaryOp.MulI64:case i.BinaryOp.MulF32:case i.BinaryOp.MulF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" * "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.DivI32:case i.BinaryOp.DivI64:case i.BinaryOp.DivF32:case i.BinaryOp.DivF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" / "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.DivU32:return this.push("<i32>(<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" / <u32>"),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.RemI32:case i.BinaryOp.RemI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" % "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.RemU32:return this.push("<i32>(<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" / <u32>"),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.AndI32:case i.BinaryOp.AndI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" & "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.OrI32:case i.BinaryOp.OrI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" | "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.XorI32:case i.BinaryOp.XorI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" ^ "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.ShlI32:case i.BinaryOp.ShlI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" << "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.ShrU32:case i.BinaryOp.ShrU64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" >>> "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.ShrI32:case i.BinaryOp.ShrI64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" >> "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.RotlI32:return this.push("rotl<i32>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.RotrI32:return this.push("rotr<i32>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.EqI32:case i.BinaryOp.EqI64:case i.BinaryOp.EqF32:case i.BinaryOp.EqF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" == "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.NeI32:case i.BinaryOp.NeI64:case i.BinaryOp.NeF32:case i.BinaryOp.NeF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" != "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.LtI32:case i.BinaryOp.LtI64:case i.BinaryOp.LtF32:case i.BinaryOp.LtF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" < "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.LtU32:return this.push("<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" < <u32>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.LeI32:case i.BinaryOp.LeI64:case i.BinaryOp.LeF32:case i.BinaryOp.LeF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" <= "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.LeU32:return this.push("<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" <= <u32>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GtI32:case i.BinaryOp.GtI64:case i.BinaryOp.GtF32:case i.BinaryOp.GtF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" > "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GtU32:return this.push("<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" > <u32>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GeI32:case i.BinaryOp.GeI64:case i.BinaryOp.GeF32:case i.BinaryOp.GeF64:return this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" >= "),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GeU32:return this.push("<u32>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" >= <u32>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.DivU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" / <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.RemU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" % <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.RotlI64:return this.push("rotl<i64>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.RotrI64:return this.push("rotr<i64>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.LtU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" < <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.LeU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" <= <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GtU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" > <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.GeU64:return this.push("<u64>"),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(" >= <u64>"),void this.decompileExpression(_BinaryenBinaryGetRight(e));case i.BinaryOp.CopysignF32:return this.push("copysign<f32>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.MinF32:return this.push("min<f32>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.MaxF32:return this.push("max<f32>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.CopysignF64:return this.push("copysign<f64>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.MinF64:return this.push("min<f64>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")");case i.BinaryOp.MaxF64:return this.push("max<f64>("),this.decompileExpression(_BinaryenBinaryGetLeft(e)),this.push(", "),this.decompileExpression(_BinaryenBinaryGetRight(e)),void this.push(")")}return;case i.ExpressionId.Select:return this.push("select<"),this.push(n(c)),this.push(">("),this.decompileExpression(_BinaryenSelectGetIfTrue(e)),this.push(", "),this.decompileExpression(_BinaryenSelectGetIfFalse(e)),this.push(", "),this.decompileExpression(_BinaryenSelectGetCondition(e)),void this.push(")");case i.ExpressionId.Drop:return this.decompileExpression(_BinaryenDropGetValue(e)),void this.push(";\n");case i.ExpressionId.Return:return void((t=_BinaryenReturnGetValue(e))?(this.push("return "),this.decompileExpression(t),this.push(";\n")):this.push("return;\n"));case i.ExpressionId.Host:switch(_BinaryenHostGetOp(e)){case i.HostOp.CurrentMemory:return void this.push("current_memory()");case i.HostOp.GrowMemory:return this.push("grow_memory("),this.decompileExpression(_BinaryenHostGetOperand(e,0)),void this.push(")")}break;case i.ExpressionId.Nop:return void this.push(";\n");case i.ExpressionId.Unreachable:return void this.push("unreachable()");case i.ExpressionId.AtomicCmpxchg:case i.ExpressionId.AtomicRMW:case i.ExpressionId.AtomicWait:case i.ExpressionId.AtomicWake:}throw new Error("not implemented")},e.prototype.push=function(e){this.text.push(e)},e.prototype.finish=function(){var e=this.text.join("");return this.text=[],e},e}();t.Decompiler=s}])});
//# sourceMappingURL=assemblyscript.js.map