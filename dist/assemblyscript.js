!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("binaryen")):"function"==typeof define&&define.amd?define(["binaryen"],t):"object"==typeof exports?exports.assemblyscript=t(require("binaryen")):e.assemblyscript=t(e.binaryen)}("undefined"!=typeof self?self:this,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=29)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.IMPORT=1]="IMPORT",e[e.EXPORT=2]="EXPORT",e[e.DECLARE=4]="DECLARE",e[e.CONST=8]="CONST",e[e.LET=16]="LET",e[e.STATIC=32]="STATIC",e[e.READONLY=64]="READONLY",e[e.ABSTRACT=128]="ABSTRACT",e[e.PUBLIC=256]="PUBLIC",e[e.PRIVATE=512]="PRIVATE",e[e.PROTECTED=1024]="PROTECTED",e[e.GET=2048]="GET",e[e.SET=4096]="SET",e[e.AMBIENT=8192]="AMBIENT",e[e.GENERIC=16384]="GENERIC",e[e.GENERIC_CONTEXT=32768]="GENERIC_CONTEXT",e[e.INSTANCE=65536]="INSTANCE",e[e.CONSTRUCTOR=131072]="CONSTRUCTOR",e[e.ARROW=262144]="ARROW",e[e.MODULE_EXPORT=524288]="MODULE_EXPORT",e[e.MODULE_IMPORT=1048576]="MODULE_IMPORT",e[e.BUILTIN=2097152]="BUILTIN",e[e.COMPILED=4194304]="COMPILED",e[e.INLINED=8388608]="INLINED",e[e.SCOPED=16777216]="SCOPED",e[e.TRAMPOLINE=33554432]="TRAMPOLINE",e[e.VIRTUAL=67108864]="VIRTUAL",e[e.MAIN=134217728]="MAIN"}(t.CommonFlags||(t.CommonFlags={})),t.PATH_DELIMITER="/",t.PARENT_SUBST="..",t.GETTER_PREFIX="get:",t.SETTER_PREFIX="set:",t.INSTANCE_DELIMITER="#",t.STATIC_DELIMITER=".",t.INNER_DELIMITER="~",t.LIBRARY_SUBST="~lib",t.LIBRARY_PREFIX=t.LIBRARY_SUBST+t.PATH_DELIMITER,t.FILESPACE_PREFIX="file:"},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(21)),n(r(20)),n(r(19)),n(r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(9),a=r(1),s=r(9);function o(e){switch(e){case n.INFO:return"INFO";case n.WARNING:return"WARNING";case n.ERROR:return"ERROR";default:return assert(!1),""}}function c(e){switch(e){case n.INFO:return t.COLOR_BLUE;case n.WARNING:return t.COLOR_YELLOW;case n.ERROR:return t.COLOR_RED;default:return assert(!1),""}}t.DiagnosticCode=s.DiagnosticCode,t.diagnosticCodeToString=s.diagnosticCodeToString,function(e){e[e.INFO=0]="INFO",e[e.WARNING=1]="WARNING",e[e.ERROR=2]="ERROR"}(n=t.DiagnosticCategory||(t.DiagnosticCategory={})),t.diagnosticCategoryToString=o,t.COLOR_BLUE="[96m",t.COLOR_YELLOW="[93m",t.COLOR_RED="[91m",t.COLOR_RESET="[0m",t.diagnosticCategoryToColor=c;var p=function(){function e(e,t,r){this.range=null,this.code=e,this.category=t,this.message=r}return e.create=function(t,r,n,a,s){void 0===n&&(n=null),void 0===a&&(a=null),void 0===s&&(s=null);var o=i.diagnosticCodeToString(t);return null!=n&&(o=o.replace("{0}",n)),null!=a&&(o=o.replace("{1}",a)),null!=s&&(o=o.replace("{2}",s)),new e(t,r,o)},e.createInfo=function(t,r,i){return void 0===r&&(r=null),void 0===i&&(i=null),e.create(t,n.INFO,r,i)},e.createWarning=function(t,r,i){return void 0===r&&(r=null),void 0===i&&(i=null),e.create(t,n.WARNING,r,i)},e.createError=function(t,r,i){return void 0===r&&(r=null),void 0===i&&(i=null),e.create(t,n.ERROR,r,i)},e.prototype.withRange=function(e){return this.range=e,this},e.prototype.toString=function(){return this.range?o(this.category)+" "+this.code.toString(10)+': "'+this.message+'" in '+this.range.source.normalizedPath+":"+this.range.line.toString(10)+":"+this.range.column.toString(10):o(this.category)+" "+this.code.toString(10)+": "+this.message},e}();function l(e,r){void 0===r&&(r=!1);for(var n=e.source.text,i=n.length,s=e.start,o=e.end;s>0&&!a.isLineBreak(n.charCodeAt(s-1));)s--;for(;o<i&&!a.isLineBreak(n.charCodeAt(o));)o++;for(var c=["\n ",n.substring(s,o),"\n "];s<e.start;)c.push(" "),s++;if(r&&c.push(t.COLOR_RED),e.start==e.end)c.push("^");else for(;s++<e.end;)c.push("~");return r&&c.push(t.COLOR_RESET),c.join("")}t.DiagnosticMessage=p,t.formatDiagnosticMessage=function(e,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var i=[];if(r&&i.push(c(e.category)),i.push(o(e.category)),r&&i.push(t.COLOR_RESET),i.push(e.code<1e3?" AS":" TS"),i.push(e.code.toString(10)),i.push(": "),i.push(e.message),e.range){var a=e.range;n&&(i.push("\n"),i.push(l(e.range,r))),i.push("\n"),i.push(" in "),i.push(a.source.normalizedPath),i.push("("),i.push(a.line.toString(10)),i.push(","),i.push(a.column.toString(10)),i.push(")")}return i.join("")},t.formatDiagnosticContext=l;var u=function(){function e(e){void 0===e&&(e=null),this.diagnostics=e||new Array}return e.prototype.emitDiagnostic=function(e,t,r,n,i,a){void 0===n&&(n=null),void 0===i&&(i=null),void 0===a&&(a=null);var s=p.create(e,t,n,i,a).withRange(r);this.diagnostics.push(s)},e.prototype.info=function(e,t,r,i,a){void 0===r&&(r=null),void 0===i&&(i=null),void 0===a&&(a=null),this.emitDiagnostic(e,n.INFO,t,r,i,a)},e.prototype.warning=function(e,t,r,i,a){void 0===r&&(r=null),void 0===i&&(i=null),void 0===a&&(a=null),this.emitDiagnostic(e,n.WARNING,t,r,i,a)},e.prototype.error=function(e,t,r,i,a){void 0===r&&(r=null),void 0===i&&(i=null),void 0===a&&(a=null),this.emitDiagnostic(e,n.ERROR,t,r,i,a)},e}();t.DiagnosticEmitter=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,a=r(10);!function(e){e[e.None=_BinaryenTypeNone()]="None",e[e.I32=_BinaryenTypeInt32()]="I32",e[e.I64=_BinaryenTypeInt64()]="I64",e[e.F32=_BinaryenTypeFloat32()]="F32",e[e.F64=_BinaryenTypeFloat64()]="F64",e[e.Unreachable=_BinaryenTypeUnreachable()]="Unreachable",e[e.Auto=_BinaryenTypeAuto()]="Auto"}(n=t.NativeType||(t.NativeType={})),function(e){e[e.Invalid=_BinaryenInvalidId()]="Invalid",e[e.Block=_BinaryenBlockId()]="Block",e[e.If=_BinaryenIfId()]="If",e[e.Loop=_BinaryenLoopId()]="Loop",e[e.Break=_BinaryenBreakId()]="Break",e[e.Switch=_BinaryenSwitchId()]="Switch",e[e.Call=_BinaryenCallId()]="Call",e[e.CallImport=_BinaryenCallImportId()]="CallImport",e[e.CallIndirect=_BinaryenCallIndirectId()]="CallIndirect",e[e.GetLocal=_BinaryenGetLocalId()]="GetLocal",e[e.SetLocal=_BinaryenSetLocalId()]="SetLocal",e[e.GetGlobal=_BinaryenGetGlobalId()]="GetGlobal",e[e.SetGlobal=_BinaryenSetGlobalId()]="SetGlobal",e[e.Load=_BinaryenLoadId()]="Load",e[e.Store=_BinaryenStoreId()]="Store",e[e.Const=_BinaryenConstId()]="Const",e[e.Unary=_BinaryenUnaryId()]="Unary",e[e.Binary=_BinaryenBinaryId()]="Binary",e[e.Select=_BinaryenSelectId()]="Select",e[e.Drop=_BinaryenDropId()]="Drop",e[e.Return=_BinaryenReturnId()]="Return",e[e.Host=_BinaryenHostId()]="Host",e[e.Nop=_BinaryenNopId()]="Nop",e[e.Unreachable=_BinaryenUnreachableId()]="Unreachable",e[e.AtomicCmpxchg=_BinaryenAtomicCmpxchgId()]="AtomicCmpxchg",e[e.AtomicRMW=_BinaryenAtomicRMWId()]="AtomicRMW",e[e.AtomicWait=_BinaryenAtomicWaitId()]="AtomicWait",e[e.AtomicWake=_BinaryenAtomicWakeId()]="AtomicWake"}(i=t.ExpressionId||(t.ExpressionId={})),function(e){e[e.ClzI32=_BinaryenClzInt32()]="ClzI32",e[e.CtzI32=_BinaryenCtzInt32()]="CtzI32",e[e.PopcntI32=_BinaryenPopcntInt32()]="PopcntI32",e[e.NegF32=_BinaryenNegFloat32()]="NegF32",e[e.AbsF32=_BinaryenAbsFloat32()]="AbsF32",e[e.CeilF32=_BinaryenCeilFloat32()]="CeilF32",e[e.FloorF32=_BinaryenFloorFloat32()]="FloorF32",e[e.TruncF32=_BinaryenTruncFloat32()]="TruncF32",e[e.NearestF32=_BinaryenNearestFloat32()]="NearestF32",e[e.SqrtF32=_BinaryenSqrtFloat32()]="SqrtF32",e[e.EqzI32=_BinaryenEqZInt32()]="EqzI32",e[e.ClzI64=_BinaryenClzInt64()]="ClzI64",e[e.CtzI64=_BinaryenCtzInt64()]="CtzI64",e[e.PopcntI64=_BinaryenPopcntInt64()]="PopcntI64",e[e.NegF64=_BinaryenNegFloat64()]="NegF64",e[e.AbsF64=_BinaryenAbsFloat64()]="AbsF64",e[e.CeilF64=_BinaryenCeilFloat64()]="CeilF64",e[e.FloorF64=_BinaryenFloorFloat64()]="FloorF64",e[e.TruncF64=_BinaryenTruncFloat64()]="TruncF64",e[e.NearestF64=_BinaryenNearestFloat64()]="NearestF64",e[e.SqrtF64=_BinaryenSqrtFloat64()]="SqrtF64",e[e.EqzI64=_BinaryenEqZInt64()]="EqzI64",e[e.ExtendI32=_BinaryenExtendSInt32()]="ExtendI32",e[e.ExtendU32=_BinaryenExtendUInt32()]="ExtendU32",e[e.WrapI64=_BinaryenWrapInt64()]="WrapI64",e[e.TruncF32ToI32=_BinaryenTruncSFloat32ToInt32()]="TruncF32ToI32",e[e.TruncF32ToI64=_BinaryenTruncSFloat32ToInt64()]="TruncF32ToI64",e[e.TruncF32ToU32=_BinaryenTruncUFloat32ToInt32()]="TruncF32ToU32",e[e.TruncF32ToU64=_BinaryenTruncUFloat32ToInt64()]="TruncF32ToU64",e[e.TruncF64ToI32=_BinaryenTruncSFloat64ToInt32()]="TruncF64ToI32",e[e.TruncF64ToI64=_BinaryenTruncSFloat64ToInt64()]="TruncF64ToI64",e[e.TruncF64ToU32=_BinaryenTruncUFloat64ToInt32()]="TruncF64ToU32",e[e.TruncF64ToU64=_BinaryenTruncUFloat64ToInt64()]="TruncF64ToU64",e[e.ReinterpretF32=_BinaryenReinterpretFloat32()]="ReinterpretF32",e[e.ReinterpretF64=_BinaryenReinterpretFloat64()]="ReinterpretF64",e[e.ConvertI32ToF32=_BinaryenConvertSInt32ToFloat32()]="ConvertI32ToF32",e[e.ConvertI32ToF64=_BinaryenConvertSInt32ToFloat64()]="ConvertI32ToF64",e[e.ConvertU32ToF32=_BinaryenConvertUInt32ToFloat32()]="ConvertU32ToF32",e[e.ConvertU32ToF64=_BinaryenConvertUInt32ToFloat64()]="ConvertU32ToF64",e[e.ConvertI64ToF32=_BinaryenConvertSInt64ToFloat32()]="ConvertI64ToF32",e[e.ConvertI64ToF64=_BinaryenConvertSInt64ToFloat64()]="ConvertI64ToF64",e[e.ConvertU64ToF32=_BinaryenConvertUInt64ToFloat32()]="ConvertU64ToF32",e[e.ConvertU64ToF64=_BinaryenConvertUInt64ToFloat64()]="ConvertU64ToF64",e[e.PromoteF32=_BinaryenPromoteFloat32()]="PromoteF32",e[e.DemoteF64=_BinaryenDemoteFloat64()]="DemoteF64",e[e.ReinterpretI32=_BinaryenReinterpretInt32()]="ReinterpretI32",e[e.ReinterpretI64=_BinaryenReinterpretInt64()]="ReinterpretI64",e[e.ExtendI8ToI32=_BinaryenExtendS8Int32()]="ExtendI8ToI32",e[e.ExtendI16ToI32=_BinaryenExtendS16Int32()]="ExtendI16ToI32",e[e.ExtendI8ToI64=_BinaryenExtendS8Int64()]="ExtendI8ToI64",e[e.ExtendI16ToI64=_BinaryenExtendS16Int64()]="ExtendI16ToI64",e[e.ExtendI32ToI64=_BinaryenExtendS32Int64()]="ExtendI32ToI64"}(t.UnaryOp||(t.UnaryOp={})),function(e){e[e.AddI32=_BinaryenAddInt32()]="AddI32",e[e.SubI32=_BinaryenSubInt32()]="SubI32",e[e.MulI32=_BinaryenMulInt32()]="MulI32",e[e.DivI32=_BinaryenDivSInt32()]="DivI32",e[e.DivU32=_BinaryenDivUInt32()]="DivU32",e[e.RemI32=_BinaryenRemSInt32()]="RemI32",e[e.RemU32=_BinaryenRemUInt32()]="RemU32",e[e.AndI32=_BinaryenAndInt32()]="AndI32",e[e.OrI32=_BinaryenOrInt32()]="OrI32",e[e.XorI32=_BinaryenXorInt32()]="XorI32",e[e.ShlI32=_BinaryenShlInt32()]="ShlI32",e[e.ShrU32=_BinaryenShrUInt32()]="ShrU32",e[e.ShrI32=_BinaryenShrSInt32()]="ShrI32",e[e.RotlI32=_BinaryenRotLInt32()]="RotlI32",e[e.RotrI32=_BinaryenRotRInt32()]="RotrI32",e[e.EqI32=_BinaryenEqInt32()]="EqI32",e[e.NeI32=_BinaryenNeInt32()]="NeI32",e[e.LtI32=_BinaryenLtSInt32()]="LtI32",e[e.LtU32=_BinaryenLtUInt32()]="LtU32",e[e.LeI32=_BinaryenLeSInt32()]="LeI32",e[e.LeU32=_BinaryenLeUInt32()]="LeU32",e[e.GtI32=_BinaryenGtSInt32()]="GtI32",e[e.GtU32=_BinaryenGtUInt32()]="GtU32",e[e.GeI32=_BinaryenGeSInt32()]="GeI32",e[e.GeU32=_BinaryenGeUInt32()]="GeU32",e[e.AddI64=_BinaryenAddInt64()]="AddI64",e[e.SubI64=_BinaryenSubInt64()]="SubI64",e[e.MulI64=_BinaryenMulInt64()]="MulI64",e[e.DivI64=_BinaryenDivSInt64()]="DivI64",e[e.DivU64=_BinaryenDivUInt64()]="DivU64",e[e.RemI64=_BinaryenRemSInt64()]="RemI64",e[e.RemU64=_BinaryenRemUInt64()]="RemU64",e[e.AndI64=_BinaryenAndInt64()]="AndI64",e[e.OrI64=_BinaryenOrInt64()]="OrI64",e[e.XorI64=_BinaryenXorInt64()]="XorI64",e[e.ShlI64=_BinaryenShlInt64()]="ShlI64",e[e.ShrU64=_BinaryenShrUInt64()]="ShrU64",e[e.ShrI64=_BinaryenShrSInt64()]="ShrI64",e[e.RotlI64=_BinaryenRotLInt64()]="RotlI64",e[e.RotrI64=_BinaryenRotRInt64()]="RotrI64",e[e.EqI64=_BinaryenEqInt64()]="EqI64",e[e.NeI64=_BinaryenNeInt64()]="NeI64",e[e.LtI64=_BinaryenLtSInt64()]="LtI64",e[e.LtU64=_BinaryenLtUInt64()]="LtU64",e[e.LeI64=_BinaryenLeSInt64()]="LeI64",e[e.LeU64=_BinaryenLeUInt64()]="LeU64",e[e.GtI64=_BinaryenGtSInt64()]="GtI64",e[e.GtU64=_BinaryenGtUInt64()]="GtU64",e[e.GeI64=_BinaryenGeSInt64()]="GeI64",e[e.GeU64=_BinaryenGeUInt64()]="GeU64",e[e.AddF32=_BinaryenAddFloat32()]="AddF32",e[e.SubF32=_BinaryenSubFloat32()]="SubF32",e[e.MulF32=_BinaryenMulFloat32()]="MulF32",e[e.DivF32=_BinaryenDivFloat32()]="DivF32",e[e.CopysignF32=_BinaryenCopySignFloat32()]="CopysignF32",e[e.MinF32=_BinaryenMinFloat32()]="MinF32",e[e.MaxF32=_BinaryenMaxFloat32()]="MaxF32",e[e.EqF32=_BinaryenEqFloat32()]="EqF32",e[e.NeF32=_BinaryenNeFloat32()]="NeF32",e[e.LtF32=_BinaryenLtFloat32()]="LtF32",e[e.LeF32=_BinaryenLeFloat32()]="LeF32",e[e.GtF32=_BinaryenGtFloat32()]="GtF32",e[e.GeF32=_BinaryenGeFloat32()]="GeF32",e[e.AddF64=_BinaryenAddFloat64()]="AddF64",e[e.SubF64=_BinaryenSubFloat64()]="SubF64",e[e.MulF64=_BinaryenMulFloat64()]="MulF64",e[e.DivF64=_BinaryenDivFloat64()]="DivF64",e[e.CopysignF64=_BinaryenCopySignFloat64()]="CopysignF64",e[e.MinF64=_BinaryenMinFloat64()]="MinF64",e[e.MaxF64=_BinaryenMaxFloat64()]="MaxF64",e[e.EqF64=_BinaryenEqFloat64()]="EqF64",e[e.NeF64=_BinaryenNeFloat64()]="NeF64",e[e.LtF64=_BinaryenLtFloat64()]="LtF64",e[e.LeF64=_BinaryenLeFloat64()]="LeF64",e[e.GtF64=_BinaryenGtFloat64()]="GtF64",e[e.GeF64=_BinaryenGeFloat64()]="GeF64"}(t.BinaryOp||(t.BinaryOp={})),function(e){e[e.PageSize=_BinaryenPageSize()]="PageSize",e[e.CurrentMemory=_BinaryenCurrentMemory()]="CurrentMemory",e[e.GrowMemory=_BinaryenGrowMemory()]="GrowMemory",e[e.HasFeature=_BinaryenHasFeature()]="HasFeature"}(t.HostOp||(t.HostOp={})),function(e){e[e.Add=_BinaryenAtomicRMWAdd()]="Add",e[e.Sub=_BinaryenAtomicRMWSub()]="Sub",e[e.And=_BinaryenAtomicRMWAnd()]="And",e[e.Or=_BinaryenAtomicRMWOr()]="Or",e[e.Xor=_BinaryenAtomicRMWXor()]="Xor",e[e.Xchg=_BinaryenAtomicRMWXchg()]="Xchg"}(t.AtomicRMWOp||(t.AtomicRMWOp={}));var s=function(){function e(){}return e.create=function(t,r){var n=new e;return n.buffer=t,n.offset=r,n},e}();t.MemorySegment=s;var o=function(){function e(){this.cachedTemporaryName=0,this.hasTemporaryFunction=!1,this.cachedPrecomputeName=0,this.cachedPrecomputeNames=0}return e.create=function(){var t=new e;return t.ref=_BinaryenModuleCreate(),t.cachedByValue=allocate_memory(16),t},e.createFrom=function(t){var r=p(t);try{var n=new e;return n.ref=_BinaryenModuleRead(r,t.length),n.cachedByValue=allocate_memory(24),n}finally{free_memory(changetype(r))}},e.prototype.addFunctionType=function(e,t,r){var n=h(e),i=l(r);try{return _BinaryenAddFunctionType(this.ref,n,t,i,r?r.length:0)}finally{free_memory(i),free_memory(n)}},e.prototype.getFunctionTypeBySignature=function(e,t){var r=l(t);try{return _BinaryenGetFunctionTypeBySignature(this.ref,e,r,t?t.length:0)}finally{free_memory(r)}},e.prototype.removeFunctionType=function(e){var t=h(e);try{_BinaryenRemoveFunctionType(this.ref,t)}finally{free_memory(t)}},e.prototype.createI32=function(e){var t=this.cachedByValue;return _BinaryenLiteralInt32(t,e),_BinaryenConst(this.ref,t)},e.prototype.createI64=function(e,t){void 0===t&&(t=0);var r=this.cachedByValue;return _BinaryenLiteralInt64(r,e,t),_BinaryenConst(this.ref,r)},e.prototype.createF32=function(e){var t=this.cachedByValue;return _BinaryenLiteralFloat32(t,e),_BinaryenConst(this.ref,t)},e.prototype.createF64=function(e){var t=this.cachedByValue;return _BinaryenLiteralFloat64(t,e),_BinaryenConst(this.ref,t)},e.prototype.createUnary=function(e,t){return _BinaryenUnary(this.ref,e,t)},e.prototype.createBinary=function(e,t,r){return _BinaryenBinary(this.ref,e,t,r)},e.prototype.createHost=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=h(t),i=u(r);try{return _BinaryenHost(this.ref,e,n,i,r?r.length:0)}finally{free_memory(i),free_memory(n)}},e.prototype.createGetLocal=function(e,t){return _BinaryenGetLocal(this.ref,e,t)},e.prototype.createTeeLocal=function(e,t){return _BinaryenTeeLocal(this.ref,e,t)},e.prototype.createGetGlobal=function(e,t){var r=h(e);try{return _BinaryenGetGlobal(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createLoad=function(e,t,r,n,i){return void 0===i&&(i=0),_BinaryenLoad(this.ref,e,t?1:0,i,e,n,r)},e.prototype.createStore=function(e,t,r,n,i){return void 0===i&&(i=0),_BinaryenStore(this.ref,e,i,e,t,r,n)},e.prototype.createAtomicLoad=function(e,t,r,n){return void 0===n&&(n=0),_BinaryenAtomicLoad(this.ref,e,n,r,t)},e.prototype.createAtomicStore=function(e,t,r,n,i){return void 0===i&&(i=0),_BinaryenAtomicStore(this.ref,e,i,t,r,n)},e.prototype.createAtomicRMW=function(e,t,r,n,i,a){return _BinaryenAtomicRMW(this.ref,e,t,r,n,i,a)},e.prototype.createAtomicCmpxchg=function(e,t,r,n,i,a){return _BinaryenAtomicCmpxchg(this.ref,e,t,r,n,i,a)},e.prototype.createAtomicWait=function(e,t,r,n){return _BinaryenAtomicWait(this.ref,e,t,r,n)},e.prototype.createAtomicWake=function(e,t){return _BinaryenAtomicWake(this.ref,e,t)},e.prototype.createSetLocal=function(e,t){return _BinaryenSetLocal(this.ref,e,t)},e.prototype.createSetGlobal=function(e,t){var r=h(e);try{return _BinaryenSetGlobal(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createBlock=function(e,t,r){void 0===r&&(r=n.None);var i=h(e),a=u(t);try{return _BinaryenBlock(this.ref,i,a,t.length,r)}finally{free_memory(a),free_memory(i)}},e.prototype.createBreak=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);var n=h(e);try{return _BinaryenBreak(this.ref,n,t,r)}finally{free_memory(n)}},e.prototype.createDrop=function(e){return _BinaryenDrop(this.ref,e)},e.prototype.createLoop=function(e,t){var r=h(e);try{return _BinaryenLoop(this.ref,r,t)}finally{free_memory(r)}},e.prototype.createIf=function(e,t,r){return void 0===r&&(r=0),_BinaryenIf(this.ref,e,t,r)},e.prototype.createNop=function(){return _BinaryenNop(this.ref)},e.prototype.createReturn=function(e){return void 0===e&&(e=0),_BinaryenReturn(this.ref,e)},e.prototype.createSelect=function(e,t,r){return _BinaryenSelect(this.ref,r,e,t)},e.prototype.createSwitch=function(e,t,r,n){void 0===n&&(n=0);for(var i=e.length,a=new Array(i),s=0;s<i;++s)a[s]=h(e[s]);var o=l(a),c=h(t);try{return _BinaryenSwitch(this.ref,o,i,c,r,n)}finally{free_memory(c),free_memory(o);for(s=i-1;s>=0;--s)free_memory(a[s])}},e.prototype.createCall=function(e,t,r){var n=h(e),i=u(t);try{return _BinaryenCall(this.ref,n,i,t&&t.length||0,r)}finally{free_memory(i),free_memory(n)}},e.prototype.createCallImport=function(e,t,r){var n=h(e),i=u(t);try{return _BinaryenCallImport(this.ref,n,i,t&&t.length||0,r)}finally{free_memory(i),free_memory(n)}},e.prototype.createCallIndirect=function(e,t,r){var n=u(t),i=h(r);try{return _BinaryenCallIndirect(this.ref,e,n,t&&t.length||0,i)}finally{free_memory(i),free_memory(n)}},e.prototype.createUnreachable=function(){return _BinaryenUnreachable(this.ref)},e.prototype.addGlobal=function(e,t,r,n){var i=h(e);try{return _BinaryenAddGlobal(this.ref,i,t,r?1:0,n)}finally{free_memory(i)}},e.prototype.addFunction=function(e,t,r,n){var i=h(e),a=l(r);try{return _BinaryenAddFunction(this.ref,i,t,a,r?r.length:0,n)}finally{free_memory(a),free_memory(i)}},e.prototype.removeFunction=function(e){var t=h(e);try{_BinaryenRemoveFunction(this.ref,t)}finally{free_memory(t)}},e.prototype.addTemporaryFunction=function(e,t,r){this.hasTemporaryFunction=assert(!this.hasTemporaryFunction);var n=this.cachedTemporaryName;n||(this.cachedTemporaryName=n=h(""));var i=l(t);try{var a=_BinaryenAddFunctionType(this.ref,n,e,i,t?t.length:0);return _BinaryenAddFunction(this.ref,n,a,0,0,r)}finally{free_memory(i)}},e.prototype.removeTemporaryFunction=function(){this.hasTemporaryFunction=!assert(this.hasTemporaryFunction);var e=assert(this.cachedTemporaryName);_BinaryenRemoveFunction(this.ref,e),_BinaryenRemoveFunctionType(this.ref,e)},e.prototype.addFunctionExport=function(e,t){var r=h(e),n=h(t);try{return _BinaryenAddFunctionExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addTableExport=function(e,t){var r=h(e),n=h(t);try{return _BinaryenAddTableExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addMemoryExport=function(e,t){var r=h(e),n=h(t);try{return _BinaryenAddMemoryExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.addGlobalExport=function(e,t){var r=h(e),n=h(t);try{return _BinaryenAddGlobalExport(this.ref,r,n)}finally{free_memory(n),free_memory(r)}},e.prototype.removeExport=function(e){var t=h(e);try{_BinaryenRemoveExport(this.ref,t)}finally{free_memory(t)}},e.prototype.addFunctionImport=function(e,t,r,n){var i=h(e),a=h(t),s=h(r);try{return _BinaryenAddFunctionImport(this.ref,i,a,s,n)}finally{free_memory(s),free_memory(a),free_memory(i)}},e.prototype.addTableImport=function(e,t,r){var n=h(e),i=h(t),a=h(r);try{return _BinaryenAddTableImport(this.ref,n,i,a)}finally{free_memory(a),free_memory(i),free_memory(n)}},e.prototype.addMemoryImport=function(e,t,r){var n=h(e),i=h(t),a=h(r);try{return _BinaryenAddMemoryImport(this.ref,n,i,a)}finally{free_memory(a),free_memory(i),free_memory(n)}},e.prototype.addGlobalImport=function(e,t,r,n){var i=h(e),a=h(t),s=h(r);try{return _BinaryenAddGlobalImport(this.ref,i,a,s,n)}finally{free_memory(s),free_memory(a),free_memory(i)}},e.prototype.removeImport=function(e){var t=h(e);try{_BinaryenRemoveImport(this.ref,t)}finally{free_memory(t)}},e.prototype.setMemory=function(e,t,r,n,i){void 0===i&&(i=null);for(var s=h(i),o=r.length,c=new Array(o),u=new Array(o),d=new Array(o),_=0;_<o;++_){var m=r[_].buffer,y=r[_].offset;c[_]=p(m),u[_]=n==a.Target.WASM64?this.createI64(i64_low(y),i64_high(y)):this.createI32(i64_low(y)),d[_]=m.length}var g=l(c),T=l(u),E=l(d);try{_BinaryenSetMemory(this.ref,e,t,s,g,T,E,o)}finally{free_memory(E),free_memory(T),free_memory(g);for(_=o-1;_>=0;--_)free_memory(c[_]);free_memory(s)}},e.prototype.setFunctionTable=function(e){var t=u(e);try{_BinaryenSetFunctionTable(this.ref,t,e.length)}finally{free_memory(t)}},e.prototype.setStart=function(e){_BinaryenSetStart(this.ref,e)},e.prototype.setOptimizeLevel=function(e){void 0===e&&(e=2),_BinaryenSetOptimizeLevel(e)},e.prototype.setShrinkLevel=function(e){void 0===e&&(e=1),_BinaryenSetShrinkLevel(e)},e.prototype.setDebugInfo=function(e){void 0===e&&(e=!1),_BinaryenSetDebugInfo(e)},e.prototype.optimize=function(e){void 0===e&&(e=0),e?_BinaryenFunctionOptimize(e,this.ref):_BinaryenModuleOptimize(this.ref)},e.prototype.runPasses=function(e,t){void 0===t&&(t=0);for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=h(e[i]);var a=l(n);try{t?_BinaryenFunctionRunPasses(t,this.ref,a,r):_BinaryenModuleRunPasses(this.ref,a,r)}finally{free_memory(a);for(i=r;i>=0;--i)free_memory(n[i])}},e.prototype.precomputeFunction=function(e){var t=this.cachedPrecomputeNames;if(!t){var r=h("precompute");this.cachedPrecomputeName=r,this.cachedPrecomputeNames=t=l([r])}_BinaryenFunctionRunPasses(e,this.ref,t,1)},e.prototype.validate=function(){return 1==_BinaryenModuleValidate(this.ref)},e.prototype.interpret=function(){_BinaryenModuleInterpret(this.ref)},e.prototype.toBinary=function(e){var t=this.cachedByValue,r=h(e),n=0,i=0;try{_BinaryenModuleAllocateAndWrite(t,this.ref,r),n=d(t);var a=d(t+4);i=d(t+8);var s=new m;return s.output=function(e,t){for(var r=new Uint8Array(t),n=0;n<t;++n)r[n]=load(e+n);return r}(n,a),s.sourceMap=_(i),s}finally{r&&free_memory(r),n&&free_memory(n),i&&free_memory(i)}},e.prototype.toText=function(){throw new Error("not implemented")},e.prototype.toAsmjs=function(){throw new Error("not implemented")},e.prototype.dispose=function(){assert(this.ref),free_memory(this.cachedByValue),free_memory(this.cachedTemporaryName),free_memory(this.cachedPrecomputeName),free_memory(this.cachedPrecomputeNames),_BinaryenModuleDispose(this.ref),this.ref=0},e.prototype.createRelooper=function(){return c.create(this)},e.prototype.cloneExpression=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=i32.MAX_VALUE),r<0)return 0;var a,s;switch(r-=1,_BinaryenExpressionGetId(e)){case i.Const:switch(_BinaryenExpressionGetType(e)){case n.I32:return this.createI32(_BinaryenConstGetValueI32(e));case n.I64:return this.createI64(_BinaryenConstGetValueI64Low(e),_BinaryenConstGetValueI64High(e));case n.F32:return this.createF32(_BinaryenConstGetValueF32(e));case n.F64:return this.createF64(_BinaryenConstGetValueF64(e));default:throw new Error("concrete type expected")}case i.GetLocal:return _BinaryenGetLocal(this.ref,_BinaryenGetLocalGetIndex(e),_BinaryenExpressionGetType(e));case i.GetGlobal:var o=_BinaryenGetGlobalGetName(e);if(!o)break;return _BinaryenGetGlobal(this.ref,o,_BinaryenExpressionGetType(e));case i.Load:if(!(a=this.cloneExpression(_BinaryenLoadGetPtr(e),t,r)))break;return _BinaryenLoadIsAtomic(e)?_BinaryenAtomicLoad(this.ref,_BinaryenLoadGetBytes(e),_BinaryenLoadGetOffset(e),_BinaryenExpressionGetType(e),a):_BinaryenLoad(this.ref,_BinaryenLoadGetBytes(e),_BinaryenLoadIsSigned(e)?1:0,_BinaryenLoadGetOffset(e),_BinaryenLoadGetAlign(e),_BinaryenExpressionGetType(e),a);case i.Unary:if(!(a=this.cloneExpression(_BinaryenUnaryGetValue(e),t,r)))break;return _BinaryenUnary(this.ref,_BinaryenUnaryGetOp(e),a);case i.Binary:if(!(a=this.cloneExpression(_BinaryenBinaryGetLeft(e),t,r)))break;if(!(s=this.cloneExpression(_BinaryenBinaryGetRight(e),t,r)))break;return _BinaryenBinary(this.ref,_BinaryenBinaryGetOp(e),a,s)}return 0},e.prototype.addDebugInfoFile=function(e){var t=h(e);try{return _BinaryenModuleAddDebugInfoFileName(this.ref,t)}finally{free_memory(t)}},e.prototype.getDebugInfoFile=function(e){return _(_BinaryenModuleGetDebugInfoFileName(this.ref,e))},e.prototype.setDebugLocation=function(e,t,r,n,i){_BinaryenFunctionSetDebugLocation(e,t,r,n,i)},e.MAX_MEMORY_WASM32=65535,e.MAX_MEMORY_WASM64=65535,e}();t.Module=o,t.getExpressionId=function(e){return _BinaryenExpressionGetId(e)},t.getExpressionType=function(e){return _BinaryenExpressionGetType(e)},t.getConstValueI32=function(e){return _BinaryenConstGetValueI32(e)},t.getConstValueI64Low=function(e){return _BinaryenConstGetValueI64Low(e)},t.getConstValueI64High=function(e){return _BinaryenConstGetValueI64High(e)},t.getConstValueF32=function(e){return _BinaryenConstGetValueF32(e)},t.getConstValueF64=function(e){return _BinaryenConstGetValueF64(e)},t.getGetLocalIndex=function(e){return _BinaryenGetLocalGetIndex(e)},t.getSetLocalIndex=function(e){return _BinaryenSetLocalGetIndex(e)},t.getSetLocalValue=function(e){return _BinaryenSetLocalGetValue(e)},t.isTeeLocal=function(e){return _BinaryenSetLocalIsTee(e)},t.getBinaryOp=function(e){return _BinaryenBinaryGetOp(e)},t.getBinaryLeft=function(e){return _BinaryenBinaryGetLeft(e)},t.getBinaryRight=function(e){return _BinaryenBinaryGetRight(e)},t.getUnaryOp=function(e){return _BinaryenUnaryGetOp(e)},t.getUnaryValue=function(e){return _BinaryenUnaryGetValue(e)},t.getLoadBytes=function(e){return _BinaryenLoadGetBytes(e)},t.getLoadOffset=function(e){return _BinaryenLoadGetOffset(e)},t.getLoadPtr=function(e){return _BinaryenLoadGetPtr(e)},t.isLoadSigned=function(e){return _BinaryenLoadIsSigned(e)},t.getStoreBytes=function(e){return _BinaryenStoreGetBytes(e)},t.getStoreOffset=function(e){return _BinaryenStoreGetOffset(e)},t.getStorePtr=function(e){return _BinaryenStoreGetPtr(e)},t.getStoreValue=function(e){return _BinaryenStoreGetValue(e)},t.getBlockName=function(e){return _(_BinaryenBlockGetName(e))},t.getBlockChildCount=function(e){return _BinaryenBlockGetNumChildren(e)},t.getBlockChild=function(e,t){return _BinaryenBlockGetChild(e,t)},t.getIfCondition=function(e){return _BinaryenIfGetCondition(e)},t.getIfTrue=function(e){return _BinaryenIfGetIfTrue(e)},t.getIfFalse=function(e){return _BinaryenIfGetIfFalse(e)},t.getLoopName=function(e){return _(_BinaryenLoopGetName(e))},t.getLoopBody=function(e){return _BinaryenLoopGetBody(e)},t.getBreakName=function(e){return _(_BinaryenBreakGetName(e))},t.getBreakCondition=function(e){return _BinaryenBreakGetCondition(e)},t.getSelectThen=function(e){return _BinaryenSelectGetIfTrue(e)},t.getSelectElse=function(e){return _BinaryenSelectGetIfFalse(e)},t.getSelectCondition=function(e){return _BinaryenSelectGetCondition(e)},t.getDropValue=function(e){return _BinaryenDropGetValue(e)},t.getReturnValue=function(e){return _BinaryenReturnGetValue(e)},t.getCallTarget=function(e){return _(_BinaryenCallGetTarget(e))},t.getHostOp=function(e){return _BinaryenHostGetOp(e)},t.getHostOperandCount=function(e){return _BinaryenHostGetNumOperands(e)},t.getHostOperand=function(e,t){return _BinaryenHostGetOperand(e,t)},t.getHostName=function(e){return _(_BinaryenHostGetNameOperand(e))},t.getFunctionBody=function(e){return _BinaryenFunctionGetBody(e)},t.getFunctionName=function(e){return _(_BinaryenFunctionGetName(e))},t.getFunctionParamCount=function(e){return _BinaryenFunctionGetNumParams(e)},t.getFunctionParamType=function(e,t){return _BinaryenFunctionGetParam(e,t)},t.getFunctionResultType=function(e){return _BinaryenFunctionGetResult(e)};var c=function(){function e(){}return e.create=function(t){var r=new e;return r.module=t,r.ref=_RelooperCreate(),r},e.prototype.addBlock=function(e){return _RelooperAddBlock(this.ref,e)},e.prototype.addBranch=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),_RelooperAddBranch(e,t,r,n)},e.prototype.addBlockWithSwitch=function(e,t){return _RelooperAddBlockWithSwitch(this.ref,e,t)},e.prototype.addBranchForSwitch=function(e,t,r,n){void 0===n&&(n=0);var i=l(r);try{_RelooperAddBranchForSwitch(e,t,i,r.length,n)}finally{free_memory(i)}},e.prototype.renderAndDispose=function(e,t){return _RelooperRenderAndDispose(this.ref,e,t,this.module.ref)},e}();function p(e){if(!e)return 0;for(var t=e.length,r=allocate_memory(t),n=r,i=0;i<t;++i)store(n++,e[i]);return r}function l(e){if(!e)return 0;for(var t=allocate_memory(e.length<<2),r=t,n=0,i=e.length;n<i;++n){var a=e[n];store(r,255&a),store(r+1,a>>8&255),store(r+2,a>>16&255),store(r+3,a>>>24),r+=4}return t}function u(e){return l(e)}function h(e){if(null==e)return 0;for(var t=allocate_memory(function(e){for(var t=0,r=0,n=e.length;r<n;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&r+1<n&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return t}(e)+1),r=t,n=0,i=e.length;n<i;++n){var a=e.charCodeAt(n);a>=55296&&a<=57343&&n+1<i&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++n)),a<=127?store(r++,a):a<=2047?(store(r++,192|a>>>6),store(r++,128|63&a)):a<=65535?(store(r++,224|a>>>12),store(r++,128|a>>>6&63),store(r++,128|63&a)):a<=2097151?(store(r++,240|a>>>18),store(r++,128|a>>>12&63),store(r++,128|a>>>6&63),store(r++,128|63&a)):a<=67108863?(store(r++,248|a>>>24),store(r++,128|a>>>18&63),store(r++,128|a>>>12&63),store(r++,128|a>>>6&63),store(r++,128|63&a)):(store(r++,252|a>>>30),store(r++,128|a>>>24&63),store(r++,128|a>>>18&63),store(r++,128|a>>>12&63),store(r++,128|a>>>6&63),store(r++,128|63&a))}return store(r,0),t}function d(e){return load(e)|load(e+1)<<8|load(e+2)<<16|load(e+3)<<24}function _(e){if(!e)return null;for(var t,r,n,i,a,s=new Array;t=load(e++);)128&t?(r=63&load(e++),192!=(224&t)?(n=63&load(e++),224==(240&t)?t=(15&t)<<12|r<<6|n:(i=63&load(e++),240==(248&t)?t=(7&t)<<18|r<<12|n<<6|i:(a=63&load(e++),t=248==(252&t)?(3&t)<<24|r<<18|n<<12|i<<6|a:(1&t)<<30|r<<24|n<<18|i<<12|a<<6|63&load(e++))),s.push(t)):s.push((31&t)<<6|r)):s.push(t);return String.fromCodePoints(s)}t.Relooper=c,t.readString=_;var m=function(){return function(){}}();t.BinaryModule=m},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(8);t.Token=a.Token,t.Range=a.Range;var s,o=r(1);!function(e){e[e.SOURCE=0]="SOURCE",e[e.TYPE=1]="TYPE",e[e.TYPEPARAMETER=2]="TYPEPARAMETER",e[e.PARAMETER=3]="PARAMETER",e[e.SIGNATURE=4]="SIGNATURE",e[e.IDENTIFIER=5]="IDENTIFIER",e[e.ASSERTION=6]="ASSERTION",e[e.BINARY=7]="BINARY",e[e.CALL=8]="CALL",e[e.COMMA=9]="COMMA",e[e.ELEMENTACCESS=10]="ELEMENTACCESS",e[e.FALSE=11]="FALSE",e[e.FUNCTION=12]="FUNCTION",e[e.INSTANCEOF=13]="INSTANCEOF",e[e.LITERAL=14]="LITERAL",e[e.NEW=15]="NEW",e[e.NULL=16]="NULL",e[e.PARENTHESIZED=17]="PARENTHESIZED",e[e.PROPERTYACCESS=18]="PROPERTYACCESS",e[e.TERNARY=19]="TERNARY",e[e.SUPER=20]="SUPER",e[e.THIS=21]="THIS",e[e.TRUE=22]="TRUE",e[e.CONSTRUCTOR=23]="CONSTRUCTOR",e[e.UNARYPOSTFIX=24]="UNARYPOSTFIX",e[e.UNARYPREFIX=25]="UNARYPREFIX",e[e.BLOCK=26]="BLOCK",e[e.BREAK=27]="BREAK",e[e.CONTINUE=28]="CONTINUE",e[e.DO=29]="DO",e[e.EMPTY=30]="EMPTY",e[e.EXPORT=31]="EXPORT",e[e.EXPORTIMPORT=32]="EXPORTIMPORT",e[e.EXPRESSION=33]="EXPRESSION",e[e.FOR=34]="FOR",e[e.IF=35]="IF",e[e.IMPORT=36]="IMPORT",e[e.RETURN=37]="RETURN",e[e.SWITCH=38]="SWITCH",e[e.THROW=39]="THROW",e[e.TRY=40]="TRY",e[e.VARIABLE=41]="VARIABLE",e[e.VOID=42]="VOID",e[e.WHILE=43]="WHILE",e[e.CLASSDECLARATION=44]="CLASSDECLARATION",e[e.ENUMDECLARATION=45]="ENUMDECLARATION",e[e.ENUMVALUEDECLARATION=46]="ENUMVALUEDECLARATION",e[e.FIELDDECLARATION=47]="FIELDDECLARATION",e[e.FUNCTIONDECLARATION=48]="FUNCTIONDECLARATION",e[e.IMPORTDECLARATION=49]="IMPORTDECLARATION",e[e.INTERFACEDECLARATION=50]="INTERFACEDECLARATION",e[e.METHODDECLARATION=51]="METHODDECLARATION",e[e.NAMESPACEDECLARATION=52]="NAMESPACEDECLARATION",e[e.TYPEDECLARATION=53]="TYPEDECLARATION",e[e.VARIABLEDECLARATION=54]="VARIABLEDECLARATION",e[e.DECORATOR=55]="DECORATOR",e[e.EXPORTMEMBER=56]="EXPORTMEMBER",e[e.SWITCHCASE=57]="SWITCHCASE",e[e.COMMENT=58]="COMMENT"}(s=t.NodeKind||(t.NodeKind={})),t.nodeIsConstantValue=function(e){switch(e){case s.LITERAL:case s.NULL:case s.TRUE:case s.FALSE:return!0}return!1},t.nodeIsCallable=function(e){switch(e){case s.IDENTIFIER:case s.CALL:case s.ELEMENTACCESS:case s.PROPERTYACCESS:return!0}return!1},t.nodeIsGenericCallable=function(e){switch(e){case s.IDENTIFIER:case s.PROPERTYACCESS:return!0}return!1};var c=function(){function e(){this.parent=null,this.flags=i.CommonFlags.NONE}return e.prototype.is=function(e){return(this.flags&e)==e},e.prototype.isAny=function(e){return 0!=(this.flags&e)},e.prototype.set=function(e){this.flags|=e},e.createType=function(e,t,r,n){var i=new l;return i.range=n,i.name=e,e.parent=i,i.typeArguments=t,t&&Re(t,i),i.isNullable=r,i},e.createOmittedType=function(t){return e.createType(e.createIdentifierExpression("",t),null,!1,t)},e.createTypeParameter=function(e,t,r){var n=new u;return n.range=r,n.name=e,e.parent=n,n.extendsType=t,t&&(t.parent=n),n},e.createParameter=function(e,t,r,n,i){var a=new h;return a.range=i,a.name=e,e.parent=a,a.type=t,t&&(t.parent=a),a.initializer=r,r&&(r.parent=a),a.parameterKind=n,a},e.createSignature=function(e,t,r,n,i){var a=new _;return a.range=i,a.parameters=e,Re(e,a),a.returnType=t,t.parent=a,a.explicitThisType=r,r&&(r.parent=a),a.isNullable=n,a},e.createDecorator=function(e,t,r){var n=new y;return n.range=r,n.name=e,e.parent=n,n.arguments=t,t&&Re(t,n),n.decoratorKind=m(e),n},e.createComment=function(e,t,r){var n=new g;return n.range=r,n.commentKind=t,n.text=e,n},e.createIdentifierExpression=function(e,t){var r=new f;return r.range=t,r.text=e,r},e.createEmptyIdentifierExpression=function(e){var t=new f;return t.range=e,t.text="",t},e.createArrayLiteralExpression=function(e,t){var r=new v;return r.range=t,r.elementExpressions=e,function(e,t){for(var r=0,n=e.length;r<n;++r){var i=e[r];i&&(i.parent=t)}}(e,r),r},e.createAssertionExpression=function(e,t,r,n){var i=new A;return i.range=n,i.assertionKind=e,i.expression=t,t.parent=i,i.toType=r,r.parent=i,i},e.createBinaryExpression=function(e,t,r,n){var i=new N;return i.range=n,i.operator=e,i.left=t,t.parent=i,i.right=r,r.parent=i,i},e.createCallExpression=function(e,t,r,n){var i=new C;return i.range=n,i.expression=e,e.parent=i,i.typeArguments=t,t&&Re(t,i),i.arguments=r,Re(r,i),i},e.createCommaExpression=function(e,t){var r=new O;return r.range=t,r.expressions=e,Re(e,r),r},e.createConstructorExpression=function(e){var t=new S;return t.range=e,t},e.createElementAccessExpression=function(e,t,r){var n=new L;return n.range=r,n.expression=e,e.parent=n,n.elementExpression=t,t.parent=n,n},e.createFalseExpression=function(e){var t=new V;return t.range=e,t},e.createFloatLiteralExpression=function(e,t){var r=new b;return r.range=t,r.value=e,r},e.createFunctionExpression=function(e){var t=new k;return t.flags=e.flags&i.CommonFlags.ARROW,t.range=e.range,t.declaration=e,t},e.createInstanceOfExpression=function(e,t,r){var n=new R;return n.range=r,n.expression=e,e.parent=n,n.isType=t,t.parent=n,n},e.createIntegerLiteralExpression=function(e,t){var r=new x;return r.range=t,r.value=e,r},e.createNewExpression=function(e,t,r,n){var i=new F;return i.range=n,i.expression=e,e.parent=i,i.typeArguments=t,t&&Re(t,i),i.arguments=r,Re(r,i),i},e.createNullExpression=function(e){var t=new B;return t.range=e,t},e.createParenthesizedExpression=function(e,t){var r=new U;return r.range=t,r.expression=e,e.parent=r,r},e.createPropertyAccessExpression=function(e,t,r){var n=new D;return n.range=r,n.expression=e,e.parent=n,n.property=t,t.parent=n,n},e.createRegexpLiteralExpression=function(e,t,r){var n=new P;return n.range=r,n.pattern=e,n.patternFlags=t,n},e.createTernaryExpression=function(e,t,r,n){var i=new w;return i.range=n,i.condition=e,e.parent=i,i.ifThen=t,t.parent=i,i.ifElse=r,r.parent=i,i},e.createStringLiteralExpression=function(e,t){var r=new M;return r.range=t,r.value=e,r},e.createSuperExpression=function(e){var t=new G;return t.range=e,t},e.createThisExpression=function(e){var t=new K;return t.range=e,t},e.createTrueExpression=function(e){var t=new z;return t.range=e,t},e.createUnaryPostfixExpression=function(e,t,r){var n=new X;return n.range=r,n.operator=e,n.operand=t,t.parent=n,n},e.createUnaryPrefixExpression=function(e,t,r){var n=new W;return n.range=r,n.operator=e,n.operand=t,t.parent=n,n},e.createBlockStatement=function(e,t){var r=new $;return r.range=t,r.statements=e,Re(e,r),r},e.createBreakStatement=function(e,t){var r=new J;return r.range=t,r.label=e,e&&(e.parent=r),r},e.createClassDeclaration=function(e,t,r,n,i,a,s,o){var c=new ee;return c.range=o,c.flags=s,c.name=e,e.parent=c,c.typeParameters=t,Re(t,c),c.extendsType=r,r&&(r.parent=c),c.implementsTypes=n,n&&Re(n,c),c.members=i,Re(i,c),c.decorators=a,a&&Re(a,c),c},e.createContinueStatement=function(e,t){var r=new te;return r.range=t,r.label=e,e&&(e.parent=r),r},e.createDoStatement=function(e,t,r){var n=new re;return n.range=r,n.statement=e,e.parent=n,n.condition=t,t.parent=n,n},e.createEmptyStatement=function(e){var t=new ne;return t.range=e,t},e.createEnumDeclaration=function(e,t,r,n,i){var a=new ie;return a.range=i,a.flags=n,a.name=e,e.parent=a,a.values=t,Re(t,a),a.decorators=r,r&&Re(r,a),a},e.createEnumValueDeclaration=function(e,t,r,n){var i=new ae;return i.range=n,i.flags=r,i.name=e,e.parent=i,i.value=t,t&&(t.parent=i),i},e.createExportStatement=function(e,t,r,n){var i=new ce;if(i.range=n,i.flags=r,i.members=e,e&&Re(e,i),i.path=t,t){var a=o.normalizePath(t.value);t.value.startsWith(".")?i.normalizedPath=o.resolvePath(a,n.source.normalizedPath):i.normalizedPath=a,i.internalPath=ke(i.normalizedPath)}else i.normalizedPath=null,i.internalPath=null;return i},e.createExportImportStatement=function(e,t,r){var n=new se;return n.range=r,n.name=e,e.parent=n,n.externalName=t,t.parent=n,n},e.createExportMember=function(e,t,r){var n=new oe;return n.range=r,n.name=e,e.parent=n,t?t.parent=n:t=e,n.externalName=t,n},e.createExpressionStatement=function(e){var t=new pe;return t.range=e.range,t.expression=e,e.parent=t,t},e.createIfStatement=function(e,t,r,n){var i=new de;return i.range=n,i.condition=e,e.parent=i,i.ifTrue=t,t.parent=i,i.ifFalse=r,r&&(r.parent=i),i},e.createImportStatement=function(e,t,r){var n=new me;n.range=r,n.declarations=e,e&&Re(e,n),n.namespaceName=null,n.path=t;var a=o.normalizePath(t.value);return t.value.startsWith(".")?n.normalizedPath=o.resolvePath(a,r.source.normalizedPath):(a.startsWith(i.LIBRARY_PREFIX)||(a=i.LIBRARY_PREFIX+a),n.normalizedPath=a),n.internalPath=ke(n.normalizedPath),n},e.createImportStatementWithWildcard=function(e,t,r){var n=new me;return n.range=r,n.declarations=null,n.namespaceName=e,n.path=t,n.normalizedPath=o.resolvePath(o.normalizePath(t.value),r.source.normalizedPath),n.internalPath=ke(n.normalizedPath),n},e.createImportDeclaration=function(e,t,r){var n=new _e;return n.range=r,n.externalName=e,e.parent=n,t?t.parent=n:t=e,n.name=t,n},e.createInterfaceDeclaration=function(e,t,r,n,i,a,s){var o=new ye;return o.range=s,o.flags=a,o.name=e,e.parent=o,o.typeParameters=t,t&&Re(t,o),o.extendsType=r,r&&(r.parent=o),o.members=n,Re(n,o),o.decorators=i,i&&Re(i,o),o},e.createFieldDeclaration=function(e,t,r,n,i,a){var s=new le;return s.range=a,s.flags=i,s.name=e,e.parent=s,s.type=t,t&&(t.parent=s),s.initializer=r,r&&(r.parent=s),s.decorators=n,n&&Re(n,s),s},e.createForStatement=function(e,t,r,n,i){var a=new ue;return a.range=i,a.initializer=e,e&&(e.parent=a),a.condition=t,t&&(t.parent=a),a.incrementor=r,r&&(r.parent=a),a.statement=n,n.parent=a,a},e.createFunctionDeclaration=function(e,t,r,n,i,a,s){var o=new he;return o.range=s,o.flags=a,o.name=e,e.parent=o,o.typeParameters=t,t&&Re(t,o),o.signature=r,r.parent=o,o.body=n,n&&(n.parent=o),o.decorators=i,i&&Re(i,o),o},e.createMethodDeclaration=function(e,t,r,n,i,a,s){var o=new ge;return o.range=s,o.flags=a,o.name=e,e.parent=o,o.typeParameters=t,t&&Re(t,o),o.signature=r,r.parent=o,o.body=n,n&&(n.parent=o),o.decorators=i,i&&Re(i,o),o},e.createNamespaceDeclaration=function(e,t,r,n,i){var a=new Te;return a.range=i,a.flags=n,a.name=e,e.parent=a,a.members=t,Re(t,a),a.decorators=r,r&&Re(r,a),a},e.createReturnStatement=function(e,t){var r=new Ee;return r.range=t,r.value=e,e&&(e.parent=r),r},e.createSwitchStatement=function(e,t,r){var n=new Ie;return n.range=r,n.condition=e,e.parent=n,n.cases=t,Re(t,n),n},e.createSwitchCase=function(e,t,r){var n=new fe;return n.range=r,n.label=e,e&&(e.parent=n),n.statements=t,Re(t,n),n},e.createThrowStatement=function(e,t){var r=new ve;return r.range=t,r.value=e,e.parent=r,r},e.createTryStatement=function(e,t,r,n,i){var a=new Ae;return a.range=i,a.statements=e,Re(e,a),a.catchVariable=t,t&&(t.parent=a),a.catchStatements=r,r&&Re(r,a),a.finallyStatements=n,n&&Re(n,a),a},e.createTypeDeclaration=function(e,t,r,n,i,a){var s=new Ne;return s.range=a,s.flags=i,s.name=e,e.parent=s,s.typeParameters=t,t&&Re(t,s),s.type=r,r.parent=s,s.decorators=n,n&&Re(n,s),s},e.createVariableStatement=function(e,t,r,n){var i=new Oe;return i.range=n,i.flags=r,i.declarations=e,Re(e,i),i.decorators=t,t&&Re(t,i),i},e.createVariableDeclaration=function(e,t,r,n,i,a){var s=new Ce;return s.range=a,s.flags=i,s.name=e,e.parent=s,s.type=t,t&&(t.parent=s),s.initializer=r,r&&(r.parent=s),s.decorators=n,s},e.createVoidStatement=function(e,t){var r=new Se;return r.range=t,r.expression=e,r},e.createWhileStatement=function(e,t,r){var n=new Le;return n.range=r,n.condition=e,e.parent=n,n.statement=t,t.parent=n,n},e}();t.Node=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(c);t.CommonTypeNode=p;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TYPE,t}return n(t,e),t}(p);t.TypeNode=l;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TYPEPARAMETER,t}return n(t,e),t}(c);t.TypeParameterNode=u,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.REST=2]="REST"}(t.ParameterKind||(t.ParameterKind={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.PARAMETER,t.implicitFieldDeclaration=null,t}return n(t,e),t}(c);t.ParameterNode=h;var d,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.SIGNATURE,t}return n(t,e),t}(p);function m(e){if(e.kind==s.IDENTIFIER){var t=e.text;switch(assert(t.length),t.charCodeAt(0)){case 101:if("external"==t)return d.EXTERNAL;break;case 103:if("global"==t)return d.GLOBAL;break;case 105:if("inline"==t)return d.INLINE;break;case 111:if("operator"==t)return d.OPERATOR;break;case 115:if("sealed"==t)return d.SEALED;break;case 117:if("unmanaged"==t)return d.UNMANAGED}}else if(e.kind==s.PROPERTYACCESS&&e.expression.kind==s.IDENTIFIER){t=e.expression.text;assert(t.length);var r=e.property.text;if(assert(r.length),"operator"==t)switch(r.charCodeAt(0)){case 98:if("binary"==r)return d.OPERATOR_BINARY;break;case 112:switch(r){case"prefix":return d.OPERATOR_PREFIX;case"postfix":return d.OPERATOR_POSTFIX}}}return d.CUSTOM}t.SignatureNode=_,function(e){e[e.CUSTOM=0]="CUSTOM",e[e.GLOBAL=1]="GLOBAL",e[e.OPERATOR=2]="OPERATOR",e[e.OPERATOR_BINARY=3]="OPERATOR_BINARY",e[e.OPERATOR_PREFIX=4]="OPERATOR_PREFIX",e[e.OPERATOR_POSTFIX=5]="OPERATOR_POSTFIX",e[e.UNMANAGED=6]="UNMANAGED",e[e.SEALED=7]="SEALED",e[e.INLINE=8]="INLINE",e[e.EXTERNAL=9]="EXTERNAL"}(d=t.DecoratorKind||(t.DecoratorKind={})),t.decoratorNameToKind=m;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.DECORATOR,t}return n(t,e),t}(c);t.DecoratorNode=y,function(e){e[e.LINE=0]="LINE",e[e.TRIPLE=1]="TRIPLE",e[e.BLOCK=2]="BLOCK"}(t.CommentKind||(t.CommentKind={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.COMMENT,t}return n(t,e),t}(c);t.CommentNode=g;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(c);t.Expression=T;var E,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.IDENTIFIER,t}return n(t,e),t}(T);t.IdentifierExpression=f,function(e){e[e.FLOAT=0]="FLOAT",e[e.INTEGER=1]="INTEGER",e[e.STRING=2]="STRING",e[e.REGEXP=3]="REGEXP",e[e.ARRAY=4]="ARRAY",e[e.OBJECT=5]="OBJECT"}(E=t.LiteralKind||(t.LiteralKind={}));var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.LITERAL,t}return n(t,e),t}(T);t.LiteralExpression=I;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=E.ARRAY,t}return n(t,e),t}(I);t.ArrayLiteralExpression=v,function(e){e[e.PREFIX=0]="PREFIX",e[e.AS=1]="AS"}(t.AssertionKind||(t.AssertionKind={}));var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.ASSERTION,t}return n(t,e),t}(T);t.AssertionExpression=A;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.BINARY,t}return n(t,e),t}(T);t.BinaryExpression=N;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.CALL,t}return n(t,e),t}(T);t.CallExpression=C;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.COMMA,t}return n(t,e),t}(T);t.CommaExpression=O;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.CONSTRUCTOR,t.text="constructor",t}return n(t,e),t}(f);t.ConstructorExpression=S;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.ELEMENTACCESS,t}return n(t,e),t}(T);t.ElementAccessExpression=L;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=E.FLOAT,t}return n(t,e),t}(I);t.FloatLiteralExpression=b;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.FUNCTION,t}return n(t,e),t}(T);t.FunctionExpression=k;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.INSTANCEOF,t}return n(t,e),t}(T);t.InstanceOfExpression=R;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=E.INTEGER,t}return n(t,e),t}(I);t.IntegerLiteralExpression=x;var F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.NEW,t}return n(t,e),t}(C);t.NewExpression=F;var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.NULL,t.text="null",t}return n(t,e),t}(f);t.NullExpression=B;var U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.PARENTHESIZED,t}return n(t,e),t}(T);t.ParenthesizedExpression=U;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.PROPERTYACCESS,t}return n(t,e),t}(T);t.PropertyAccessExpression=D;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=E.REGEXP,t}return n(t,e),t}(I);t.RegexpLiteralExpression=P;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TERNARY,t}return n(t,e),t}(T);t.TernaryExpression=w;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.literalKind=E.STRING,t}return n(t,e),t}(I);t.StringLiteralExpression=M;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.SUPER,t.text="super",t}return n(t,e),t}(f);t.SuperExpression=G;var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.THIS,t.text="this",t}return n(t,e),t}(f);t.ThisExpression=K;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TRUE,t.text="true",t}return n(t,e),t}(f);t.TrueExpression=z;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.FALSE,t.text="false",t}return n(t,e),t}(f);t.FalseExpression=V;var H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(T);t.UnaryExpression=H;var X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.UNARYPOSTFIX,t}return n(t,e),t}(H);t.UnaryPostfixExpression=X;var W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.UNARYPREFIX,t}return n(t,e),t}(H);t.UnaryPrefixExpression=W,t.isLastStatement=function(e){var t=assert(e.parent);if(t.kind==s.BLOCK){var r=t.statements;if(r[r.length-1]===e)switch(assert(t.parent).kind){case s.FUNCTIONDECLARATION:case s.METHODDECLARATION:return!0}}return!1};var Y,Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(c);t.Statement=Q,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ENTRY=1]="ENTRY",e[e.LIBRARY=2]="LIBRARY"}(Y=t.SourceKind||(t.SourceKind={}));var q=function(e){function t(t,r,n){var o=e.call(this)||this;o.kind=s.SOURCE,o.parent=null,o.tokenizer=null,o.debugInfoIndex=-1,o.exportPaths=null,o.sourceKind=n,o.normalizedPath=t;var c=ke(o.normalizedPath);o.internalPath=c;var p=c.lastIndexOf(i.PATH_DELIMITER);return o.simplePath=p>=0?c.substring(p+1):c,o.statements=new Array,o.range=new a.Range(o,0,r.length),o.text=r,o}return n(t,e),Object.defineProperty(t.prototype,"isEntry",{get:function(){return this.sourceKind==Y.ENTRY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLibrary",{get:function(){return this.sourceKind==Y.LIBRARY},enumerable:!0,configurable:!0}),t}(c);t.Source=q;var j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.decorators=null,t.cachedProgramLevelInternalName=null,t.cachedFileLevelInternalName=null,t}return n(t,e),Object.defineProperty(t.prototype,"programLevelInternalName",{get:function(){return this.cachedProgramLevelInternalName||(this.cachedProgramLevelInternalName=be(this,!0)),this.cachedProgramLevelInternalName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fileLevelInternalName",{get:function(){return this.cachedFileLevelInternalName||(this.cachedFileLevelInternalName=be(this,!1)),this.cachedFileLevelInternalName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTopLevel",{get:function(){var e=this.parent;return!!e&&(!(e.kind==s.VARIABLE&&!(e=e.parent))&&e.kind==s.SOURCE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTopLevelExport",{get:function(){var e=this.parent;return!(!e||e.kind==s.VARIABLE&&!(e=e.parent))&&(e.kind==s.NAMESPACEDECLARATION?this.is(i.CommonFlags.EXPORT)&&e.isTopLevelExport:e.kind==s.CLASSDECLARATION?this.is(i.CommonFlags.STATIC)&&e.isTopLevelExport:e.kind==s.SOURCE&&this.is(i.CommonFlags.EXPORT))},enumerable:!0,configurable:!0}),t.prototype.needsExplicitExport=function(e){return e.name.text!=e.externalName.text||this.range.source!=e.range.source||!this.isTopLevelExport},t}(Q);t.DeclarationStatement=j;var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(j);t.VariableLikeDeclarationStatement=Z;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.BLOCK,t}return n(t,e),t}(Q);t.BlockStatement=$;var J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.BREAK,t}return n(t,e),t}(Q);t.BreakStatement=J;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.CLASSDECLARATION,t}return n(t,e),Object.defineProperty(t.prototype,"isGeneric",{get:function(){var e=this.typeParameters;return null!=e&&e.length>0},enumerable:!0,configurable:!0}),t}(j);t.ClassDeclaration=ee;var te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.CONTINUE,t}return n(t,e),t}(Q);t.ContinueStatement=te;var re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.DO,t}return n(t,e),t}(Q);t.DoStatement=re;var ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.EMPTY,t}return n(t,e),t}(Q);t.EmptyStatement=ne;var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.ENUMDECLARATION,t}return n(t,e),t}(j);t.EnumDeclaration=ie;var ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.ENUMVALUEDECLARATION,t}return n(t,e),t}(j);t.EnumValueDeclaration=ae;var se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.EXPORTIMPORT,t}return n(t,e),t}(c);t.ExportImportStatement=se;var oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.EXPORTMEMBER,t}return n(t,e),t}(c);t.ExportMember=oe;var ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.EXPORT,t}return n(t,e),t}(Q);t.ExportStatement=ce;var pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.EXPRESSION,t}return n(t,e),t}(Q);t.ExpressionStatement=pe;var le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.FIELDDECLARATION,t.parameterIndex=-1,t}return n(t,e),t}(Z);t.FieldDeclaration=le;var ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.FOR,t}return n(t,e),t}(Q);t.ForStatement=ue;var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.FUNCTIONDECLARATION,t}return n(t,e),Object.defineProperty(t.prototype,"isGeneric",{get:function(){var e=this.typeParameters;return null!=e&&e.length>0},enumerable:!0,configurable:!0}),t}(j);t.FunctionDeclaration=he;var de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.IF,t}return n(t,e),t}(Q);t.IfStatement=de;var _e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.IMPORTDECLARATION,t}return n(t,e),t}(j);t.ImportDeclaration=_e;var me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.IMPORT,t}return n(t,e),t}(Q);t.ImportStatement=me;var ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.INTERFACEDECLARATION,t}return n(t,e),t}(ee);t.InterfaceDeclaration=ye;var ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.METHODDECLARATION,t}return n(t,e),t}(he);t.MethodDeclaration=ge;var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.NAMESPACEDECLARATION,t}return n(t,e),t}(j);t.NamespaceDeclaration=Te;var Ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.RETURN,t}return n(t,e),t}(Q);t.ReturnStatement=Ee;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.SWITCHCASE,t}return n(t,e),t}(c);t.SwitchCase=fe;var Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.SWITCH,t}return n(t,e),t}(Q);t.SwitchStatement=Ie;var ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.THROW,t}return n(t,e),t}(Q);t.ThrowStatement=ve;var Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TRY,t}return n(t,e),t}(Q);t.TryStatement=Ae;var Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.TYPEDECLARATION,t}return n(t,e),t}(j);t.TypeDeclaration=Ne;var Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.VARIABLEDECLARATION,t}return n(t,e),t}(Z);t.VariableDeclaration=Ce;var Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.VARIABLE,t}return n(t,e),t}(Q);t.VariableStatement=Oe;var Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.VOID,t}return n(t,e),t}(Q);t.VoidStatement=Se;var Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.kind=s.WHILE,t}return n(t,e),t}(Q);function be(e,t){void 0===t&&(t=!1);var r=e.name.text,n=e.parent;return n&&(e.kind!=s.VARIABLEDECLARATION||n.kind!=s.VARIABLE||(n=n.parent))?n.kind==s.CLASSDECLARATION?be(n,t)+(e.is(i.CommonFlags.STATIC)?i.STATIC_DELIMITER:i.INSTANCE_DELIMITER)+r:n.kind==s.NAMESPACEDECLARATION||n.kind==s.ENUMDECLARATION?be(n,t)+i.STATIC_DELIMITER+r:t?r:e.range.source.internalPath+i.PATH_DELIMITER+r:r}function ke(e){return e.endsWith(".ts")&&(e=e.substring(0,e.length-3)),e}function Re(e,t){for(var r=0,n=e.length;r<n;++r)e[r].parent=t}t.WhileStatement=Le,t.findDecorator=function(e,t){if(t)for(var r=0,n=t.length;r<n;++r){var i=t[r];if(i.decoratorKind==e)return i}return null},t.mangleInternalName=be,t.mangleInternalPath=ke},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),c=r(2),p=r(7),l=r(4),u=r(3),h=function(){return function(){}}(),d=function(){return function(){}}(),_=function(){return function(){}}();function m(e,t){switch(assert(t.length),e){case l.DecoratorKind.OPERATOR:case l.DecoratorKind.OPERATOR_BINARY:switch(t.charCodeAt(0)){case 91:if("[]"==t)return s.INDEXED_GET;if("[]="==t)return s.INDEXED_SET;break;case 123:if("{}"==t)return s.UNCHECKED_INDEXED_GET;if("{}="==t)return s.UNCHECKED_INDEXED_SET;break;case 43:if("+"==t)return s.ADD;break;case 45:if("-"==t)return s.SUB;break;case 42:if("*"==t)return s.MUL;if("**"==t)return s.POW;break;case 47:if("/"==t)return s.DIV;break;case 37:if("%"==t)return s.REM;break;case 38:if("&"==t)return s.BITWISE_AND;break;case 124:if("|"==t)return s.BITWISE_OR;break;case 94:if("^"==t)return s.BITWISE_XOR;break;case 61:if("=="==t)return s.EQ;break;case 33:if("!="==t)return s.NE;break;case 62:if(">"==t)return s.GT;if(">="==t)return s.GE;if(">>"==t)return s.BITWISE_SHR;if(">>>"==t)return s.BITWISE_SHR_U;break;case 60:if("<"==t)return s.LT;if("<="==t)return s.LE;if("<<"==t)return s.BITWISE_SHL}break;case l.DecoratorKind.OPERATOR_PREFIX:switch(t.charCodeAt(0)){case 43:if("+"==t)return s.PLUS;if("++"==t)return s.PREFIX_INC;break;case 45:if("-"==t)return s.MINUS;if("--"==t)return s.PREFIX_DEC;break;case 33:if("!"==t)return s.NOT;break;case 126:if("~"==t)return s.BITWISE_NOT}break;case l.DecoratorKind.OPERATOR_POSTFIX:switch(t.charCodeAt(0)){case 43:if("++"==t)return s.POSTFIX_INC;break;case 45:if("--"==t)return s.POSTFIX_DEC}}return s.INVALID}!function(e){e[e.INVALID=0]="INVALID",e[e.INDEXED_GET=1]="INDEXED_GET",e[e.INDEXED_SET=2]="INDEXED_SET",e[e.UNCHECKED_INDEXED_GET=3]="UNCHECKED_INDEXED_GET",e[e.UNCHECKED_INDEXED_SET=4]="UNCHECKED_INDEXED_SET",e[e.ADD=5]="ADD",e[e.SUB=6]="SUB",e[e.MUL=7]="MUL",e[e.DIV=8]="DIV",e[e.REM=9]="REM",e[e.POW=10]="POW",e[e.BITWISE_AND=11]="BITWISE_AND",e[e.BITWISE_OR=12]="BITWISE_OR",e[e.BITWISE_XOR=13]="BITWISE_XOR",e[e.BITWISE_SHL=14]="BITWISE_SHL",e[e.BITWISE_SHR=15]="BITWISE_SHR",e[e.BITWISE_SHR_U=16]="BITWISE_SHR_U",e[e.EQ=17]="EQ",e[e.NE=18]="NE",e[e.GT=19]="GT",e[e.GE=20]="GE",e[e.LT=21]="LT",e[e.LE=22]="LE",e[e.PLUS=23]="PLUS",e[e.MINUS=24]="MINUS",e[e.NOT=25]="NOT",e[e.BITWISE_NOT=26]="BITWISE_NOT",e[e.PREFIX_INC=27]="PREFIX_INC",e[e.PREFIX_DEC=28]="PREFIX_DEC",e[e.POSTFIX_INC=29]="POSTFIX_INC",e[e.POSTFIX_DEC=30]="POSTFIX_DEC"}(s=t.OperatorKind||(t.OperatorKind={}));var y,g,T=new Map,E=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this,t)||this;return r.diagnosticsOffset=0,r.elementsLookup=new Map,r.instancesLookup=new Map,r.typesLookup=T,r.typeAliases=new Map,r.fileLevelExports=new Map,r.moduleLevelExports=new Map,r.arrayPrototype=null,r.arrayBufferViewPrototype=null,r.stringInstance=null,r.mainFunction=null,r.resolvedThisExpression=null,r.resolvedElementExpression=null,r.sources=[],r}return n(t,e),t.prototype.getSource=function(e){for(var t=this.sources,r=0,n=t.length;r<n;++r){var i=t[r];if(i.normalizedPath==e)return i}return null},t.prototype.lookupSourceByPath=function(e){var t;return this.getSource(e+".ts")||this.getSource(e+"/index.ts")||this.getSource((t=o.LIBRARY_PREFIX+e)+".ts")||this.getSource(t+"/index.ts")},t.prototype.initialize=function(e){var t,r,n,s;this.options=e,this.typesLookup=new Map([["i8",p.Type.i8],["i16",p.Type.i16],["i32",p.Type.i32],["i64",p.Type.i64],["isize",e.isizeType],["u8",p.Type.u8],["u16",p.Type.u16],["u32",p.Type.u32],["u64",p.Type.u64],["usize",e.usizeType],["bool",p.Type.bool],["f32",p.Type.f32],["f64",p.Type.f64],["void",p.Type.void],["number",p.Type.f64],["boolean",p.Type.bool]]);for(var u=new Array,h=new Map,d=new Array,_=new Array,m=0,g=this.sources.length;m<g;++m){var T=this.sources[m],E=new v(this,T);this.elementsLookup.set(E.internalName,E),this.currentFilespace=E;for(var f=T.statements,I=0,A=f.length;I<A;++I){var N=f[I];switch(N.kind){case l.NodeKind.CLASSDECLARATION:this.initializeClass(N,d,_);break;case l.NodeKind.ENUMDECLARATION:this.initializeEnum(N);break;case l.NodeKind.EXPORT:this.initializeExports(N,h);break;case l.NodeKind.FUNCTIONDECLARATION:this.initializeFunction(N);break;case l.NodeKind.IMPORT:this.initializeImports(N,h,u);break;case l.NodeKind.INTERFACEDECLARATION:this.initializeInterface(N);break;case l.NodeKind.NAMESPACEDECLARATION:this.initializeNamespace(N,d,_);break;case l.NodeKind.TYPEDECLARATION:this.initializeTypeAlias(N);break;case l.NodeKind.VARIABLE:this.initializeVariables(N)}}}for(m=0;m<u.length;){var C=u[m];if(Q=C.declaration)(x=this.tryResolveImport(C.externalName,h))?(this.elementsLookup.set(C.localName,x),u.splice(m,1)):(x=this.tryResolveImport(C.externalNameAlt,h))?(this.elementsLookup.set(C.localName,x),u.splice(m,1)):(this.error(c.DiagnosticCode.Module_0_has_no_exported_member_1,Q.range,Q.parent.path.value,Q.externalName.text),++m);else(x=this.elementsLookup.get(C.externalName))?(this.elementsLookup.set(C.localName,x),u.splice(m,1)):(x=this.elementsLookup.get(C.externalNameAlt))?(this.elementsLookup.set(C.localName,x),u.splice(m,1)):(assert(!1),++m)}try{for(var O=i(h),S=O.next();!S.done;S=O.next()){var L=a(S.value,2),b=L[0],k=L[1],R=k,x=void 0;do{if(!R.isReExport){(x=this.elementsLookup.get(R.externalName))||(x=this.elementsLookup.get(R.member.name.text))?this.setExportAndCheckLibrary(b,x,R.member.externalName):this.error(c.DiagnosticCode.Cannot_find_name_0,k.member.range,k.member.name.text);break}if(x=this.fileLevelExports.get(R.externalName)){this.setExportAndCheckLibrary(b,x,R.member.externalName);break}(R=h.get(R.externalName))||this.error(c.DiagnosticCode.Module_0_has_no_exported_member_1,k.member.externalName.range,k.member.parent.path.value,k.member.externalName.text)}while(R)}}catch(e){t={error:e}}finally{try{S&&!S.done&&(r=O.return)&&r.call(O)}finally{if(t)throw t.error}}for(m=0,g=d.length;m<g;++m){var F=d[m],B=F.declaration,U=assert(B.extendsType),D=this.resolveIdentifier(U.name,null);if(D)if(D.kind==y.CLASS_PROTOTYPE){var P=D;F.basePrototype=P}else this.error(c.DiagnosticCode.A_class_may_only_extend_another_class,U.range)}var w=e.globalAliases;if(w)try{for(var M=i(w),G=M.next();!G.done;G=M.next()){var K=a(G.value,2),z=K[0],V=K[1];if(V.length){if(!(x=this.elementsLookup.get(V)))throw new Error("element not found: "+V);this.elementsLookup.set(z,x)}}}catch(e){n={error:e}}finally{try{G&&!G.done&&(s=M.return)&&s.call(M)}finally{if(n)throw n.error}}var H=this.elementsLookup.get("Array");H&&(assert(H.kind==y.CLASS_PROTOTYPE),this.arrayPrototype=H);var X=this.elementsLookup.get("ArrayBufferView");X&&(assert(X.kind==y.INTERFACE_PROTOTYPE),this.arrayBufferViewPrototype=X);var W=this.elementsLookup.get("String");if(W){assert(W.kind==y.CLASS_PROTOTYPE);var Y=W.resolve(null);if(Y)if(this.typesLookup.has("string")){var Q=W.declaration;this.error(c.DiagnosticCode.Duplicate_identifier_0,Q.name.range,Q.programLevelInternalName)}else this.stringInstance=Y,this.typesLookup.set("string",Y.type)}x=assert(this.elementsLookup.get("start"));(assert(x.kind==y.FUNCTION_PROTOTYPE),this.startFunction=x,this.moduleLevelExports.has("main"))&&((x=this.moduleLevelExports.get("main")).kind!=y.FUNCTION_PROTOTYPE||x.isAny(o.CommonFlags.GENERIC|o.CommonFlags.AMBIENT)||(x.set(o.CommonFlags.MAIN),this.mainFunction=x))},t.prototype.tryResolveImport=function(e,t){for(var r,n=this.fileLevelExports;;){if(r=n.get(e))return r;var i=t.get(e);if(!i)break;if(!i.isReExport)return this.elementsLookup.get(i.externalName);e=i.externalName}return null},t.prototype.filterDecorators=function(e,t){for(var r=g.NONE,n=0,i=e.length;n<i;++n){var a=e[n],s=f(l.decoratorNameToKind(a.name));s&&(t&s?r&s?this.error(c.DiagnosticCode.Duplicate_decorator,a.range,a.name.range.toString()):r|=s:this.error(c.DiagnosticCode.Decorator_0_is_not_valid_here,a.range,a.name.range.toString()))}return r},t.prototype.checkGlobalOptions=function(e,t){var r=t.parent;if(e.hasDecorator(g.GLOBAL)||t.range.source.is(o.CommonFlags.BUILTIN)||t.range.source.isLibrary&&e.is(o.CommonFlags.EXPORT)&&(assert(r).kind==l.NodeKind.SOURCE||r.kind==l.NodeKind.VARIABLE&&assert(r.parent).kind==l.NodeKind.SOURCE)){var n=t.programLevelInternalName;this.elementsLookup.has(n)?this.error(c.DiagnosticCode.Duplicate_identifier_0,t.name.range,e.internalName):(this.elementsLookup.set(n,e),e.is(o.CommonFlags.BUILTIN)&&(e.internalName=n))}},t.prototype.initializeClass=function(e,t,r,n){void 0===n&&(n=null);var i=e.fileLevelInternalName;if(this.elementsLookup.has(i))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,i);else{var a=e.decorators,s=e.name.text,p=new D(this,s,i,e,a?this.filterDecorators(a,g.GLOBAL|g.SEALED|g.UNMANAGED):g.NONE);p.parent=n,this.elementsLookup.set(i,p);var u=e.implementsTypes;if(u){var h=u.length;p.hasDecorator(g.UNMANAGED)?h&&this.error(c.DiagnosticCode.Unmanaged_classes_cannot_implement_interfaces,l.Range.join(e.name.range,u[h-1].range)):h&&r.push(p)}if(e.extendsType&&t.push(p),n){if(n.members){if(n.members.has(s))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,i)}else n.members=new Map;n.members.set(s,p),n.is(o.CommonFlags.MODULE_EXPORT)&&p.is(o.CommonFlags.EXPORT)&&p.set(o.CommonFlags.MODULE_EXPORT)}else if(p.is(o.CommonFlags.EXPORT)){if(this.fileLevelExports.has(i))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,i);if(this.fileLevelExports.set(i,p),this.currentFilespace.members.set(s,p),p.is(o.CommonFlags.EXPORT)&&e.range.source.isEntry){if(this.moduleLevelExports.has(s))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,this.moduleLevelExports.get(s).internalName);p.set(o.CommonFlags.MODULE_EXPORT),this.moduleLevelExports.set(s,p)}}for(var d=e.members,_=0,m=d.length;_<m;++_){var y=d[_];switch(y.kind){case l.NodeKind.FIELDDECLARATION:this.initializeField(y,p);break;case l.NodeKind.METHODDECLARATION:y.isAny(o.CommonFlags.GET|o.CommonFlags.SET)?this.initializeAccessor(y,p):this.initializeMethod(y,p);break;default:throw new Error("class member expected")}}this.checkGlobalOptions(p,e)}},t.prototype.initializeField=function(e,t){var r=e.name.text,n=e.fileLevelInternalName,i=e.decorators;if(e.is(o.CommonFlags.STATIC)){if(this.elementsLookup.has(n))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n);if(t.members){if(t.members.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.members=new Map;var a=new S(this,r,n,p.Type.void,e,i?this.filterDecorators(i,g.NONE):g.NONE);a.parent=t,t.members.set(r,a),this.elementsLookup.set(n,a),t.is(o.CommonFlags.MODULE_EXPORT)&&a.set(o.CommonFlags.MODULE_EXPORT)}else{if(t.instanceMembers){if(t.instanceMembers.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.instanceMembers=new Map;var s=new F(t,r,n,e);i&&this.filterDecorators(i,g.NONE),t.instanceMembers.set(r,s)}},t.prototype.initializeMethod=function(e,t){var r=e.name.text,n=e.fileLevelInternalName,i=null,a=e.decorators,s=g.NONE;if(a&&(s=this.filterDecorators(a,g.OPERATOR_BINARY|g.OPERATOR_PREFIX|g.OPERATOR_POSTFIX|g.INLINE)),e.is(o.CommonFlags.STATIC)){if(assert(e.name.kind!=l.NodeKind.CONSTRUCTOR),this.elementsLookup.has(n))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n);if(t.members){if(t.members.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.members=new Map;i=new k(this,r,n,e,t,s),t.members.set(r,i),this.elementsLookup.set(n,i),t.is(o.CommonFlags.MODULE_EXPORT)&&i.set(o.CommonFlags.MODULE_EXPORT)}else{if(t.instanceMembers){if(t.instanceMembers.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.instanceMembers=new Map;i=new k(this,r,n,e,t,s),e.name.kind==l.NodeKind.CONSTRUCTOR?t.constructorPrototype?this.error(c.DiagnosticCode.Multiple_constructor_implementations_are_not_allowed,e.name.range):(i.set(o.CommonFlags.CONSTRUCTOR),t.constructorPrototype=i):t.instanceMembers.set(r,i),t.is(o.CommonFlags.MODULE_EXPORT)&&i.set(o.CommonFlags.MODULE_EXPORT)}this.checkOperatorOverloads(e.decorators,i,t)},t.prototype.checkOperatorOverloads=function(e,t,r){if(e)for(var n=0,i=e.length;n<i;++n){var a=e[n];switch(a.decoratorKind){case l.DecoratorKind.OPERATOR:case l.DecoratorKind.OPERATOR_BINARY:case l.DecoratorKind.OPERATOR_PREFIX:case l.DecoratorKind.OPERATOR_POSTFIX:var o=a.arguments&&a.arguments.length||0;if(1==o){var p=a.arguments[0];if(p.kind==l.NodeKind.LITERAL&&p.literalKind==l.LiteralKind.STRING){var u=m(a.decoratorKind,p.value);if(u==s.INVALID)this.error(c.DiagnosticCode.Operation_not_supported,p.range);else{var h=r.overloadPrototypes;h.has(u)?this.error(c.DiagnosticCode.Duplicate_function_implementation,p.range):(t.operatorKind=u,h.set(u,t))}}else this.error(c.DiagnosticCode.String_literal_expected,p.range)}else this.error(c.DiagnosticCode.Expected_0_arguments_but_got_1,a.range,"1",o.toString(0))}}},t.prototype.initializeAccessor=function(e,t){var r=e.name.text,n=e.fileLevelInternalName,i=this.elementsLookup.get(n),a=e.is(o.CommonFlags.GET),s=!1;if(i){if(i.kind!=y.PROPERTY||null!=(a?i.getterPrototype:i.setterPrototype))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else i=new U(this,r,n,t),s=!0;var p=e.decorators,l=g.NONE;p&&(l=this.filterDecorators(p,g.INLINE));var u=(a?o.GETTER_PREFIX:o.SETTER_PREFIX)+r;if(e.is(o.CommonFlags.STATIC)){var h=t.internalName+o.STATIC_DELIMITER+u;if(this.elementsLookup.has(h))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,h);var d=new k(this,u,h,e,null,l);if(a?i.getterPrototype=d:i.setterPrototype=d,s){if(t.members){if(t.members.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,h)}else t.members=new Map;t.members.set(r,i)}else assert(t.members&&t.members.has(r));this.elementsLookup.set(n,i),t.is(o.CommonFlags.MODULE_EXPORT)&&i.set(o.CommonFlags.MODULE_EXPORT)}else{var _=t.internalName+o.INSTANCE_DELIMITER+u;if(t.instanceMembers){if(t.instanceMembers.has(u))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.instanceMembers=new Map;var m=new k(this,u,_,e,t,l);a?i.getterPrototype=m:i.setterPrototype=m,t.instanceMembers.set(u,i),this.elementsLookup.set(n,i),t.is(o.CommonFlags.MODULE_EXPORT)&&(i.set(o.CommonFlags.MODULE_EXPORT),m.set(o.CommonFlags.MODULE_EXPORT))}},t.prototype.initializeEnum=function(e,t){void 0===t&&(t=null);var r=e.fileLevelInternalName;if(this.elementsLookup.has(r))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);else{var n=e.name.text,i=new N(this,n,r,e);if(i.parent=t,this.elementsLookup.set(r,i),t){if(t.members){if(t.members.has(n))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(n,i),t.is(o.CommonFlags.MODULE_EXPORT)&&i.is(o.CommonFlags.EXPORT)&&i.set(o.CommonFlags.MODULE_EXPORT)}else if(i.is(o.CommonFlags.EXPORT)){if(this.fileLevelExports.has(r))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);if(this.fileLevelExports.set(r,i),this.currentFilespace.members.set(n,i),e.range.source.isEntry){if(this.moduleLevelExports.has(n))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,this.moduleLevelExports.get(n).internalName);i.set(o.CommonFlags.MODULE_EXPORT),this.moduleLevelExports.set(n,i)}}for(var a=e.values,s=0,p=a.length;s<p;++s)this.initializeEnumValue(a[s],i);this.checkGlobalOptions(i,e)}},t.prototype.initializeEnumValue=function(e,t){var r=e.name.text,n=e.fileLevelInternalName;if(t.members){if(t.members.has(r))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,n)}else t.members=new Map;var i=new C(t,this,r,n,e);t.members.set(r,i),t.is(o.CommonFlags.MODULE_EXPORT)&&i.set(o.CommonFlags.MODULE_EXPORT)},t.prototype.initializeExports=function(e,t){var r=e.members;if(r)for(var n=0,i=r.length;n<i;++n)this.initializeExport(r[n],e.internalPath,t);else this.error(c.DiagnosticCode.Operation_not_supported,e.range)},t.prototype.setExportAndCheckLibrary=function(e,t,r){this.fileLevelExports.set(e,t);var n=r.range.source.internalPath,i=o.FILESPACE_PREFIX+n,a=this.elementsLookup.get(i);a||(a=assert(this.elementsLookup.get(i+o.PATH_DELIMITER+"index"))),assert(a.kind==y.FILESPACE);var s=r.text;a.members.set(s,t),r.range.source.isLibrary&&(this.elementsLookup.has(s)?this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,r.range,s):(t.internalName=s,this.elementsLookup.set(s,t)))},t.prototype.initializeExport=function(e,t,r){var n,i,a,s=e.range.source.internalPath+o.PATH_DELIMITER+e.externalName.text;if(this.fileLevelExports.has(s))this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalName.range,s);else if(null==t){if(n=e.range.source.internalPath+o.PATH_DELIMITER+e.name.text,i=this.elementsLookup.get(n))return void this.setExportAndCheckLibrary(s,i,e.externalName);if(r.has(s))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalName.range,s);(a=new d).isReExport=!1,a.externalName=n,a.member=e,r.set(s,a)}else{if(n=t+o.PATH_DELIMITER+e.name.text,i=this.elementsLookup.get(n))return void this.setExportAndCheckLibrary(s,i,e.externalName);for(var p=new Set;a=r.get(n);){if(!a.isReExport){if(i=this.elementsLookup.get(a.externalName))return void this.setExportAndCheckLibrary(s,i,e.externalName);break}if(i=this.fileLevelExports.get(a.externalName))return void this.setExportAndCheckLibrary(s,i,e.externalName);if(n=a.externalName,p.has(a))break;p.add(a)}if(r.has(s))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.externalName.range,s);(a=new d).isReExport=!0,a.externalName=n,a.member=e,r.set(s,a)}},t.prototype.initializeFunction=function(e,t){void 0===t&&(t=null);var r=e.fileLevelInternalName;if(this.elementsLookup.has(r))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);else{var n=e.name.text,i=e.decorators,a=new k(this,n,r,e,null,i?this.filterDecorators(i,g.GLOBAL|g.INLINE|g.EXTERNAL):g.NONE);if(a.parent=t,this.elementsLookup.set(r,a),t){if(t.members){if(t.members.has(n))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(n,a),t.is(o.CommonFlags.MODULE_EXPORT)&&a.is(o.CommonFlags.EXPORT)&&(a.parent=t,a.set(o.CommonFlags.MODULE_EXPORT))}else if(a.is(o.CommonFlags.EXPORT)){if(this.fileLevelExports.has(r))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);if(this.fileLevelExports.set(r,a),this.currentFilespace.members.set(n,a),e.range.source.isEntry){if(this.moduleLevelExports.has(n))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,this.moduleLevelExports.get(n).internalName);a.set(o.CommonFlags.MODULE_EXPORT),this.moduleLevelExports.set(n,a)}}this.checkGlobalOptions(a,e)}},t.prototype.initializeImports=function(e,t,r){var n=e.declarations;if(n)for(var i=0,a=n.length;i<a;++i)this.initializeImport(n[i],e.internalPath,t,r);else if(e.namespaceName){var s=e.namespaceName.text,p=e.range.source.internalPath+o.PATH_DELIMITER+s;if(this.elementsLookup.has(p))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.namespaceName.range,p);var l=this.elementsLookup.get(e.internalPath);if(l)return void this.elementsLookup.set(p,l);var u=new h;u.localName=p;var d=o.FILESPACE_PREFIX+e.internalPath;u.externalName=d,u.externalNameAlt=d+o.PATH_DELIMITER+"index",u.declaration=null,r.push(u)}},t.prototype.initializeImport=function(e,t,r,n){var i=e.fileLevelInternalName;if(this.elementsLookup.has(i))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,i);else{var a,s=t+o.PATH_DELIMITER+e.externalName.text;if(a=this.fileLevelExports.get(s))this.elementsLookup.set(i,a);else{var p=o.PATH_DELIMITER+"index",l=new h;l.localName=i,t.endsWith(p)?(l.externalName=s,l.externalNameAlt=t.substring(0,t.length-p.length+1)+e.externalName.text):(l.externalName=s,l.externalNameAlt=t+p+o.PATH_DELIMITER+e.externalName.text),l.declaration=e,n.push(l)}}},t.prototype.initializeInterface=function(e,t){void 0===t&&(t=null);var r=e.fileLevelInternalName;if(this.elementsLookup.has(r))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);else{var n=e.decorators,i=e.name.text,a=new w(this,i,r,e,n?this.filterDecorators(n,g.GLOBAL):g.NONE);if(a.parent=t,this.elementsLookup.set(r,a),t){if(t.members){if(t.members.has(a.internalName))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r)}else t.members=new Map;t.members.set(a.internalName,a),t.is(o.CommonFlags.MODULE_EXPORT)&&a.is(o.CommonFlags.EXPORT)&&a.set(o.CommonFlags.MODULE_EXPORT)}else if(a.is(o.CommonFlags.EXPORT)){if(this.fileLevelExports.has(r))return void this.error(c.DiagnosticCode.Export_declaration_conflicts_with_exported_declaration_of_0,e.name.range,r);if(this.fileLevelExports.set(r,a),this.currentFilespace.members.set(i,a),e.range.source.isEntry){if(this.moduleLevelExports.has(i))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,this.moduleLevelExports.get(i).internalName);a.set(o.CommonFlags.MODULE_EXPORT),this.moduleLevelExports.set(i,a)}}for(var s=e.members,p=0,u=s.length;p<u;++p){var h=s[p];switch(h.kind){case l.NodeKind.FIELDDECLARATION:this.initializeField(h,a);break;case l.NodeKind.METHODDECLARATION:h.isAny(o.CommonFlags.GET|o.CommonFlags.SET)?this.initializeAccessor(h,a):this.initializeMethod(h,a);break;default:throw new Error("interface member expected")}}this.checkGlobalOptions(a,e)}},t.prototype.initializeNamespace=function(e,t,r,n){void 0===n&&(n=null);var i=e.fileLevelInternalName,a=e.name.text,s=this.elementsLookup.get(i);if(s||((s=new A(this,a,i,e)).parent=n,this.elementsLookup.set(i,s),this.checkGlobalOptions(s,e)),n){if(n.members){if(n.members.has(a))return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,i)}else n.members=new Map;n.members.set(a,s),n.is(o.CommonFlags.MODULE_EXPORT)&&s.is(o.CommonFlags.EXPORT)&&s.set(o.CommonFlags.MODULE_EXPORT)}else if(s.is(o.CommonFlags.EXPORT)){var p=this.fileLevelExports.get(i);if(p?(p.is(o.CommonFlags.EXPORT)||this.error(c.DiagnosticCode.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local,e.name.range,s.internalName),s=p):this.fileLevelExports.set(i,s),this.currentFilespace.members.set(a,s),e.range.source.isEntry){if(this.moduleLevelExports.has(a)){if(this.moduleLevelExports.get(a)!==s)return void this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,this.moduleLevelExports.get(a).internalName)}else this.moduleLevelExports.set(a,s);s.set(o.CommonFlags.MODULE_EXPORT)}}for(var u=e.members,h=0,d=u.length;h<d;++h)switch(u[h].kind){case l.NodeKind.CLASSDECLARATION:this.initializeClass(u[h],t,r,s);break;case l.NodeKind.ENUMDECLARATION:this.initializeEnum(u[h],s);break;case l.NodeKind.FUNCTIONDECLARATION:this.initializeFunction(u[h],s);break;case l.NodeKind.INTERFACEDECLARATION:this.initializeInterface(u[h],s);break;case l.NodeKind.NAMESPACEDECLARATION:this.initializeNamespace(u[h],t,r,s);break;case l.NodeKind.TYPEDECLARATION:this.error(c.DiagnosticCode.Operation_not_supported,u[h].range);break;case l.NodeKind.VARIABLE:this.initializeVariables(u[h],s);break;default:throw new Error("namespace member expected")}},t.prototype.initializeTypeAlias=function(e,t){void 0===t&&(t=null);var r=e.name.text;if(this.typesLookup.has(r)||this.typeAliases.has(r))this.error(c.DiagnosticCode.Duplicate_identifier_0,e.name.range,r);else{var n=new _;n.typeParameters=e.typeParameters,n.type=e.type,this.typeAliases.set(r,n)}},t.prototype.initializeVariables=function(e,t){void 0===t&&(t=null);for(var r=e.declarations,n=0,i=r.length;n<i;++n){var a=r[n],s=a.decorators,l=a.fileLevelInternalName;if(this.elementsLookup.has(l))this.error(c.DiagnosticCode.Duplicate_identifier_0,a.name.range,l);else{var u=a.name.text,h=new S(this,u,l,p.Type.void,a,s?this.filterDecorators(s,g.GLOBAL|g.EXTERNAL):g.NONE);if(h.parent=t,this.elementsLookup.set(l,h),t){if(t.members){if(t.members.has(u)){this.error(c.DiagnosticCode.Duplicate_identifier_0,a.name.range,l);continue}}else t.members=new Map;t.members.set(u,h),t.is(o.CommonFlags.MODULE_EXPORT)&&h.is(o.CommonFlags.EXPORT)&&h.set(o.CommonFlags.MODULE_EXPORT)}else if(h.is(o.CommonFlags.EXPORT)&&(this.fileLevelExports.has(l)?this.error(c.DiagnosticCode.Duplicate_identifier_0,a.name.range,l):this.fileLevelExports.set(l,h),this.currentFilespace.members.set(u,h),a.range.source.isEntry)){if(this.moduleLevelExports.has(u)){this.error(c.DiagnosticCode.Duplicate_identifier_0,a.name.range,this.moduleLevelExports.get(u).internalName);continue}h.set(o.CommonFlags.MODULE_EXPORT),this.moduleLevelExports.set(u,h)}this.checkGlobalOptions(h,a)}}},t.prototype.resolveSignature=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=!0);var n=e.explicitThisType,i=null;if(n&&!(i=this.resolveType(n,t,r)))return null;for(var a=e.parameters,s=a.length,o=new Array(s),c=new Array(s),u=0,h=!1,d=0;d<s;++d){var _=a[d];switch(_.parameterKind){case l.ParameterKind.DEFAULT:u=d+1;break;case l.ParameterKind.REST:assert(d==s),h=!0}var m=this.resolveType(assert(_.type),t,r);if(!m)return null;o[d]=m,c[d]=_.name.text}var y,g=e.returnType;if(g){if(!(y=this.resolveType(g,t,r)))return null}else y=p.Type.void;var T=new p.Signature(o,y,i);return T.parameterNames=c,T.requiredParameters=u,T.hasRest=h,T},t.prototype.resolveType=function(e,t,r){if(void 0===t&&(t=null),void 0===r&&(r=!0),e.kind==l.NodeKind.SIGNATURE){var n=this.resolveSignature(e,t,r);return n?e.isNullable?n.type.asNullable():n.type:null}var i,a=e,s=a.name.text,u=s,h=a.range.source.internalPath+o.PATH_DELIMITER+s;if((i=this.elementsLookup.get(h))||(i=this.elementsLookup.get(u)))switch(i.kind){case y.ENUM:return p.Type.i32;case y.CLASS_PROTOTYPE:var d=i.resolveUsingTypeArguments(a.typeArguments,t,null);return d?e.isNullable?d.type.asNullable():d.type:null}var _,m=this.typeAliases.get(s);if(m)return this.resolveType(m.type,t,r);if(a.typeArguments){for(var g=a.typeArguments.length,T=new Array(g),E=0;E<g;++E){var f=this.resolveType(a.typeArguments[E],t,r);if(!f)return null;T[E]=f}if(g){var I=p.typesToString(T);I.length&&(h+="<"+I+">",u+="<"+I+">")}else if(t){var v=t.get(u);if(v)return v}}return(_=this.typesLookup.get(h))||(_=this.typesLookup.get(u))?_:(r&&this.error(c.DiagnosticCode.Cannot_find_name_0,a.name.range,u),null)},t.prototype.resolveTypeArguments=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.length,a=t?t.length:0;if(i!=a)return a?this.error(c.DiagnosticCode.Expected_0_type_arguments_but_got_1,l.Range.join(t[0].range,t[a-1].range),i.toString(10),a.toString(10)):n&&this.error(c.DiagnosticCode.Expected_0_type_arguments_but_got_1,n.range.atEnd,i.toString(10),"0"),null;for(var s=new Array(i),o=0;o<i;++o){var p=this.resolveType(t[o],r,!0);if(!p)return null;s[o]=p}return s},t.prototype.resolveIdentifier=function(e,t,r){void 0===r&&(r=null);var n,i,a=e.text;if(r){if(r.members&&(n=r.members.get(a))&&n.kind==y.ENUMVALUE)return this.resolvedThisExpression=null,this.resolvedElementExpression=null,n}else if(t){if(n=t.flow.getScopedLocal(a))return this.resolvedThisExpression=null,this.resolvedElementExpression=null,n;if(i=t.prototype.parent)do{if(n=this.elementsLookup.get(i.internalName+o.STATIC_DELIMITER+a))return this.resolvedThisExpression=null,this.resolvedElementExpression=null,n}while(i=i.parent)}return(n=this.elementsLookup.get(e.range.source.internalPath+o.PATH_DELIMITER+a))?(this.resolvedThisExpression=null,this.resolvedElementExpression=null,n):(n=this.elementsLookup.get(a))?(this.resolvedThisExpression=null,this.resolvedElementExpression=null,n):(this.error(c.DiagnosticCode.Cannot_find_name_0,e.range,a),null)},t.prototype.resolvePropertyAccess=function(e,t){var r=e.expression,n=this.resolveExpression(r,t);if(!n)return null;var i=e.property.text;switch(n.kind){case y.GLOBAL:case y.LOCAL:case y.FIELD:if(!(a=n.type.classReference))return this.error(c.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,i,n.type.toString()),null;n=a;break;case y.PROPERTY:var a,o=assert(n.getterPrototype).resolve();if(!o)return null;if(!(a=o.signature.returnType.classReference))return this.error(c.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,i,o.signature.returnType.toString()),null;n=a;break;case y.CLASS:var p=this.resolvedElementExpression;if(p){var l=n.lookupOverload(s.INDEXED_GET);if(!l)return this.error(c.DiagnosticCode.Index_signature_is_missing_in_type_0,p.range,n.internalName),null;var u=l.signature.returnType;if(!(n=u.classReference))return this.error(c.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,i,u.toString()),null}}switch(n.kind){case y.CLASS_PROTOTYPE:case y.CLASS:for(;;){var h=void 0;if((d=n.members)&&(h=d.get(i)))return this.resolvedThisExpression=r,this.resolvedElementExpression=null,h;if(n.kind==y.CLASS_PROTOTYPE){if(!n.basePrototype)break;n=n.basePrototype}else{if(n.kind!=y.CLASS)break;if(!n.base)break;n=n.base}}break;default:var d;if(d=n.members)if(h=d.get(i))return this.resolvedThisExpression=r,this.resolvedElementExpression=null,h}return this.error(c.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.property.range,i,n.internalName),null},t.prototype.resolveElementAccess=function(e,t){var r=e.expression,n=this.resolveExpression(r,t);if(!n)return null;switch(n.kind){case y.GLOBAL:case y.LOCAL:case y.FIELD:if(n=n.type.classReference)return this.resolvedThisExpression=r,this.resolvedElementExpression=e.elementExpression,n;break;case y.CLASS:var i=n.lookupOverload(s.INDEXED_GET);if(!i)return this.error(c.DiagnosticCode.Index_signature_is_missing_in_type_0,e.range,n.internalName),null;if(n=i.signature.returnType.classReference)return this.resolvedThisExpression=r,this.resolvedElementExpression=e.elementExpression,n}return this.error(c.DiagnosticCode.Operation_not_supported,r.range),null},t.prototype.resolveExpression=function(e,t){for(;e.kind==l.NodeKind.PARENTHESIZED;)e=e.expression;switch(e.kind){case l.NodeKind.ASSERTION:var r=this.resolveType(e.toType);if(r)if(p=r.classReference)return this.resolvedThisExpression=null,this.resolvedElementExpression=null,p;return null;case l.NodeKind.BINARY:throw new Error("not implemented");case l.NodeKind.THIS:if(t.flow.is(2048))if(n=t.flow.getScopedLocal("this"))return this.resolvedThisExpression=null,this.resolvedElementExpression=null,n;return(i=t.parent)?(this.resolvedThisExpression=null,this.resolvedElementExpression=null,i):(this.error(c.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),null);case l.NodeKind.SUPER:var n,i;if(t.flow.is(2048))if(n=t.flow.getScopedLocal("super"))return this.resolvedThisExpression=null,this.resolvedElementExpression=null,n;return(i=t.parent)&&i.kind==y.CLASS&&(i=i.base)?(this.resolvedThisExpression=null,this.resolvedElementExpression=null,i):(this.error(c.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),null);case l.NodeKind.IDENTIFIER:return this.resolveIdentifier(e,t);case l.NodeKind.LITERAL:switch(e.literalKind){case l.LiteralKind.STRING:return this.resolvedThisExpression=e,this.resolvedElementExpression=null,this.stringInstance}break;case l.NodeKind.PROPERTYACCESS:return this.resolvePropertyAccess(e,t);case l.NodeKind.ELEMENTACCESS:return this.resolveElementAccess(e,t);case l.NodeKind.CALL:var a=e.expression,s=this.resolveExpression(a,t);if(!s)return null;if(s.kind==y.FUNCTION_PROTOTYPE){var o=s.resolveUsingTypeArguments(e.typeArguments,t.flow.contextualTypeArguments,e);if(!o)return null;var p,u=o.signature.returnType;if(p=u.classReference)return p;var h=u.signatureReference;if(h){var d=h.cachedFunctionTarget;return d||(d=new x(this,h),h.cachedFunctionTarget=d),d}return this.error(c.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,a.range,s.internalName),null}}return this.error(c.DiagnosticCode.Operation_not_supported,e.range),null},t}(c.DiagnosticEmitter);function f(e){switch(e){case l.DecoratorKind.GLOBAL:return g.GLOBAL;case l.DecoratorKind.OPERATOR:case l.DecoratorKind.OPERATOR_BINARY:return g.OPERATOR_BINARY;case l.DecoratorKind.OPERATOR_PREFIX:return g.OPERATOR_PREFIX;case l.DecoratorKind.OPERATOR_POSTFIX:return g.OPERATOR_POSTFIX;case l.DecoratorKind.UNMANAGED:return g.UNMANAGED;case l.DecoratorKind.SEALED:return g.SEALED;case l.DecoratorKind.INLINE:return g.INLINE;case l.DecoratorKind.EXTERNAL:return g.EXTERNAL;default:return g.NONE}}t.Program=E,function(e){e[e.GLOBAL=0]="GLOBAL",e[e.LOCAL=1]="LOCAL",e[e.ENUM=2]="ENUM",e[e.ENUMVALUE=3]="ENUMVALUE",e[e.FUNCTION_PROTOTYPE=4]="FUNCTION_PROTOTYPE",e[e.FUNCTION=5]="FUNCTION",e[e.FUNCTION_TARGET=6]="FUNCTION_TARGET",e[e.CLASS_PROTOTYPE=7]="CLASS_PROTOTYPE",e[e.CLASS=8]="CLASS",e[e.INTERFACE_PROTOTYPE=9]="INTERFACE_PROTOTYPE",e[e.INTERFACE=10]="INTERFACE",e[e.FIELD_PROTOTYPE=11]="FIELD_PROTOTYPE",e[e.FIELD=12]="FIELD",e[e.PROPERTY=13]="PROPERTY",e[e.NAMESPACE=14]="NAMESPACE",e[e.FILESPACE=15]="FILESPACE"}(y=t.ElementKind||(t.ElementKind={})),function(e){e[e.NONE=0]="NONE",e[e.GLOBAL=1]="GLOBAL",e[e.OPERATOR_BINARY=2]="OPERATOR_BINARY",e[e.OPERATOR_PREFIX=4]="OPERATOR_PREFIX",e[e.OPERATOR_POSTFIX=8]="OPERATOR_POSTFIX",e[e.UNMANAGED=16]="UNMANAGED",e[e.SEALED=32]="SEALED",e[e.INLINE=64]="INLINE",e[e.EXTERNAL=128]="EXTERNAL"}(g=t.DecoratorFlags||(t.DecoratorFlags={})),t.decoratorKindToFlag=f;var I=function(){function e(e,t,r){this.flags=o.CommonFlags.NONE,this.decoratorFlags=g.NONE,this.members=null,this.parent=null,this.program=e,this.simpleName=t,this.internalName=r}return e.prototype.is=function(e){return(this.flags&e)==e},e.prototype.isAny=function(e){return 0!=(this.flags&e)},e.prototype.set=function(e){this.flags|=e},e.prototype.hasDecorator=function(e){return(this.decoratorFlags&e)==e},e}();t.Element=I;var v=function(e){function t(t,r){var n=e.call(this,t,r.internalPath,o.FILESPACE_PREFIX+r.internalPath)||this;return n.kind=y.FILESPACE,n.members=new Map,n}return n(t,e),t}(I);t.Filespace=v;var A=function(e){function t(t,r,n,i){var a=e.call(this,t,r,n)||this;return a.kind=y.NAMESPACE,a.declaration=i,a.flags=i.flags,a}return n(t,e),t}(I);t.Namespace=A;var N=function(e){function t(t,r,n,i){var a=e.call(this,t,r,n)||this;return a.kind=y.ENUM,a.declaration=i,a.flags=i.flags,a}return n(t,e),t}(I);t.Enum=N;var C=function(e){function t(t,r,n,i,a){var s=e.call(this,r,n,i)||this;return s.kind=y.ENUMVALUE,s.constantValue=0,s.parent=t,s.declaration=a,s}return n(t,e),t}(I);t.EnumValue=C,function(e){e[e.NONE=0]="NONE",e[e.INTEGER=1]="INTEGER",e[e.FLOAT=2]="FLOAT"}(t.ConstantValueKind||(t.ConstantValueKind={}));var O=function(e){function t(t,r,n,i,a){var s=e.call(this,t,r,n)||this;return s.constantValueKind=0,s.type=i,s.declaration=a,s}return n(t,e),t.prototype.withConstantIntegerValue=function(e,t){return this.constantValueKind=1,this.constantIntegerValue=i64_new(e,t),this.set(o.CommonFlags.CONST|o.CommonFlags.INLINED),this},t.prototype.withConstantFloatValue=function(e){return this.constantValueKind=2,this.constantFloatValue=e,this.set(o.CommonFlags.CONST|o.CommonFlags.INLINED),this},t}(I);t.VariableLikeElement=O;var S=function(e){function t(t,r,n,i,a,s){var c=e.call(this,t,r,n,i,a)||this;return c.kind=y.GLOBAL,c.flags=a?a.flags:o.CommonFlags.NONE,c.decoratorFlags=s,c.type=i,c}return n(t,e),t}(O);t.Global=S;var L=function(){return function(e,t,r){void 0===r&&(r=null),this.name=e,this.type=t,this.initializer=r}}();t.Parameter=L;var b=function(e){function t(t,r,n,i,a){void 0===a&&(a=null);var s=e.call(this,t,r,r,i,a)||this;return s.kind=y.LOCAL,s.scopedGlobal=null,s.index=n,s}return n(t,e),t}(O);t.Local=b;var k=function(e){function t(t,r,n,i,a,o){void 0===a&&(a=null),void 0===o&&(o=g.NONE);var c=e.call(this,t,r,n)||this;return c.kind=y.FUNCTION_PROTOTYPE,c.instances=new Map,c.classTypeArguments=null,c.operatorKind=s.INVALID,c.declaration=i,c.flags=i.flags,c.classPrototype=a,c.decoratorFlags=o,c}return n(t,e),t.prototype.resolve=function(e,t){var r,n;void 0===e&&(e=null),void 0===t&&(t=null);var s=e?p.typesToString(e):"",c=this.instances.get(s);if(c)return c;var u=this.declaration,h=this.is(o.CommonFlags.INSTANCE),d=this.classPrototype,_=t;if(t=new Map,_)try{for(var m=i(_),y=m.next();!y.done;y=m.next()){var g=a(y.value,2),T=g[0],E=g[1];t.set(T,E)}}catch(e){r={error:e}}finally{try{y&&!y.done&&(n=m.return)&&n.call(m)}finally{if(r)throw r.error}}var f=this.classTypeArguments;if(f){assert(this.is(o.CommonFlags.INSTANCE));var I=assert(d).declaration.typeParameters,v=I.length;assert(v==f.length);for(var A=0;A<v;++A)t.set(I[A].name.text,f[A])}else assert(!f);var N,C=u.signature,O=u.typeParameters;if(e&&(N=e.length)){assert(O&&N==O.length);for(A=0;A<N;++A)t.set(O[A].name.text,e[A])}else assert(!O||0==O.length);var S=null,L=null;if(h){if(!(S=assert(d).resolve(f,t)))return null;L=S.type,t.set("this",L)}var b,k=C.parameters,x=k.length,F=new Array(x),B=new Array(x),U=0;for(A=0;A<x;++A){var D=k[A];D.parameterKind==l.ParameterKind.DEFAULT&&(U=A+1);var P=assert(D.type),w=this.program.resolveType(P,t,!0);if(!w)return null;F[A]=w,B[A]=D.name.text}if(this.is(o.CommonFlags.SET))b=p.Type.void;else if(this.is(o.CommonFlags.CONSTRUCTOR))b=assert(S).type;else{P=assert(C.returnType);var M=this.program.resolveType(P,t,!0);if(!M)return null;b=M}var G=new p.Signature(F,b,L);G.parameterNames=B,G.requiredParameters=U;var K=this.internalName;return s.length&&(K+="<"+s+">"),c=new R(this,K,G,S||d,t),this.instances.set(s,c),this.program.instancesLookup.set(K,c),c},t.prototype.resolvePartial=function(e){assert(this.is(o.CommonFlags.INSTANCE));var r=assert(this.classPrototype);if(!e||!e.length)return this;var n=this.simpleName,i=p.typesToString(e),a=new t(this.program,n,r.internalName+"<"+i+">"+o.INSTANCE_DELIMITER+n,this.declaration,r,this.decoratorFlags);return a.flags=this.flags,a.operatorKind=this.operatorKind,a.classTypeArguments=e,a},t.prototype.resolveUsingTypeArguments=function(e,t,r){var n=null;return!this.is(o.CommonFlags.GENERIC)||(assert(null!=e&&0!=e.length),n=this.program.resolveTypeArguments(assert(this.declaration.typeParameters),e,t,r))?this.resolve(n,t):null},t.prototype.resolveBuiltinTypeArguments=function(e,t){assert(this.is(o.CommonFlags.BUILTIN));var r=null;if(e){var n=e.length;r=new Array(n);for(var i=0;i<n;++i){var a=this.program.resolveType(e[i],t,!0);if(!a)return null;r[i]=a}}return r},t.prototype.toString=function(){return this.simpleName},t}(I);t.FunctionPrototype=k;var R=function(e){function t(t,r,n,s,c){var p,l;void 0===s&&(s=null),void 0===c&&(c=null);var u=e.call(this,t.program,t.simpleName,r)||this;if(u.kind=y.FUNCTION,u.localsByName=new Map,u.localsByIndex=[],u.additionalLocals=[],u.breakContext=null,u.debugLocations=[],u.ref=0,u.functionTableIndex=-1,u.trampoline=null,u.outerScope=null,u.nextBreakId=0,u.breakStack=null,u.nextInlineId=0,u.tempI32s=null,u.tempI64s=null,u.tempF32s=null,u.tempF64s=null,u.prototype=t,u.signature=n,u.parent=s,u.flags=t.flags,u.decoratorFlags=t.decoratorFlags,u.contextualTypeArguments=c,!t.is(o.CommonFlags.AMBIENT|o.CommonFlags.BUILTIN)&&!t.is(o.CommonFlags.DECLARE)){var h=0;if(s&&s.kind==y.CLASS){assert(u.is(o.CommonFlags.INSTANCE));var d=new b(t.program,"this",h++,assert(n.thisType));u.localsByName.set("this",d),u.localsByIndex[d.index]=d;var _=s.contextualTypeArguments;if(_){u.contextualTypeArguments||(u.contextualTypeArguments=new Map);try{for(var m=i(_),g=m.next();!g.done;g=m.next()){var T=a(g.value,2),E=T[0],f=T[1];u.contextualTypeArguments.has(E)||u.contextualTypeArguments.set(E,f)}}catch(e){p={error:e}}finally{try{g&&!g.done&&(l=m.return)&&l.call(m)}finally{if(p)throw p.error}}}}else assert(!u.is(o.CommonFlags.INSTANCE));for(var I=n.parameterTypes,v=0,A=I.length;v<A;++v){var N=I[v],C=n.getParameterName(v);d=new b(t.program,C,h++,N);u.localsByName.set(C,d),u.localsByIndex[d.index]=d}}return u.flow=G.create(u),u}return n(t,e),t.prototype.addLocal=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=this.signature.parameterTypes.length+this.additionalLocals.length;this.is(o.CommonFlags.INSTANCE)&&++n;var i=new b(this.prototype.program,t||"var$"+n.toString(10),n,e,r);if(t){if(this.localsByName.has(t))throw new Error("duplicate local name");this.localsByName.set(t,i)}return this.localsByIndex[i.index]=i,this.additionalLocals.push(e),i},t.prototype.getTempLocal=function(e,t){var r,n;switch(void 0===t&&(t=!1),e.toNativeType()){case u.NativeType.I32:r=this.tempI32s;break;case u.NativeType.I64:r=this.tempI64s;break;case u.NativeType.F32:r=this.tempF32s;break;case u.NativeType.F64:r=this.tempF64s;break;default:throw new Error("concrete type expected")}return r&&r.length?((n=r.pop()).type=e,n.flags=o.CommonFlags.NONE):n=this.addLocal(e),e.is(36)&&this.flow.setLocalWrapped(n.index,t),n},t.prototype.freeTempLocal=function(e){if(!e.is(o.CommonFlags.INLINED)){var t;switch(assert(e.index>=0),assert(null!=e.type),e.type.toNativeType()){case u.NativeType.I32:t=this.tempI32s||(this.tempI32s=[]);break;case u.NativeType.I64:t=this.tempI64s||(this.tempI64s=[]);break;case u.NativeType.F32:t=this.tempF32s||(this.tempF32s=[]);break;case u.NativeType.F64:t=this.tempF64s||(this.tempF64s=[]);break;default:throw new Error("concrete type expected")}assert(e.index>=0),t.push(e)}},t.prototype.getAndFreeTempLocal=function(e,t){var r,n;switch(e.toNativeType()){case u.NativeType.I32:r=this.tempI32s||(this.tempI32s=[]);break;case u.NativeType.I64:r=this.tempI64s||(this.tempI64s=[]);break;case u.NativeType.F32:r=this.tempF32s||(this.tempF32s=[]);break;case u.NativeType.F64:r=this.tempF64s||(this.tempF64s=[]);break;default:throw new Error("concrete type expected")}return r.length?(n=r[r.length-1]).type=e:(n=this.addLocal(e),r.push(n)),e.is(36)&&this.flow.setLocalWrapped(n.index,t),n},t.prototype.enterBreakContext=function(){var e=this.nextBreakId++;return this.breakStack?this.breakStack.push(e):this.breakStack=[e],this.breakContext=e.toString(10)},t.prototype.leaveBreakContext=function(){assert(null!=this.breakStack);var e=this.breakStack.length;assert(e>0),this.breakStack.pop(),e>1?this.breakContext=this.breakStack[e-2].toString(10):(this.breakContext=null,this.breakStack=null)},t.prototype.finalize=function(e,t){if(this.ref=t,assert(!this.breakStack||!this.breakStack.length),this.breakStack=null,this.breakContext=null,this.tempI32s=this.tempI64s=this.tempF32s=this.tempF64s=null,this.program.options.sourceMap)for(var r=this.debugLocations,n=0,i=r.length;n<i;++n){var a=r[n];e.setDebugLocation(t,a.debugInfoRef,a.source.debugInfoIndex,a.line,a.column)}},t.prototype.toString=function(){return this.prototype.simpleName},t}(I);t.Function=R;var x=function(e){function t(t,r){var n=e.call(this,t,"","")||this;n.kind=y.FUNCTION_TARGET;var i=r.toSignatureString();return n.simpleName=i,n.internalName=i,n.signature=r,n.type=p.Type.u32.asFunction(r),n}return n(t,e),t}(I);t.FunctionTarget=x;var F=function(e){function t(t,r,n,i){var a=e.call(this,t.program,r,n)||this;return a.kind=y.FIELD_PROTOTYPE,a.classPrototype=t,a.declaration=i,a.flags=i.flags,a}return n(t,e),t}(I);t.FieldPrototype=F;var B=function(e){function t(t,r,n,i,a){var s=e.call(this,t.program,t.simpleName,r,n,i)||this;return s.kind=y.FIELD,s.memoryOffset=-1,s.prototype=t,s.flags=t.flags,s.type=n,s.parent=a,s}return n(t,e),t}(O);t.Field=B;var U=function(e){function t(t,r,n,i){var a=e.call(this,t,r,n)||this;return a.kind=y.PROPERTY,a.getterPrototype=null,a.setterPrototype=null,a.parent=i,a}return n(t,e),t}(I);t.Property=U;var D=function(e){function t(t,r,n,i,a){var s=e.call(this,t,r,n)||this;return s.kind=y.CLASS_PROTOTYPE,s.instances=new Map,s.instanceMembers=null,s.basePrototype=null,s.constructorPrototype=null,s.overloadPrototypes=new Map,s.declaration=i,s.flags=i.flags,s.decoratorFlags=a,s}return n(t,e),t.prototype.resolve=function(e,t){var r,n,u,h,d,_,m,T;void 0===t&&(t=null);var E=e?p.typesToString(e):"",f=this.instances.get(E);if(f)return f;var I=t;if(t=new Map,I)try{for(var v=i(I),A=v.next();!A.done;A=v.next()){var N=a(A.value,2),C=N[0],O=N[1];t.set(C,O)}}catch(e){r={error:e}}finally{try{A&&!A.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}var S,L,b=this.declaration,k=null;if(b.extendsType){var R=this.program.resolveType(b.extendsType,null);if(!R)return null;if(!(k=R.classReference))return this.program.error(c.DiagnosticCode.A_class_may_only_extend_another_class,b.extendsType.range),null;if(k.hasDecorator(g.SEALED))return this.program.error(c.DiagnosticCode.Class_0_is_sealed_and_cannot_be_extended,b.extendsType.range,k.internalName),null;if(k.hasDecorator(g.UNMANAGED)!=this.hasDecorator(g.UNMANAGED))return this.program.error(c.DiagnosticCode.Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa,l.Range.join(b.name.range,b.extendsType.range)),null}if(e){if((L=e.length)!=b.typeParameters.length)throw new Error("type argument count mismatch");for(S=0;S<L;++S)t.set(b.typeParameters[S].name.text,e[S])}else if(b.typeParameters.length)throw new Error("type argument count mismatch");var x=this.simpleName,F=this.internalName;E.length&&(x+="<"+E+">",F+="<"+E+">"),(f=new P(this,x,F,e,k)).contextualTypeArguments=t,this.instances.set(E,f),this.program.instancesLookup.set(F,f);var D=0;if(k&&(D=k.currentMemoryOffset,k.members)){f.members||(f.members=new Map);try{for(var w=i(k.members.values()),M=w.next();!M.done;M=w.next()){var G=M.value;f.members.set(G.simpleName,G)}}catch(e){u={error:e}}finally{try{M&&!M.done&&(h=w.return)&&h.call(w)}finally{if(u)throw u.error}}}if(this.constructorPrototype){var K=this.constructorPrototype.resolvePartial(e);K&&(f.constructorInstance=K.resolve())}if(this.instanceMembers)try{for(var z=i(this.instanceMembers.values()),V=z.next();!V.done;V=z.next()){var H=V.value;switch(H.kind){case y.FIELD_PROTOTYPE:f.members||(f.members=new Map);var X=H.declaration;if(!X.type)throw new Error("type expected");var W=this.program.resolveType(X.type,f.contextualTypeArguments);if(!W)break;var Y=new B(H,F+o.INSTANCE_DELIMITER+H.simpleName,W,X,f);switch(W.byteSize){case 1:break;case 2:1&D&&++D;break;case 4:3&D&&(D=1+(3|D));break;case 8:7&D&&(D=1+(7|D));break;default:assert(!1)}Y.memoryOffset=D,D+=W.byteSize,f.members.set(H.simpleName,Y);break;case y.FUNCTION_PROTOTYPE:f.members||(f.members=new Map);var Q=H.resolvePartial(e);Q&&(Q.internalName=F+o.INSTANCE_DELIMITER+Q.simpleName,f.members.set(H.simpleName,Q));break;case y.PROPERTY:f.members||(f.members=new Map);var q=assert(H.getterPrototype),j=H.setterPrototype,Z=new U(this.program,H.simpleName,F+o.INSTANCE_DELIMITER+H.simpleName,this),$=q.resolvePartial(e);if(!$)return null;if($.internalName=F+o.INSTANCE_DELIMITER+$.simpleName,Z.getterPrototype=$,j){var J=j.resolvePartial(e);if(!J)return null;J.internalName=F+o.INSTANCE_DELIMITER+J.simpleName,Z.setterPrototype=J}f.members.set(H.simpleName,Z);break;default:assert(!1)}}}catch(e){d={error:e}}finally{try{V&&!V.done&&(_=z.return)&&_.call(z)}finally{if(d)throw d.error}}try{for(var ee=i(this.overloadPrototypes),te=ee.next();!te.done;te=ee.next()){var re=a(te.value,2),ne=re[0],ie=re[1];assert(ne!=s.INVALID);var ae=void 0;if(ie.is(o.CommonFlags.INSTANCE)){var se=ie.resolvePartial(e);if(!se)continue;ae=se.resolve()}else ae=ie.resolve();if(ae){var oe=f.overloads;oe||(f.overloads=oe=new Map),oe.set(ne,ae)}}}catch(e){m={error:e}}finally{try{te&&!te.done&&(T=ee.return)&&T.call(ee)}finally{if(m)throw m.error}}return f.currentMemoryOffset=D,f},t.prototype.resolveUsingTypeArguments=function(e,t,r){var n=null;if(this.is(o.CommonFlags.GENERIC)){if(assert(null!=e&&0!=e.length),!(n=this.program.resolveTypeArguments(this.declaration.typeParameters,e,t,r)))return null}else assert(null==e||!e.length);return this.resolve(n,t)},t.prototype.toString=function(){return this.simpleName},t}(I);t.ClassPrototype=D;var P=function(e){function t(t,r,n,s,o){var c,p;void 0===s&&(s=null),void 0===o&&(o=null);var l=e.call(this,t.program,r,n)||this;if(l.kind=y.CLASS,l.contextualTypeArguments=null,l.currentMemoryOffset=0,l.constructorInstance=null,l.overloads=null,l.prototype=t,l.flags=t.flags,l.decoratorFlags=t.decoratorFlags,l.typeArguments=s,l.type=t.program.options.usizeType.asClass(l),l.base=o,o){var u=o.contextualTypeArguments;if(u){l.contextualTypeArguments||(l.contextualTypeArguments=new Map);try{for(var h=i(u),d=h.next();!d.done;d=h.next()){var _=a(d.value,2),m=_[0],g=_[1];l.contextualTypeArguments.set(m,g)}}catch(e){c={error:e}}finally{try{d&&!d.done&&(p=h.return)&&p.call(h)}finally{if(c)throw c.error}}}}var T,E,f=l.prototype.declaration;if(f){var I=f.typeParameters;if(s){if((E=s.length)!=I.length)throw new Error("type argument count mismatch");if(E)for(l.contextualTypeArguments||(l.contextualTypeArguments=new Map),T=0;T<E;++T)l.contextualTypeArguments.set(I[T].name.text,s[T])}else if(I.length)throw new Error("type argument count mismatch")}return l}return n(t,e),t.prototype.isAssignableTo=function(e){var t=this;do{if(t==e)return!0}while(t=t.base);return!1},t.prototype.lookupOverload=function(e,t){if(void 0===t&&(t=!1),t)switch(e){case s.INDEXED_GET:if(r=this.lookupOverload(s.UNCHECKED_INDEXED_GET))return r;break;case s.INDEXED_SET:var r;if(r=this.lookupOverload(s.UNCHECKED_INDEXED_SET))return r;break;default:assert(!1)}var n=this;do{var i=n.overloads;if(i){var a=i.get(e);if(a)return a}}while(n=n.base);return null},t.prototype.toString=function(){return this.simpleName},t}(I);t.Class=P;var w=function(e){function t(t,r,n,i,a){var s=e.call(this,t,r,n,i,a)||this;return s.kind=y.INTERFACE_PROTOTYPE,s}return n(t,e),t}(D);t.InterfacePrototype=w;var M=function(e){function t(t,r,n,i,a){void 0===i&&(i=[]),void 0===a&&(a=null);var s=e.call(this,t,r,n,i,a)||this;return s.kind=y.INTERFACE,s}return n(t,e),t}(P);t.Interface=M,function(e){e[e.NONE=0]="NONE",e[e.RETURNS=1]="RETURNS",e[e.RETURNS_WRAPPED=2]="RETURNS_WRAPPED",e[e.THROWS=4]="THROWS",e[e.BREAKS=8]="BREAKS",e[e.CONTINUES=16]="CONTINUES",e[e.ALLOCATES=32]="ALLOCATES",e[e.CONDITIONALLY_RETURNS=64]="CONDITIONALLY_RETURNS",e[e.CONDITIONALLY_THROWS=128]="CONDITIONALLY_THROWS",e[e.CONDITIONALLY_BREAKS=256]="CONDITIONALLY_BREAKS",e[e.CONDITIONALLY_CONTINUES=512]="CONDITIONALLY_CONTINUES",e[e.CONDITIONALLY_ALLOCATES=1024]="CONDITIONALLY_ALLOCATES",e[e.INLINE_CONTEXT=2048]="INLINE_CONTEXT",e[e.UNCHECKED_CONTEXT=4096]="UNCHECKED_CONTEXT",e[e.ANY_TERMINATING=29]="ANY_TERMINATING",e[e.ANY_CATEGORICAL=63]="ANY_CATEGORICAL",e[e.ANY_CONDITIONAL=1984]="ANY_CONDITIONAL"}(t.FlowFlags||(t.FlowFlags={}));var G=function(){function e(){this.scopedLocals=null}return e.create=function(t){var r=new e;return r.parent=null,r.flags=0,r.currentFunction=t,r.continueLabel=null,r.breakLabel=null,r.returnLabel=null,r.returnType=t.signature.returnType,r.contextualTypeArguments=t.contextualTypeArguments,r.wrappedLocals=i64_new(0),r.wrappedLocalsExt=null,r},e.prototype.is=function(e){return(this.flags&e)==e},e.prototype.isAny=function(e){return 0!=(this.flags&e)},e.prototype.set=function(e){this.flags|=e},e.prototype.unset=function(e){this.flags&=~e},e.prototype.fork=function(){var t=new e;return t.parent=this,t.flags=this.flags,t.currentFunction=this.currentFunction,t.continueLabel=this.continueLabel,t.breakLabel=this.breakLabel,t.returnLabel=this.returnLabel,t.returnType=this.returnType,t.contextualTypeArguments=this.contextualTypeArguments,t.wrappedLocals=this.wrappedLocals,t.wrappedLocalsExt=this.wrappedLocalsExt?this.wrappedLocalsExt.slice():null,t},e.prototype.free=function(){var e,t,r=assert(this.parent);if(this.scopedLocals){try{for(var n=i(this.scopedLocals.values()),a=n.next();!a.done;a=n.next()){var s=a.value;s.is(o.CommonFlags.SCOPED)&&this.currentFunction.freeTempLocal(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.scopedLocals=null}return r},e.prototype.addScopedLocal=function(e,t,r,n){var i=this.currentFunction.getTempLocal(e,!1);if(this.scopedLocals){var a=this.scopedLocals.get(t);if(a)return n?this.currentFunction.program.error(c.DiagnosticCode.Duplicate_identifier_0,n.name.range):assert(!1),a}else this.scopedLocals=new Map;return i.set(o.CommonFlags.SCOPED),this.scopedLocals.set(t,i),e.is(36)&&this.setLocalWrapped(i.index,r),i},e.prototype.addScopedLocalAlias=function(e,t,r){if(this.scopedLocals){var n=this.scopedLocals.get(r);if(n){var i=n.declaration;return i?this.currentFunction.program.error(c.DiagnosticCode.Duplicate_identifier_0,i.name.range):assert(!1),n}}else this.scopedLocals=new Map;assert(e<this.currentFunction.localsByIndex.length);var a=new b(this.currentFunction.program,r,e,t,null);return this.scopedLocals.set(r,a),a},e.prototype.getScopedLocal=function(e){var t,r=this;do{if(r.scopedLocals&&(t=r.scopedLocals.get(e)))return t}while(r=r.parent);return this.currentFunction.localsByName.get(e)},e.prototype.isLocalWrapped=function(e){var t,r;if(e<64){if(e<0)return!0;t=this.wrappedLocals}else{if(!(r=this.wrappedLocalsExt))return!1;var n=(e-64)/64|0;if(n>=r.length)return!1;t=r[n],e-=64*(n+1)}return i64_ne(i64_and(t,i64_shl(i64_one,i64_new(e))),i64_zero)},e.prototype.setLocalWrapped=function(e,t){var r,n=-1;if(e<64){if(e<0)return;r=this.wrappedLocals}else{var i=this.wrappedLocalsExt;for(n=(e-64)/64|0,i||(this.wrappedLocalsExt=i=new Array(n+1),i.length=0);i.length<=n;)i.push(i64_new(0));r=i[n],e-=64*(n+1)}r=t?i64_or(r,i64_shl(i64_one,i64_new(e))):i64_and(r,i64_not(i64_shl(i64_one,i64_new(e)))),n>=0?this.wrappedLocalsExt[n]=r:this.wrappedLocals=r},e.prototype.inherit=function(e){this.flags|=2047&e.flags,this.wrappedLocals=e.wrappedLocals,this.wrappedLocalsExt=e.wrappedLocalsExt},e.prototype.inheritConditional=function(e){e.is(1)&&this.set(64),e.is(4)&&this.set(128),e.is(8)&&e.breakLabel==this.breakLabel&&this.set(256),e.is(16)&&e.continueLabel==this.continueLabel&&this.set(512),e.is(32)&&this.set(1024)},e.prototype.inheritMutual=function(e,t){this.flags|=e.flags&t.flags&63,this.flags|=1984&e.flags,this.flags|=1984&t.flags,this.wrappedLocals=i64_and(e.wrappedLocals,t.wrappedLocals);var r=e.wrappedLocalsExt,n=t.wrappedLocalsExt;if(null!=r&&null!=n){var i=this.wrappedLocalsExt,a=min(r.length,n.length);if(a){if(i)for(;i.length<a;)i.push(i64_new(0));else i=new Array(a);for(var s=0;s<a;++s)i[s]=i64_and(r[s],n[s])}}},e.prototype.canOverflow=function(e,t){if(assert(t!=p.Type.void),!t.is(36))return!1;var r;switch(u.getExpressionId(e)){case u.ExpressionId.GetLocal:var n=this.currentFunction,i=n.localsByIndex[u.getGetLocalIndex(e)];return!n.flow.isLocalWrapped(i.index)||K(i.type,t);case u.ExpressionId.SetLocal:return assert(u.isTeeLocal(e)),this.canOverflow(u.getSetLocalValue(e),t);case u.ExpressionId.GetGlobal:return!1;case u.ExpressionId.Binary:switch(u.getBinaryOp(e)){case u.BinaryOp.EqI32:case u.BinaryOp.EqI64:case u.BinaryOp.EqF32:case u.BinaryOp.EqF64:case u.BinaryOp.NeI32:case u.BinaryOp.NeI64:case u.BinaryOp.NeF32:case u.BinaryOp.NeF64:case u.BinaryOp.LtI32:case u.BinaryOp.LtU32:case u.BinaryOp.LtI64:case u.BinaryOp.LtU64:case u.BinaryOp.LtF32:case u.BinaryOp.LtF64:case u.BinaryOp.LeI32:case u.BinaryOp.LeU32:case u.BinaryOp.LeI64:case u.BinaryOp.LeU64:case u.BinaryOp.LeF32:case u.BinaryOp.LeF64:case u.BinaryOp.GtI32:case u.BinaryOp.GtU32:case u.BinaryOp.GtI64:case u.BinaryOp.GtU64:case u.BinaryOp.GtF32:case u.BinaryOp.GtF64:case u.BinaryOp.GeI32:case u.BinaryOp.GeU32:case u.BinaryOp.GeI64:case u.BinaryOp.GeU64:case u.BinaryOp.GeF32:case u.BinaryOp.GeF64:return!1;case u.BinaryOp.MulI32:return!(u.getExpressionId(r=u.getBinaryLeft(e))==u.ExpressionId.Const&&(0==u.getConstValueI32(r)||1==u.getConstValueI32(r)&&!this.canOverflow(u.getBinaryRight(e),t))||u.getExpressionId(r=u.getBinaryRight(e))==u.ExpressionId.Const&&(0==u.getConstValueI32(r)||1==u.getConstValueI32(r)&&!this.canOverflow(u.getBinaryLeft(e),t)));case u.BinaryOp.AndI32:return!(u.getExpressionId(r=u.getBinaryLeft(e))==u.ExpressionId.Const&&u.getConstValueI32(r)<=t.computeSmallIntegerMask(p.Type.i32)||!this.canOverflow(r,t)||u.getExpressionId(r=u.getBinaryRight(e))==u.ExpressionId.Const&&u.getConstValueI32(r)<=t.computeSmallIntegerMask(p.Type.i32)||!this.canOverflow(r,t));case u.BinaryOp.ShlI32:var a=32-t.size;return u.getExpressionId(r=u.getBinaryRight(e))!=u.ExpressionId.Const||u.getConstValueI32(r)<a;case u.BinaryOp.ShrI32:a=32-t.size;return this.canOverflow(u.getBinaryLeft(e),t)&&(u.getExpressionId(r=u.getBinaryRight(e))!=u.ExpressionId.Const||u.getConstValueI32(r)<a);case u.BinaryOp.ShrU32:a=32-t.size;return t.is(1)?!(u.getExpressionId(r=u.getBinaryRight(e))==u.ExpressionId.Const&&u.getConstValueI32(r)>a):this.canOverflow(u.getBinaryLeft(e),t)&&!(u.getExpressionId(r=u.getBinaryRight(e))==u.ExpressionId.Const&&u.getConstValueI32(r)>=a);case u.BinaryOp.DivU32:case u.BinaryOp.RemI32:case u.BinaryOp.RemU32:return this.canOverflow(u.getBinaryLeft(e),t)||this.canOverflow(u.getBinaryRight(e),t)}break;case u.ExpressionId.Unary:switch(u.getUnaryOp(e)){case u.UnaryOp.EqzI32:case u.UnaryOp.EqzI64:return!1;case u.UnaryOp.ClzI32:case u.UnaryOp.CtzI32:case u.UnaryOp.PopcntI32:return t.size<7}break;case u.ExpressionId.Const:var s=0;switch(u.getExpressionType(e)){case u.NativeType.I32:s=u.getConstValueI32(e);break;case u.NativeType.I64:s=u.getConstValueI64Low(e);break;case u.NativeType.F32:s=i32(u.getConstValueF32(e));break;case u.NativeType.F64:s=i32(u.getConstValueF64(e));break;default:assert(!1)}switch(t.kind){case 0:return s<i8.MIN_VALUE||s>i8.MAX_VALUE;case 1:return s<i16.MIN_VALUE||s>i16.MAX_VALUE;case 5:return s<0||s>u8.MAX_VALUE;case 6:return s<0||s>u16.MAX_VALUE;case 10:return 0!=(-2&s)}break;case u.ExpressionId.Load:var o=void 0;switch(u.getLoadBytes(e)){case 1:o=u.isLoadSigned(e)?p.Type.i8:p.Type.u8;break;case 2:o=u.isLoadSigned(e)?p.Type.i16:p.Type.u16;break;default:o=u.isLoadSigned(e)?p.Type.i32:p.Type.u32}return K(o,t);case u.ExpressionId.Block:if(!u.getBlockName(e)){var c=assert(u.getBlockChildCount(e)),l=u.getBlockChild(e,c-1);return this.canOverflow(l,t)}break;case u.ExpressionId.If:return this.canOverflow(u.getIfTrue(e),t)||this.canOverflow(assert(u.getIfFalse(e)),t);case u.ExpressionId.Select:return this.canOverflow(u.getSelectThen(e),t)||this.canOverflow(u.getSelectElse(e),t);case u.ExpressionId.Call:var h=this.currentFunction.program,d=assert(h.instancesLookup.get(assert(u.getCallTarget(e))));assert(d.kind==y.FUNCTION);var _=d.signature.returnType;return!d.flow.is(2)||K(_,t);case u.ExpressionId.Unreachable:return!1}return!0},e.prototype.finalize=function(){assert(null==this.parent),this.continueLabel=null,this.breakLabel=null,this.returnLabel=null,this.contextualTypeArguments=null},e}();function K(e,t){var r=e.byteSize,n=t.byteSize;return!e.is(4)||r>n||e.is(1)!=t.is(1)}t.Flow=G},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);!function(e){e[e.I8=0]="I8",e[e.I16=1]="I16",e[e.I32=2]="I32",e[e.I64=3]="I64",e[e.ISIZE=4]="ISIZE",e[e.U8=5]="U8",e[e.U16=6]="U16",e[e.U32=7]="U32",e[e.U64=8]="U64",e[e.USIZE=9]="USIZE",e[e.BOOL=10]="BOOL",e[e.F32=11]="F32",e[e.F64=12]="F64",e[e.VOID=13]="VOID"}(t.TypeKind||(t.TypeKind={})),function(e){e[e.NONE=0]="NONE",e[e.SIGNED=1]="SIGNED",e[e.UNSIGNED=2]="UNSIGNED",e[e.INTEGER=4]="INTEGER",e[e.FLOAT=8]="FLOAT",e[e.POINTER=16]="POINTER",e[e.SHORT=32]="SHORT",e[e.LONG=64]="LONG",e[e.VALUE=128]="VALUE",e[e.REFERENCE=256]="REFERENCE",e[e.NULLABLE=512]="NULLABLE"}(t.TypeFlags||(t.TypeFlags={}));var i=function(){function e(e,t,r){this.cachedNullableType=null,this.kind=e,this.flags=t,this.size=r,this.byteSize=ceil(r/8),this.classReference=null,this.signatureReference=null,this.nonNullableType=this}return Object.defineProperty(e.prototype,"intType",{get:function(){switch(this.kind){case 0:return e.i8;case 1:return e.i16;case 11:case 2:return e.i32;case 12:case 3:return e.i64;case 4:return 64==this.size?e.isize64:e.isize32;case 5:return e.u8;case 6:return e.u16;case 7:return e.u32;case 8:return e.u64;case 9:return 64==this.size?e.usize64:e.usize32;case 10:default:return e.i32}},enumerable:!0,configurable:!0}),e.prototype.computeSmallIntegerShift=function(e){return e.size-this.size},e.prototype.computeSmallIntegerMask=function(e){var t=this.is(2)?this.size:this.size-1;return-1>>>e.size-t},e.prototype.is=function(e){return(this.flags&e)==e},e.prototype.isAny=function(e){return 0!=(this.flags&e)},e.prototype.asClass=function(t){assert(9==this.kind&&!this.classReference);var r=new e(this.kind,-129&this.flags|256,this.size);return r.classReference=t,r},e.prototype.asFunction=function(t){assert(7==this.kind&&!this.signatureReference);var r=new e(this.kind,-129&this.flags|256,this.size);return r.signatureReference=t,r},e.prototype.asNullable=function(){return assert(this.is(256)),this.cachedNullableType||(assert(!this.is(512)),this.cachedNullableType=new e(this.kind,512|this.flags,this.size),this.cachedNullableType.nonNullableType=this,this.cachedNullableType.classReference=this.classReference,this.cachedNullableType.signatureReference=this.signatureReference),this.cachedNullableType},e.prototype.isAssignableTo=function(e,t){var r,n,i,a;if(void 0===t&&(t=!1),this.is(256)){if(e.is(256)&&(!this.is(512)||e.is(512)))if(r=this.classReference){if(n=e.classReference)return r.isAssignableTo(n)}else if((i=this.signatureReference)&&(a=e.signatureReference))return i.isAssignableTo(a)}else if(!e.is(256))if(this.is(4))if(e.is(4)){if(!t||this.is(1)==e.is(1))return this.size<=e.size}else{if(11==e.kind)return this.size<=23;if(12==e.kind)return this.size<=52}else if(this.is(8)&&e.is(8))return this.size<=e.size;return!1},e.commonCompatible=function(e,t,r){return t.isAssignableTo(e,r)?e:e.isAssignableTo(t,r)?t:null},e.prototype.toString=function(e){if(void 0===e&&(e=!1),!e&&this.is(256)){var t=this.classReference;if(t)return this.is(512)?t.toString()+" | null":t.toString();var r=this.signatureReference;if(r)return this.is(512)?"("+r.toString(!0)+") | null":r.toString(!0);assert(!1)}switch(this.kind){case 0:return"i8";case 1:return"i16";case 2:return"i32";case 3:return"i64";case 4:return"isize";case 5:return"u8";case 6:return"u16";case 7:return"u32";case 8:return"u64";case 9:return"usize";case 10:return"bool";case 11:return"f32";case 12:return"f64";default:assert(!1);case 13:return"void"}},e.prototype.toNativeType=function(){switch(this.kind){default:return n.NativeType.I32;case 3:case 8:return n.NativeType.I64;case 4:case 9:return 64==this.size?n.NativeType.I64:n.NativeType.I32;case 11:return n.NativeType.F32;case 12:return n.NativeType.F64;case 13:return n.NativeType.None}},e.prototype.toNativeZero=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(0);case 4:case 9:if(64!=this.size)return e.createI32(0);case 3:case 8:return e.createI64(0);case 11:return e.createF32(0);case 12:return e.createF64(0)}},e.prototype.toNativeOne=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(1);case 4:case 9:if(64!=this.size)return e.createI32(1);case 3:case 8:return e.createI64(1);case 11:return e.createF32(1);case 12:return e.createF64(1)}},e.prototype.toNativeNegOne=function(e){switch(this.kind){case 13:assert(!1);default:return e.createI32(-1);case 4:case 9:if(64!=this.size)return e.createI32(-1);case 3:case 8:return e.createI64(-1,-1);case 11:return e.createF32(-1);case 12:return e.createF64(-1)}},e.prototype.toSignatureString=function(){switch(this.kind){default:return"i";case 3:case 8:return"I";case 4:case 9:return 64==this.size?"I":"i";case 11:return"f";case 12:return"F";case 13:return"v"}},e.i8=new e(0,165,8),e.i16=new e(1,165,16),e.i32=new e(2,133,32),e.i64=new e(3,197,64),e.isize32=new e(4,149,32),e.isize64=new e(4,213,64),e.u8=new e(5,166,8),e.u16=new e(6,166,16),e.u32=new e(7,134,32),e.u64=new e(8,198,64),e.usize32=new e(9,150,32),e.usize64=new e(9,214,64),e.bool=new e(10,166,1),e.f32=new e(11,137,32),e.f64=new e(12,201,64),e.void=new e(13,0,0),e}();t.Type=i,t.typesToNativeTypes=function(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=e[n].toNativeType();return r},t.typesToString=function(e){var t=e.length;if(!t)return"";for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n].toString();return r.join(",")};var a=function(){function e(e,t,r){void 0===e&&(e=null),void 0===t&&(t=null),void 0===r&&(r=null),this.cachedFunctionTarget=null,this.parameterTypes=e||[],this.parameterNames=null,this.requiredParameters=0,this.returnType=t||i.void,this.thisType=r,this.hasRest=!1,this.type=i.u32.asFunction(this)}return e.prototype.getParameterName=function(e){var t=this.parameterNames;return t&&t.length>e?t[e]:o(e)},e.prototype.isAssignableTo=function(e){var t=this.thisType,r=e.thisType;if(t){if(!r||!t.isAssignableTo(r))return!1}else if(r)return!1;if(this.hasRest!=e.hasRest)return!1;var n=this.parameterTypes,i=e.parameterTypes,a=n.length;if(a!=i.length)return!1;for(var s=0;s<a;++s){var o=n[s],c=i[s];if(!o.isAssignableTo(c))return!1}var p=this.returnType,l=e.returnType;return p==l||p.isAssignableTo(l)},e.makeSignatureString=function(e,t,r){void 0===r&&(r=null);var n=[];if(r&&n.push(r.toSignatureString()),e)for(var i=0,a=e.length;i<a;++i)n.push(e[i].toSignatureString());return n.push(t.toSignatureString()),n.join("")},e.prototype.toSignatureString=function(){return e.makeSignatureString(this.parameterTypes,this.returnType,this.thisType)},e.prototype.toString=function(e){void 0===e&&(e=!1);var t=new Array;t.push("(");var r=0,n=this.thisType;n&&e&&(t.push("this: "),t.push(n.toString()),r=1);var i=this.parameterTypes,a=i.length;if(a)for(var s=this.parameterNames,c=s?s.length:0,p=this.requiredParameters,l=this.hasRest?a-1:-1,u=0;u<a;++u,++r)r&&t.push(", "),u==l&&t.push("..."),u<c?t.push(s[u]):t.push(o(u)),u>=p&&u!=l?t.push("?: "):t.push(": "),t.push(i[u].toString());return t.push(") => "),t.push(this.returnType.toString()),t.join("")},e}();t.Signature=a;var s=null;function o(e){s||(s=[]);for(var t=s.length;t<=e;++t)s.push("arg$"+t.toString(10));return s[e-1]}t.getDefaultParameterName=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,a,s=r(2),o=r(4),c=r(1);function p(e){switch(assert(e.length),e.charCodeAt(0)){case 97:switch(e){case"abstract":return i.ABSTRACT;case"as":return i.AS;case"async":return i.ASYNC;case"await":return i.AWAIT}break;case 98:switch(e){case"break":return i.BREAK}break;case 99:switch(e){case"case":return i.CASE;case"catch":return i.CATCH;case"class":return i.CLASS;case"continue":return i.CONTINUE;case"const":return i.CONST;case"constructor":return i.CONSTRUCTOR}break;case 100:switch(e){case"debugger":return i.DEBUGGER;case"declare":return i.DECLARE;case"default":return i.DEFAULT;case"delete":return i.DELETE;case"do":return i.DO}break;case 101:switch(e){case"else":return i.ELSE;case"enum":return i.ENUM;case"export":return i.EXPORT;case"extends":return i.EXTENDS}break;case 102:switch(e){case"false":return i.FALSE;case"finally":return i.FINALLY;case"for":return i.FOR;case"from":return i.FROM;case"function":return i.FUNCTION}break;case 103:switch(e){case"get":return i.GET}break;case 105:switch(e){case"if":return i.IF;case"implements":return i.IMPLEMENTS;case"import":return i.IMPORT;case"in":return i.IN;case"instanceof":return i.INSTANCEOF;case"interface":return i.INTERFACE;case"is":return i.IS}break;case 107:switch(e){case"keyof":return i.KEYOF}break;case 108:switch(e){case"let":return i.LET}break;case 109:switch(e){case"module":return i.MODULE}break;case 110:switch(e){case"namespace":return i.NAMESPACE;case"new":return i.NEW;case"null":return i.NULL}break;case 111:switch(e){case"of":return i.OF}break;case 112:switch(e){case"package":return i.PACKAGE;case"private":return i.PRIVATE;case"protected":return i.PROTECTED;case"public":return i.PUBLIC}break;case 114:switch(e){case"readonly":return i.READONLY;case"return":return i.RETURN}break;case 115:switch(e){case"set":return i.SET;case"static":return i.STATIC;case"super":return i.SUPER;case"switch":return i.SWITCH}break;case 116:switch(e){case"this":return i.THIS;case"throw":return i.THROW;case"true":return i.TRUE;case"try":return i.TRY;case"type":return i.TYPE;case"typeof":return i.TYPEOF}break;case 118:switch(e){case"var":return i.VAR;case"void":return i.VOID}break;case 119:switch(e){case"while":return i.WHILE;case"with":return i.WITH}break;case 121:switch(e){case"yield":return i.YIELD}}return i.INVALID}function l(e){switch(e){case i.ABSTRACT:case i.AS:case i.CONSTRUCTOR:case i.DECLARE:case i.DELETE:case i.FROM:case i.FOR:case i.GET:case i.IS:case i.KEYOF:case i.MODULE:case i.NAMESPACE:case i.READONLY:case i.SET:case i.TYPE:return!0;default:return!1}}!function(e){e[e.ABSTRACT=0]="ABSTRACT",e[e.AS=1]="AS",e[e.ASYNC=2]="ASYNC",e[e.AWAIT=3]="AWAIT",e[e.BREAK=4]="BREAK",e[e.CASE=5]="CASE",e[e.CATCH=6]="CATCH",e[e.CLASS=7]="CLASS",e[e.CONST=8]="CONST",e[e.CONTINUE=9]="CONTINUE",e[e.CONSTRUCTOR=10]="CONSTRUCTOR",e[e.DEBUGGER=11]="DEBUGGER",e[e.DECLARE=12]="DECLARE",e[e.DEFAULT=13]="DEFAULT",e[e.DELETE=14]="DELETE",e[e.DO=15]="DO",e[e.ELSE=16]="ELSE",e[e.ENUM=17]="ENUM",e[e.EXPORT=18]="EXPORT",e[e.EXTENDS=19]="EXTENDS",e[e.FALSE=20]="FALSE",e[e.FINALLY=21]="FINALLY",e[e.FOR=22]="FOR",e[e.FROM=23]="FROM",e[e.FUNCTION=24]="FUNCTION",e[e.GET=25]="GET",e[e.IF=26]="IF",e[e.IMPLEMENTS=27]="IMPLEMENTS",e[e.IMPORT=28]="IMPORT",e[e.IN=29]="IN",e[e.INSTANCEOF=30]="INSTANCEOF",e[e.INTERFACE=31]="INTERFACE",e[e.IS=32]="IS",e[e.KEYOF=33]="KEYOF",e[e.LET=34]="LET",e[e.MODULE=35]="MODULE",e[e.NAMESPACE=36]="NAMESPACE",e[e.NEW=37]="NEW",e[e.NULL=38]="NULL",e[e.OF=39]="OF",e[e.PACKAGE=40]="PACKAGE",e[e.PRIVATE=41]="PRIVATE",e[e.PROTECTED=42]="PROTECTED",e[e.PUBLIC=43]="PUBLIC",e[e.READONLY=44]="READONLY",e[e.RETURN=45]="RETURN",e[e.SET=46]="SET",e[e.STATIC=47]="STATIC",e[e.SUPER=48]="SUPER",e[e.SWITCH=49]="SWITCH",e[e.THIS=50]="THIS",e[e.THROW=51]="THROW",e[e.TRUE=52]="TRUE",e[e.TRY=53]="TRY",e[e.TYPE=54]="TYPE",e[e.TYPEOF=55]="TYPEOF",e[e.VAR=56]="VAR",e[e.VOID=57]="VOID",e[e.WHILE=58]="WHILE",e[e.WITH=59]="WITH",e[e.YIELD=60]="YIELD",e[e.OPENBRACE=61]="OPENBRACE",e[e.CLOSEBRACE=62]="CLOSEBRACE",e[e.OPENPAREN=63]="OPENPAREN",e[e.CLOSEPAREN=64]="CLOSEPAREN",e[e.OPENBRACKET=65]="OPENBRACKET",e[e.CLOSEBRACKET=66]="CLOSEBRACKET",e[e.DOT=67]="DOT",e[e.DOT_DOT_DOT=68]="DOT_DOT_DOT",e[e.SEMICOLON=69]="SEMICOLON",e[e.COMMA=70]="COMMA",e[e.LESSTHAN=71]="LESSTHAN",e[e.GREATERTHAN=72]="GREATERTHAN",e[e.LESSTHAN_EQUALS=73]="LESSTHAN_EQUALS",e[e.GREATERTHAN_EQUALS=74]="GREATERTHAN_EQUALS",e[e.EQUALS_EQUALS=75]="EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS=76]="EXCLAMATION_EQUALS",e[e.EQUALS_EQUALS_EQUALS=77]="EQUALS_EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS_EQUALS=78]="EXCLAMATION_EQUALS_EQUALS",e[e.EQUALS_GREATERTHAN=79]="EQUALS_GREATERTHAN",e[e.PLUS=80]="PLUS",e[e.MINUS=81]="MINUS",e[e.ASTERISK_ASTERISK=82]="ASTERISK_ASTERISK",e[e.ASTERISK=83]="ASTERISK",e[e.SLASH=84]="SLASH",e[e.PERCENT=85]="PERCENT",e[e.PLUS_PLUS=86]="PLUS_PLUS",e[e.MINUS_MINUS=87]="MINUS_MINUS",e[e.LESSTHAN_LESSTHAN=88]="LESSTHAN_LESSTHAN",e[e.GREATERTHAN_GREATERTHAN=89]="GREATERTHAN_GREATERTHAN",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN=90]="GREATERTHAN_GREATERTHAN_GREATERTHAN",e[e.AMPERSAND=91]="AMPERSAND",e[e.BAR=92]="BAR",e[e.CARET=93]="CARET",e[e.EXCLAMATION=94]="EXCLAMATION",e[e.TILDE=95]="TILDE",e[e.AMPERSAND_AMPERSAND=96]="AMPERSAND_AMPERSAND",e[e.BAR_BAR=97]="BAR_BAR",e[e.QUESTION=98]="QUESTION",e[e.COLON=99]="COLON",e[e.EQUALS=100]="EQUALS",e[e.PLUS_EQUALS=101]="PLUS_EQUALS",e[e.MINUS_EQUALS=102]="MINUS_EQUALS",e[e.ASTERISK_EQUALS=103]="ASTERISK_EQUALS",e[e.ASTERISK_ASTERISK_EQUALS=104]="ASTERISK_ASTERISK_EQUALS",e[e.SLASH_EQUALS=105]="SLASH_EQUALS",e[e.PERCENT_EQUALS=106]="PERCENT_EQUALS",e[e.LESSTHAN_LESSTHAN_EQUALS=107]="LESSTHAN_LESSTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_EQUALS=108]="GREATERTHAN_GREATERTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS=109]="GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS",e[e.AMPERSAND_EQUALS=110]="AMPERSAND_EQUALS",e[e.BAR_EQUALS=111]="BAR_EQUALS",e[e.CARET_EQUALS=112]="CARET_EQUALS",e[e.AT=113]="AT",e[e.IDENTIFIER=114]="IDENTIFIER",e[e.STRINGLITERAL=115]="STRINGLITERAL",e[e.INTEGERLITERAL=116]="INTEGERLITERAL",e[e.FLOATLITERAL=117]="FLOATLITERAL",e[e.INVALID=118]="INVALID",e[e.ENDOFFILE=119]="ENDOFFILE"}(i=t.Token||(t.Token={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PREFER=1]="PREFER",e[e.ALWAYS=2]="ALWAYS"}(a=t.IdentifierHandling||(t.IdentifierHandling={})),t.tokenFromKeyword=p,t.tokenIsAlsoIdentifier=l,t.operatorTokenToString=function(e){switch(e){case i.DELETE:return"delete";case i.IN:return"in";case i.INSTANCEOF:return"instanceof";case i.NEW:return"new";case i.TYPEOF:return"typeof";case i.VOID:return"void";case i.YIELD:return"yield";case i.DOT_DOT_DOT:return"...";case i.COMMA:return",";case i.LESSTHAN:return"<";case i.GREATERTHAN:return">";case i.LESSTHAN_EQUALS:return"<=";case i.GREATERTHAN_EQUALS:return">=";case i.EQUALS_EQUALS:return"==";case i.EXCLAMATION_EQUALS:return"!=";case i.EQUALS_EQUALS_EQUALS:return"===";case i.EXCLAMATION_EQUALS_EQUALS:return"!==";case i.PLUS:return"+";case i.MINUS:return"-";case i.ASTERISK_ASTERISK:return"**";case i.ASTERISK:return"*";case i.SLASH:return"/";case i.PERCENT:return"%";case i.PLUS_PLUS:return"++";case i.MINUS_MINUS:return"--";case i.LESSTHAN_LESSTHAN:return"<<";case i.GREATERTHAN_GREATERTHAN:return">>";case i.GREATERTHAN_GREATERTHAN_GREATERTHAN:return">>>";case i.AMPERSAND:return"&";case i.BAR:return"|";case i.CARET:return"^";case i.EXCLAMATION:return"!";case i.TILDE:return"~";case i.AMPERSAND_AMPERSAND:return"&&";case i.BAR_BAR:return"||";case i.EQUALS:return"=";case i.PLUS_EQUALS:return"+=";case i.MINUS_EQUALS:return"-=";case i.ASTERISK_EQUALS:return"*=";case i.ASTERISK_ASTERISK_EQUALS:return"**=";case i.SLASH_EQUALS:return"/=";case i.PERCENT_EQUALS:return"%=";case i.LESSTHAN_LESSTHAN_EQUALS:return"<<=";case i.GREATERTHAN_GREATERTHAN_EQUALS:return">>=";case i.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:return">>>=";case i.AMPERSAND_EQUALS:return"&=";case i.BAR_EQUALS:return"|=";case i.CARET_EQUALS:return"^=";default:return assert(!1),""}};var u=function(){function e(e,t,r){this.debugInfoRef=0,this.source=e,this.start=t,this.end=r}return e.join=function(t,r){if(t.source!=r.source)throw new Error("source mismatch");return new e(t.source,t.start<r.start?t.start:r.start,t.end>r.end?t.end:r.end)},Object.defineProperty(e.prototype,"atStart",{get:function(){return new e(this.source,this.start,this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atEnd",{get:function(){return new e(this.source,this.end,this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){for(var e=this.source.text,t=1,r=this.start;r>=0;--r)10==e.charCodeAt(r)&&t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){for(var e=this.source.text,t=0,r=this.start-1;r>=0&&10!=e.charCodeAt(r);--r)++t;return t},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.source.text.substring(this.start,this.end)},e}();t.Range=u;var h=function(e){function t(t,r){void 0===r&&(r=null);var n=e.call(this,r)||this;n.end=0,n.pos=0,n.token=-1,n.tokenPos=0,n.nextToken=-1,n.nextTokenPos=0,n.nextTokenOnNewLine=!1,n.onComment=null,n.source=t,n.pos=0,n.end=t.text.length,n.diagnostics=r||new Array;var i=t.text;if(n.pos<n.end&&65279==i.charCodeAt(n.pos)&&++n.pos,n.pos+1<n.end&&35==i.charCodeAt(n.pos)&&33==i.charCodeAt(n.pos+1))for(n.pos+=2;n.pos<n.end&&10!=i.charCodeAt(n.pos);)++n.pos;return n}return n(t,e),t.prototype.next=function(e){return void 0===e&&(e=a.DEFAULT),this.nextToken=-1,this.token=this.unsafeNext(e)},t.prototype.unsafeNext=function(e,t){void 0===e&&(e=a.DEFAULT),void 0===t&&(t=i32.MAX_VALUE);for(var r=this.source.text;this.pos<this.end;){this.tokenPos=this.pos;var n=r.charCodeAt(this.pos);switch(n){case 13:++this.pos<this.end&&10==r.charCodeAt(this.pos)&&++this.pos;break;case 10:case 9:case 11:case 12:case 32:++this.pos;break;case 33:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.EXCLAMATION_EQUALS_EQUALS):i.EXCLAMATION_EQUALS):i.EXCLAMATION;case 34:case 39:case 96:return i.STRINGLITERAL;case 37:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.PERCENT_EQUALS):i.PERCENT;case 38:if(++this.pos,t>1&&this.pos<this.end){if(38==r.charCodeAt(this.pos))return++this.pos,i.AMPERSAND_AMPERSAND;if(61==r.charCodeAt(this.pos))return++this.pos,i.AMPERSAND_EQUALS}return i.AMPERSAND;case 40:return++this.pos,i.OPENPAREN;case 41:return++this.pos,i.CLOSEPAREN;case 42:if(++this.pos,t>1&&this.pos<this.end){if(61==r.charCodeAt(this.pos))return++this.pos,i.ASTERISK_EQUALS;if(42==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.ASTERISK_ASTERISK_EQUALS):i.ASTERISK_ASTERISK}return i.ASTERISK;case 43:if(++this.pos,t>1&&this.pos<this.end){if(43==r.charCodeAt(this.pos))return++this.pos,i.PLUS_PLUS;if(61==r.charCodeAt(this.pos))return++this.pos,i.PLUS_EQUALS}return i.PLUS;case 44:return++this.pos,i.COMMA;case 45:if(++this.pos,t>1&&this.pos<this.end){if(45==r.charCodeAt(this.pos))return++this.pos,i.MINUS_MINUS;if(61==r.charCodeAt(this.pos))return++this.pos,i.MINUS_EQUALS}return i.MINUS;case 46:if(++this.pos,t>1&&this.pos<this.end){if(c.isDecimalDigit(r.charCodeAt(this.pos)))return--this.pos,i.FLOATLITERAL;if(t>2&&this.pos+1<this.end&&46==r.charCodeAt(this.pos)&&46==r.charCodeAt(this.pos+1))return this.pos+=2,i.DOT_DOT_DOT}return i.DOT;case 47:var u=this.pos;if(++this.pos,t>1&&this.pos<this.end){if(47==r.charCodeAt(this.pos)){var h=o.CommentKind.LINE;for(this.pos+1<this.end&&47==r.charCodeAt(this.pos+1)&&(++this.pos,h=o.CommentKind.TRIPLE);++this.pos<this.end;)if(10==r.charCodeAt(this.pos)){++this.pos;break}this.onComment&&this.onComment(h,r.substring(u,this.pos),this.range(u,this.pos));break}if(42==r.charCodeAt(this.pos)){for(var d=!1;++this.pos<this.end;)if(42==(n=r.charCodeAt(this.pos))&&this.pos+1<this.end&&47==r.charCodeAt(this.pos+1)){this.pos+=2,d=!0;break}d?this.onComment&&this.onComment(o.CommentKind.BLOCK,r.substring(u,this.pos),this.range(u,this.pos)):this.error(s.DiagnosticCode._0_expected,this.range(this.pos),"*/");break}if(61==r.charCodeAt(this.pos))return++this.pos,i.SLASH_EQUALS}return i.SLASH;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.testInteger()?i.INTEGERLITERAL:i.FLOATLITERAL;case 58:return++this.pos,i.COLON;case 59:return++this.pos,i.SEMICOLON;case 60:if(++this.pos,t>1&&this.pos<this.end){if(60==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.LESSTHAN_LESSTHAN_EQUALS):i.LESSTHAN_LESSTHAN;if(61==r.charCodeAt(this.pos))return++this.pos,i.LESSTHAN_EQUALS}return i.LESSTHAN;case 61:if(++this.pos,t>1&&this.pos<this.end){if(61==r.charCodeAt(this.pos))return++this.pos,t>2&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.EQUALS_EQUALS_EQUALS):i.EQUALS_EQUALS;if(62==r.charCodeAt(this.pos))return++this.pos,i.EQUALS_GREATERTHAN}return i.EQUALS;case 62:if(++this.pos,t>1&&this.pos<this.end){if(62==r.charCodeAt(this.pos)){if(++this.pos,t>2&&this.pos<this.end){if(62==r.charCodeAt(this.pos))return++this.pos,t>3&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS):i.GREATERTHAN_GREATERTHAN_GREATERTHAN;if(61==r.charCodeAt(this.pos))return++this.pos,i.GREATERTHAN_GREATERTHAN_EQUALS}return i.GREATERTHAN_GREATERTHAN}if(61==r.charCodeAt(this.pos))return++this.pos,i.GREATERTHAN_EQUALS}return i.GREATERTHAN;case 63:return++this.pos,i.QUESTION;case 91:return++this.pos,i.OPENBRACKET;case 93:return++this.pos,i.CLOSEBRACKET;case 94:return++this.pos,t>1&&this.pos<this.end&&61==r.charCodeAt(this.pos)?(++this.pos,i.CARET_EQUALS):i.CARET;case 123:return++this.pos,i.OPENBRACE;case 124:if(++this.pos,t>1&&this.pos<this.end){if(124==r.charCodeAt(this.pos))return++this.pos,i.BAR_BAR;if(61==r.charCodeAt(this.pos))return++this.pos,i.BAR_EQUALS}return i.BAR;case 125:return++this.pos,i.CLOSEBRACE;case 126:return++this.pos,i.TILDE;case 64:return++this.pos,i.AT;default:if(c.isIdentifierStart(n)){if(c.isKeywordCharacter(n)){for(var _=this.pos;++this.pos<this.end&&c.isIdentifierPart(n=r.charCodeAt(this.pos));)if(!c.isKeywordCharacter(n))return this.pos=_,i.IDENTIFIER;var m=p(r.substring(_,this.pos));if(m!=i.INVALID&&e!==a.ALWAYS&&(e!==a.PREFER||!l(m)))return m;this.pos=_}return i.IDENTIFIER}if(c.isWhiteSpace(n)){++this.pos;break}return this.error(s.DiagnosticCode.Invalid_character,this.range(this.pos,this.pos+1)),++this.pos,i.INVALID}}return i.ENDOFFILE},t.prototype.peek=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=a.DEFAULT),void 0===r&&(r=i32.MAX_VALUE);var n=this.source.text;if(this.nextToken<0){var i=this.pos,s=this.token,o=this.tokenPos;if(this.nextToken=this.unsafeNext(t,r),this.nextTokenPos=this.tokenPos,e)for(this.nextTokenOnNewLine=!1;--this.tokenPos>i;)if(c.isLineBreak(n.charCodeAt(this.tokenPos))){this.nextTokenOnNewLine=!0;break}this.pos=i,this.token=s,this.tokenPos=o}return this.nextToken},t.prototype.skipIdentifier=function(){return this.skip(i.IDENTIFIER,a.PREFER)},t.prototype.skipIdentifierName=function(){return this.skip(i.IDENTIFIER,a.ALWAYS)},t.prototype.skip=function(e,t){void 0===t&&(t=a.DEFAULT);var r=this.pos,n=this.token,s=this.tokenPos,o=i32.MAX_VALUE;switch(e){case i.GREATERTHAN:o=1}return this.token=this.unsafeNext(t,o),this.token==e?(this.nextToken=-1,!0):(this.pos=r,this.token=n,this.tokenPos=s,!1)},t.prototype.mark=function(){var e;return _?(e=_,_=null):e=new d,e.pos=this.pos,e.token=this.token,e.tokenPos=this.tokenPos,e},t.prototype.discard=function(e){_=e},t.prototype.reset=function(e){this.pos=e.pos,this.token=e.token,this.tokenPos=e.tokenPos,this.nextToken=-1},t.prototype.range=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),e<0?(e=this.tokenPos,t=this.pos):t<0&&(t=e),new u(this.source,e,t)},t.prototype.readIdentifier=function(){for(var e=this.source.text,t=this.pos;++this.pos<this.end&&c.isIdentifierPart(e.charCodeAt(this.pos)););return e.substring(t,this.pos)},t.prototype.readString=function(){for(var e=this.source.text,t=e.charCodeAt(this.pos++),r=this.pos,n="";;){if(this.pos>=this.end){n+=e.substring(r,this.pos),this.error(s.DiagnosticCode.Unterminated_string_literal,this.range(r-1,this.end));break}var i=e.charCodeAt(this.pos);if(i==t){n+=e.substring(r,this.pos++);break}if(92!=i){if(c.isLineBreak(i)){n+=e.substring(r,this.pos),this.error(s.DiagnosticCode.Unterminated_string_literal,this.range(r-1,this.pos));break}++this.pos}else n+=e.substring(r,this.pos),n+=this.readEscapeSequence(),r=this.pos}return n},t.prototype.readEscapeSequence=function(){if(++this.pos>=this.end)return this.error(s.DiagnosticCode.Unexpected_end_of_text,this.range(this.end)),"";var e=this.source.text,t=e.charCodeAt(this.pos++);switch(t){case 48:return"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return this.pos<this.end&&123==e.charCodeAt(this.pos)?(++this.pos,this.readExtendedUnicodeEscape()):this.readUnicodeEscape();case 13:this.pos<this.end&&10==e.charCodeAt(this.pos)&&++this.pos;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(t)}},t.prototype.readRegexpPattern=function(){for(var e=this.source.text,t=this.pos,r=!1;;){if(this.pos>=this.end){this.error(s.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,this.end));break}if(92!=e.charCodeAt(this.pos)){var n=e.charCodeAt(this.pos);if(47==n&&!r)break;if(c.isLineBreak(n)){this.error(s.DiagnosticCode.Unterminated_regular_expression_literal,this.range(t,this.pos));break}++this.pos,r=!1}else++this.pos,r=!0}return e.substring(t,this.pos)},t.prototype.readRegexpFlags=function(){for(var e=this.source.text,t=this.pos,r=0;this.pos<this.end;){var n=e.charCodeAt(this.pos);if(!c.isIdentifierPart(n))break;switch(++this.pos,n){case 103:r|=1&r?-1:1;break;case 105:r|=2&r?-1:2;break;case 109:r|=4&r?-1:4;break;default:r=-1}}return-1==r&&this.error(s.DiagnosticCode.Invalid_regular_expression_flags,this.range(t,this.pos)),e.substring(t,this.pos)},t.prototype.testInteger=function(){var e=this.source.text;if(48==e.charCodeAt(this.pos)&&this.pos+1<this.end)switch(e.charCodeAt(this.pos+2)){case 88:case 120:case 66:case 98:case 79:case 111:return!0}for(var t=this.pos;t<this.end;){var r=e.charCodeAt(t);if(46==r||69==r||101==r)return!1;if((r<48||r>57)&&95!=r)break;t++}return!0},t.prototype.readInteger=function(){var e=this.source.text;if(48==e.charCodeAt(this.pos)&&this.pos+2<this.end){switch(e.charCodeAt(this.pos+1)){case 88:case 120:return this.pos+=2,this.readHexInteger();case 66:case 98:return this.pos+=2,this.readBinaryInteger();case 79:case 111:return this.pos+=2,this.readOctalInteger()}if(c.isOctalDigit(e.charCodeAt(this.pos+1))){var t=this.pos;++this.pos;var r=this.readOctalInteger();return this.error(s.DiagnosticCode.Octal_literals_are_not_allowed_in_strict_mode,this.range(t,this.pos)),r}}return this.readDecimalInteger()},t.prototype.readHexInteger=function(){for(var e=this.source.text,t=this.pos,r=i64_new(0,0),n=i64_new(16,0),i=t;this.pos<this.end;){var a=this.pos,o=e.charCodeAt(a);if(o>=48&&o<=57)r=i64_add(i64_mul(r,n),i64_new(o-48,0));else if(o>=65&&o<=70)r=i64_add(i64_mul(r,n),i64_new(10+o-65,0));else if(o>=97&&o<=102)r=i64_add(i64_mul(r,n),i64_new(10+o-97,0));else{if(95!=o)break;i==a&&this.error(i==t?s.DiagnosticCode.Numeric_separators_are_not_allowed_here:s.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(a)),i=a+1}this.pos=a+1}return this.pos==t?this.error(s.DiagnosticCode.Hexadecimal_digit_expected,this.range(t)):i==this.pos&&this.error(s.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(i-1)),r},t.prototype.readDecimalInteger=function(){for(var e=this.source.text,t=this.pos,r=i64_new(0,0),n=i64_new(10,0),i=t;this.pos<this.end;){var a=this.pos,o=e.charCodeAt(a);if(o>=48&&o<=57)r=i64_add(i64_mul(r,n),i64_new(o-48,0));else{if(95!=o)break;i==a&&this.error(i==t?s.DiagnosticCode.Numeric_separators_are_not_allowed_here:s.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(a)),i=a+1}this.pos=a+1}return this.pos==t?this.error(s.DiagnosticCode.Digit_expected,this.range(t)):i==this.pos&&this.error(s.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(i-1)),r},t.prototype.readOctalInteger=function(){for(var e=this.source.text,t=this.pos,r=i64_new(0,0),n=i64_new(8,0),i=t;this.pos<this.end;){var a=this.pos,o=e.charCodeAt(a);if(o>=48&&o<=55)r=i64_add(i64_mul(r,n),i64_new(o-48,0));else{if(95!=o)break;i==a&&this.error(i==t?s.DiagnosticCode.Numeric_separators_are_not_allowed_here:s.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(a)),i=a+1}++this.pos}return this.pos==t?this.error(s.DiagnosticCode.Octal_digit_expected,this.range(t)):i==this.pos&&this.error(s.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(i-1)),r},t.prototype.readBinaryInteger=function(){for(var e=this.source.text,t=this.pos,r=i64_new(0,0),n=i64_new(2,0),i=i64_new(1,0),a=t;this.pos<this.end;){var o=this.pos,c=e.charCodeAt(o);if(48==c)r=i64_mul(r,n);else if(49==c)r=i64_add(i64_mul(r,n),i);else{if(95!=c)break;a==o&&this.error(a==t?s.DiagnosticCode.Numeric_separators_are_not_allowed_here:s.DiagnosticCode.Multiple_consecutive_numeric_separators_are_not_permitted,this.range(o)),a=o+1}this.pos=o+1}return this.pos==t?this.error(s.DiagnosticCode.Binary_digit_expected,this.range(t)):a==this.pos&&this.error(s.DiagnosticCode.Numeric_separators_are_not_allowed_here,this.range(a-1)),r},t.prototype.readFloat=function(){return this.readDecimalFloat()},t.prototype.readDecimalFloat=function(){for(var e=this.pos,t=this.source.text;this.pos<this.end&&c.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos;if(this.pos<this.end&&46==t.charCodeAt(this.pos))for(++this.pos;this.pos<this.end&&c.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos;if(this.pos<this.end){var r=t.charCodeAt(this.pos);if(69==r||101==r)for(++this.pos<this.end&&(45==t.charCodeAt(this.pos)||43==t.charCodeAt(this.pos))&&c.isDecimalDigit(t.charCodeAt(this.pos+1))&&++this.pos;this.pos<this.end&&c.isDecimalDigit(t.charCodeAt(this.pos));)++this.pos}return parseFloat(t.substring(e,this.pos))},t.prototype.readHexFloat=function(){throw new Error("not implemented")},t.prototype.readUnicodeEscape=function(){for(var e=4,t=0,r=this.source.text;this.pos<this.end;){var n=r.charCodeAt(this.pos++);if(n>=48&&n<=57)t=16*t+n-48;else if(n>=65&&n<=70)t=16*t+10+n-65;else{if(!(n>=97&&n<=102))return this.error(s.DiagnosticCode.Hexadecimal_digit_expected,this.range(this.pos-1,this.pos)),"";t=16*t+10+n-97}if(0==--e)break}return e?(this.error(s.DiagnosticCode.Unexpected_end_of_text,this.range(this.pos)),""):String.fromCharCode(t)},t.prototype.readExtendedUnicodeEscape=function(){var e=this.pos,t=this.readHexInteger(),r=i64_low(t),n=!1;assert(!i64_high(t)),r>1114111&&(this.error(s.DiagnosticCode.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive,this.range(e,this.pos)),n=!0);var i=this.source.text;return this.pos>=this.end?(this.error(s.DiagnosticCode.Unexpected_end_of_text,this.range(e,this.end)),n=!0):125==i.charCodeAt(this.pos)?++this.pos:(this.error(s.DiagnosticCode.Unterminated_Unicode_escape_sequence,this.range(e,this.pos)),n=!0),n?"":r<65536?String.fromCharCode(r):String.fromCharCode(55296+((r-65536)/1024|0),(r-65536)%1024+56320)},t.prototype.finish=function(){},t}(s.DiagnosticEmitter);t.Tokenizer=h;var d=function(){return function(){}}();t.State=d;var _=null},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Operation_not_supported=100]="Operation_not_supported",e[e.Operation_is_unsafe=101]="Operation_is_unsafe",e[e.Conversion_from_type_0_to_1_requires_an_explicit_cast=200]="Conversion_from_type_0_to_1_requires_an_explicit_cast",e[e.Conversion_from_type_0_to_1_will_require_an_explicit_cast_when_switching_between_32_64_bit=201]="Conversion_from_type_0_to_1_will_require_an_explicit_cast_when_switching_between_32_64_bit",e[e.Type_0_cannot_be_changed_to_type_1=202]="Type_0_cannot_be_changed_to_type_1",e[e.Type_0_cannot_be_reinterpreted_as_type_1=203]="Type_0_cannot_be_reinterpreted_as_type_1",e[e.Basic_type_0_cannot_be_nullable=204]="Basic_type_0_cannot_be_nullable",e[e.Cannot_export_a_mutable_global=205]="Cannot_export_a_mutable_global",e[e.Compiling_constant_with_non_constant_initializer_as_mutable=206]="Compiling_constant_with_non_constant_initializer_as_mutable",e[e.Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa=207]="Unmanaged_classes_cannot_extend_managed_classes_and_vice_versa",e[e.Unmanaged_classes_cannot_implement_interfaces=208]="Unmanaged_classes_cannot_implement_interfaces",e[e.Invalid_regular_expression_flags=209]="Invalid_regular_expression_flags",e[e.Implementation_0_must_match_the_signature_1=210]="Implementation_0_must_match_the_signature_1",e[e.Class_0_is_sealed_and_cannot_be_extended=211]="Class_0_is_sealed_and_cannot_be_extended",e[e.Decorator_0_is_not_valid_here=212]="Decorator_0_is_not_valid_here",e[e.Duplicate_decorator=213]="Duplicate_decorator",e[e.An_allocator_must_be_declared_to_allocate_memory_Try_importing_allocator_arena_or_allocator_tlsf=214]="An_allocator_must_be_declared_to_allocate_memory_Try_importing_allocator_arena_or_allocator_tlsf",e[e.Optional_parameter_must_have_an_initializer=215]="Optional_parameter_must_have_an_initializer",e[e.Unterminated_string_literal=1002]="Unterminated_string_literal",e[e.Identifier_expected=1003]="Identifier_expected",e[e._0_expected=1005]="_0_expected",e[e.A_file_cannot_have_a_reference_to_itself=1006]="A_file_cannot_have_a_reference_to_itself",e[e.Trailing_comma_not_allowed=1009]="Trailing_comma_not_allowed",e[e.Unexpected_token=1012]="Unexpected_token",e[e.A_rest_parameter_must_be_last_in_a_parameter_list=1014]="A_rest_parameter_must_be_last_in_a_parameter_list",e[e.Parameter_cannot_have_question_mark_and_initializer=1015]="Parameter_cannot_have_question_mark_and_initializer",e[e.A_required_parameter_cannot_follow_an_optional_parameter=1016]="A_required_parameter_cannot_follow_an_optional_parameter",e[e.Enum_member_must_have_initializer=1061]="Enum_member_must_have_initializer",e[e.Statements_are_not_allowed_in_ambient_contexts=1036]="Statements_are_not_allowed_in_ambient_contexts",e[e.Initializers_are_not_allowed_in_ambient_contexts=1039]="Initializers_are_not_allowed_in_ambient_contexts",e[e._0_modifier_cannot_be_used_here=1042]="_0_modifier_cannot_be_used_here",e[e.A_rest_parameter_cannot_be_optional=1047]="A_rest_parameter_cannot_be_optional",e[e.A_rest_parameter_cannot_have_an_initializer=1048]="A_rest_parameter_cannot_have_an_initializer",e[e.A_set_accessor_must_have_exactly_one_parameter=1049]="A_set_accessor_must_have_exactly_one_parameter",e[e.A_set_accessor_parameter_cannot_have_an_initializer=1052]="A_set_accessor_parameter_cannot_have_an_initializer",e[e.A_get_accessor_cannot_have_parameters=1054]="A_get_accessor_cannot_have_parameters",e[e.Type_parameters_cannot_appear_on_a_constructor_declaration=1092]="Type_parameters_cannot_appear_on_a_constructor_declaration",e[e.Type_annotation_cannot_appear_on_a_constructor_declaration=1093]="Type_annotation_cannot_appear_on_a_constructor_declaration",e[e.An_accessor_cannot_have_type_parameters=1094]="An_accessor_cannot_have_type_parameters",e[e.A_set_accessor_cannot_have_a_return_type_annotation=1095]="A_set_accessor_cannot_have_a_return_type_annotation",e[e.Type_parameter_list_cannot_be_empty=1098]="Type_parameter_list_cannot_be_empty",e[e.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement=1104]="A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement",e[e.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement=1105]="A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement",e[e.A_return_statement_can_only_be_used_within_a_function_body=1108]="A_return_statement_can_only_be_used_within_a_function_body",e[e.Expression_expected=1109]="Expression_expected",e[e.Type_expected=1110]="Type_expected",e[e.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement=1113]="A_default_clause_cannot_appear_more_than_once_in_a_switch_statement",e[e.Duplicate_label_0=1114]="Duplicate_label_0",e[e.Octal_literals_are_not_allowed_in_strict_mode=1121]="Octal_literals_are_not_allowed_in_strict_mode",e[e.Digit_expected=1124]="Digit_expected",e[e.Hexadecimal_digit_expected=1125]="Hexadecimal_digit_expected",e[e.Unexpected_end_of_text=1126]="Unexpected_end_of_text",e[e.Invalid_character=1127]="Invalid_character",e[e._case_or_default_expected=1130]="_case_or_default_expected",e[e.A_declare_modifier_cannot_be_used_in_an_already_ambient_context=1038]="A_declare_modifier_cannot_be_used_in_an_already_ambient_context",e[e.Type_argument_expected=1140]="Type_argument_expected",e[e.String_literal_expected=1141]="String_literal_expected",e[e.Line_break_not_permitted_here=1142]="Line_break_not_permitted_here",e[e.Declaration_expected=1146]="Declaration_expected",e[e._const_declarations_must_be_initialized=1155]="_const_declarations_must_be_initialized",e[e.Unterminated_regular_expression_literal=1161]="Unterminated_regular_expression_literal",e[e.Interface_declaration_cannot_have_implements_clause=1176]="Interface_declaration_cannot_have_implements_clause",e[e.Binary_digit_expected=1177]="Binary_digit_expected",e[e.Octal_digit_expected=1178]="Octal_digit_expected",e[e.An_implementation_cannot_be_declared_in_ambient_contexts=1183]="An_implementation_cannot_be_declared_in_ambient_contexts",e[e.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive=1198]="An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive",e[e.Unterminated_Unicode_escape_sequence=1199]="Unterminated_Unicode_escape_sequence",e[e.Decorators_are_not_valid_here=1206]="Decorators_are_not_valid_here",e[e._abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration=1242]="_abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration",e[e.A_class_may_only_extend_another_class=1311]="A_class_may_only_extend_another_class",e[e.A_parameter_property_cannot_be_declared_using_a_rest_parameter=1317]="A_parameter_property_cannot_be_declared_using_a_rest_parameter",e[e.Duplicate_identifier_0=2300]="Duplicate_identifier_0",e[e.Cannot_find_name_0=2304]="Cannot_find_name_0",e[e.Module_0_has_no_exported_member_1=2305]="Module_0_has_no_exported_member_1",e[e.Generic_type_0_requires_1_type_argument_s=2314]="Generic_type_0_requires_1_type_argument_s",e[e.Type_0_is_not_generic=2315]="Type_0_is_not_generic",e[e.Type_0_is_not_assignable_to_type_1=2322]="Type_0_is_not_assignable_to_type_1",e[e.Index_signature_is_missing_in_type_0=2329]="Index_signature_is_missing_in_type_0",e[e._this_cannot_be_referenced_in_current_location=2332]="_this_cannot_be_referenced_in_current_location",e[e._super_can_only_be_referenced_in_a_derived_class=2335]="_super_can_only_be_referenced_in_a_derived_class",e[e.Property_0_does_not_exist_on_type_1=2339]="Property_0_does_not_exist_on_type_1",e[e.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures=2349]="Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures",e[e.Cannot_use_new_with_an_expression_whose_type_lacks_a_construct_signature=2351]="Cannot_use_new_with_an_expression_whose_type_lacks_a_construct_signature",e[e.A_function_whose_declared_type_is_not_void_must_return_a_value=2355]="A_function_whose_declared_type_is_not_void_must_return_a_value",e[e.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access=2357]="The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access",e[e.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access=2364]="The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access",e[e.Operator_0_cannot_be_applied_to_types_1_and_2=2365]="Operator_0_cannot_be_applied_to_types_1_and_2",e[e._get_and_set_accessor_must_have_the_same_type=2380]="_get_and_set_accessor_must_have_the_same_type",e[e.Constructor_implementation_is_missing=2390]="Constructor_implementation_is_missing",e[e.Function_implementation_is_missing_or_not_immediately_following_the_declaration=2391]="Function_implementation_is_missing_or_not_immediately_following_the_declaration",e[e.Multiple_constructor_implementations_are_not_allowed=2392]="Multiple_constructor_implementations_are_not_allowed",e[e.Duplicate_function_implementation=2393]="Duplicate_function_implementation",e[e.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local=2395]="Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local",e[e.Type_0_has_no_property_1=2460]="Type_0_has_no_property_1",e[e.The_0_operator_cannot_be_applied_to_type_1=2469]="The_0_operator_cannot_be_applied_to_type_1",e[e.Export_declaration_conflicts_with_exported_declaration_of_0=2484]="Export_declaration_conflicts_with_exported_declaration_of_0",e[e.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property=2540]="Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property",e[e.The_target_of_an_assignment_must_be_a_variable_or_a_property_access=2541]="The_target_of_an_assignment_must_be_a_variable_or_a_property_access",e[e.Index_signature_in_type_0_only_permits_reading=2542]="Index_signature_in_type_0_only_permits_reading",e[e.Expected_0_arguments_but_got_1=2554]="Expected_0_arguments_but_got_1",e[e.Expected_at_least_0_arguments_but_got_1=2555]="Expected_at_least_0_arguments_but_got_1",e[e.Expected_0_type_arguments_but_got_1=2558]="Expected_0_type_arguments_but_got_1",e[e.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums=2651]="A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums",e[e.Namespace_0_has_no_exported_member_1=2694]="Namespace_0_has_no_exported_member_1",e[e.File_0_not_found=6054]="File_0_not_found",e[e.Numeric_separators_are_not_allowed_here=6188]="Numeric_separators_are_not_allowed_here",e[e.Multiple_consecutive_numeric_separators_are_not_permitted=6189]="Multiple_consecutive_numeric_separators_are_not_permitted"}(t.DiagnosticCode||(t.DiagnosticCode={})),t.diagnosticCodeToString=function(e){switch(e){case 100:return"Operation not supported.";case 101:return"Operation is unsafe.";case 200:return"Conversion from type '{0}' to '{1}' requires an explicit cast.";case 201:return"Conversion from type '{0}' to '{1}' will require an explicit cast when switching between 32/64-bit.";case 202:return"Type '{0}' cannot be changed to type '{1}'.";case 203:return"Type '{0}' cannot be reinterpreted as type '{1}'.";case 204:return"Basic type '{0}' cannot be nullable.";case 205:return"Cannot export a mutable global.";case 206:return"Compiling constant with non-constant initializer as mutable.";case 207:return"Unmanaged classes cannot extend managed classes and vice-versa.";case 208:return"Unmanaged classes cannot implement interfaces.";case 209:return"Invalid regular expression flags.";case 210:return"Implementation '{0}' must match the signature '{1}'.";case 211:return"Class '{0}' is sealed and cannot be extended.";case 212:return"Decorator '{0}' is not valid here.";case 213:return"Duplicate decorator.";case 214:return"An allocator must be declared to allocate memory. Try importing allocator/arena or allocator/tlsf.";case 215:return"Optional parameter must have an initializer.";case 1002:return"Unterminated string literal.";case 1003:return"Identifier expected.";case 1005:return"'{0}' expected.";case 1006:return"A file cannot have a reference to itself.";case 1009:return"Trailing comma not allowed.";case 1012:return"Unexpected token.";case 1014:return"A rest parameter must be last in a parameter list.";case 1015:return"Parameter cannot have question mark and initializer.";case 1016:return"A required parameter cannot follow an optional parameter.";case 1061:return"Enum member must have initializer.";case 1036:return"Statements are not allowed in ambient contexts.";case 1039:return"Initializers are not allowed in ambient contexts.";case 1042:return"'{0}' modifier cannot be used here.";case 1047:return"A rest parameter cannot be optional.";case 1048:return"A rest parameter cannot have an initializer.";case 1049:return"A 'set' accessor must have exactly one parameter.";case 1052:return"A 'set' accessor parameter cannot have an initializer.";case 1054:return"A 'get' accessor cannot have parameters.";case 1092:return"Type parameters cannot appear on a constructor declaration.";case 1093:return"Type annotation cannot appear on a constructor declaration.";case 1094:return"An accessor cannot have type parameters.";case 1095:return"A 'set' accessor cannot have a return type annotation.";case 1098:return"Type parameter list cannot be empty.";case 1104:return"A 'continue' statement can only be used within an enclosing iteration statement.";case 1105:return"A 'break' statement can only be used within an enclosing iteration or switch statement.";case 1108:return"A 'return' statement can only be used within a function body.";case 1109:return"Expression expected.";case 1110:return"Type expected.";case 1113:return"A 'default' clause cannot appear more than once in a 'switch' statement.";case 1114:return"Duplicate label '{0}'.";case 1121:return"Octal literals are not allowed in strict mode.";case 1124:return"Digit expected.";case 1125:return"Hexadecimal digit expected.";case 1126:return"Unexpected end of text.";case 1127:return"Invalid character.";case 1130:return"'case' or 'default' expected.";case 1038:return"A 'declare' modifier cannot be used in an already ambient context.";case 1140:return"Type argument expected.";case 1141:return"String literal expected.";case 1142:return"Line break not permitted here.";case 1146:return"Declaration expected.";case 1155:return"'const' declarations must be initialized.";case 1161:return"Unterminated regular expression literal.";case 1176:return"Interface declaration cannot have 'implements' clause.";case 1177:return"Binary digit expected.";case 1178:return"Octal digit expected.";case 1183:return"An implementation cannot be declared in ambient contexts.";case 1198:return"An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive.";case 1199:return"Unterminated Unicode escape sequence.";case 1206:return"Decorators are not valid here.";case 1242:return"'abstract' modifier can only appear on a class, method, or property declaration.";case 1311:return"A class may only extend another class.";case 1317:return"A parameter property cannot be declared using a rest parameter.";case 2300:return"Duplicate identifier '{0}'.";case 2304:return"Cannot find name '{0}'.";case 2305:return"Module '{0}' has no exported member '{1}'.";case 2314:return"Generic type '{0}' requires {1} type argument(s).";case 2315:return"Type '{0}' is not generic.";case 2322:return"Type '{0}' is not assignable to type '{1}'.";case 2329:return"Index signature is missing in type '{0}'.";case 2332:return"'this' cannot be referenced in current location.";case 2335:return"'super' can only be referenced in a derived class.";case 2339:return"Property '{0}' does not exist on type '{1}'.";case 2349:return"Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures.";case 2351:return"Cannot use 'new' with an expression whose type lacks a construct signature.";case 2355:return"A function whose declared type is not 'void' must return a value.";case 2357:return"The operand of an increment or decrement operator must be a variable or a property access.";case 2364:return"The left-hand side of an assignment expression must be a variable or a property access.";case 2365:return"Operator '{0}' cannot be applied to types '{1}' and '{2}'.";case 2380:return"'get' and 'set' accessor must have the same type.";case 2390:return"Constructor implementation is missing.";case 2391:return"Function implementation is missing or not immediately following the declaration.";case 2392:return"Multiple constructor implementations are not allowed.";case 2393:return"Duplicate function implementation.";case 2395:return"Individual declarations in merged declaration '{0}' must be all exported or all local.";case 2460:return"Type '{0}' has no property '{1}'.";case 2469:return"The '{0}' operator cannot be applied to type '{1}'.";case 2484:return"Export declaration conflicts with exported declaration of '{0}'.";case 2540:return"Cannot assign to '{0}' because it is a constant or a read-only property.";case 2541:return"The target of an assignment must be a variable or a property access.";case 2542:return"Index signature in type '{0}' only permits reading.";case 2554:return"Expected {0} arguments, but got {1}.";case 2555:return"Expected at least {0} arguments, but got {1}.";case 2558:return"Expected {0} type arguments, but got {1}.";case 2651:return"A member initializer in a enum declaration cannot reference members declared after it, including members defined in other enums.";case 2694:return"Namespace '{0}' has no exported member '{1}'.";case 6054:return"File '{0}' not found.";case 6188:return"Numeric separators are not allowed here.";case 6189:return"Multiple consecutive numeric separators are not permitted.";default:return""}}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(22),o=r(2),c=r(3),p=r(0),l=r(5),u=r(8),h=r(4),d=r(7),_=r(1);!function(e){e[e.WASM32=0]="WASM32",e[e.WASM64=1]="WASM64"}(a=t.Target||(t.Target={}));var m=function(){function e(){this.target=a.WASM32,this.noTreeShaking=!1,this.noAssert=!1,this.importMemory=!1,this.importTable=!1,this.memoryBase=0,this.sourceMap=!1,this.globalAliases=null,this.features=0}return Object.defineProperty(e.prototype,"isWasm64",{get:function(){return this.target==a.WASM64},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usizeType",{get:function(){return this.target==a.WASM64?d.Type.usize64:d.Type.usize32},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isizeType",{get:function(){return this.target==a.WASM64?d.Type.isize64:d.Type.isize32},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nativeSizeType",{get:function(){return this.target==a.WASM64?c.NativeType.I64:c.NativeType.I32},enumerable:!0,configurable:!0}),e.prototype.hasFeature=function(e){return 0!=(this.features&e)},e}();t.Options=m,function(e){e[e.NONE=0]="NONE",e[e.SIGN_EXTENSION=1]="SIGN_EXTENSION",e[e.MUTABLE_GLOBAL=2]="MUTABLE_GLOBAL"}(t.Feature||(t.Feature={})),function(e){e[e.NONE=0]="NONE",e[e.IMPLICIT=1]="IMPLICIT",e[e.EXPLICIT=2]="EXPLICIT"}(t.ConversionKind||(t.ConversionKind={})),function(e){e[e.NONE=0]="NONE",e[e.WRAP=1]="WRAP"}(t.WrapMode||(t.WrapMode={}));var y,g,T=function(e){function t(t,r){void 0===r&&(r=null);var n=e.call(this,t.diagnostics)||this;return n.outerFunction=null,n.currentEnum=null,n.currentType=d.Type.void,n.memorySegments=[],n.stringSegments=new Map,n.functionTable=[],n.argcVar=0,n.argcSet=0,n.f32ModInstance=null,n.f64ModInstance=null,n.f32PowInstance=null,n.f64PowInstance=null,n.program=t,r||(r=new m),n.options=r,n.memoryOffset=i64_new(max(r.memoryBase,8)),n.module=c.Module.create(),n}return n(t,e),t.compile=function(e,r){return void 0===r&&(r=null),new t(e,r).compile()},t.prototype.compile=function(){var e=this.options,t=this.module,r=this.program;r.initialize(e);var n=new l.Function(r.startFunction,"start",new d.Signature([],d.Type.void));this.startFunctionInstance=n;var i=new Array;this.startFunctionBody=i,this.currentFunction=n;for(var a=r.sources,s=0,o=a.length;s<o;++s)a[s].isEntry&&this.compileSource(a[s]);if(i.length||null!==r.mainFunction){var p=n.signature,u=t.addFunction(n.internalName,this.ensureFunctionType(p.parameterTypes,p.returnType,p.thisType),d.typesToNativeTypes(n.additionalLocals),t.createBlock(null,i));n.finalize(t,u),r.mainFunction||t.setStart(u)}var h=this.memoryOffset;h=i64_align(h,e.usizeType.byteSize),this.memoryOffset=h,e.isWasm64?t.addGlobal("HEAP_BASE",c.NativeType.I64,!1,t.createI64(i64_low(h),i64_high(h))):t.addGlobal("HEAP_BASE",c.NativeType.I32,!1,t.createI32(i64_low(h)));var _=this.memorySegments.length?i64_low(i64_shr_u(i64_align(h,65536),i64_new(16,0))):0;t.setMemory(_,this.options.isWasm64?c.Module.MAX_MEMORY_WASM64:c.Module.MAX_MEMORY_WASM32,this.memorySegments,e.target,"memory"),e.importMemory&&t.addMemoryImport("0","env","memory");var m=this.functionTable,y=m.length,g=!1;if(y){var T=new Array(y);for(s=0;s<y;++s)T[s]=m[s].ref;t.setFunctionTable(T),t.addTableExport("0","table"),g=!0}return e.importTable&&(t.addTableImport("0","env","table"),g||t.addTableExport("0","table")),t},t.prototype.compileSourceByPath=function(e,t){var r=this.program.lookupSourceByPath(e);r?this.compileSource(r):this.error(o.DiagnosticCode.File_0_not_found,t.range,e)},t.prototype.compileSource=function(e){if(!e.is(p.CommonFlags.COMPILED)){e.set(p.CommonFlags.COMPILED);for(var t=this.options.noTreeShaking,r=e.isEntry,n=this.startFunctionInstance,i=this.startFunctionBody,a=e.statements,s=0,o=a.length;s<o;++s){var c=a[s];switch(c.kind){case h.NodeKind.CLASSDECLARATION:(t||r&&c.is(p.CommonFlags.EXPORT))&&!c.isGeneric&&this.compileClassDeclaration(c,[]);break;case h.NodeKind.INTERFACEDECLARATION:break;case h.NodeKind.ENUMDECLARATION:(t||r&&c.is(p.CommonFlags.EXPORT))&&this.compileEnumDeclaration(c);break;case h.NodeKind.FUNCTIONDECLARATION:(t||r&&c.is(p.CommonFlags.EXPORT))&&!c.isGeneric&&this.compileFunctionDeclaration(c,[]);break;case h.NodeKind.IMPORT:this.compileSourceByPath(c.normalizedPath,c.path);break;case h.NodeKind.NAMESPACEDECLARATION:(t||r&&c.is(p.CommonFlags.EXPORT))&&this.compileNamespaceDeclaration(c);break;case h.NodeKind.VARIABLE:var l=this.compileVariableStatement(c);l&&i.push(l);break;case h.NodeKind.EXPORT:null!=c.normalizedPath&&this.compileSourceByPath(c.normalizedPath,c.path),(t||r)&&this.compileExportStatement(c);break;default:var u=this.currentFunction;this.currentFunction=n,i.push(this.compileStatement(c)),this.currentFunction=u}}}},t.prototype.compileGlobalDeclaration=function(e){var t=assert(this.program.elementsLookup.get(e.fileLevelInternalName));return assert(t.kind==l.ElementKind.GLOBAL),this.compileGlobal(t)?t:null},t.prototype.compileGlobal=function(e){if(e.is(p.CommonFlags.COMPILED))return!0;e.set(p.CommonFlags.COMPILED);var t=this.module,r=e.declaration,n=0;if(e.type==d.Type.void)if(r)if(r.type){var i=this.program.resolveType(r.type);if(!i)return!1;if(i==d.Type.void)return this.error(o.DiagnosticCode.Type_expected,r.type.range),!1;e.type=i}else{if(!r.initializer)return this.error(o.DiagnosticCode.Type_expected,r.name.range.atEnd),!1;if(n=this.compileExpressionRetainType(r.initializer,d.Type.void,1),this.currentType==d.Type.void)return this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,r.initializer.range,this.currentType.toString(),"<auto>"),!1;e.type=this.currentType}else assert(!1);if(e.is(p.CommonFlags.AMBIENT|p.CommonFlags.BUILTIN))return!0;var a=e.type.toNativeType(),s=e.isAny(p.CommonFlags.CONST)||e.is(p.CommonFlags.STATIC|p.CommonFlags.READONLY);if(e.is(p.CommonFlags.AMBIENT))return s||this.options.hasFeature(2)?(e.set(p.CommonFlags.MODULE_IMPORT),r?f(e,r,e.parent):(y="env",g=e.simpleName),t.addGlobalImport(e.internalName,y,g,a),e.set(p.CommonFlags.COMPILED),!0):(this.error(o.DiagnosticCode.Operation_not_supported,assert(r).range),!1);var l=!1;e.is(p.CommonFlags.INLINED)?n=this.compileInlineConstant(e,e.type,!0):r&&r.initializer?(n||(n=this.compileExpression(r.initializer,e.type,1,1)),c.getExpressionId(n)!=c.ExpressionId.Const&&(s?(n=this.precomputeExpressionRef(n),c.getExpressionId(n)!=c.ExpressionId.Const&&(this.warning(o.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,r.range),l=!0)):l=!0)):n=e.type.toNativeZero(t);var u=e.internalName;if(l)t.addGlobal(u,a,!0,e.type.toNativeZero(t)),this.startFunctionBody.push(t.createSetGlobal(u,n));else if(s){switch(c.getExpressionType(n)){case c.NativeType.I32:e.constantValueKind=1,e.constantIntegerValue=i64_new(c.getConstValueI32(n),0);break;case c.NativeType.I64:e.constantValueKind=1,e.constantIntegerValue=i64_new(c.getConstValueI64Low(n),c.getConstValueI64High(n));break;case c.NativeType.F32:e.constantValueKind=2,e.constantFloatValue=c.getConstValueF32(n);break;case c.NativeType.F64:e.constantValueKind=2,e.constantFloatValue=c.getConstValueF64(n);break;default:return assert(!1),!1}e.set(p.CommonFlags.INLINED),e.is(p.CommonFlags.MODULE_EXPORT)?(t.addGlobal(u,a,!1,n),t.addGlobalExport(u,E(e))):r&&r.isTopLevel&&t.addGlobal(u,a,!1,n)}else t.addGlobal(u,a,!s,n);return!0},t.prototype.compileEnumDeclaration=function(e){var t=assert(this.program.elementsLookup.get(e.fileLevelInternalName));return assert(t.kind==l.ElementKind.ENUM),this.compileEnum(t)?t:null},t.prototype.compileEnum=function(e){var t,r;if(e.is(p.CommonFlags.COMPILED))return!0;e.set(p.CommonFlags.COMPILED);var n=this.module;this.currentEnum=e;var a=null;if(e.members)try{for(var s=i(e.members.values()),u=s.next();!u.done;u=s.next()){var h=u.value;if(h.kind==l.ElementKind.ENUMVALUE){var _=!1,m=h,y=m.declaration;if(m.set(p.CommonFlags.COMPILED),m.is(p.CommonFlags.INLINED))e.declaration.isTopLevelExport&&n.addGlobal(m.internalName,c.NativeType.I32,!1,n.createI32(m.constantValue));else{var g=void 0;y.value?(g=this.compileExpression(y.value,d.Type.i32,1,0),c.getExpressionId(g)!=c.ExpressionId.Const&&(g=this.precomputeExpressionRef(g),c.getExpressionId(g)!=c.ExpressionId.Const&&(e.is(p.CommonFlags.CONST)&&this.warning(o.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,y.range),_=!0))):null==a?g=n.createI32(0):a.is(p.CommonFlags.INLINED)?g=n.createI32(a.constantValue+1):(g=n.createBinary(c.BinaryOp.AddI32,n.createGetGlobal(a.internalName,c.NativeType.I32),n.createI32(1)),e.is(p.CommonFlags.CONST)&&this.warning(o.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,y.range),_=!0),_?(n.addGlobal(m.internalName,c.NativeType.I32,!0,n.createI32(0)),this.startFunctionBody.push(n.createSetGlobal(m.internalName,g))):(n.addGlobal(m.internalName,c.NativeType.I32,!1,g),c.getExpressionType(g)==c.NativeType.I32?(m.constantValue=c.getConstValueI32(g),m.set(p.CommonFlags.INLINED)):(assert(!1),m.constantValue=0))}a=m,e.is(p.CommonFlags.MODULE_EXPORT)&&(h.is(p.CommonFlags.INLINED)||this.options.hasFeature(2)?n.addGlobalExport(h.internalName,E(h)):y&&this.warning(o.DiagnosticCode.Cannot_export_a_mutable_global,y.range))}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return this.currentEnum=null,!0},t.prototype.compileFunctionDeclaration=function(e,t,r){void 0===r&&(r=null);var n=assert(this.program.elementsLookup.get(e.fileLevelInternalName));return assert(n.kind==l.ElementKind.FUNCTION_PROTOTYPE),this.compileFunctionUsingTypeArguments(n,t,r,null,n.declaration.name)},t.prototype.compileFunctionUsingTypeArguments=function(e,t,r,n,i){var a=e.resolveUsingTypeArguments(t,r,i);return a?(a.outerScope=n,this.compileFunction(a)?a:null):null},t.prototype.ensureFunctionType=function(e,t,r){void 0===r&&(r=null);var n,i=e?e.length:0,a=0;if(r?((n=new Array(1+i))[0]=r.toNativeType(),a=1):n=new Array(i),e)for(var s=0;s<i;++s,++a)n[a]=e[s].toNativeType();var o=t.toNativeType(),c=this.module,p=c.getFunctionTypeBySignature(o,n);if(!p){var l=d.Signature.makeSignatureString(e,t,r);p=c.addFunctionType(l,o,n)}return p},t.prototype.compileFunction=function(e){if(e.is(p.CommonFlags.COMPILED))return!0;assert(!e.is(p.CommonFlags.AMBIENT|p.CommonFlags.BUILTIN)),e.set(p.CommonFlags.COMPILED);var t,r=e.prototype.declaration,n=r.body;n?e.is(p.CommonFlags.AMBIENT)&&this.error(o.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,r.name.range):e.is(p.CommonFlags.AMBIENT)||this.error(o.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,r.name.range);var i=e.signature,a=this.ensureFunctionType(i.parameterTypes,i.returnType,i.thisType),s=this.module;if(n){var u=e.is(p.CommonFlags.CONSTRUCTOR),_=e.signature.returnType,m=this.currentFunction;this.currentFunction=e;var T=e.flow,I=void 0;if(n.kind==h.NodeKind.EXPRESSION)assert(!e.isAny(p.CommonFlags.CONSTRUCTOR|p.CommonFlags.GET|p.CommonFlags.SET|p.CommonFlags.MAIN)),assert(e.is(p.CommonFlags.ARROW)),I=this.compileExpression(n.expression,_,1,0),T.set(1),T.canOverflow(I,_)||T.set(2),T.finalize();else{assert(n.kind==h.NodeKind.BLOCK);var v=this.compileStatements(n.statements);if(e.is(p.CommonFlags.MAIN)&&(s.addGlobal("~started",c.NativeType.I32,!0,s.createI32(0)),v.unshift(s.createIf(s.createUnary(c.UnaryOp.EqzI32,s.createGetGlobal("~started",c.NativeType.I32)),s.createBlock(null,[s.createCall("start",null,c.NativeType.None),s.createSetGlobal("~started",s.createI32(1))])))),T.finalize(),u){var A=this.options.nativeSizeType;if(assert(e.is(p.CommonFlags.INSTANCE)),!T.is(1))if(T.is(32))v.push(s.createGetLocal(0,A));else{var N=assert(e.parent);assert(N.kind==l.ElementKind.CLASS),v.push(s.createTeeLocal(0,this.makeConditionalAllocate(N,r.name)))}}else _==d.Type.void||T.is(1)||this.error(o.DiagnosticCode.A_function_whose_declared_type_is_not_void_must_return_a_value,r.signature.returnType.range);I=v.length?1==v.length?v[0]:s.createBlock(null,v,_.toNativeType()):s.createNop()}if(this.currentFunction=m,t=s.addFunction(e.internalName,a,d.typesToNativeTypes(e.additionalLocals),I),e.hasDecorator(l.DecoratorFlags.EXTERNAL)){var C=assert(h.findDecorator(h.DecoratorKind.EXTERNAL,r.decorators));this.error(o.DiagnosticCode.Operation_not_supported,C.range)}}else e.set(p.CommonFlags.MODULE_IMPORT),f(e,r,e.prototype.parent),t=s.addFunctionImport(e.internalName,y,g,a);return e.is(p.CommonFlags.MODULE_EXPORT)&&(i.requiredParameters<i.parameterTypes.length&&(e=this.ensureTrampoline(e),this.ensureArgcSet()),s.addFunctionExport(e.internalName,E(e))),e.finalize(s,t),!0},t.prototype.compileNamespaceDeclaration=function(e){for(var t=e.members,r=this.options.noTreeShaking,n=0,i=t.length;n<i;++n){var a=t[n];switch(a.kind){case h.NodeKind.CLASSDECLARATION:!r&&!a.is(p.CommonFlags.EXPORT)||a.isGeneric||this.compileClassDeclaration(a,[]);break;case h.NodeKind.INTERFACEDECLARATION:!r&&!a.is(p.CommonFlags.EXPORT)||a.isGeneric||this.compileInterfaceDeclaration(a,[]);break;case h.NodeKind.ENUMDECLARATION:(r||a.is(p.CommonFlags.EXPORT))&&this.compileEnumDeclaration(a);break;case h.NodeKind.FUNCTIONDECLARATION:!r&&!a.is(p.CommonFlags.EXPORT)||a.isGeneric||this.compileFunctionDeclaration(a,[]);break;case h.NodeKind.NAMESPACEDECLARATION:(r||a.is(p.CommonFlags.EXPORT))&&this.compileNamespaceDeclaration(a);break;case h.NodeKind.VARIABLE:if(r||a.is(p.CommonFlags.EXPORT)){var s=this.compileVariableStatement(a,!0);s&&this.startFunctionBody.push(s)}break;default:assert(!1)}}},t.prototype.compileNamespace=function(e){var t,r;if(e.members){var n=this.options.noTreeShaking;try{for(var a=i(e.members.values()),s=a.next();!s.done;s=a.next()){var o=s.value;switch(o.kind){case l.ElementKind.CLASS_PROTOTYPE:!n&&!o.is(p.CommonFlags.EXPORT)||o.is(p.CommonFlags.GENERIC)||this.compileClassUsingTypeArguments(o,[]);break;case l.ElementKind.ENUM:this.compileEnum(o);break;case l.ElementKind.FUNCTION_PROTOTYPE:!n&&!o.is(p.CommonFlags.EXPORT)||o.is(p.CommonFlags.GENERIC)||this.compileFunctionUsingTypeArguments(o,[],null,null,o.declaration.name);break;case l.ElementKind.GLOBAL:this.compileGlobal(o);break;case l.ElementKind.NAMESPACE:this.compileNamespace(o)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}},t.prototype.compileExportStatement=function(e){var t=this.module,r=this.program.fileLevelExports,n=e.members;if(n)for(var i=0,a=n.length;i<a;++i){var s=n[i],c=e.range.source.internalPath+p.PATH_DELIMITER+s.externalName.text,u=r.get(c);if(u)switch(u.kind){case l.ElementKind.CLASS_PROTOTYPE:u.is(p.CommonFlags.GENERIC)||this.compileClassUsingTypeArguments(u,[]);break;case l.ElementKind.ENUM:this.compileEnum(u);break;case l.ElementKind.FUNCTION_PROTOTYPE:if(!u.is(p.CommonFlags.GENERIC)&&e.range.source.isEntry){var h=this.compileFunctionUsingTypeArguments(u,[],null,null,u.declaration.name);if(h){var d=h.prototype.declaration;d&&d.needsExplicitExport(s)&&t.addFunctionExport(h.internalName,s.externalName.text)}}break;case l.ElementKind.GLOBAL:if(this.compileGlobal(u)&&e.range.source.isEntry){var _=u.declaration;_&&_.needsExplicitExport(s)&&(u.is(p.CommonFlags.INLINED)?t.addGlobalExport(u.internalName,s.externalName.text):this.warning(o.DiagnosticCode.Cannot_export_a_mutable_global,s.range))}break;case l.ElementKind.NAMESPACE:this.compileNamespace(u)}}},t.prototype.compileClassDeclaration=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=assert(this.program.elementsLookup.get(e.fileLevelInternalName));assert(i.kind==l.ElementKind.CLASS_PROTOTYPE),this.compileClassUsingTypeArguments(i,t,r,n)},t.prototype.compileClassUsingTypeArguments=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=e.resolveUsingTypeArguments(t,r,n);i&&this.compileClass(i)},t.prototype.compileClass=function(e){var t,r,n,a;if(e.is(p.CommonFlags.COMPILED))return!0;e.set(p.CommonFlags.COMPILED);var s=e.prototype.members;if(s)try{for(var o=i(s.values()),c=o.next();!c.done;c=o.next()){switch((y=c.value).kind){case l.ElementKind.GLOBAL:this.compileGlobal(y);break;case l.ElementKind.FUNCTION_PROTOTYPE:y.is(p.CommonFlags.GENERIC)||this.compileFunctionUsingTypeArguments(y,[],null,null,y.declaration.name);break;case l.ElementKind.PROPERTY:(S=y.getterPrototype)&&this.compileFunctionUsingTypeArguments(S,[],null,null,S.declaration.name),(L=y.setterPrototype)&&this.compileFunctionUsingTypeArguments(L,[],null,null,L.declaration.name)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}var u=e.constructorInstance;u&&this.compileFunction(u);var h=e.members;if(h)try{for(var _=i(h.values()),m=_.next();!m.done;m=_.next()){var y;switch((y=m.value).kind){case l.ElementKind.FUNCTION_PROTOTYPE:y.is(p.CommonFlags.GENERIC)||this.compileFunctionUsingTypeArguments(y,[],e.contextualTypeArguments,null,y.declaration.name);break;case l.ElementKind.FIELD:if(y.set(p.CommonFlags.COMPILED),!e.is(p.CommonFlags.MODULE_EXPORT)||y.is(p.CommonFlags.PRIVATE))break;var g=this.module,T=y.simpleName,f=y.type,I=f.toNativeType(),v=y.memoryOffset,A=this.options.usizeType,N=this.options.nativeSizeType,C=E(y,p.GETTER_PREFIX+T);if(g.addFunction(C,this.ensureFunctionType(null,f,A),null,g.createLoad(f.byteSize,f.is(1),g.createGetLocal(0,N),I,v)),g.addFunctionExport(C,C),y.is(p.CommonFlags.READONLY))break;var O=E(y,p.SETTER_PREFIX+T);g.addFunction(O,this.ensureFunctionType([f],d.Type.void,A),null,g.createStore(f.byteSize,g.createGetLocal(0,N),g.createGetLocal(1,I),I,v)),g.addFunctionExport(O,O);break;case l.ElementKind.PROPERTY:var S,L;(S=y.getterPrototype)&&this.compileFunctionUsingTypeArguments(S,[],e.contextualTypeArguments,null,S.declaration.name),(L=y.setterPrototype)&&this.compileFunctionUsingTypeArguments(L,[],e.contextualTypeArguments,null,L.declaration.name)}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=_.return)&&a.call(_)}finally{if(n)throw n.error}}return!0},t.prototype.compileInterfaceDeclaration=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.error(o.DiagnosticCode.Operation_not_supported,e.range)},t.prototype.addMemorySegment=function(e,t){void 0===t&&(t=8);var r=i64_align(this.memoryOffset,t),n=c.MemorySegment.create(e,r);return this.memorySegments.push(n),this.memoryOffset=i64_add(r,i64_new(e.length,0)),n},t.prototype.ensureFunctionTableEntry=function(e){if(assert(e.is(p.CommonFlags.COMPILED)),e.functionTableIndex>=0)return e.functionTableIndex;var t=this.functionTable,r=t.length;return!e.is(p.CommonFlags.TRAMPOLINE)&&e.signature.requiredParameters<e.signature.parameterTypes.length&&(e=this.ensureTrampoline(e)),t.push(e),e.functionTableIndex=r,r},t.prototype.compileStatement=function(e){var t,r=this.module;switch(e.kind){case h.NodeKind.BLOCK:t=this.compileBlockStatement(e);break;case h.NodeKind.BREAK:t=this.compileBreakStatement(e);break;case h.NodeKind.CONTINUE:t=this.compileContinueStatement(e);break;case h.NodeKind.DO:t=this.compileDoStatement(e);break;case h.NodeKind.EMPTY:t=this.compileEmptyStatement(e);break;case h.NodeKind.EXPRESSION:t=this.compileExpressionStatement(e);break;case h.NodeKind.FOR:t=this.compileForStatement(e);break;case h.NodeKind.IF:t=this.compileIfStatement(e);break;case h.NodeKind.RETURN:t=this.compileReturnStatement(e);break;case h.NodeKind.SWITCH:t=this.compileSwitchStatement(e);break;case h.NodeKind.THROW:t=this.compileThrowStatement(e);break;case h.NodeKind.TRY:t=this.compileTryStatement(e);break;case h.NodeKind.VARIABLE:(t=this.compileVariableStatement(e))||(t=r.createNop());break;case h.NodeKind.VOID:t=this.compileVoidStatement(e);break;case h.NodeKind.WHILE:t=this.compileWhileStatement(e);break;case h.NodeKind.TYPEDECLARATION:if(this.currentFunction==this.startFunctionInstance)return r.createNop();default:assert(!1),t=r.createUnreachable()}return this.options.sourceMap&&this.addDebugLocation(t,e.range),t},t.prototype.compileStatements=function(e){var t=e.length,r=new Array(t);r.length=0;for(var n=this.currentFunction.flow,i=0;i<t;++i){var a=this.compileStatement(e[i]);switch(c.getExpressionId(a)){case c.ExpressionId.Block:if(!c.getBlockName(a)){for(var s=0,o=c.getBlockChildCount(a);s<o;++s)r.push(c.getBlockChild(a,s));break}default:r.push(a);case c.ExpressionId.Nop:}if(n.isAny(29))break}return r},t.prototype.compileBlockStatement=function(e){var t=e.statements,r=this.currentFunction.flow,n=r.fork();this.currentFunction.flow=n;var i=this.compileStatements(t),a=0==i.length?this.module.createNop():1==i.length?i[0]:this.module.createBlock(null,i,c.getExpressionType(i[i.length-1]));return this.currentFunction.flow=n.free(),r.inherit(n),a},t.prototype.compileBreakStatement=function(e){var t=this.module;if(e.label)return this.error(o.DiagnosticCode.Operation_not_supported,e.label.range),t.createUnreachable();var r=this.currentFunction.flow,n=r.breakLabel;return null==n?(this.error(o.DiagnosticCode.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement,e.range),t.createUnreachable()):(r.set(8),t.createBreak(n))},t.prototype.compileContinueStatement=function(e){var t=this.module,r=e.label;if(r)return this.error(o.DiagnosticCode.Operation_not_supported,r.range),t.createUnreachable();var n=this.currentFunction.flow,i=n.continueLabel;return null==i?(this.error(o.DiagnosticCode.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement,e.range),t.createUnreachable()):(n.set(16),t.createBreak(i))},t.prototype.compileDoStatement=function(e){var t=this.currentFunction,r=this.module,n=t.enterBreakContext(),i=t.flow,a=i.fork();t.flow=a;var s="break|"+n;a.breakLabel=s;var o="continue|"+n;a.continueLabel=o;var p=this.compileStatement(e.statement),l=this.makeIsTrueish(this.compileExpression(e.condition,d.Type.i32,0,0),this.currentType);t.flow=a.free(),t.leaveBreakContext();var u=a.isAny(29);return a.unset(792),i.inherit(a),r.createBlock(s,[r.createLoop(o,u?p:r.createBlock(null,[p,r.createBreak(o,l)],c.NativeType.None))],u?c.NativeType.Unreachable:c.NativeType.None)},t.prototype.compileEmptyStatement=function(e){return this.module.createNop()},t.prototype.compileExpressionStatement=function(e){var t=this.compileExpression(e.expression,d.Type.void,0,0);return this.currentType!=d.Type.void&&(t=this.module.createDrop(t),this.currentType=d.Type.void),t},t.prototype.compileForStatement=function(e){var t=this.currentFunction,r=t.enterBreakContext(),n=t.flow,i=n.fork();t.flow=i;var a=i.breakLabel="break|"+r;i.breakLabel=a;var s="continue|"+r;i.continueLabel=s;var o="repeat|"+r,p=this.module,l=e.initializer?this.compileStatement(e.initializer):0,u=0,h=!1;if(e.condition){u=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType);var _=this.precomputeExpressionRef(u);c.getExpressionId(_)==c.ExpressionId.Const&&(assert(c.getExpressionType(_)==c.NativeType.I32),0!=c.getConstValueI32(_)&&(h=!0)),u=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType)}else u=p.createI32(1),h=!0;var m=e.incrementor?this.compileExpression(e.incrementor,d.Type.void,1,0):0,y=this.compileStatement(e.statement);t.flow=i.free(),t.leaveBreakContext();var g=i.isAny(528);i.unset(792);var T=h&&i.isAny(29);h?n.inherit(i):n.inheritConditional(i);var E=new Array;l&&E.push(l);var f=new Array;return g?f.push(p.createBlock(s,[p.createBreak(a,p.createUnary(c.UnaryOp.EqzI32,u)),y],c.NativeType.None)):(f.push(p.createBreak(a,p.createUnary(c.UnaryOp.EqzI32,u))),f.push(y)),m&&f.push(m),f.push(p.createBreak(o)),E.push(p.createLoop(o,p.createBlock(null,f,c.NativeType.None))),p.createBlock(a,E,T?c.NativeType.Unreachable:c.NativeType.None)},t.prototype.compileIfStatement=function(e){var t=this.module,r=this.currentFunction,n=e.ifTrue,i=e.ifFalse,a=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType);if(!this.options.noTreeShaking||this.currentFunction.isAny(p.CommonFlags.GENERIC|p.CommonFlags.GENERIC_CONTEXT)){var s=this.precomputeExpressionRef(a);if(c.getExpressionId(s)==c.ExpressionId.Const&&c.getExpressionType(s)==c.NativeType.I32)return c.getConstValueI32(s)?this.compileStatement(n):i?this.compileStatement(i):t.createNop();a=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType)}var o=r.flow,l=o.fork();r.flow=l;var u=this.compileStatement(n);r.flow=l.free();var h=0;if(i){var _=o.fork();r.flow=_,h=this.compileStatement(i),r.flow=_.free(),o.inheritMutual(l,_)}else o.inheritConditional(l);return t.createIf(a,u,h)},t.prototype.compileReturnStatement=function(e){var t=this.module,r=this.currentFunction,n=0,i=r.flow;if(i.set(1),e.value){var a=i.returnType;if(a==d.Type.void)return this.compileExpressionRetainType(e.value,a,0),this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,e.value.range,this.currentType.toString(),a.toString()),this.currentType=d.Type.void,t.createUnreachable();n=this.compileExpression(e.value,a,1,r.is(p.CommonFlags.MODULE_EXPORT)?1:0),i.canOverflow(n,a)||i.set(2)}return h.isLastStatement(e)?n||t.createNop():i.is(2048)?t.createBreak(assert(i.returnLabel),0,n):t.createReturn(n)},t.prototype.compileSwitchStatement=function(e){var t=this.module,r=this.currentFunction,n=e.cases,i=n.length;if(!i)return this.compileExpression(e.condition,d.Type.void,1,0);var a=r.enterBreakContext(),s=r.flow,o=r.getTempLocal(d.Type.u32,!1),p=o.index,l=new Array(1+i);l[0]=t.createSetLocal(p,this.compileExpression(e.condition,d.Type.u32,1,0));for(var u=1,h=-1,_=0;_<i;++_){var m=n[_].label;m?l[u++]=t.createBreak("case"+_.toString(10)+"|"+a,t.createBinary(c.BinaryOp.EqI32,t.createGetLocal(p,c.NativeType.I32),this.compileExpression(m,d.Type.u32,1,0))):h=_}r.freeTempLocal(o),l[u]=t.createBreak((h>=0?"case"+h.toString(10):"break")+"|"+a);var y=t.createBlock("case0|"+a,l,c.NativeType.None),g=!0,T=!0,E=!0,f=!0;for(_=0;_<i;++_){var I=n[_].statements,v=I.length,A=s.fork();r.flow=A;var N="break|"+a;A.breakLabel=N;var C=_==i-1,O=C?N:"case"+(_+1).toString(10)+"|"+a,S=new Array(1+v);S[0]=y;for(var L=1,b=!1,k=0;k<v;++k){var R=this.compileStatement(I[k]);if(c.getExpressionId(R)!=c.ExpressionId.Nop&&(S[L++]=R,A.isAny(29))){b=!0;break}}S.length=L,(b||C)&&(A.is(1)||(g=!1),A.is(2)||(T=!1),A.is(4)||(E=!1),A.is(32)||(f=!1)),A.unset(264),r.flow=A.free(),y=t.createBlock(O,S,c.NativeType.None)}return r.leaveBreakContext(),h>=0&&(g&&s.set(1),T&&s.set(2),E&&s.set(4),f&&s.set(32)),y},t.prototype.compileThrowStatement=function(e){var t=this.currentFunction.flow;return t.set(4),t.set(1),s.compileAbort(this,null,e)},t.prototype.compileTryStatement=function(e){return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileVariableStatement=function(e,t){void 0===t&&(t=!1);var r=this.program,n=this.currentFunction,i=e.declarations,a=i.length;if(t||n==this.startFunctionInstance&&e.parent&&e.parent.kind==h.NodeKind.SOURCE){for(var s=0;s<a;++s)this.compileGlobalDeclaration(i[s]);return 0}var u=new Array,_=this.currentFunction.flow;for(s=0;s<a;++s){var m=i[s],y=m.name.text,g=null,T=0;if(m.type){if(!(g=r.resolveType(m.type,_.contextualTypeArguments)))continue;m.initializer&&(T=this.compileExpression(m.initializer,g,1,0))}else{if(!m.initializer){this.error(o.DiagnosticCode.Type_expected,m.name.range.atEnd);continue}if(T=this.compileExpressionRetainType(m.initializer,d.Type.void,0),this.currentType==d.Type.void){this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,m.range,this.currentType.toString(),"<auto>");continue}g=this.currentType}var E=!1;if(m.is(p.CommonFlags.CONST))if(T)if(T=this.precomputeExpressionRef(T),c.getExpressionId(T)==c.ExpressionId.Const){var f=new l.Local(r,y,-1,g);switch(c.getExpressionType(T)){case c.NativeType.I32:f=f.withConstantIntegerValue(c.getConstValueI32(T),0);break;case c.NativeType.I64:f=f.withConstantIntegerValue(c.getConstValueI64Low(T),c.getConstValueI64High(T));break;case c.NativeType.F32:f=f.withConstantFloatValue(c.getConstValueF32(T));break;case c.NativeType.F64:f=f.withConstantFloatValue(c.getConstValueF64(T));break;default:return assert(!1),this.module.createUnreachable()}var I=n.flow.scopedLocals;if(I){if(I.has(y))return this.error(o.DiagnosticCode.Duplicate_identifier_0,m.name.range,y),this.module.createUnreachable()}else n.flow.scopedLocals=I=new Map;I.set(y,f),E=!0}else this.warning(o.DiagnosticCode.Compiling_constant_with_non_constant_initializer_as_mutable,m.range);else this.error(o.DiagnosticCode._const_declarations_must_be_initialized,m.range);if(!E){f=void 0;f=m.isAny(p.CommonFlags.LET|p.CommonFlags.CONST)||_.is(2048)?_.addScopedLocal(g,y,!1,m):n.addLocal(g,y,m),T?(u.push(this.compileAssignmentWithValue(m.name,T)),f.type.is(36)&&_.setLocalWrapped(f.index,!_.canOverflow(T,g))):f.type.is(36)&&_.setLocalWrapped(f.index,!0)}}return u.length?1==u.length?u[0]:this.module.createBlock(null,u,c.NativeType.None):0},t.prototype.compileVoidStatement=function(e){return this.compileExpression(e.expression,d.Type.void,2,0)},t.prototype.compileWhileStatement=function(e){var t=this.module,r=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType);if(!this.options.noTreeShaking||this.currentFunction.isAny(p.CommonFlags.GENERIC|p.CommonFlags.GENERIC_CONTEXT)){var n=this.precomputeExpressionRef(r);if(c.getExpressionId(n)==c.ExpressionId.Const&&c.getExpressionType(n)==c.NativeType.I32){if(!c.getConstValueI32(n))return t.createNop()}else r=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType)}var i=this.currentFunction,a=i.enterBreakContext(),s=i.flow,o=s.fork();i.flow=o;var l="break|"+a;o.breakLabel=l;var u="continue|"+a;o.continueLabel=u;var h=this.compileStatement(e.statement),_=o.isAny(29);return i.flow=o.free(),i.leaveBreakContext(),o.unset(792),s.inheritConditional(o),t.createBlock(l,[t.createLoop(u,t.createIf(r,_?h:t.createBlock(null,[h,t.createBreak(u)],c.NativeType.None)))],c.NativeType.None)},t.prototype.compileInlineConstant=function(e,t,r){assert(e.is(p.CommonFlags.INLINED));var n=e.type;switch(!r&&n.is(4)&&t.is(4)&&n.size<t.size?(this.currentType=t).kind:(this.currentType=n).kind){case 0:case 1:var i=n.computeSmallIntegerShift(d.Type.i32);return this.module.createI32(1==e.constantValueKind?i64_low(e.constantIntegerValue)<<i>>i:0);case 5:case 6:case 10:var a=e.type.computeSmallIntegerMask(d.Type.i32);return this.module.createI32(1==e.constantValueKind?i64_low(e.constantIntegerValue)&a:0);case 2:case 7:return this.module.createI32(1==e.constantValueKind?i64_low(e.constantIntegerValue):0);case 4:case 9:if(!e.program.options.isWasm64)return this.module.createI32(1==e.constantValueKind?i64_low(e.constantIntegerValue):0);case 3:case 8:return 1==e.constantValueKind?this.module.createI64(i64_low(e.constantIntegerValue),i64_high(e.constantIntegerValue)):this.module.createI64(0);case 12:if(!e.is(p.CommonFlags.BUILTIN)||t!=d.Type.f32)return this.module.createF64(e.constantFloatValue);this.currentType=d.Type.f32;case 11:return this.module.createF32(e.constantFloatValue);default:return assert(!1),this.module.createUnreachable()}},t.prototype.compileExpression=function(e,t,r,n){var i;switch(this.currentType=t,e.kind){case h.NodeKind.ASSERTION:i=this.compileAssertionExpression(e,t);break;case h.NodeKind.BINARY:i=this.compileBinaryExpression(e,t);break;case h.NodeKind.CALL:i=this.compileCallExpression(e,t);break;case h.NodeKind.COMMA:i=this.compileCommaExpression(e,t);break;case h.NodeKind.ELEMENTACCESS:i=this.compileElementAccessExpression(e,t);break;case h.NodeKind.FUNCTION:i=this.compileFunctionExpression(e,t);break;case h.NodeKind.IDENTIFIER:case h.NodeKind.FALSE:case h.NodeKind.NULL:case h.NodeKind.THIS:case h.NodeKind.SUPER:case h.NodeKind.TRUE:i=this.compileIdentifierExpression(e,t,0==r);break;case h.NodeKind.INSTANCEOF:i=this.compileInstanceOfExpression(e,t);break;case h.NodeKind.LITERAL:i=this.compileLiteralExpression(e,t);break;case h.NodeKind.NEW:i=this.compileNewExpression(e,t);break;case h.NodeKind.PARENTHESIZED:i=this.compileParenthesizedExpression(e,t);break;case h.NodeKind.PROPERTYACCESS:i=this.compilePropertyAccessExpression(e,t,0==r);break;case h.NodeKind.TERNARY:i=this.compileTernaryExpression(e,t);break;case h.NodeKind.UNARYPOSTFIX:i=this.compileUnaryPostfixExpression(e,t);break;case h.NodeKind.UNARYPREFIX:i=this.compileUnaryPrefixExpression(e,t);break;default:assert(!1),i=this.module.createUnreachable()}var a=this.currentType;return 0!=r&&a!=t?(i=this.convertExpression(i,a,t,r,n,e),this.currentType=t):1==n&&(i=this.ensureSmallIntegerWrap(i,a)),this.options.sourceMap&&this.addDebugLocation(i,e.range),i},t.prototype.compileExpressionRetainType=function(e,t,r){return this.compileExpression(e,t==d.Type.void?d.Type.i32:t,0,r)},t.prototype.precomputeExpression=function(e,t,r,n){return this.precomputeExpressionRef(this.compileExpression(e,t,r,n))},t.prototype.precomputeExpressionRef=function(e){var t=this.module,r=this.currentType.toNativeType(),n=t.addTemporaryFunction(r,null,e);t.runPasses(["precompute"],n);var i=c.getFunctionBody(n);return t.removeTemporaryFunction(),i},t.prototype.convertExpression=function(e,t,r,n,i,a){assert(0!=n);var s=this.module;return 13==t.kind?(assert(13!=r.kind),this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,a.range,t.toString(),r.toString()),s.createUnreachable()):13==r.kind?s.createDrop(e):(t.isAssignableTo(r)||1==n&&this.error(o.DiagnosticCode.Conversion_from_type_0_to_1_requires_an_explicit_cast,a.range,t.toString(),r.toString()),t.is(8)?r.is(8)?11==t.kind?12==r.kind&&(e=s.createUnary(c.UnaryOp.PromoteF32,e)):11==r.kind&&(e=s.createUnary(c.UnaryOp.DemoteF64,e)):r.is(4)?e=11==t.kind?r.is(1)?r.is(64)?s.createUnary(c.UnaryOp.TruncF32ToI64,e):s.createUnary(c.UnaryOp.TruncF32ToI32,e):r.is(64)?s.createUnary(c.UnaryOp.TruncF32ToU64,e):s.createUnary(c.UnaryOp.TruncF32ToU32,e):r.is(1)?r.is(64)?s.createUnary(c.UnaryOp.TruncF64ToI64,e):s.createUnary(c.UnaryOp.TruncF64ToI32,e):r.is(64)?s.createUnary(c.UnaryOp.TruncF64ToU64,e):s.createUnary(c.UnaryOp.TruncF64ToU32,e):(assert(0==r.flags,"void type expected"),e=s.createDrop(e)):t.is(4)&&r.is(8)?e=11==r.kind?t.is(64)?s.createUnary(t.is(1)?c.UnaryOp.ConvertI64ToF32:c.UnaryOp.ConvertU64ToF32,e):s.createUnary(t.is(1)?c.UnaryOp.ConvertI32ToF32:c.UnaryOp.ConvertU32ToF32,e):t.is(64)?s.createUnary(t.is(1)?c.UnaryOp.ConvertI64ToF64:c.UnaryOp.ConvertU64ToF64,e):s.createUnary(t.is(1)?c.UnaryOp.ConvertI32ToF64:c.UnaryOp.ConvertU32ToF64,e):t.is(64)?r.is(64)||(e=s.createUnary(c.UnaryOp.WrapI64,e)):r.is(64)?(e=s.createUnary(r.is(1)?c.UnaryOp.ExtendI32:c.UnaryOp.ExtendU32,this.ensureSmallIntegerWrap(e,t)),i=0):t.is(32)&&t.size<r.size&&(e=this.ensureSmallIntegerWrap(e,t),i=0),this.currentType=r,1==i?this.ensureSmallIntegerWrap(e,r):e)},t.prototype.compileAssertionExpression=function(e,t){var r=this.program.resolveType(e.toType,this.currentFunction.flow.contextualTypeArguments);return r?this.compileExpression(e.expression,r,2,0):this.module.createUnreachable()},t.prototype.compileBinaryExpression=function(e,t){var r,n,i,a,s,p,h=this.module,_=e.left,m=e.right,y=!1,g=e.operator;switch(g){case u.Token.LESSTHAN:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.LT)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!0)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"<",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.LtI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.LtI64,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.LtI64:c.BinaryOp.LtI32,r,i);break;case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.LtU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.LtU64:c.BinaryOp.LtU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.LtU64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.LtF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.LtF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.GREATERTHAN:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.GT)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!0)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,">",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.GtI32,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.GtI64:c.BinaryOp.GtI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.GtI64,r,i);break;case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.GtU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.GtU64:c.BinaryOp.GtU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.GtU64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.GtF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.GtF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.LESSTHAN_EQUALS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.LE)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!0)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"<=",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.LeI32,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.LeI64:c.BinaryOp.LeI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.LeI64,r,i);break;case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.LeU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.LeU64:c.BinaryOp.LeU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.LeU64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.LeF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.LeF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.GREATERTHAN_EQUALS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.GE)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!0)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,">=",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.GeI32,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.GeI64:c.BinaryOp.GeI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.GeI64,r,i);break;case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.GeU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.GeU64:c.BinaryOp.GeU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.GeU64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.GeF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.GeF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.EQUALS_EQUALS_EQUALS:case u.Token.EQUALS_EQUALS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,g==u.Token.EQUALS_EQUALS&&this.currentType.is(256))if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.EQ)){p=this.compileBinaryOverload(v,_,r,m,e);break}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,u.operatorTokenToString(e.operator),n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.EqI32,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.EqI64:c.BinaryOp.EqI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.EqI64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.EqF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.EqF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.EXCLAMATION_EQUALS_EQUALS:case u.Token.EXCLAMATION_EQUALS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,g==u.Token.EXCLAMATION_EQUALS&&this.currentType.is(256))if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.NE)){p=this.compileBinaryOverload(v,_,r,m,e);break}if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,u.operatorTokenToString(e.operator),n.toString(),a.toString()),this.currentType=t,h.createUnreachable();switch(r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m),s.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:p=h.createBinary(c.BinaryOp.NeI32,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.NeI64:c.BinaryOp.NeI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.NeI64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.NeF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.NeF64,r,i);break;default:assert(!1),p=h.createUnreachable()}this.currentType=d.Type.bool;break;case u.Token.EQUALS:return this.compileAssignment(_,m,t);case u.Token.PLUS_EQUALS:y=!0;case u.Token.PLUS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.ADD)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)i=this.compileExpression(m,n,1,0);else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"+",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:p=h.createBinary(c.BinaryOp.AddI32,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.AddI64:c.BinaryOp.AddI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.AddI64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.AddF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.AddF64,r,i);break;default:assert(!1),p=h.createUnreachable()}break;case u.Token.MINUS_EQUALS:y=!0;case u.Token.MINUS:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.SUB)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)i=this.compileExpression(m,n,1,0),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"-",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:p=h.createBinary(c.BinaryOp.SubI32,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.SubI64:c.BinaryOp.SubI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.SubI64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.SubF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.SubF64,r,i);break;default:assert(!1),p=h.createUnreachable()}break;case u.Token.ASTERISK_EQUALS:y=!0;case u.Token.ASTERISK:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.MUL)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)r=this.ensureSmallIntegerWrap(r,n),i=this.compileExpression(m,n,1,1);else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"*",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:p=h.createBinary(c.BinaryOp.MulI32,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.MulI64:c.BinaryOp.MulI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.MulI64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.MulF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.MulF64,r,i);break;default:assert(!1),p=h.createUnreachable()}break;case u.Token.ASTERISK_ASTERISK_EQUALS:y=!0;case u.Token.ASTERISK_ASTERISK:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.POW)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}var T=void 0;if(11==this.currentType.kind){if(i=this.compileExpression(m,d.Type.f32,1,0),a=this.currentType,!(T=this.f32PowInstance)){if(!(E=this.program.elementsLookup.get("Mathf"))){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Mathf"),p=h.createUnreachable();break}if(!(f=E.members?E.members.get("pow"):null)){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Mathf.pow"),p=h.createUnreachable();break}assert(f.kind==l.ElementKind.FUNCTION_PROTOTYPE),this.f32PowInstance=T=f.resolve()}}else if(r=this.convertExpression(r,this.currentType,d.Type.f64,1,0,_),n=this.currentType,i=this.compileExpression(m,d.Type.f64,1,0),a=this.currentType,!(T=this.f64PowInstance)){if(!(E=this.program.elementsLookup.get("Math"))){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Math"),p=h.createUnreachable();break}if(!(f=E.members?E.members.get("pow"):null)){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Math.pow"),p=h.createUnreachable();break}assert(f.kind==l.ElementKind.FUNCTION_PROTOTYPE),this.f64PowInstance=T=f.resolve()}p=T&&this.compileFunction(T)?this.makeCallDirect(T,[r,i]):h.createUnreachable();break;case u.Token.SLASH_EQUALS:y=!0;case u.Token.SLASH:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.DIV)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)r=this.ensureSmallIntegerWrap(r,n),i=this.compileExpression(m,n,1,1),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"/",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m)}switch(this.currentType.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.DivI32,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.DivI64:c.BinaryOp.DivI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.DivI64,r,i);break;case 5:case 6:case 10:case 7:p=h.createBinary(c.BinaryOp.DivU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.DivU64:c.BinaryOp.DivU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.DivU64,r,i);break;case 11:p=h.createBinary(c.BinaryOp.DivF32,r,i);break;case 12:p=h.createBinary(c.BinaryOp.DivF64,r,i);break;default:assert(!1),p=h.createUnreachable()}break;case u.Token.PERCENT_EQUALS:y=!0;case u.Token.PERCENT:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.REM)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)r=this.ensureSmallIntegerWrap(r,n),i=this.compileExpression(m,n,1,1),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"%",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,1,_),i=this.convertExpression(i,a,a=s,1,1,m)}switch(this.currentType.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.RemI32,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.RemI64:c.BinaryOp.RemI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.RemI64,r,i);break;case 5:case 6:case 10:case 7:p=h.createBinary(c.BinaryOp.RemU32,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.RemU64:c.BinaryOp.RemU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.RemU64,r,i);break;case 11:if(!(T=this.f32ModInstance)){if(!(E=this.program.elementsLookup.get("Mathf"))){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Mathf"),p=h.createUnreachable();break}if(!(f=E.members?E.members.get("mod"):null)){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Mathf.mod"),p=h.createUnreachable();break}assert(f.kind==l.ElementKind.FUNCTION_PROTOTYPE),this.f32ModInstance=T=f.resolve()}p=T&&this.compileFunction(T)?this.makeCallDirect(T,[r,i]):h.createUnreachable();break;case 12:if(!(T=this.f64ModInstance)){var E,f;if(!(E=this.program.elementsLookup.get("Math"))){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Math"),p=h.createUnreachable();break}if(!(f=E.members?E.members.get("mod"):null)){this.error(o.DiagnosticCode.Cannot_find_name_0,e.range,"Math.mod"),p=h.createUnreachable();break}assert(f.kind==l.ElementKind.FUNCTION_PROTOTYPE),this.f64ModInstance=T=f.resolve()}p=T&&this.compileFunction(T)?this.makeCallDirect(T,[r,i]):h.createUnreachable();break;default:assert(!1),p=h.createUnreachable()}break;case u.Token.LESSTHAN_LESSTHAN_EQUALS:y=!0;case u.Token.LESSTHAN_LESSTHAN:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_SHL)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}switch(i=this.compileExpression(m,n,1,0),a=this.currentType,this.currentType.kind){case 0:case 1:case 5:case 6:case 10:case 2:case 7:p=h.createBinary(c.BinaryOp.ShlI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.ShlI64,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.ShlI64:c.BinaryOp.ShlI32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.GREATERTHAN_GREATERTHAN_EQUALS:y=!0;case u.Token.GREATERTHAN_GREATERTHAN:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_SHR)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}switch(r=this.ensureSmallIntegerWrap(r,n),i=this.compileExpression(m,n,1,1),a=this.currentType,this.currentType.kind){case 0:case 1:case 2:p=h.createBinary(c.BinaryOp.ShrI32,r,i);break;case 3:p=h.createBinary(c.BinaryOp.ShrI64,r,i);break;case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.ShrI64:c.BinaryOp.ShrI32,r,i);break;case 5:case 6:case 10:case 7:p=h.createBinary(c.BinaryOp.ShrU32,r,i);break;case 8:p=h.createBinary(c.BinaryOp.ShrU64,r,i);break;case 9:p=h.createBinary(this.options.isWasm64?c.BinaryOp.ShrU64:c.BinaryOp.ShrU32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:y=!0;case u.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_SHR_U)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}switch(r=this.ensureSmallIntegerWrap(r,n),i=this.compileExpression(m,n,1,0),a=this.currentType,this.currentType.kind){case 5:case 6:case 10:p=h.createBinary(c.BinaryOp.ShrU32,r,i);case 0:case 1:case 2:case 7:p=h.createBinary(c.BinaryOp.ShrU32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.ShrU64,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.ShrU64:c.BinaryOp.ShrU32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.AMPERSAND_EQUALS:y=!0;case u.Token.AMPERSAND:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_AND)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)i=this.compileExpression(m,n,1,0),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"&",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 10:case 7:p=h.createBinary(c.BinaryOp.AndI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.AndI64,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.AndI64:c.BinaryOp.AndI32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.BAR_EQUALS:y=!0;case u.Token.BAR:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_OR)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)i=this.compileExpression(m,n,1,0),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"|",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:p=h.createBinary(c.BinaryOp.OrI32,r,i);break;case 2:case 7:p=h.createBinary(c.BinaryOp.OrI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.OrI64,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.OrI64:c.BinaryOp.OrI32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.CARET_EQUALS:y=!0;case u.Token.CARET:if(r=this.compileExpressionRetainType(_,t.intType,0),n=this.currentType,this.currentType.is(256)){var I,v;if(I=n.classReference)if(v=I.lookupOverload(l.OperatorKind.BITWISE_XOR)){p=this.compileBinaryOverload(v,_,r,m,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}if(y)i=this.compileExpression(m,n,1,0),a=this.currentType;else{if(i=this.compileExpressionRetainType(m,n,0),a=this.currentType,!(s=d.Type.commonCompatible(n,a,!1)))return this.error(o.DiagnosticCode.Operator_0_cannot_be_applied_to_types_1_and_2,e.range,"^",n.toString(),a.toString()),this.currentType=t,h.createUnreachable();r=this.convertExpression(r,n,n=s,1,0,_),i=this.convertExpression(i,a,a=s,1,0,m)}switch(this.currentType.kind){case 0:case 1:case 5:case 6:case 10:p=h.createBinary(c.BinaryOp.XorI32,r,i);break;case 2:case 7:p=h.createBinary(c.BinaryOp.XorI32,r,i);break;case 3:case 8:p=h.createBinary(c.BinaryOp.XorI64,r,i);break;case 9:case 4:p=h.createBinary(this.options.isWasm64?c.BinaryOp.XorI64:c.BinaryOp.XorI32,r,i);break;case 11:case 12:return this.error(o.DiagnosticCode.The_0_operator_cannot_be_applied_to_type_1,e.range,u.operatorTokenToString(e.operator),this.currentType.toString()),h.createUnreachable();default:assert(!1),p=h.createUnreachable()}break;case u.Token.AMPERSAND_AMPERSAND:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,i=this.compileExpression(m,n,1,0),a=this.currentType,p=h.cloneExpression(r,!0,0))this.makeIsTrueish(r,this.currentType),p=h.createIf(this.makeIsTrueish(r,this.currentType),i,p);else{var A=this.currentFunction.flow,N=this.currentFunction.getAndFreeTempLocal(this.currentType,!A.canOverflow(r,this.currentType));p=h.createIf(this.makeIsTrueish(h.createTeeLocal(N.index,r),this.currentType),i,h.createGetLocal(assert(N).index,this.currentType.toNativeType()))}break;case u.Token.BAR_BAR:if(r=this.compileExpressionRetainType(_,t,0),n=this.currentType,i=this.compileExpression(m,n,1,0),a=this.currentType,p=this.module.cloneExpression(r,!0,0))p=this.module.createIf(this.makeIsTrueish(r,this.currentType),p,i);else{A=this.currentFunction.flow,N=this.currentFunction.getAndFreeTempLocal(this.currentType,!A.canOverflow(r,this.currentType));p=h.createIf(this.makeIsTrueish(h.createTeeLocal(N.index,r),this.currentType),h.createGetLocal(assert(N).index,this.currentType.toNativeType()),i)}break;default:assert(!1),p=this.module.createUnreachable()}return y?this.compileAssignmentWithValue(_,p,t!=d.Type.void):p},t.prototype.compileUnaryOverload=function(e,t,r,n){var i,a=0;return e.is(p.CommonFlags.INSTANCE)?(a=r,i=[]):i=[t],this.compileCallDirect(e,i,n,a,e.hasDecorator(l.DecoratorFlags.INLINE))},t.prototype.compileBinaryOverload=function(e,t,r,n,i){var a,s=0;if(e.is(p.CommonFlags.INSTANCE)){var o=assert(e.parent);assert(o.kind==l.ElementKind.CLASS),s=r,a=[n]}else a=[t,n];return this.compileCallDirect(e,a,i,s,e.hasDecorator(l.DecoratorFlags.INLINE))},t.prototype.compileAssignment=function(e,t,r){var n,i=this.program,a=this.currentFunction,s=i.resolveExpression(e,a);if(!s)return this.module.createUnreachable();switch(s.kind){case l.ElementKind.GLOBAL:if(!this.compileGlobal(s))return this.module.createUnreachable();assert(s.type!=d.Type.void);case l.ElementKind.LOCAL:case l.ElementKind.FIELD:n=s.type;break;case l.ElementKind.PROPERTY:var c=s.setterPrototype;if(c){var p=c.resolve();if(!p)return this.module.createUnreachable();assert(1==p.signature.parameterTypes.length),n=p.signature.parameterTypes[0];break}return this.error(o.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,s.internalName),this.module.createUnreachable();case l.ElementKind.CLASS:if(i.resolvedElementExpression){var u=a.flow.is(4096),h=s.lookupOverload(l.OperatorKind.INDEXED_SET,u);if(!h)return s.lookupOverload(l.OperatorKind.INDEXED_GET,u)?this.error(o.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,s.internalName):this.error(o.DiagnosticCode.Index_signature_is_missing_in_type_0,e.range,s.internalName),this.module.createUnreachable();assert(2==h.signature.parameterTypes.length),n=h.signature.parameterTypes[1];break}default:return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()}assert(n!=d.Type.void);var _=this.compileExpression(t,n,1,0);return this.compileAssignmentWithValue(e,_,r!=d.Type.void)},t.prototype.compileAssignmentWithValue=function(e,t,r){void 0===r&&(r=!1);var n=this.module,i=this.program.resolveExpression(e,this.currentFunction);if(!i)return n.createUnreachable();switch(i.kind){case l.ElementKind.LOCAL:var a=i.type;if(assert(a!=d.Type.void),this.currentType=r?a:d.Type.void,i.is(p.CommonFlags.CONST))return this.error(o.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,i.internalName),n.createUnreachable();var s=this.currentFunction.flow;return a.is(36)&&s.setLocalWrapped(i.index,!s.canOverflow(t,a)),r?n.createTeeLocal(i.index,t):n.createSetLocal(i.index,t);case l.ElementKind.GLOBAL:if(!this.compileGlobal(i))return n.createUnreachable();a=i.type;if(assert(a!=d.Type.void),this.currentType=r?a:d.Type.void,i.is(p.CommonFlags.CONST))return this.error(o.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,i.internalName),n.createUnreachable();if(t=this.ensureSmallIntegerWrap(t,a),r){var c=a.toNativeType(),u=i.internalName;return n.createBlock(null,[n.createSetGlobal(u,t),n.createGetGlobal(u,c)],c)}return n.createSetGlobal(i.internalName,t);case l.ElementKind.FIELD:var h=i.declaration;if(i.is(p.CommonFlags.READONLY)&&!this.currentFunction.is(p.CommonFlags.CONSTRUCTOR)&&null!=h&&null==h.initializer)return this.error(o.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,i.internalName),n.createUnreachable();var _=assert(this.program.resolvedThisExpression),m=this.compileExpressionRetainType(_,this.options.usizeType,0);a=i.type;this.currentType=r?a:d.Type.void;c=a.toNativeType();if(10==a.kind&&(t=this.ensureSmallIntegerWrap(t,a)),r){s=(L=this.currentFunction).flow;var y=L.getAndFreeTempLocal(a,!s.canOverflow(t,a)).index;return n.createBlock(null,[n.createSetLocal(y,t),n.createStore(a.byteSize,m,n.createGetLocal(y,c),c,i.memoryOffset),n.createGetLocal(y,c)],c)}return n.createStore(a.byteSize,m,t,c,i.memoryOffset);case l.ElementKind.PROPERTY:var g=i.setterPrototype;if(g){var T=g.resolve();if(!T)return n.createUnreachable();if(!r){if(T.is(p.CommonFlags.INSTANCE)){_=assert(this.program.resolvedThisExpression),m=this.compileExpressionRetainType(_,this.options.usizeType,0);return this.makeCallDirect(T,[m,t])}return this.makeCallDirect(T,[t])}var E=i.getterPrototype;assert(null!=E);var f=E.resolve();if(!f)return n.createUnreachable();var I=(R=f.signature.returnType).toNativeType();if(T.is(p.CommonFlags.INSTANCE)){_=assert(this.program.resolvedThisExpression),m=this.compileExpressionRetainType(_,this.options.usizeType,0),y=this.currentFunction.getAndFreeTempLocal(R,!1).index;return n.createBlock(null,[this.makeCallDirect(T,[n.createTeeLocal(y,m),t]),this.makeCallDirect(f,[n.createGetLocal(y,I)])],I)}return n.createBlock(null,[this.makeCallDirect(T,[t]),this.makeCallDirect(f)],I)}return this.error(o.DiagnosticCode.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.range,i.internalName),n.createUnreachable();case l.ElementKind.CLASS:var v=this.program.resolvedElementExpression;if(v){var A=this.currentFunction.flow.is(4096),N=i.lookupOverload(l.OperatorKind.INDEXED_GET,A);if(!N)return this.error(o.DiagnosticCode.Index_signature_is_missing_in_type_0,e.range,i.internalName),n.createUnreachable();var C=i.lookupOverload(l.OperatorKind.INDEXED_SET,A);if(!C)return this.error(o.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,e.range,i.internalName),this.currentType=r?N.signature.returnType:d.Type.void,n.createUnreachable();var O=i.type,S=(_=assert(this.program.resolvedThisExpression),m=this.compileExpressionRetainType(_,this.options.usizeType,0),this.compileExpression(v,d.Type.i32,1,0));if(r){var L,b=(L=this.currentFunction).getTempLocal(O,!1),k=L.getAndFreeTempLocal(this.currentType,!1),R=N.signature.returnType;return this.currentFunction.freeTempLocal(b),n.createBlock(null,[this.makeCallDirect(C,[n.createTeeLocal(b.index,m),n.createTeeLocal(k.index,S),t]),this.makeCallDirect(N,[n.createGetLocal(b.index,b.type.toNativeType()),n.createGetLocal(k.index,k.type.toNativeType())])],R.toNativeType())}return this.makeCallDirect(C,[m,S,t])}}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()},t.prototype.compileCallExpression=function(e,t){var r,n,i=this.module,a=this.currentFunction,s=this.program.resolveExpression(e.expression,a);if(!s)return i.createUnreachable();switch(s.kind){case l.ElementKind.FUNCTION_PROTOTYPE:var u=s,_=e.typeArguments;if(u.is(p.CommonFlags.AMBIENT|p.CommonFlags.BUILTIN))return this.compileCallExpressionBuiltin(u,e,t);var m=null;if(_){if(!u.is(p.CommonFlags.GENERIC))return this.error(o.DiagnosticCode.Type_0_is_not_generic,e.expression.range,u.internalName),i.createUnreachable();m=u.resolveUsingTypeArguments(_,this.currentFunction.flow.contextualTypeArguments,e)}else{if(u.is(p.CommonFlags.GENERIC)){for(var y=new Map,g=assert(u.declaration.typeParameters),T=g.length,E=0;E<T;++E)y.set(g[E].name.text,null);var f=u.declaration.signature.parameters,I=f.length,v=e.arguments,A=v.length,N=new Array(A);for(E=0;E<I;++E){var C=f[E].type,O=C.kind==h.NodeKind.TYPE?C.name.text:null,S=E<A?v[E]:u.declaration.signature.parameters[E].initializer;if(!S)return this.error(o.DiagnosticCode.Expected_0_arguments_but_got_1,e.range,I.toString(10),A.toString(10)),i.createUnreachable();if(null!==O&&y.has(O)){if(R=y.get(O)){N[E]=this.compileExpressionRetainType(S,R,0);var L=void 0;if(!(L=d.Type.commonCompatible(R,this.currentType,!0))&&!(L=d.Type.commonCompatible(R,this.currentType,!1)))return this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,f[E].type.range,this.currentType.toString(),R.toString()),i.createUnreachable();R=L}else N[E]=this.compileExpressionRetainType(S,d.Type.i32,0),R=this.currentType;y.set(O,R)}else{var b=this.program.resolveType(f[E].type,this.currentFunction.flow.contextualTypeArguments,!0);if(!b)return i.createUnreachable();N[E]=this.compileExpression(S,b,1,0)}}var k=new Array(T);for(E=0;E<T;++E){var R=assert(y.get(g[E].name.text));k[E]=R}return(m=u.resolve(k,this.currentFunction.flow.contextualTypeArguments))?this.makeCallDirect(m,N):this.module.createUnreachable()}m=u.resolve(null,this.currentFunction.flow.contextualTypeArguments)}if(!m)return this.module.createUnreachable();var x=0;return m.is(p.CommonFlags.INSTANCE)&&(x=this.compileExpressionRetainType(assert(this.program.resolvedThisExpression),this.options.usizeType,0)),this.compileCallDirect(m,e.arguments,e,x,m.hasDecorator(l.DecoratorFlags.INLINE));case l.ElementKind.LOCAL:if(r=s.type.signatureReference){n=i.createGetLocal(s.index,c.NativeType.I32);break}return this.error(o.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,s.type.toString()),i.createUnreachable();case l.ElementKind.GLOBAL:if(r=s.type.signatureReference){n=i.createGetGlobal(s.internalName,s.type.toNativeType());break}return this.error(o.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,s.type.toString()),i.createUnreachable();case l.ElementKind.FIELD:if(r=s.type.signatureReference){var F=assert(this.program.resolvedThisExpression);x=this.compileExpressionRetainType(F,this.options.usizeType,0);n=i.createLoad(4,!1,x,c.NativeType.I32,s.memoryOffset);break}return this.error(o.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,e.range,s.type.toString()),i.createUnreachable();case l.ElementKind.FUNCTION_TARGET:r=s.signature,n=this.compileExpression(e.expression,s.type,1,0);break;case l.ElementKind.PROPERTY:default:return this.error(o.DiagnosticCode.Operation_not_supported,e.range),i.createUnreachable()}return this.compileCallIndirect(r,n,e.arguments,e)},t.prototype.compileCallExpressionBuiltin=function(e,t,r){var n=s.compileCall(this,e,e.resolveBuiltinTypeArguments(t.typeArguments,this.currentFunction.flow.contextualTypeArguments),t.arguments,r,t);return n||(this.error(o.DiagnosticCode.Operation_not_supported,t.range),this.module.createUnreachable())},t.prototype.checkCallSignature=function(e,t,r,n){if(r!=(null!=e.thisType))return this.error(o.DiagnosticCode.Operation_not_supported,n.range),!1;var i=e.hasRest;if(i)return this.error(o.DiagnosticCode.Operation_not_supported,n.range),!1;var a=e.requiredParameters,s=e.parameterTypes.length;return t<a?(this.error(a<s?o.DiagnosticCode.Expected_at_least_0_arguments_but_got_1:o.DiagnosticCode.Expected_0_arguments_but_got_1,n.range,a.toString(),t.toString()),!1):!(t>s&&!i)||(this.error(o.DiagnosticCode.Expected_0_arguments_but_got_1,n.range,s.toString(),t.toString()),!1)},t.prototype.compileCallDirect=function(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var a=t.length,s=e.signature;if(!this.checkCallSignature(s,a,0!=n,r))return this.module.createUnreachable();if(i)return assert(!e.is(p.CommonFlags.TRAMPOLINE)),this.compileCallInlineUnchecked(e,t,r,n);var o=n?a+1:a,c=new Array(o),l=0;n&&(c[0]=n,l=1);for(var u=s.parameterTypes,h=0;h<a;++h,++l)c[l]=this.compileExpression(t[h],u[h],1,0);return assert(l==o),this.makeCallDirect(e,c)},t.prototype.compileCallInlineUnchecked=function(e,t,r,n){var a,s;void 0===n&&(n=0);var u=t.length,_=e.signature,m=this.currentFunction,y=this.module,g=e.prototype.declaration,T=m.flow,E=e.internalName+"|inlined."+(e.nextInlineId++).toString(10),f=e.signature.returnType,I=l.Flow.create(m);I.set(2048),I.returnLabel=E,I.returnType=f,I.contextualTypeArguments=e.contextualTypeArguments;var v=[];if(n){var A=assert(e.parent);if(assert(A.kind==l.ElementKind.CLASS),c.getExpressionId(n)==c.ExpressionId.GetLocal)I.addScopedLocalAlias(c.getGetLocalIndex(n),A.type,"this");else{var N=I.addScopedLocal(A.type,"this",!1);v.push(y.createSetLocal(N.index,n))}}for(var C=_.parameterTypes,O=0;O<u;++O){var S=this.compileExpression(t[O],C[O],1,0);if(c.getExpressionId(S)==c.ExpressionId.GetLocal)I.addScopedLocalAlias(c.getGetLocalIndex(S),C[O],_.getParameterName(O));else{var L=I.addScopedLocal(C[O],_.getParameterName(O),!I.canOverflow(S,C[O]));v.push(y.createSetLocal(L.index,S))}}m.flow=I;var b=_.parameterTypes.length;for(O=u;O<b;++O){var k=this.compileExpression(assert(g.signature.parameters[O].initializer),C[O],1,1);L=I.addScopedLocal(C[O],_.getParameterName(O),!I.canOverflow(k,C[O]));v.push(y.createSetLocal(L.index,k))}var R=assert(g.body);if(R.kind==h.NodeKind.BLOCK)for(var x=R.statements,F=(O=0,x.length);O<F;++O){var B=this.compileStatement(x[O]);if(c.getExpressionId(B)!=c.ExpressionId.Nop&&(v.push(B),I.isAny(29)))break}else v.push(this.compileStatement(R));var U=I.scopedLocals;if(U){try{for(var D=i(U.values()),P=D.next();!P.done;P=D.next()){var w=P.value;w.is(p.CommonFlags.SCOPED)&&m.freeTempLocal(w)}}catch(e){a={error:e}}finally{try{P&&!P.done&&(s=D.return)&&s.call(D)}finally{if(a)throw a.error}}I.scopedLocals=null}return I.finalize(),this.currentFunction.flow=T,this.currentType=f,f==d.Type.void||I.isAny(29)?y.createBlock(E,v,f.toNativeType()):(this.error(o.DiagnosticCode.A_function_whose_declared_type_is_not_void_must_return_a_value,g.signature.returnType.range),y.createUnreachable())},t.prototype.ensureTrampoline=function(e){var t=e.trampoline;if(t)return t;var r=e.signature,n=e.internalName,i=r.parameterTypes,a=e.prototype.declaration.signature.parameters,s=r.returnType,u=r.thisType,h=e.is(p.CommonFlags.INSTANCE),_=r.requiredParameters,m=_,y=i.length,g=y;h&&(++m,++g);var T=assert(g-m),E=new Array(m),f=0,I=this.module;h&&(E[0]=I.createGetLocal(0,this.options.nativeSizeType),f=1);for(var v=0;v<_;++v,++f)E[f]=I.createGetLocal(f,i[v].toNativeType());assert(f==m);var A=new d.Signature(i,s,u),N=n+"|trampoline";A.requiredParameters=y,(t=new l.Function(e.prototype,N,A,e.parent,e.contextualTypeArguments)).set(e.flags|p.CommonFlags.TRAMPOLINE|p.CommonFlags.COMPILED),e.trampoline=t;var C=this.currentFunction;this.currentFunction=t;var O=T+1,S=new Array(O),L="of"+T.toString(10);for(v=0;v<O;++v){var b=v.toString(10)+L;S[v]=b}var k=I.createBlock(S[0],[I.createBlock("oob",[I.createSwitch(S,"oob",_?I.createBinary(c.BinaryOp.SubI32,I.createGetGlobal("~argc",c.NativeType.I32),I.createI32(_)):I.createGetGlobal("~argc",c.NativeType.I32))]),I.createUnreachable()]);for(v=0;v<T;++v,++f){var R=i[_+v],x=a[_+v],F=x.initializer,B=void 0;F?B=I.createSetLocal(f,this.compileExpression(F,R,1,1)):(this.error(o.DiagnosticCode.Optional_parameter_must_have_an_initializer,x.range),B=I.createUnreachable()),k=I.createBlock(S[v+1],[k,B]),E[f]=I.createGetLocal(f,R.toNativeType())}this.currentFunction=C,assert(f==g);var U=I.addFunction(N,this.ensureFunctionType(A.parameterTypes,A.returnType,A.thisType),d.typesToNativeTypes(t.additionalLocals),I.createBlock(null,[k,I.createCall(n,E,s.toNativeType())],s.toNativeType()));return t.finalize(I,U),t},t.prototype.ensureArgcVar=function(){if(!this.argcVar){var e=this.module;this.argcVar=e.addGlobal("~argc",c.NativeType.I32,!0,e.createI32(0))}return"~argc"},t.prototype.ensureArgcSet=function(){if(!this.argcSet){var e=this.module;this.argcSet=e.addFunction("~setargc",this.ensureFunctionType([d.Type.u32],d.Type.void),null,e.createSetGlobal(this.ensureArgcVar(),e.createGetLocal(0,c.NativeType.I32))),e.addFunctionExport("~setargc","_setargc")}return"~setargc"},t.prototype.makeCallDirect=function(e,t){void 0===t&&(t=null);var r=t?t.length:0,n=r,i=e.signature.requiredParameters,a=e.signature.parameterTypes.length,s=a;e.is(p.CommonFlags.INSTANCE)&&(++i,++s,--n),assert(r>=i);var o=this.module;if(!this.compileFunction(e))return o.createUnreachable();var c=e.signature.returnType,l=e.is(p.CommonFlags.MODULE_IMPORT);if(r<s){t||((t=new Array(s)).length=0);for(var u=e.signature.parameterTypes,d=e.prototype.declaration.signature.parameters,_=!0,m=n;m<a;++m){var y=d[m].initializer;if(null===y||!h.nodeIsConstantValue(y.kind)){_=!1;break}}if(_)for(m=n;m<a;++m)t.push(this.compileExpression(d[m].initializer,u[m],1,0));else{for(m=n;m<a;++m)t.push(u[m].toNativeZero(o));if(!l){var g=e;if(e=this.ensureTrampoline(e),!this.compileFunction(e))return o.createUnreachable();e.flow.flags=g.flow.flags,this.program.instancesLookup.set(e.internalName,e);var T=c.toNativeType();return this.currentType=c,o.createBlock(null,[o.createSetGlobal(this.ensureArgcVar(),o.createI32(n)),o.createCall(e.internalName,t,T)],T)}}}return this.currentType=c,l?o.createCallImport(e.internalName,t,c.toNativeType()):o.createCall(e.internalName,t,c.toNativeType())},t.prototype.compileCallIndirect=function(e,t,r,n,i){void 0===i&&(i=0);var a=r.length;if(!this.checkCallSignature(e,a,0!=i,n))return this.module.createUnreachable();var s=i?a+1:a,o=new Array(s),c=0;i&&(o[0]=i,c=1);for(var p=e.parameterTypes,l=0;l<a;++l,++c)o[c]=this.compileExpression(r[l],p[l],1,0);return assert(c==s),this.makeCallIndirect(e,t,o)},t.prototype.makeCallIndirect=function(e,t,r){void 0===r&&(r=null);var n=r?r.length:0,i=n,a=e.requiredParameters,s=e.parameterTypes.length,o=s;e.thisType&&(++a,++o,--i),assert(n>=a),this.ensureFunctionType(e.parameterTypes,e.returnType,e.thisType);var c=this.module;if(n<o){r||((r=new Array(o)).length=0);for(var p=e.parameterTypes,l=i;l<s;++l)r.push(p[l].toNativeZero(c))}var u=e.returnType;return this.currentType=u,c.createBlock(null,[c.createSetGlobal(this.ensureArgcVar(),c.createI32(i)),c.createCallIndirect(t,r,e.toSignatureString())],u.toNativeType())},t.prototype.compileCommaExpression=function(e,t){for(var r=e.expressions,n=r.length,i=new Array(n--),a=0;a<n;++a)i[a]=this.compileExpression(r[a],d.Type.void,2,0);return i[n]=this.compileExpression(r[n],t,1,0),this.module.createBlock(null,i,this.currentType.toNativeType())},t.prototype.compileElementAccessExpression=function(e,t){var r=this.program.resolveElementAccess(e,this.currentFunction);if(!r)return this.module.createUnreachable();switch(r.kind){case l.ElementKind.CLASS:var n=this.currentFunction.flow.is(4096),i=r.lookupOverload(l.OperatorKind.INDEXED_GET,n);if(!i)return this.error(o.DiagnosticCode.Index_signature_is_missing_in_type_0,e.expression.range,r.internalName),this.module.createUnreachable();var a=this.compileExpression(e.expression,r.type,1,0);return this.compileCallDirect(i,[e.elementExpression],e,a)}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileFunctionExpression=function(e,t){var r=e.declaration,n=r.name,i=(n.text.length?n.text:"anonymous")+"|"+this.functionTable.length.toString(10),a=this.currentFunction,s=new l.FunctionPrototype(this.program,i,a.internalName+p.INNER_DELIMITER+i,r,null,l.DecoratorFlags.NONE),o=a.flow,c=this.compileFunctionUsingTypeArguments(s,[],o.contextualTypeArguments,o,r);if(!c)return this.module.createUnreachable();this.currentType=c.signature.type;var u=this.ensureFunctionTableEntry(c);return u<0?this.module.createUnreachable():this.module.createI32(u)},t.prototype.compileIdentifierExpression=function(e,t,r){var n=this.module,i=this.currentFunction;switch(e.kind){case h.NodeKind.NULL:var a=this.options;return t.classReference||(this.currentType=a.usizeType),a.isWasm64?n.createI64(0):n.createI32(0);case h.NodeKind.TRUE:return this.currentType=d.Type.bool,n.createI32(1);case h.NodeKind.FALSE:return this.currentType=d.Type.bool,n.createI32(0);case h.NodeKind.THIS:if((_=i.flow).is(2048))if(m=_.getScopedLocal("this"))return this.currentType=m.type,n.createGetLocal(m.index,m.type.toNativeType());if(i.is(p.CommonFlags.INSTANCE)){var s=assert(i.parent);assert(s.kind==l.ElementKind.CLASS);var u=s.type;return i.is(p.CommonFlags.CONSTRUCTOR)&&!_.is(32)?(_.set(32),this.currentType=u,n.createTeeLocal(0,this.makeConditionalAllocate(s,e))):(this.currentType=u,n.createGetLocal(0,u.toNativeType()))}return this.error(o.DiagnosticCode._this_cannot_be_referenced_in_current_location,e.range),this.currentType=this.options.usizeType,n.createUnreachable();case h.NodeKind.SUPER:var _,m;if((_=i.flow).is(2048))if(m=_.getScopedLocal("this"))if(y=assert(m.type.classReference).base)return this.currentType=y.type,n.createGetLocal(m.index,y.type.toNativeType());if(i.is(p.CommonFlags.INSTANCE)){var y;s=assert(i.parent);if(assert(s.kind==l.ElementKind.CLASS),y=s.base){var g=y.type;return this.currentType=g,n.createGetLocal(0,g.toNativeType())}}return this.error(o.DiagnosticCode._super_can_only_be_referenced_in_a_derived_class,e.range),this.currentType=this.options.usizeType,n.createUnreachable()}var T=this.program.resolveIdentifier(e,i,this.currentEnum);if(!T)return n.createUnreachable();switch(T.kind){case l.ElementKind.LOCAL:if(T.is(p.CommonFlags.INLINED))return this.compileInlineConstant(T,t,r);var E=T.type,f=T.index;return assert(f>=0),this.currentType=E,this.module.createGetLocal(f,E.toNativeType());case l.ElementKind.GLOBAL:if(!this.compileGlobal(T))return this.module.createUnreachable();var I=T.type;return assert(I!=d.Type.void),T.is(p.CommonFlags.INLINED)?this.compileInlineConstant(T,t,r):(this.currentType=I,this.module.createGetGlobal(T.internalName,I.toNativeType()));case l.ElementKind.ENUMVALUE:return T.is(p.CommonFlags.COMPILED)?(this.currentType=d.Type.i32,T.is(p.CommonFlags.INLINED)?this.module.createI32(T.constantValue):this.module.createGetGlobal(T.internalName,c.NativeType.I32)):(this.error(o.DiagnosticCode.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums,e.range),this.currentType=d.Type.i32,this.module.createUnreachable());case l.ElementKind.FUNCTION_PROTOTYPE:var v=T.resolve(null,i.flow.contextualTypeArguments);if(!v||!this.compileFunction(v))return n.createUnreachable();var A=this.ensureFunctionTableEntry(v);return this.currentType=v.signature.type,this.module.createI32(A)}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable()},t.prototype.compileInstanceOfExpression=function(e,t){var r=this.module,n=this.compileExpressionRetainType(e.expression,this.options.usizeType,0),i=this.currentType,a=this.program.resolveType(e.isType);return this.currentType=d.Type.bool,a?i.is(512)&&!a.is(512)?i.nonNullableType.isAssignableTo(a)?r.createBinary(i.is(64)?c.BinaryOp.NeI64:c.BinaryOp.NeI32,n,i.toNativeZero(r)):r.createI32(0):r.createI32(i.isAssignableTo(a,!0)?1:0):r.createUnreachable()},t.prototype.compileLiteralExpression=function(e,t,r){void 0===r&&(r=!1);var n=this.module;switch(e.literalKind){case h.LiteralKind.ARRAY:assert(!r);var i=t.classReference;return i&&i.prototype==this.program.arrayPrototype?this.compileArrayLiteral(assert(i.typeArguments)[0],e.elementExpressions,e):(this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable());case h.LiteralKind.FLOAT:var a=e.value;return r&&(a=-a),t==d.Type.f32?n.createF32(a):(this.currentType=d.Type.f64,n.createF64(a));case h.LiteralKind.INTEGER:var s=e.value;switch(r&&(s=i64_sub(i64_new(0),s)),t.kind){case 0:if(i64_is_i8(s))return n.createI32(i64_low(s));break;case 5:if(i64_is_u8(s))return n.createI32(i64_low(s));break;case 1:if(i64_is_i16(s))return n.createI32(i64_low(s));break;case 6:if(i64_is_u16(s))return n.createI32(i64_low(s));break;case 2:if(i64_is_i32(s))return n.createI32(i64_low(s));break;case 7:if(i64_is_u32(s))return n.createI32(i64_low(s));break;case 10:if(i64_is_bool(s))return n.createI32(i64_low(s));break;case 4:if(!this.options.isWasm64){if(i64_is_i32(s))return n.createI32(i64_low(s));break}return n.createI64(i64_low(s),i64_high(s));case 9:if(!this.options.isWasm64){if(i64_is_u32(s))return n.createI32(i64_low(s));break}return n.createI64(i64_low(s),i64_high(s));case 3:case 8:return n.createI64(i64_low(s),i64_high(s));case 11:if(i64_is_f32(s))return n.createF32(i64_to_f32(s));break;case 12:if(i64_is_f64(s))return n.createF64(i64_to_f64(s));break;case 13:break;default:return assert(!1),n.createUnreachable()}return i64_is_i32(s)?(this.currentType=d.Type.i32,n.createI32(i64_low(s))):i64_is_u32(s)?(this.currentType=d.Type.u32,n.createI32(i64_low(s))):(this.currentType=d.Type.i64,n.createI64(i64_low(s),i64_high(s)));case h.LiteralKind.STRING:return assert(!r),this.compileStaticString(e.value)}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.currentType=t,n.createUnreachable()},t.prototype.compileStaticString=function(e){var t=this.module,r=this.options,n=this.stringSegments,i=n.get(e);if(!i){var a=e.length,s=new Uint8Array(4+2*a);s[0]=255&a,s[1]=a>>>8&255,s[2]=a>>>16&255,s[3]=a>>>24&255;for(var o=0;o<a;++o)s[4+2*o]=255&e.charCodeAt(o),s[5+2*o]=e.charCodeAt(o)>>>8&255;i=this.addMemorySegment(s,r.usizeType.byteSize),n.set(e,i)}var c=i.offset,p=this.program.typesLookup.get("string");return this.currentType=p||r.usizeType,r.isWasm64?t.createI64(i64_low(c),i64_high(c)):(assert(i64_is_i32(c)),t.createI32(i64_low(c)))},t.prototype.compileArrayLiteral=function(e,t,r){var n=!0,i=this.module,a=assert(this.program.arrayPrototype);if(!a||a.kind!=l.ElementKind.CLASS_PROTOTYPE)return i.createUnreachable();var s=a.resolve([e]);if(!s)return i.createUnreachable();var p=s.type,u=t.length;if(u){var h=e.toNativeType(),d=void 0,m=void 0;switch(h){case c.NativeType.I32:d=changetype(new Int32Array(u)),m=4*u;break;case c.NativeType.I64:d=changetype(new Array(u)),m=8*u;break;case c.NativeType.F32:d=changetype(new Float32Array(u)),m=4*u;break;case c.NativeType.F64:d=changetype(new Float64Array(u)),m=8*u;break;default:return assert(!1),i.createUnreachable()}for(var y=new Array(u),g=void 0,T=0;T<u;++T)if(y[T]=t[T]?this.compileExpression(t[T],e,1,0):e.toNativeZero(i),n)if(g=this.precomputeExpressionRef(y[T]),c.getExpressionId(g)==c.ExpressionId.Const)switch(assert(c.getExpressionType(g)==h),h){case c.NativeType.I32:changetype(d)[T]=c.getConstValueI32(g);break;case c.NativeType.I64:changetype(d)[T]=i64_new(c.getConstValueI64Low(g),c.getConstValueI64High(g));break;case c.NativeType.F32:changetype(d)[T]=c.getConstValueF32(g);break;case c.NativeType.F64:changetype(d)[T]=c.getConstValueF64(g);break;default:assert(!1)}else n=!1;var E=this.options.usizeType.byteSize;if(n){var f=E+4,I=1<<32-clz(m+8-1),v=new Uint8Array(f+I),A=this.addMemorySegment(v),N=0;switch(8==E?(_.writeI64(i64_add(A.offset,i64_new(f)),v,N),N+=8):(assert(0==i64_high(A.offset)),_.writeI32(i64_low(A.offset)+f,v,N),N+=4),_.writeI32(u,v,N),N+=4,assert(N==f),_.writeI32(m,v,N),N+=8,h){case c.NativeType.I32:for(T=0;T<u;++T)_.writeI32(changetype(d)[T],v,N),N+=4;break;case c.NativeType.I64:for(T=0;T<u;++T)_.writeI64(changetype(d)[T],v,N),N+=8;break;case c.NativeType.F32:for(T=0;T<u;++T)_.writeF32(changetype(d)[T],v,N),N+=4;break;case c.NativeType.F64:for(T=0;T<u;++T)_.writeF64(changetype(d)[T],v,N),N+=8;break;default:return assert(!1),i.createUnreachable()}return assert(N<=f+I),this.currentType=p,8==E?i.createI64(i64_low(A.offset),i64_high(A.offset)):i.createI32(i64_low(A.offset))}this.currentType=p;var C=s.lookupOverload(l.OperatorKind.INDEXED_SET,!0);if(!C)return this.error(o.DiagnosticCode.Index_signature_in_type_0_only_permits_reading,r.range,s.internalName),i.createUnreachable();var O=p.toNativeType(),S=this.currentFunction,L=S.getTempLocal(p,!1),b=new Array(2+u),k=0;b[k++]=i.createSetLocal(L.index,this.makeCallDirect(assert(s.constructorInstance),[i.createI32(0),i.createI32(u)]));for(T=0;T<u;++T)b[k++]=this.makeCallDirect(C,[i.createGetLocal(L.index,O),i.createI32(T),y[T]]);return assert(k+1==b.length),b[k]=i.createGetLocal(L.index,O),S.freeTempLocal(L),this.currentType=p,i.createBlock(null,b,O)}return this.currentType=p,this.makeCallDirect(assert(s.constructorInstance),[i.createI32(0),i.createI32(0)])},t.prototype.compileNewExpression=function(e,t){var r=this.module,n=this.options,i=this.currentFunction,a=this.program.resolveExpression(e.expression,i);if(!a)return r.createUnreachable();if(a.kind!=l.ElementKind.CLASS_PROTOTYPE)return this.error(o.DiagnosticCode.Cannot_use_new_with_an_expression_whose_type_lacks_a_construct_signature,e.expression.range),this.module.createUnreachable();var s,c,u=a,h=null,d=e.typeArguments;if(!(h=!d&&null!==(s=t.classReference)&&s.is(p.CommonFlags.GENERIC)?u.resolve(s.typeArguments,i.flow.contextualTypeArguments):u.resolveUsingTypeArguments(d,i.flow.contextualTypeArguments,e)))return r.createUnreachable();for(var _=h,m=h.constructorInstance;!m&&(_=h.base);)m=_.constructorInstance;return c=m?this.compileCallDirect(m,e.arguments,e,n.usizeType.toNativeZero(r)):this.makeAllocate(h,e),this.currentType=h.type,c},t.prototype.compileParenthesizedExpression=function(e,t){return this.compileExpression(e.expression,t,0,0)},t.prototype.compilePropertyAccessExpression=function(e,t,r){var n=this.program,i=this.module,a=n.resolvePropertyAccess(e,this.currentFunction);if(!a)return i.createUnreachable();switch(a.kind){case l.ElementKind.GLOBAL:if(!this.compileGlobal(a))return i.createUnreachable();var s=a.type;return assert(s!=d.Type.void),a.is(p.CommonFlags.INLINED)?this.compileInlineConstant(a,t,r):(this.currentType=s,i.createGetGlobal(a.internalName,s.toNativeType()));case l.ElementKind.ENUMVALUE:var u=a.parent;return assert(null!==u&&u.kind==l.ElementKind.ENUM),this.compileEnum(u)?(this.currentType=d.Type.i32,a.is(p.CommonFlags.INLINED)?i.createI32(a.constantValue):i.createGetGlobal(a.internalName,c.NativeType.I32)):this.module.createUnreachable();case l.ElementKind.FIELD:var h=assert(n.resolvedThisExpression);assert(a.memoryOffset>=0);var _=this.compileExpressionRetainType(h,this.options.usizeType,0);return this.currentType=a.type,i.createLoad(a.type.byteSize,a.type.is(5),_,a.type.toNativeType(),a.memoryOffset);case l.ElementKind.PROPERTY:var m=a.getterPrototype;if(m){var y=m.resolve(null);if(!y)return i.createUnreachable();var g=y.signature;if(!this.checkCallSignature(g,0,y.is(p.CommonFlags.INSTANCE),e))return i.createUnreachable();var T=0!=(y.decoratorFlags&l.DecoratorFlags.INLINE);if(y.is(p.CommonFlags.INSTANCE)){u=assert(y.parent);assert(u.kind==l.ElementKind.CLASS);h=assert(n.resolvedThisExpression),_=this.compileExpressionRetainType(h,this.options.usizeType,0);return this.currentType=g.returnType,this.compileCallDirect(y,[],e,_,T)}return this.currentType=g.returnType,this.compileCallDirect(y,[],e,0,T)}return this.error(o.DiagnosticCode.Property_0_does_not_exist_on_type_1,e.range,a.simpleName,a.parent.toString()),i.createUnreachable()}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),i.createUnreachable()},t.prototype.compileTernaryExpression=function(e,t){var r=e.ifThen,n=e.ifElse,i=this.currentFunction,a=i.flow,s=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType);if(!this.options.noTreeShaking||this.currentFunction.isAny(p.CommonFlags.GENERIC|p.CommonFlags.GENERIC_CONTEXT)){var l=this.precomputeExpressionRef(s);if(c.getExpressionId(l)==c.ExpressionId.Const&&c.getExpressionType(l)==c.NativeType.I32)return c.getConstValueI32(l)?this.compileExpressionRetainType(r,t,0):this.compileExpressionRetainType(n,t,0);s=this.makeIsTrueish(this.compileExpressionRetainType(e.condition,d.Type.bool,0),this.currentType)}var u=a.fork();i.flow=u;var h=this.compileExpressionRetainType(r,t,0),_=this.currentType;u.free();var m=a.fork();i.flow=m;var y=this.compileExpressionRetainType(n,t,0),g=this.currentType;i.flow=m.free(),a.inheritMutual(u,m);var T=d.Type.commonCompatible(_,g,!1);return T?(h=this.convertExpression(h,_,T,1,0,r),y=this.convertExpression(y,g,T,1,0,n),this.currentType=T,this.module.createIf(s,h,y)):(this.error(o.DiagnosticCode.Type_0_is_not_assignable_to_type_1,e.range,_.toString(),g.toString()),this.currentType=t,this.module.createUnreachable())},t.prototype.compileUnaryPostfixExpression=function(e,t){var r=this.module,n=this.currentFunction,i=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0);if(c.getExpressionId(i)==c.ExpressionId.Unreachable)return i;var a,s,p,l=this.currentType;switch(e.operator){case u.Token.PLUS_PLUS:if(this.currentType.is(256))return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();switch(l.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:a=c.BinaryOp.AddI32,s=c.NativeType.I32,p=r.createI32(1);break;case 9:case 4:a=(h=this.options).isWasm64?c.BinaryOp.AddI64:c.BinaryOp.AddI32,s=h.nativeSizeType,p=l.toNativeOne(r);break;case 3:case 8:a=c.BinaryOp.AddI64,s=c.NativeType.I64,p=r.createI64(1);break;case 11:a=c.BinaryOp.AddF32,s=c.NativeType.F32,p=r.createF32(1);break;case 12:a=c.BinaryOp.AddF64,s=c.NativeType.F64,p=r.createF64(1);break;default:return assert(!1),r.createUnreachable()}break;case u.Token.MINUS_MINUS:if(this.currentType.is(256))return this.error(o.DiagnosticCode.Operation_not_supported,e.range),this.module.createUnreachable();switch(l.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:a=c.BinaryOp.SubI32,s=c.NativeType.I32,p=r.createI32(1);break;case 9:case 4:var h;a=(h=this.options).isWasm64?c.BinaryOp.SubI64:c.BinaryOp.SubI32,s=h.nativeSizeType,p=l.toNativeOne(r);break;case 3:case 8:a=c.BinaryOp.SubI64,s=c.NativeType.I64,p=r.createI64(1);break;case 11:a=c.BinaryOp.SubF32,s=c.NativeType.F32,p=r.createF32(1);break;case 12:a=c.BinaryOp.SubF64,s=c.NativeType.F64,p=r.createF64(1);break;default:return assert(!1),r.createUnreachable()}break;default:return assert(!1),r.createUnreachable()}if(t==d.Type.void)return this.compileAssignmentWithValue(e.operand,r.createBinary(a,i,p),!1);var _=n.getTempLocal(l,!1),m=this.compileAssignmentWithValue(e.operand,r.createBinary(a,this.module.createGetLocal(_.index,s),p),!1);this.currentType=assert(_).type,n.freeTempLocal(_);var y=_.index;return r.createBlock(null,[r.createSetLocal(y,i),m,r.createGetLocal(y,s)],s)},t.prototype.compileUnaryPrefixExpression=function(e,t){var r,n=this.module,i=!1;switch(e.operator){case u.Token.PLUS:if(r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0),this.currentType.is(256)){if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.PLUS)){r=this.compileUnaryOverload(s,e.operand,r,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()}break;case u.Token.MINUS:if(e.operand.kind==h.NodeKind.LITERAL&&(e.operand.literalKind==h.LiteralKind.INTEGER||e.operand.literalKind==h.LiteralKind.FLOAT)){r=this.compileLiteralExpression(e.operand,t,!0),this.options.sourceMap&&this.addDebugLocation(r,e.range);break}if(r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0),this.currentType.is(256)){if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.MINUS)){r=this.compileUnaryOverload(s,e.operand,r,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()}switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:r=n.createBinary(c.BinaryOp.SubI32,n.createI32(0),r);break;case 9:case 4:r=n.createBinary(this.options.isWasm64?c.BinaryOp.SubI64:c.BinaryOp.SubI32,this.currentType.toNativeZero(n),r);break;case 3:case 8:r=n.createBinary(c.BinaryOp.SubI64,n.createI64(0),r);break;case 11:r=n.createUnary(c.UnaryOp.NegF32,r);break;case 12:r=n.createUnary(c.UnaryOp.NegF64,r);break;default:assert(!1),r=n.createUnreachable()}break;case u.Token.PLUS_PLUS:if(i=!0,r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0),this.currentType.is(256)){if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.PREFIX_INC)){r=this.compileUnaryOverload(s,e.operand,r,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()}switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:r=n.createBinary(c.BinaryOp.AddI32,r,this.module.createI32(1));break;case 9:case 4:r=n.createBinary(this.options.isWasm64?c.BinaryOp.AddI64:c.BinaryOp.AddI32,r,this.currentType.toNativeOne(n));break;case 3:case 8:r=n.createBinary(c.BinaryOp.AddI64,r,n.createI64(1));break;case 11:r=n.createBinary(c.BinaryOp.AddF32,r,n.createF32(1));break;case 12:r=n.createBinary(c.BinaryOp.AddF64,r,n.createF64(1));break;default:assert(!1),r=n.createUnreachable()}break;case u.Token.MINUS_MINUS:if(i=!0,r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0),this.currentType.is(256)){if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.PREFIX_DEC)){r=this.compileUnaryOverload(s,e.operand,r,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()}switch(this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:r=n.createBinary(c.BinaryOp.SubI32,r,n.createI32(1));break;case 9:case 4:r=n.createBinary(this.options.isWasm64?c.BinaryOp.SubI64:c.BinaryOp.SubI32,r,this.currentType.toNativeOne(n));break;case 3:case 8:r=n.createBinary(c.BinaryOp.SubI64,r,n.createI64(1));break;case 11:r=n.createBinary(c.BinaryOp.SubF32,r,n.createF32(1));break;case 12:r=n.createBinary(c.BinaryOp.SubF64,r,n.createF64(1));break;default:assert(!1),r=n.createUnreachable()}break;case u.Token.EXCLAMATION:if(r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t,0,0),this.currentType.is(256))if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.NOT)){r=this.compileUnaryOverload(s,e.operand,r,e);break}r=this.makeIsFalseish(r,this.currentType),this.currentType=d.Type.bool;break;case u.Token.TILDE:if(r=this.compileExpression(e.operand,t==d.Type.void?d.Type.i32:t.is(8)?d.Type.i64:t,0,0),this.currentType.is(256)){var a,s;if(a=this.currentType.classReference)if(s=a.lookupOverload(l.OperatorKind.BITWISE_NOT)){r=this.compileUnaryOverload(s,e.operand,r,e);break}return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable()}switch(r=this.convertExpression(r,this.currentType,this.currentType.intType,1,0,e.operand),this.currentType.kind){case 0:case 1:case 2:case 5:case 6:case 7:case 10:r=n.createBinary(c.BinaryOp.XorI32,r,n.createI32(-1));break;case 9:case 4:r=n.createBinary(this.options.isWasm64?c.BinaryOp.XorI64:c.BinaryOp.XorI32,r,this.currentType.toNativeNegOne(n));break;case 3:case 8:r=n.createBinary(c.BinaryOp.XorI64,r,n.createI64(-1,-1));break;default:assert(!1),r=n.createUnreachable()}break;case u.Token.TYPEOF:return this.error(o.DiagnosticCode.Operation_not_supported,e.range),n.createUnreachable();default:return assert(!1),n.createUnreachable()}return i?this.compileAssignmentWithValue(e.operand,r,t!=d.Type.void):r},t.prototype.ensureSmallIntegerWrap=function(e,t){var r=this.module,n=this.currentFunction.flow;switch(t.kind){case 0:n.canOverflow(e,t)&&(e=this.options.hasFeature(1)?r.createUnary(c.UnaryOp.ExtendI8ToI32,e):r.createBinary(c.BinaryOp.ShrI32,r.createBinary(c.BinaryOp.ShlI32,e,r.createI32(24)),r.createI32(24)));break;case 1:n.canOverflow(e,t)&&(e=this.options.hasFeature(1)?r.createUnary(c.UnaryOp.ExtendI16ToI32,e):r.createBinary(c.BinaryOp.ShrI32,r.createBinary(c.BinaryOp.ShlI32,e,r.createI32(16)),r.createI32(16)));break;case 5:n.canOverflow(e,t)&&(e=r.createBinary(c.BinaryOp.AndI32,e,r.createI32(255)));break;case 6:n.canOverflow(e,t)&&(e=r.createBinary(c.BinaryOp.AndI32,e,r.createI32(65535)));break;case 10:n.canOverflow(e,t)&&(e=r.createBinary(c.BinaryOp.AndI32,e,r.createI32(1)))}return e},t.prototype.makeIsFalseish=function(e,t){var r=this.module;switch(t.kind){case 0:case 1:case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,t);case 2:case 7:return r.createUnary(c.UnaryOp.EqzI32,e);case 3:case 8:return r.createUnary(c.UnaryOp.EqzI64,e);case 9:case 4:return r.createUnary(64==t.size?c.UnaryOp.EqzI64:c.UnaryOp.EqzI32,e);case 11:return r.createBinary(c.BinaryOp.EqF32,e,r.createF32(0));case 12:return r.createBinary(c.BinaryOp.EqF64,e,r.createF64(0));default:return assert(!1),r.createI32(1)}},t.prototype.makeIsTrueish=function(e,t){var r=this.module;switch(t.kind){case 0:case 1:case 5:case 6:case 10:e=this.ensureSmallIntegerWrap(e,t);case 2:case 7:return e;case 3:case 8:return r.createBinary(c.BinaryOp.NeI64,e,r.createI64(0));case 9:case 4:return 64==t.size?r.createBinary(c.BinaryOp.NeI64,e,r.createI64(0)):e;case 11:return r.createBinary(c.BinaryOp.NeF32,e,r.createF32(0));case 12:return r.createBinary(c.BinaryOp.NeF64,e,r.createF64(0));default:return assert(!1),r.createI32(0)}},t.prototype.makeAllocate=function(e,t){var r,n,a=this.module,o=this.currentFunction,c=this.options.nativeSizeType,u=o.getTempLocal(e.type,!1),h=new Array;if(h.push(a.createSetLocal(u.index,s.compileAllocate(this,e,t))),e.members)try{for(var d=i(e.members.values()),_=d.next();!_.done;_=d.next()){var m=_.value;if(m.kind==l.ElementKind.FIELD){var y=m,g=y.type,T=g.toNativeType(),E=y.prototype.declaration;if(assert(!y.isAny(p.CommonFlags.CONST)),E.initializer)h.push(a.createStore(g.byteSize,a.createGetLocal(u.index,c),this.compileExpression(E.initializer,g,1,0),T,y.memoryOffset));else{var f=y.prototype.declaration.parameterIndex;h.push(a.createStore(g.byteSize,a.createGetLocal(u.index,c),f>=0?a.createGetLocal(1+f,T):g.toNativeZero(a),T,y.memoryOffset))}}}}catch(e){r={error:e}}finally{try{_&&!_.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return h.push(a.createGetLocal(u.index,c)),o.freeTempLocal(u),this.currentType=e.type,a.createBlock(null,h,c)},t.prototype.makeConditionalAllocate=function(e,t){var r=this.module,n=this.options.nativeSizeType;return this.currentType=e.type,r.createIf(n==c.NativeType.I64?r.createBinary(c.BinaryOp.NeI64,r.createGetLocal(0,c.NativeType.I64),r.createI64(0)):r.createGetLocal(0,c.NativeType.I32),r.createGetLocal(0,n),r.createTeeLocal(0,this.makeAllocate(e,t)))},t.prototype.addDebugLocation=function(e,t){var r=this.currentFunction,n=t.source;n.debugInfoIndex<0&&(n.debugInfoIndex=this.module.addDebugInfoFile(n.normalizedPath)),t.debugInfoRef=e,r.debugLocations.push(t)},t}(o.DiagnosticEmitter);function E(e,t){switch(void 0===t&&(t=e.simpleName),e.kind){case l.ElementKind.FUNCTION:return(r=e.parent||e.prototype.parent)?E(r)+(e.is(p.CommonFlags.INSTANCE)?p.INSTANCE_DELIMITER:p.STATIC_DELIMITER)+t:t;case l.ElementKind.FIELD:case l.ElementKind.ENUMVALUE:return E(r=assert(e.parent))+(e.is(p.CommonFlags.INSTANCE)?p.INSTANCE_DELIMITER:p.STATIC_DELIMITER)+t;case l.ElementKind.CLASS:return(r=e.prototype.parent)?E(r)+p.STATIC_DELIMITER+t:t;default:var r;return(r=e.parent)?E(r)+p.STATIC_DELIMITER+t:t}}function f(e,t,r){if(void 0===r&&(r=null),y=r?r.simpleName:t.range.source.simplePath,g=e.simpleName,e.hasDecorator(l.DecoratorFlags.EXTERNAL)){var n=e.program,i=assert(h.findDecorator(h.DecoratorKind.EXTERNAL,t.decorators)),a=i.arguments;if(a&&a.length){var s=a[0];s.kind==h.NodeKind.LITERAL&&s.literalKind==h.LiteralKind.STRING?(g=s.value,a.length>=2&&((s=a[1]).kind==h.NodeKind.LITERAL&&s.literalKind==h.LiteralKind.STRING?(y=g,g=s.value,a.length>2&&n.error(o.DiagnosticCode.Expected_0_arguments_but_got_1,i.range,"2",a.length.toString())):n.error(o.DiagnosticCode.String_literal_expected,s.range))):n.error(o.DiagnosticCode.String_literal_expected,s.range)}else n.error(o.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,i.range,"1","0")}}t.Compiler=T},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(5),s=r(8),o=r(2),c=r(1),p=r(4),l=i.LIBRARY_PREFIX+"builtins.ts",u=function(e){function t(){var t=e.call(this)||this;return t.backlog=new Array,t.seenlog=new Set,t.donelog=new Set,t.onComment=null,t.tryParseSignatureIsSignature=!1,t.parseParametersThis=null,t.program=new a.Program(t.diagnostics),t}return n(t,e),t.prototype.parseFile=function(e,t,r){var n=c.normalizePath(t),a=p.mangleInternalPath(n);if(!this.donelog.has(a)){this.donelog.add(a),this.seenlog.add(a);var o=new p.Source(n,e,r?p.SourceKind.ENTRY:t.startsWith(i.LIBRARY_PREFIX)&&t.indexOf(i.PATH_DELIMITER,i.LIBRARY_PREFIX.length)<0?p.SourceKind.LIBRARY:p.SourceKind.DEFAULT),u=this.program;u.sources.push(o),o.normalizedPath==l&&o.set(i.CommonFlags.BUILTIN);var h=new s.Tokenizer(o,u.diagnostics);h.onComment=this.onComment,o.tokenizer=h;for(var d=o.statements;!h.skip(s.Token.ENDOFFILE);){var _=this.parseTopLevelStatement(h);_&&(_.parent=o,d.push(_))}h.finish()}},t.prototype.parseTopLevelStatement=function(e,t){void 0===t&&(t=null);for(var r=i.CommonFlags.NONE,n=-1,a=null;e.skip(s.Token.AT);){n<0&&(n=e.tokenPos);var c=this.parseDecorator(e);c?(a||(a=[]),a.push(c)):this.skipStatement(e)}r|=e.source.flags&i.CommonFlags.BUILTIN;var p=0,l=0;e.skip(s.Token.EXPORT)&&(e.skip(s.Token.DEFAULT)&&this.error(o.DiagnosticCode.Operation_not_supported,e.range()),n<0&&(n=e.tokenPos),r|=i.CommonFlags.EXPORT,p=e.tokenPos,l=e.pos);var u=null!=t&&t.is(i.CommonFlags.AMBIENT);e.skip(s.Token.DECLARE)?(n<0&&(n=e.tokenPos),u&&this.error(o.DiagnosticCode.A_declare_modifier_cannot_be_used_in_an_already_ambient_context,e.range()),r|=i.CommonFlags.DECLARE|i.CommonFlags.AMBIENT):u&&(r|=i.CommonFlags.AMBIENT);var h=null,d=e.peek();switch(n<0&&(n=e.nextTokenPos),d){case s.Token.CONST:if(e.next(),r|=i.CommonFlags.CONST,e.skip(s.Token.ENUM)){h=this.parseEnum(e,r,a,n);break}h=this.parseVariable(e,r,a,n),a=null;break;case s.Token.LET:r|=i.CommonFlags.LET;case s.Token.VAR:e.next(),h=this.parseVariable(e,r,a,n),a=null;break;case s.Token.ENUM:e.next(),h=this.parseEnum(e,r,a,n),a=null;break;case s.Token.FUNCTION:e.next(),h=this.parseFunction(e,r,a,n),a=null;break;case s.Token.ABSTRACT:var _=e.mark();if(e.next(),!e.skip(s.Token.CLASS)){e.reset(_),h=this.parseStatement(e,!0);break}e.discard(_),r|=i.CommonFlags.ABSTRACT;case s.Token.CLASS:case s.Token.INTERFACE:e.next(),h=this.parseClassOrInterface(e,r,a,n),a=null;break;case s.Token.NAMESPACE:_=e.mark();e.next(),e.peek(!1,s.IdentifierHandling.PREFER)==s.Token.IDENTIFIER?(e.discard(_),h=this.parseNamespace(e,r,a,n),a=null):(e.reset(_),h=this.parseStatement(e,!0));break;case s.Token.IMPORT:e.next(),h=(r|=i.CommonFlags.IMPORT)&i.CommonFlags.EXPORT?this.parseExportImport(e,n):this.parseImport(e);break;case s.Token.TYPE:_=e.mark();e.next(),e.peek(!1,s.IdentifierHandling.PREFER)==s.Token.IDENTIFIER?(e.discard(_),h=this.parseTypeDeclaration(e,r,a,n),a=null):(e.reset(_),h=this.parseStatement(e,!0));break;default:r&i.CommonFlags.EXPORT?h=this.parseExport(e,r,n):(l&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(p,l),"export"),t||(h=this.parseStatement(e,!0)))}if(a)for(var m=0,y=a.length;m<y;++m)this.error(o.DiagnosticCode.Decorators_are_not_valid_here,a[m].range);return h},t.prototype.nextFile=function(){var e=this.backlog;return e.length?e.shift():null},t.prototype.finish=function(){if(this.backlog.length)throw new Error("backlog is not empty");return this.backlog=[],this.seenlog.clear(),this.donelog.clear(),this.program},t.prototype.parseType=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1);var n,i=e.next(),a=e.tokenPos;if(i==s.Token.OPENPAREN){var c=e.skip(s.Token.OPENPAREN),l=this.tryParseSignature(e);if(l){if(c){if(!e.skip(s.Token.CLOSEPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(),")"),null;if(!e.skip(s.Token.BAR))return this.error(o.DiagnosticCode._0_expected,e.range(),"|"),null;e.skip(s.Token.NULL)||this.error(o.DiagnosticCode._0_expected,e.range(),"null"),l.isNullable=!0}return l}if(c||this.tryParseSignatureIsSignature)return this.error(o.DiagnosticCode.Unexpected_token,e.range()),null;if(!t)return this.error(o.DiagnosticCode.Unexpected_token,e.range()),null;var u=this.parseType(e,!1,r);if(!u)return null;if(!e.skip(s.Token.CLOSEPAREN))return r||this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"}"),null;(n=u).range.start=a,n.range.end=e.pos}else if(i==s.Token.VOID)n=p.Node.createType(p.Node.createIdentifierExpression("void",e.range()),[],!1,e.range(a,e.pos));else if(i==s.Token.THIS)n=p.Node.createType(p.Node.createThisExpression(e.range()),[],!1,e.range(a,e.pos));else if(i==s.Token.TRUE||i==s.Token.FALSE)n=p.Node.createType(p.Node.createIdentifierExpression("bool",e.range()),[],!1,e.range(a,e.pos));else if(i==s.Token.STRINGLITERAL)e.readString(),n=p.Node.createType(p.Node.createIdentifierExpression("string",e.range()),[],!1,e.range(a,e.pos));else{if(i!=s.Token.IDENTIFIER)return r||this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var h=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),d=new Array,_=!1;if(e.skip(s.Token.LESSTHAN)){do{var m=this.parseType(e,!0,r);if(!m)return null;d.push(m)}while(e.skip(s.Token.COMMA));if(!e.skip(s.Token.GREATERTHAN))return r||this.error(o.DiagnosticCode._0_expected,e.range(e.pos),">"),null}if(e.skip(s.Token.BAR)){if(!e.skip(s.Token.NULL))return r||this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"null"),null;_=!0}n=p.Node.createType(h,d,_,e.range(a,e.pos))}for(;e.skip(s.Token.OPENBRACKET);){var y=e.tokenPos;if(!e.skip(s.Token.CLOSEBRACKET))return r||this.error(o.DiagnosticCode._0_expected,e.range(),"]"),null;var g=e.range(y,e.pos);_=!1;if(e.skip(s.Token.BAR)){if(!e.skip(s.Token.NULL))return r||this.error(o.DiagnosticCode._0_expected,e.range(),"null"),null;_=!0}if(n=p.Node.createType(p.Node.createIdentifierExpression("Array",g),[n],_,e.range(a,e.pos)),_)break}return n},t.prototype.tryParseSignature=function(e){var t,r=e.mark(),n=e.tokenPos,i=null,a=null,c=!1;if(e.skip(s.Token.CLOSEPAREN))c=!0,e.discard(r),i=[];else{c=!1;do{var l=p.ParameterKind.DEFAULT;if(e.skip(s.Token.DOT_DOT_DOT)&&(c=!0,e.discard(r),l=p.ParameterKind.REST),e.skip(s.Token.THIS)){if(!e.skip(s.Token.COLON))return e.reset(r),this.tryParseSignatureIsSignature=!1,null;c=!0,e.discard(r);var u=this.parseType(e,!1);if(!u)return null;if(u.kind!=p.NodeKind.TYPE)return this.error(o.DiagnosticCode.Operation_not_supported,u.range),this.tryParseSignatureIsSignature=!0,null;a=u}else{if(!e.skipIdentifier())return c?this.error(o.DiagnosticCode.Identifier_expected,e.range()):e.reset(r),this.tryParseSignatureIsSignature=c,null;var h=p.Node.createIdentifierExpression(e.readIdentifier(),e.range(e.tokenPos,e.pos));if(e.skip(s.Token.QUESTION)&&(c=!0,e.discard(r),l==p.ParameterKind.REST?this.error(o.DiagnosticCode.A_rest_parameter_cannot_be_optional,e.range()):l=p.ParameterKind.OPTIONAL),e.skip(s.Token.COLON)){c=!0,e.discard(r);var d=this.parseType(e);if(!d)return this.tryParseSignatureIsSignature=c,null;var _=new p.ParameterNode;_.parameterKind=l,_.name=h,_.type=d,i?i.push(_):i=[_]}else c&&this.error(o.DiagnosticCode.Type_expected,e.range())}}while(e.skip(s.Token.COMMA));if(!e.skip(s.Token.CLOSEPAREN))return c?this.error(o.DiagnosticCode._0_expected,e.range(),")"):e.reset(r),this.tryParseSignatureIsSignature=c,null}return e.skip(s.Token.EQUALS_GREATERTHAN)?(c=!0,e.discard(r),(t=this.parseType(e))?(this.tryParseSignatureIsSignature=!0,p.Node.createSignature(i||[],t,a,!1,e.range(n,e.pos))):(this.tryParseSignatureIsSignature=c,null)):(c?this.error(o.DiagnosticCode._0_expected,e.range(),"=>"):e.reset(r),this.tryParseSignatureIsSignature=c,null)},t.prototype.parseDecorator=function(e){var t=e.tokenPos;if(e.skipIdentifier()){for(var r=e.readIdentifier(),n=p.Node.createIdentifierExpression(r,e.range(t,e.pos));e.skip(s.Token.DOT);){if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;r=e.readIdentifier(),n=p.Node.createPropertyAccessExpression(n,p.Node.createIdentifierExpression(r,e.range()),e.range(t,e.pos))}var i=void 0;if(!e.skip(s.Token.OPENPAREN))return p.Node.createDecorator(n,null,e.range(t,e.pos));if(i=this.parseArguments(e))return p.Node.createDecorator(n,i,e.range(t,e.pos))}else this.error(o.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseVariable=function(e,t,r,n){var i=new Array;do{var a=this.parseVariableDeclaration(e,t,r);if(!a)return null;i.push(a)}while(e.skip(s.Token.COMMA));var o=p.Node.createVariableStatement(i,r,t,e.range(n,e.pos));return e.skip(s.Token.SEMICOLON),o},t.prototype.parseVariableDeclaration=function(e,t,r){if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var n=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),a=t,c=null;e.skip(s.Token.COLON)&&(c=this.parseType(e));var l=null;if(e.skip(s.Token.EQUALS)){if(a&i.CommonFlags.AMBIENT&&this.error(o.DiagnosticCode.Initializers_are_not_allowed_in_ambient_contexts,e.range()),!(l=this.parseExpression(e,1)))return null}else a&i.CommonFlags.CONST?a&i.CommonFlags.AMBIENT||this.error(o.DiagnosticCode._const_declarations_must_be_initialized,n.range):c||this.error(o.DiagnosticCode.Type_expected,e.range(e.pos));return p.Node.createVariableDeclaration(n,c,l,r,a,s.Range.join(n.range,e.range()))},t.prototype.parseEnum=function(e,t,r,n){if(e.next()!=s.Token.IDENTIFIER)return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var a=p.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.next()!=s.Token.OPENBRACE)return this.error(o.DiagnosticCode._0_expected,e.range(),"{"),null;for(var c=new Array;!e.skip(s.Token.CLOSEBRACE);){var l=this.parseEnumValue(e,i.CommonFlags.NONE);if(!l)return null;if(c.push(l),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEBRACE))break;return this.error(o.DiagnosticCode._0_expected,e.range(),"}"),null}}var u=p.Node.createEnumDeclaration(a,c,r,t,e.range(n,e.pos));return e.skip(s.Token.SEMICOLON),u},t.prototype.parseEnumValue=function(e,t){if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var r=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),n=null;return e.skip(s.Token.EQUALS)&&!(n=this.parseExpression(e,1))?null:p.Node.createEnumValueDeclaration(r,n,t,s.Range.join(r.range,e.range()))},t.prototype.parseReturn=function(e){var t=null;if(e.peek(!0)!=s.Token.SEMICOLON&&e.nextToken!=s.Token.CLOSEBRACE&&!e.nextTokenOnNewLine&&!(t=this.parseExpression(e)))return null;var r=p.Node.createReturnStatement(t,e.range());return e.skip(s.Token.SEMICOLON),r},t.prototype.parseTypeParameters=function(e){for(var t=new Array;!e.skip(s.Token.GREATERTHAN);){var r=this.parseTypeParameter(e);if(!r)return null;if(t.push(r),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.GREATERTHAN))break;return this.error(o.DiagnosticCode._0_expected,e.range(),">"),null}}return 0===t.length&&this.error(o.DiagnosticCode.Type_parameter_list_cannot_be_empty,e.range()),t},t.prototype.parseTypeParameter=function(e){if(e.next()==s.Token.IDENTIFIER){var t=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(s.Token.EXTENDS)){var n=this.parseType(e);if(!n)return null;if(n.kind!=p.NodeKind.TYPE)return this.error(o.DiagnosticCode.Operation_not_supported,n.range),null;r=n}return p.Node.createTypeParameter(t,r,s.Range.join(t.range,e.range()))}return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseParameters=function(e,t){void 0===t&&(t=!1);var r=new Array,n=null,i=!1,a=!1,c=null;if(this.parseParametersThis=null,e.skip(s.Token.THIS)){if(!e.skip(s.Token.COLON))return this.error(o.DiagnosticCode._0_expected,e.range(),":"),null;if(!(c=this.parseType(e)))return null;if(c.kind==p.NodeKind.TYPE?this.parseParametersThis=c:this.error(o.DiagnosticCode.Operation_not_supported,c.range),!e.skip(s.Token.COMMA))return e.skip(s.Token.CLOSEPAREN)?r:(this.error(o.DiagnosticCode._0_expected,e.range(),")"),null)}for(;!e.skip(s.Token.CLOSEPAREN);){var l=this.parseParameter(e,t);if(!l)return null;switch(n&&!a&&(this.error(o.DiagnosticCode.A_rest_parameter_must_be_last_in_a_parameter_list,n.name.range),a=!0),l.parameterKind){default:i&&this.error(o.DiagnosticCode.A_required_parameter_cannot_follow_an_optional_parameter,l.name.range);break;case p.ParameterKind.OPTIONAL:i=!0;break;case p.ParameterKind.REST:n=l}if(r.push(l),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEPAREN))break;return this.error(o.DiagnosticCode._0_expected,e.range(),")"),null}}return r},t.prototype.parseParameter=function(e,t){void 0===t&&(t=!1);var r=!1,n=!1,a=null,c=i.CommonFlags.NONE;if(t&&(e.skip(s.Token.PUBLIC)?(a=e.range(),c|=i.CommonFlags.PUBLIC):e.skip(s.Token.PROTECTED)?(a=e.range(),c|=i.CommonFlags.PROTECTED):e.skip(s.Token.PRIVATE)&&(a=e.range(),c|=i.CommonFlags.PRIVATE),e.peek()==s.Token.READONLY)){var l=e.mark();e.next(),e.peek()!=s.Token.COLON?(e.discard(l),a||(a=e.range()),c|=i.CommonFlags.READONLY):e.reset(l)}if(e.skip(s.Token.DOT_DOT_DOT)&&(c?this.error(o.DiagnosticCode.A_parameter_property_cannot_be_declared_using_a_rest_parameter,e.range()):a=e.range(),r=!0),e.skipIdentifier()){r||(a=e.range());var u=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),h=null;if((n=e.skip(s.Token.QUESTION))&&r&&this.error(o.DiagnosticCode.A_rest_parameter_cannot_be_optional,u.range),e.skip(s.Token.COLON)){if(!(h=this.parseType(e)))return null}else h=p.Node.createOmittedType(e.range(e.pos));var d=null;if(e.skip(s.Token.EQUALS)&&(r&&this.error(o.DiagnosticCode.A_rest_parameter_cannot_have_an_initializer,u.range),n?this.error(o.DiagnosticCode.Parameter_cannot_have_question_mark_and_initializer,u.range):n=!0,!(d=this.parseExpression(e,1))))return null;var _=p.Node.createParameter(u,h,d,r?p.ParameterKind.REST:n?p.ParameterKind.OPTIONAL:p.ParameterKind.DEFAULT,s.Range.join(a,e.range()));return _.flags|=c,_}return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseFunction=function(e,t,r,n){if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range(e.pos)),null;var a=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),c=-1,l=null;if(e.skip(s.Token.LESSTHAN)){if(c=e.tokenPos,!(l=this.parseTypeParameters(e)))return null;t|=i.CommonFlags.GENERIC}if(!e.skip(s.Token.OPENPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"("),null;c<0&&(c=e.tokenPos);var u=this.parseParameters(e);if(!u)return null;var h=this.parseParametersThis,d=0!=(t&i.CommonFlags.SET);d&&(1!=u.length&&this.error(o.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,a.range),u.length&&u[0].initializer&&this.error(o.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,a.range)),t&i.CommonFlags.GET&&u.length&&this.error(o.DiagnosticCode.A_get_accessor_cannot_have_parameters,a.range);var _=null;if(e.skip(s.Token.COLON)&&!(_=this.parseType(e,!0,d)))return null;_||(_=p.Node.createOmittedType(e.range(e.pos)),d||this.error(o.DiagnosticCode.Type_expected,_.range));var m=p.Node.createSignature(u,_,h,!1,e.range(c,e.pos)),y=null;if(e.skip(s.Token.OPENBRACE)){if(t&i.CommonFlags.AMBIENT&&this.error(o.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range()),!(y=this.parseBlockStatement(e,!1)))return null}else t&i.CommonFlags.AMBIENT||this.error(o.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range(e.pos));var g=p.Node.createFunctionDeclaration(a,l,m,y,r,t,e.range(n,e.pos));return e.skip(s.Token.SEMICOLON),g},t.prototype.parseFunctionExpression=function(e){var t,r=e.tokenPos,n=!1;if(e.token==s.Token.FUNCTION){if(t=e.skipIdentifier()?p.Node.createIdentifierExpression(e.readIdentifier(),e.range()):p.Node.createEmptyIdentifierExpression(e.range(e.pos)),!e.skip(s.Token.OPENPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"("),null}else n=!0,assert(e.token==s.Token.OPENPAREN),t=p.Node.createEmptyIdentifierExpression(e.range(e.tokenPos));var i=e.pos,a=this.parseParameters(e);return a?this.parseFunctionExpressionCommon(e,t,a,n,r,i):null},t.prototype.parseFunctionExpressionCommon=function(e,t,r,n,a,c){void 0===a&&(a=-1),void 0===c&&(c=-1),a<0&&(a=t.range.start),c<0&&(c=a);var l=null;if(e.skip(s.Token.COLON)){if(!(l=this.parseType(e)))return null}else l=p.Node.createOmittedType(e.range(e.pos)),this.error(o.DiagnosticCode.Type_expected,l.range);if(n&&!e.skip(s.Token.EQUALS_GREATERTHAN))return this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"=>"),null;var u,h=p.Node.createSignature(r,l,null,!1,e.range(c,e.pos));if(n)u=this.parseStatement(e,!1);else{if(!e.skip(s.Token.OPENBRACE))return this.error(o.DiagnosticCode._0_expected,e.range(e.pos),"{"),null;u=this.parseBlockStatement(e,!1)}if(!u)return null;var d=p.Node.createFunctionDeclaration(t,null,h,u,null,n?i.CommonFlags.ARROW:i.CommonFlags.NONE,e.range(a,e.pos));return p.Node.createFunctionExpression(d)},t.prototype.parseClassOrInterface=function(e,t,r,n){var a=e.token==s.Token.INTERFACE;if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var c,l=p.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(s.Token.LESSTHAN)){if(!(c=this.parseTypeParameters(e)))return null;t|=i.CommonFlags.GENERIC}else c=[];var u=null;if(e.skip(s.Token.EXTENDS)){var h=this.parseType(e);if(!h)return null;if(h.kind!=p.NodeKind.TYPE)return this.error(o.DiagnosticCode.Operation_not_supported,h.range),null;u=h}var d=null;if(e.skip(s.Token.IMPLEMENTS)){a&&this.error(o.DiagnosticCode.Interface_declaration_cannot_have_implements_clause,e.range());do{var _=this.parseType(e);if(!_)return null;a||(d||(d=[]),d.push(_))}while(e.skip(s.Token.COMMA))}if(!e.skip(s.Token.OPENBRACE))return this.error(o.DiagnosticCode._0_expected,e.range(),"{"),null;var m,y=new Array;if(a?(assert(!d),m=p.Node.createInterfaceDeclaration(l,c,u,y,r,t,e.range(n,e.pos))):m=p.Node.createClassDeclaration(l,c,u,d,y,r,t,e.range(n,e.pos)),!e.skip(s.Token.CLOSEBRACE))do{var g=this.parseClassMember(e,m);if(!g)return null;g.parent=m,y.push(g)}while(!e.skip(s.Token.CLOSEBRACE));return m},t.prototype.parseClassMember=function(e,t){for(var r=e.pos,n=new Array;e.skip(s.Token.AT);){var a=this.parseDecorator(e);if(!a)break;n.push(a)}var c=t.flags&i.CommonFlags.AMBIENT;e.skip(s.Token.PUBLIC)?c|=i.CommonFlags.PUBLIC:e.skip(s.Token.PRIVATE)?c|=i.CommonFlags.PRIVATE:e.skip(s.Token.PROTECTED)&&(c|=i.CommonFlags.PROTECTED);var l=0,u=0,h=0,d=0;e.skip(s.Token.STATIC)?(c|=i.CommonFlags.STATIC,l=e.tokenPos,u=e.pos):(e.skip(s.Token.ABSTRACT)?(c|=i.CommonFlags.ABSTRACT|i.CommonFlags.INSTANCE,h=e.tokenPos,d=e.pos):c|=i.CommonFlags.INSTANCE,t.flags&i.CommonFlags.GENERIC&&(c|=i.CommonFlags.GENERIC_CONTEXT));var _=0,m=0;e.skip(s.Token.READONLY)&&(c|=i.CommonFlags.READONLY,_=e.tokenPos,m=e.pos);var y=e.mark(),g=!1,T=!1,E=!1,f=0,I=0;if(e.skip(s.Token.GET)?e.peek(!0,s.IdentifierHandling.PREFER)!=s.Token.IDENTIFIER||e.nextTokenOnNewLine?e.reset(y):(c|=i.CommonFlags.GET,T=!0,f=e.tokenPos,I=e.pos,c&i.CommonFlags.READONLY&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(_,m),"readonly")):e.skip(s.Token.SET)?e.peek(!0,s.IdentifierHandling.PREFER)!=s.Token.IDENTIFIER||e.nextTokenOnNewLine?e.reset(y):(c|=i.CommonFlags.SET|i.CommonFlags.SET,E=!0,f=e.tokenPos,I=e.pos,c&i.CommonFlags.READONLY&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(_,m),"readonly")):e.skip(s.Token.CONSTRUCTOR)&&(g=!0,(c|=i.CommonFlags.CONSTRUCTOR)&i.CommonFlags.STATIC&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(l,u),"static"),c&i.CommonFlags.ABSTRACT&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(h,d),"abstract"),c&i.CommonFlags.READONLY&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(_,m),"readonly")),!g&&!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;var v=g?p.Node.createConstructorExpression(e.range()):p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),A=null;if(e.skip(s.Token.LESSTHAN)){var N=e.tokenPos;if(!(A=this.parseTypeParameters(e)))return null;g?this.error(o.DiagnosticCode.Type_parameters_cannot_appear_on_a_constructor_declaration,e.range(N,e.pos)):T||E?this.error(o.DiagnosticCode.An_accessor_cannot_have_type_parameters,e.range(N,e.pos)):c|=i.CommonFlags.GENERIC}if(e.skip(s.Token.OPENPAREN)){var C=e.tokenPos,O=this.parseParameters(e,g);if(!O)return null;var S=this.parseParametersThis;if(g)for(var L=0,b=O.length;L<b;++L){var k=O[L];if(k.isAny(i.CommonFlags.PUBLIC|i.CommonFlags.PROTECTED|i.CommonFlags.PRIVATE|i.CommonFlags.READONLY)){var R=p.Node.createFieldDeclaration(k.name,k.type,null,null,k.flags|i.CommonFlags.INSTANCE,k.range);R.parameterIndex=L,R.parent=t,k.implicitFieldDeclaration=R,t.members.push(R)}}else T?O.length&&this.error(o.DiagnosticCode.A_get_accessor_cannot_have_parameters,v.range):E&&(1!=O.length&&this.error(o.DiagnosticCode.A_set_accessor_must_have_exactly_one_parameter,v.range),O.length&&O[0].initializer&&this.error(o.DiagnosticCode.A_set_accessor_parameter_cannot_have_an_initializer,v.range));var x=null;if(e.skip(s.Token.COLON)){if(v.kind==p.NodeKind.CONSTRUCTOR?this.error(o.DiagnosticCode.Type_annotation_cannot_appear_on_a_constructor_declaration,e.range()):E&&this.error(o.DiagnosticCode.A_set_accessor_cannot_have_a_return_type_annotation,e.range()),!(x=this.parseType(e,v.kind==p.NodeKind.CONSTRUCTOR||E)))return null}else x=p.Node.createOmittedType(e.range(e.pos)),E||v.kind==p.NodeKind.CONSTRUCTOR||this.error(o.DiagnosticCode.Type_expected,x.range);var F=p.Node.createSignature(O,x,S,!1,e.range(C,e.pos)),B=null;if(e.skip(s.Token.OPENBRACE)){if(c&i.CommonFlags.AMBIENT&&this.error(o.DiagnosticCode.An_implementation_cannot_be_declared_in_ambient_contexts,e.range()),!(B=this.parseBlockStatement(e,!1)))return null}else c&i.CommonFlags.AMBIENT||this.error(o.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,e.range());var U=p.Node.createMethodDeclaration(v,A,F,B,n,c,e.range(r,e.pos));return e.skip(s.Token.SEMICOLON),U}if(g)this.error(o.DiagnosticCode.Constructor_implementation_is_missing,v.range);else{if(!T&&!E){c&i.CommonFlags.ABSTRACT&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(h,d),"abstract"),c&i.CommonFlags.GET&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(0,0),"get"),c&i.CommonFlags.SET&&this.error(o.DiagnosticCode._0_modifier_cannot_be_used_here,e.range(f,I),"set");var D=null;if(e.skip(s.Token.COLON)){if(!(D=this.parseType(e)))return null}else this.error(o.DiagnosticCode.Type_expected,e.range());var P=null;if(e.skip(s.Token.EQUALS)&&!(P=this.parseExpression(e)))return null;var w=p.Node.createFieldDeclaration(v,D,P,n,c,e.range(r,e.pos));return e.skip(s.Token.SEMICOLON),w}this.error(o.DiagnosticCode.Function_implementation_is_missing_or_not_immediately_following_the_declaration,v.range)}return null},t.prototype.parseNamespace=function(e,t,r,n){if(e.skipIdentifier()){var i=p.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(s.Token.OPENBRACE)){for(var a=new Array,c=p.Node.createNamespaceDeclaration(i,a,r,t,e.range(n,e.pos));!e.skip(s.Token.CLOSEBRACE);){var l=this.parseTopLevelStatement(e,c);if(!l)return null;l.parent=c,a.push(l)}return e.skip(s.Token.SEMICOLON),c}this.error(o.DiagnosticCode._0_expected,e.range(),"{")}else this.error(o.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseExport=function(e,t,r){var n=null;if(e.skip(s.Token.OPENBRACE)){for(var i=new Array;!e.skip(s.Token.CLOSEBRACE);){var a=this.parseExportMember(e);if(!a)return null;if(i.push(a),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEBRACE))break;return this.error(o.DiagnosticCode._0_expected,e.range(),"}"),null}}if(e.skip(s.Token.FROM)){if(!e.skip(s.Token.STRINGLITERAL))return this.error(o.DiagnosticCode.String_literal_expected,e.range()),null;n=p.Node.createStringLiteralExpression(e.readString(),e.range())}return null===(l=(c=p.Node.createExportStatement(i,n,t,e.range(r,e.pos))).internalPath)||this.seenlog.has(l)||(this.backlog.push(l),this.seenlog.add(l)),e.skip(s.Token.SEMICOLON),c}if(e.skip(s.Token.ASTERISK))if(e.skip(s.Token.FROM)){if(e.skip(s.Token.STRINGLITERAL)){n=p.Node.createStringLiteralExpression(e.readString(),e.range());var c=p.Node.createExportStatement(null,n,t,e.range(r,e.pos)),l=assert(c.internalPath),u=e.source;return u.exportPaths||(u.exportPaths=new Set),u.exportPaths.add(l),this.seenlog.has(l)||(this.backlog.push(l),this.seenlog.add(l)),e.skip(s.Token.SEMICOLON),c}this.error(o.DiagnosticCode.String_literal_expected,e.range())}else this.error(o.DiagnosticCode._0_expected,e.range(),"from");else this.error(o.DiagnosticCode._0_expected,e.range(),"{");return null},t.prototype.parseExportMember=function(e){if(e.skipIdentifier()){var t=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(s.Token.AS)){if(!e.skipIdentifierName())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;r=p.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return p.Node.createExportMember(t,r,r?s.Range.join(t.range,r.range):t.range)}return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseImport=function(e){var t=e.tokenPos,r=null,n=null,i=!1;if(e.skip(s.Token.OPENBRACE))for(r=new Array;!e.skip(s.Token.CLOSEBRACE);){var a=this.parseImportDeclaration(e);if(!a)return null;if(r.push(a),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEBRACE))break;return this.error(o.DiagnosticCode._0_expected,e.range(),"}"),null}}else if(e.skip(s.Token.ASTERISK)){if(!e.skip(s.Token.AS))return this.error(o.DiagnosticCode._0_expected,e.range(),"as"),null;if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;n=p.Node.createIdentifierExpression(e.readIdentifier(),e.range())}else i=!0;if(i||e.skip(s.Token.FROM)){if(e.skip(s.Token.STRINGLITERAL)){var c=p.Node.createStringLiteralExpression(e.readString(),e.range()),l=void 0;n?(assert(!r),l=p.Node.createImportStatementWithWildcard(n,c,e.range(t,e.pos))):l=p.Node.createImportStatement(r,c,e.range(t,e.pos));var u=l.internalPath;return this.seenlog.has(u)||(this.backlog.push(u),this.seenlog.add(u)),e.skip(s.Token.SEMICOLON),l}this.error(o.DiagnosticCode.String_literal_expected,e.range())}else this.error(o.DiagnosticCode._0_expected,e.range(),"from");return null},t.prototype.parseImportDeclaration=function(e){if(e.skipIdentifierName()){var t=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),r=null;if(e.skip(s.Token.AS)){if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;r=p.Node.createIdentifierExpression(e.readIdentifier(),e.range())}return p.Node.createImportDeclaration(t,r,r?s.Range.join(t.range,r.range):t.range)}return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null},t.prototype.parseExportImport=function(e,t){if(e.skipIdentifier()){var r=p.Node.createIdentifierExpression(e.readIdentifier(),e.range());if(e.skip(s.Token.EQUALS)){if(e.skipIdentifier()){var n=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),i=p.Node.createExportImportStatement(n,r,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),i}this.error(o.DiagnosticCode.Identifier_expected,e.range())}else this.error(o.DiagnosticCode._0_expected,e.range(),"=")}else this.error(o.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseStatement=function(e,t){void 0===t&&(t=!1);var r=e.mark(),n=null;switch(e.next()){case s.Token.BREAK:n=this.parseBreak(e);break;case s.Token.CONST:n=this.parseVariable(e,i.CommonFlags.CONST,null,e.tokenPos);break;case s.Token.CONTINUE:n=this.parseContinue(e);break;case s.Token.DO:n=this.parseDoStatement(e);break;case s.Token.FOR:n=this.parseForStatement(e);break;case s.Token.IF:n=this.parseIfStatement(e);break;case s.Token.LET:n=this.parseVariable(e,i.CommonFlags.LET,null,e.tokenPos);break;case s.Token.VAR:n=this.parseVariable(e,i.CommonFlags.NONE,null,e.tokenPos);break;case s.Token.OPENBRACE:n=this.parseBlockStatement(e,t);break;case s.Token.RETURN:t&&this.error(o.DiagnosticCode.A_return_statement_can_only_be_used_within_a_function_body,e.range()),n=this.parseReturn(e);break;case s.Token.SEMICOLON:return p.Node.createEmptyStatement(e.range(e.tokenPos));case s.Token.SWITCH:n=this.parseSwitchStatement(e);break;case s.Token.THROW:n=this.parseThrowStatement(e);break;case s.Token.TRY:n=this.parseTryStatement(e);break;case s.Token.VOID:n=this.parseVoidStatement(e);break;case s.Token.WHILE:n=this.parseWhileStatement(e);break;case s.Token.TYPE:if(e.peek(!1,s.IdentifierHandling.PREFER)==s.Token.IDENTIFIER){n=this.parseTypeDeclaration(e,i.CommonFlags.NONE,null,e.tokenPos);break}default:e.reset(r),n=this.parseExpressionStatement(e)}return n?e.discard(r):(e.reset(r),this.skipStatement(e)),n},t.prototype.parseBlockStatement=function(e,t){for(var r=e.tokenPos,n=new Array;!e.skip(s.Token.CLOSEBRACE);){var i=e.mark(),a=this.parseStatement(e,t);a?(e.discard(i),n.push(a)):(e.reset(i),this.skipStatement(e))}var o=p.Node.createBlockStatement(n,e.range(r,e.pos));return e.skip(s.Token.SEMICOLON),o},t.prototype.parseBreak=function(e){var t=null;e.peek(!0)!=s.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(s.IdentifierHandling.PREFER),t=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=p.Node.createBreakStatement(t,e.range());return e.skip(s.Token.SEMICOLON),r},t.prototype.parseContinue=function(e){var t=null;e.peek(!0)!=s.Token.IDENTIFIER||e.nextTokenOnNewLine||(e.next(s.IdentifierHandling.PREFER),t=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()));var r=p.Node.createContinueStatement(t,e.range());return e.skip(s.Token.SEMICOLON),r},t.prototype.parseDoStatement=function(e){var t=e.tokenPos,r=this.parseStatement(e);if(!r)return null;if(e.skip(s.Token.WHILE))if(e.skip(s.Token.OPENPAREN)){var n=this.parseExpression(e);if(!n)return null;if(e.skip(s.Token.CLOSEPAREN)){var i=p.Node.createDoStatement(r,n,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),i}this.error(o.DiagnosticCode._0_expected,e.range(),")")}else this.error(o.DiagnosticCode._0_expected,e.range(),"(");else this.error(o.DiagnosticCode._0_expected,e.range(),"while");return null},t.prototype.parseExpressionStatement=function(e){var t=this.parseExpression(e);if(!t)return null;var r=p.Node.createExpressionStatement(t);return e.skip(s.Token.SEMICOLON),r},t.prototype.parseForStatement=function(e){var t=e.tokenPos;if(e.skip(s.Token.OPENPAREN)){var r=null;if(e.skip(s.Token.CONST))r=this.parseVariable(e,i.CommonFlags.CONST,null,e.tokenPos);else if(e.skip(s.Token.LET))r=this.parseVariable(e,i.CommonFlags.LET,null,e.tokenPos);else if(e.skip(s.Token.VAR))r=this.parseVariable(e,i.CommonFlags.NONE,null,e.tokenPos);else if(!e.skip(s.Token.SEMICOLON)&&!(r=this.parseExpressionStatement(e)))return null;if(e.token==s.Token.SEMICOLON){var n=null;if(!e.skip(s.Token.SEMICOLON)&&!(n=this.parseExpressionStatement(e)))return null;if(e.token==s.Token.SEMICOLON){var a=null;if(!e.skip(s.Token.CLOSEPAREN)){if(!(a=this.parseExpression(e)))return null;if(!e.skip(s.Token.CLOSEPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(),")"),null}var c=this.parseStatement(e);return c?p.Node.createForStatement(r,n?n.expression:null,a,c,e.range(t,e.pos)):null}this.error(o.DiagnosticCode._0_expected,e.range(),";")}else this.error(o.DiagnosticCode._0_expected,e.range(),";")}else this.error(o.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseIfStatement=function(e){var t=e.tokenPos;if(e.skip(s.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(s.Token.CLOSEPAREN)){var n=this.parseStatement(e);if(!n)return null;var i=null;return e.skip(s.Token.ELSE)&&!(i=this.parseStatement(e))?null:p.Node.createIfStatement(r,n,i,e.range(t,e.pos))}this.error(o.DiagnosticCode._0_expected,e.range(),")")}else this.error(o.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseSwitchStatement=function(e){var t=e.tokenPos;if(e.skip(s.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(s.Token.CLOSEPAREN)){if(e.skip(s.Token.OPENBRACE)){for(var n=new Array;!e.skip(s.Token.CLOSEBRACE);){var i=this.parseSwitchCase(e);if(!i)return null;n.push(i)}var a=p.Node.createSwitchStatement(r,n,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),a}this.error(o.DiagnosticCode._0_expected,e.range(),"{")}else this.error(o.DiagnosticCode._0_expected,e.range(),")")}else this.error(o.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseSwitchCase=function(e){var t,r,n=e.tokenPos;if(e.skip(s.Token.CASE)){var i=this.parseExpression(e);if(!i)return null;if(e.skip(s.Token.COLON)){for(t=new Array;e.peek()!=s.Token.CASE&&e.nextToken!=s.Token.DEFAULT&&e.nextToken!=s.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return p.Node.createSwitchCase(i,t,e.range(n,e.pos))}this.error(o.DiagnosticCode._0_expected,e.range(),":")}else if(e.skip(s.Token.DEFAULT)){if(e.skip(s.Token.COLON)){for(t=new Array;e.peek()!=s.Token.CASE&&e.nextToken!=s.Token.DEFAULT&&e.nextToken!=s.Token.CLOSEBRACE;){if(!(r=this.parseStatement(e)))return null;t.push(r)}return p.Node.createSwitchCase(null,t,e.range(n,e.pos))}this.error(o.DiagnosticCode._0_expected,e.range(),":")}else this.error(o.DiagnosticCode._case_or_default_expected,e.range());return null},t.prototype.parseThrowStatement=function(e){var t=e.tokenPos,r=this.parseExpression(e);if(!r)return null;var n=p.Node.createThrowStatement(r,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),n},t.prototype.parseTryStatement=function(e){var t,r=e.tokenPos;if(e.skip(s.Token.OPENBRACE)){for(var n=new Array;!e.skip(s.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;n.push(t)}var i=null,a=null,c=null;if(e.skip(s.Token.CATCH)){if(!e.skip(s.Token.OPENPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(),"("),null;if(!e.skipIdentifier())return this.error(o.DiagnosticCode.Identifier_expected,e.range()),null;if(i=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),!e.skip(s.Token.CLOSEPAREN))return this.error(o.DiagnosticCode._0_expected,e.range(),")"),null;if(!e.skip(s.Token.OPENBRACE))return this.error(o.DiagnosticCode._0_expected,e.range(),"{"),null;for(a=[];!e.skip(s.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;a.push(t)}}if(e.skip(s.Token.FINALLY)){if(!e.skip(s.Token.OPENBRACE))return this.error(o.DiagnosticCode._0_expected,e.range(),"{"),null;for(c=[];!e.skip(s.Token.CLOSEBRACE);){if(!(t=this.parseStatement(e)))return null;c.push(t)}}if(!a&&!c)return this.error(o.DiagnosticCode._0_expected,e.range(),"catch"),null;var l=p.Node.createTryStatement(n,i,a,c,e.range(r,e.pos));return e.skip(s.Token.SEMICOLON),l}return this.error(o.DiagnosticCode._0_expected,e.range(),"{"),null},t.prototype.parseTypeDeclaration=function(e,t,r,n){if(e.skipIdentifier()){var a=p.Node.createIdentifierExpression(e.readIdentifier(),e.range()),c=null;if(e.skip(s.Token.LESSTHAN)){if(!(c=this.parseTypeParameters(e)))return null;t|=i.CommonFlags.GENERIC}if(e.skip(s.Token.EQUALS)){var l=this.parseType(e);if(!l)return null;var u=p.Node.createTypeDeclaration(a,c,l,r,t,e.range(n,e.pos));return e.skip(s.Token.SEMICOLON),u}this.error(o.DiagnosticCode._0_expected,e.range(),"=")}else this.error(o.DiagnosticCode.Identifier_expected,e.range());return null},t.prototype.parseVoidStatement=function(e){var t=e.tokenPos,r=this.parseExpression(e,20);if(!r)return null;var n=p.Node.createVoidStatement(r,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),n},t.prototype.parseWhileStatement=function(e){var t=e.tokenPos;if(e.skip(s.Token.OPENPAREN)){var r=this.parseExpression(e);if(!r)return null;if(e.skip(s.Token.CLOSEPAREN)){var n=this.parseStatement(e);if(!n)return null;var i=p.Node.createWhileStatement(r,n,e.range(t,e.pos));return e.skip(s.Token.SEMICOLON),i}this.error(o.DiagnosticCode._0_expected,e.range(),")")}else this.error(o.DiagnosticCode._0_expected,e.range(),"(");return null},t.prototype.parseExpressionStart=function(e){var t=e.next(s.IdentifierHandling.PREFER),r=e.tokenPos,n=null;if(t==s.Token.NULL)return p.Node.createNullExpression(e.range());if(t==s.Token.TRUE)return p.Node.createTrueExpression(e.range());if(t==s.Token.FALSE)return p.Node.createFalseExpression(e.range());var i=function(e){switch(e){case s.Token.DOT_DOT_DOT:return 1;case s.Token.YIELD:return 2;case s.Token.EXCLAMATION:case s.Token.TILDE:case s.Token.PLUS:case s.Token.MINUS:case s.Token.PLUS_PLUS:case s.Token.MINUS_MINUS:case s.Token.TYPEOF:case s.Token.VOID:case s.Token.DELETE:return 16;case s.Token.NEW:return 19;default:return-1}}(t);if(-1!=i){var a=void 0;return t==s.Token.NEW?(a=this.parseExpression(e,18))?a.kind==p.NodeKind.CALL?p.Node.createNewExpression(a.expression,a.typeArguments,a.arguments,e.range(r,e.pos)):(this.error(o.DiagnosticCode.Operation_not_supported,e.range()),null):null:(a=this.parseExpression(e,i))?(t!=s.Token.PLUS_PLUS&&t!=s.Token.MINUS_MINUS||a.kind!=p.NodeKind.IDENTIFIER&&a.kind!=p.NodeKind.ELEMENTACCESS&&a.kind!=p.NodeKind.PROPERTYACCESS&&this.error(o.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,a.range),p.Node.createUnaryPrefixExpression(t,a,e.range(r,e.pos))):null}switch(t){case s.Token.OPENPAREN:if(e.skip(s.Token.CLOSEPAREN))return this.parseFunctionExpressionCommon(e,p.Node.createEmptyIdentifierExpression(e.range(r)),[],!0);var c=e.mark(),l=!0;do{switch(e.next(s.IdentifierHandling.PREFER)){case s.Token.DOT_DOT_DOT:return e.reset(c),this.parseFunctionExpression(e);case s.Token.IDENTIFIER:switch(e.readIdentifier(),e.next()){case s.Token.CLOSEPAREN:if(!e.skip(s.Token.EQUALS_GREATERTHAN)){l=!1;break}case s.Token.COLON:return e.reset(c),this.parseFunctionExpression(e);case s.Token.QUESTION:case s.Token.COMMA:break;default:l=!1}break;default:l=!1}}while(l);return e.reset(c),(n=this.parseExpression(e))?e.skip(s.Token.CLOSEPAREN)?p.Node.createParenthesizedExpression(n,e.range(r,e.pos)):(this.error(o.DiagnosticCode._0_expected,e.range(),")"),null):null;case s.Token.OPENBRACKET:for(var u=new Array;!e.skip(s.Token.CLOSEBRACKET);){if(e.peek()==s.Token.COMMA)n=null;else if(!(n=this.parseExpression(e,1)))return null;if(u.push(n),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEBRACKET))break;return this.error(o.DiagnosticCode._0_expected,e.range(),"]"),null}}return p.Node.createArrayLiteralExpression(u,e.range(r,e.pos));case s.Token.LESSTHAN:var h=this.parseType(e);return h?e.skip(s.Token.GREATERTHAN)?(n=this.parseExpression(e,18))?p.Node.createAssertionExpression(p.AssertionKind.PREFIX,n,h,e.range(r,e.pos)):null:(this.error(o.DiagnosticCode._0_expected,e.range(),">"),null):null;case s.Token.IDENTIFIER:return p.Node.createIdentifierExpression(e.readIdentifier(),e.range(r,e.pos));case s.Token.THIS:return p.Node.createThisExpression(e.range(r,e.pos));case s.Token.CONSTRUCTOR:return p.Node.createConstructorExpression(e.range(r,e.pos));case s.Token.SUPER:return p.Node.createSuperExpression(e.range(r,e.pos));case s.Token.STRINGLITERAL:return p.Node.createStringLiteralExpression(e.readString(),e.range(r,e.pos));case s.Token.INTEGERLITERAL:return p.Node.createIntegerLiteralExpression(e.readInteger(),e.range(r,e.pos));case s.Token.FLOATLITERAL:return p.Node.createFloatLiteralExpression(e.readFloat(),e.range(r,e.pos));case s.Token.SLASH:var d=e.readRegexpPattern();return e.skip(s.Token.SLASH)?p.Node.createRegexpLiteralExpression(d,e.readRegexpFlags(),e.range(r,e.pos)):(this.error(o.DiagnosticCode._0_expected,e.range(),"/"),null);case s.Token.FUNCTION:return this.parseFunctionExpression(e);default:return this.error(o.DiagnosticCode.Expression_expected,e.range()),null}},t.prototype.tryParseTypeArgumentsBeforeArguments=function(e){var t=e.mark();if(!e.skip(s.Token.LESSTHAN))return null;var r=new Array;do{if(e.peek()===s.Token.GREATERTHAN)break;var n=this.parseType(e,!0,!0);if(!n)return e.reset(t),null;r.push(n)}while(e.skip(s.Token.COMMA));return e.skip(s.Token.GREATERTHAN)&&e.skip(s.Token.OPENPAREN)?r:(e.reset(t),null)},t.prototype.parseArguments=function(e){for(var t=new Array;!e.skip(s.Token.CLOSEPAREN);){var r=this.parseExpression(e,1);if(!r)return null;if(t.push(r),!e.skip(s.Token.COMMA)){if(e.skip(s.Token.CLOSEPAREN))break;return this.error(o.DiagnosticCode._0_expected,e.range(),")"),null}}return t},t.prototype.parseExpression=function(e,t){void 0===t&&(t=0);var r=this.parseExpressionStart(e);if(!r)return null;var n,i=r.range.start;if(p.nodeIsCallable(r.kind))for(var a=null;e.skip(s.Token.OPENPAREN)||p.nodeIsGenericCallable(r.kind)&&null!==(a=this.tryParseTypeArgumentsBeforeArguments(e));){var c=this.parseArguments(e);if(!c)return null;r=p.Node.createCallExpression(r,a,c,e.range(i,e.pos))}for(var l,u=null;(l=h(n=e.peek()))>=t;)switch(e.next(),n){case s.Token.AS:var _=this.parseType(e);if(!_)return null;r=p.Node.createAssertionExpression(p.AssertionKind.AS,r,_,e.range(i,e.pos));break;case s.Token.INSTANCEOF:var m=this.parseType(e);if(!m)return null;r=p.Node.createInstanceOfExpression(r,m,e.range(i,e.pos));break;case s.Token.OPENBRACKET:if(!(u=this.parseExpression(e)))return null;if(!e.skip(s.Token.CLOSEBRACKET))return this.error(o.DiagnosticCode._0_expected,e.range(),"]"),null;r=p.Node.createElementAccessExpression(r,u,e.range(i,e.pos));break;case s.Token.PLUS_PLUS:case s.Token.MINUS_MINUS:r.kind!=p.NodeKind.IDENTIFIER&&r.kind!=p.NodeKind.ELEMENTACCESS&&r.kind!=p.NodeKind.PROPERTYACCESS&&this.error(o.DiagnosticCode.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access,r.range),r=p.Node.createUnaryPostfixExpression(n,r,e.range(i,e.pos));break;case s.Token.QUESTION:var y=this.parseExpression(e);if(!y)return null;if(!e.skip(s.Token.COLON))return this.error(o.DiagnosticCode._0_expected,e.range(),":"),null;var g=this.parseExpression(e,t>0?1:0);if(!g)return null;r=p.Node.createTernaryExpression(r,y,g,e.range(i,e.pos));break;case s.Token.COMMA:var T=[r];do{if(!(r=this.parseExpression(e,1)))return null;T.push(r)}while(e.skip(s.Token.COMMA));r=p.Node.createCommaExpression(T,e.range(i,e.pos));break;default:if(!(u=this.parseExpression(e,d(n)?l:l+1)))return null;if(n==s.Token.DOT)if(u.kind==p.NodeKind.IDENTIFIER)r=p.Node.createPropertyAccessExpression(r,u,e.range(i,e.pos));else{if(u.kind!=p.NodeKind.CALL)return this.error(o.DiagnosticCode.Identifier_expected,u.range),null;var E=u;if(E.expression.kind!=p.NodeKind.IDENTIFIER)return this.error(o.DiagnosticCode.Identifier_expected,E.expression.range),null;E.expression=p.Node.createPropertyAccessExpression(r,E.expression,e.range(i,e.pos)),r=E}else r=p.Node.createBinaryExpression(n,r,u,e.range(i,e.pos))}return r},t.prototype.skipStatement=function(e){for(e.peek(!0),e.nextTokenOnNewLine&&e.next();;){var t=e.peek(!0);if(t==s.Token.ENDOFFILE||t==s.Token.SEMICOLON){e.next();break}if(e.nextTokenOnNewLine)break;switch(e.next()){case s.Token.IDENTIFIER:e.readIdentifier();break;case s.Token.STRINGLITERAL:e.readString();break;case s.Token.INTEGERLITERAL:e.readInteger();break;case s.Token.FLOATLITERAL:e.readFloat()}}},t}(o.DiagnosticEmitter);function h(e){switch(e){case s.Token.COMMA:return 0;case s.Token.EQUALS:case s.Token.PLUS_EQUALS:case s.Token.MINUS_EQUALS:case s.Token.ASTERISK_ASTERISK_EQUALS:case s.Token.ASTERISK_EQUALS:case s.Token.SLASH_EQUALS:case s.Token.PERCENT_EQUALS:case s.Token.LESSTHAN_LESSTHAN_EQUALS:case s.Token.GREATERTHAN_GREATERTHAN_EQUALS:case s.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case s.Token.AMPERSAND_EQUALS:case s.Token.CARET_EQUALS:case s.Token.BAR_EQUALS:return 3;case s.Token.QUESTION:return 4;case s.Token.BAR_BAR:return 5;case s.Token.AMPERSAND_AMPERSAND:return 6;case s.Token.BAR:return 7;case s.Token.CARET:return 8;case s.Token.AMPERSAND:return 9;case s.Token.EQUALS_EQUALS:case s.Token.EXCLAMATION_EQUALS:case s.Token.EQUALS_EQUALS_EQUALS:case s.Token.EXCLAMATION_EQUALS_EQUALS:return 10;case s.Token.AS:case s.Token.IN:case s.Token.INSTANCEOF:case s.Token.LESSTHAN:case s.Token.GREATERTHAN:case s.Token.LESSTHAN_EQUALS:case s.Token.GREATERTHAN_EQUALS:return 11;case s.Token.LESSTHAN_LESSTHAN:case s.Token.GREATERTHAN_GREATERTHAN:case s.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:return 12;case s.Token.PLUS:case s.Token.MINUS:return 13;case s.Token.ASTERISK:case s.Token.SLASH:case s.Token.PERCENT:return 14;case s.Token.ASTERISK_ASTERISK:return 15;case s.Token.PLUS_PLUS:case s.Token.MINUS_MINUS:return 17;case s.Token.DOT:case s.Token.NEW:case s.Token.OPENBRACKET:return 19;default:return-1}}function d(e){switch(e){case s.Token.EQUALS:case s.Token.PLUS_EQUALS:case s.Token.MINUS_EQUALS:case s.Token.ASTERISK_ASTERISK_EQUALS:case s.Token.ASTERISK_EQUALS:case s.Token.SLASH_EQUALS:case s.Token.PERCENT_EQUALS:case s.Token.LESSTHAN_LESSTHAN_EQUALS:case s.Token.GREATERTHAN_GREATERTHAN_EQUALS:case s.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:case s.Token.AMPERSAND_EQUALS:case s.Token.CARET_EQUALS:case s.Token.BAR_EQUALS:case s.Token.QUESTION:case s.Token.ASTERISK_ASTERISK:return!0;default:return!1}}t.Parser=u,function(e){e[e.COMMA=0]="COMMA",e[e.SPREAD=1]="SPREAD",e[e.YIELD=2]="YIELD",e[e.ASSIGNMENT=3]="ASSIGNMENT",e[e.CONDITIONAL=4]="CONDITIONAL",e[e.LOGICAL_OR=5]="LOGICAL_OR",e[e.LOGICAL_AND=6]="LOGICAL_AND",e[e.BITWISE_OR=7]="BITWISE_OR",e[e.BITWISE_XOR=8]="BITWISE_XOR",e[e.BITWISE_AND=9]="BITWISE_AND",e[e.EQUALITY=10]="EQUALITY",e[e.RELATIONAL=11]="RELATIONAL",e[e.SHIFT=12]="SHIFT",e[e.ADDITIVE=13]="ADDITIVE",e[e.MULTIPLICATIVE=14]="MULTIPLICATIVE",e[e.EXPONENTIATED=15]="EXPONENTIATED",e[e.UNARY_PREFIX=16]="UNARY_PREFIX",e[e.UNARY_POSTFIX=17]="UNARY_POSTFIX",e[e.CALL=18]="CALL",e[e.MEMBERACCESS=19]="MEMBERACCESS",e[e.GROUPING=20]="GROUPING",e[e.INVALID=-1]="INVALID"}(t.Precedence||(t.Precedence={}))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),o=r(5),c=r(1),p=function(){function e(e,t){void 0===t&&(t=!1),this.todo=[],this.seen=new Set,this.program=e,this.includePrivate}return e.prototype.walk=function(){var e,t;try{for(var r=i(this.program.moduleLevelExports.values()),n=r.next();!n.done;n=r.next()){var a=n.value;this.visitElement(a)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}for(var s=this.todo;0<s.length;)this.visitElement(s[0])},e.prototype.visitElement=function(e){if((!e.is(s.CommonFlags.PRIVATE)||this.includePrivate)&&!this.seen.has(e))switch(this.seen.add(e),e.kind){case o.ElementKind.GLOBAL:e.is(s.CommonFlags.COMPILED)&&this.visitGlobal(e);break;case o.ElementKind.ENUM:e.is(s.CommonFlags.COMPILED)&&this.visitEnum(e);break;case o.ElementKind.FUNCTION_PROTOTYPE:this.visitFunctionInstances(e);break;case o.ElementKind.CLASS_PROTOTYPE:this.visitClassInstances(e);break;case o.ElementKind.FIELD:e.is(s.CommonFlags.COMPILED)&&this.visitField(e);break;case o.ElementKind.PROPERTY:var t=e,r=t.getterPrototype;r&&this.visitFunctionInstances(r);var n=t.setterPrototype;n&&this.visitFunctionInstances(n);break;case o.ElementKind.NAMESPACE:(function e(t){var r,n,a,c,p,l;var u=t.members;if(u)try{for(var h=i(u.values()),d=h.next();!d.done;d=h.next()){var _=d.value;switch(_.kind){case o.ElementKind.FUNCTION_PROTOTYPE:try{for(var m=i(_.instances.values()),y=m.next();!y.done;y=m.next()){var g=y.value;if(g.is(s.CommonFlags.COMPILED))return!0}}catch(e){a={error:e}}finally{try{y&&!y.done&&(c=m.return)&&c.call(m)}finally{if(a)throw a.error}}break;case o.ElementKind.CLASS_PROTOTYPE:try{for(var T=i(_.instances.values()),E=T.next();!E.done;E=T.next()){var g=E.value;if(g.is(s.CommonFlags.COMPILED))return!0}}catch(e){p={error:e}}finally{try{E&&!E.done&&(l=T.return)&&l.call(T)}finally{if(p)throw p.error}}break;default:if(_.is(s.CommonFlags.COMPILED)||e(_))return!0}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return!1})(e)&&this.visitNamespace(e);break;default:assert(!1)}},e.prototype.visitFunctionInstances=function(e){var t,r;try{for(var n=i(e.instances.values()),a=n.next();!a.done;a=n.next()){var o=a.value;o.is(s.CommonFlags.COMPILED)&&this.visitFunction(o)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.visitClassInstances=function(e){var t,r;try{for(var n=i(e.instances.values()),a=n.next();!a.done;a=n.next()){var o=a.value;o.is(s.CommonFlags.COMPILED)&&this.visitClass(o)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e}(),l=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t,r)||this;return n.sb=[],n.indentLevel=0,n}return n(t,e),t.build=function(e){return new t(e).build()},t.prototype.visitGlobal=function(e){var t=this.sb,r=e.is(s.CommonFlags.INLINED);if(c.indent(t,this.indentLevel),r&&t.push("const "),t.push(this.typeToString(e.type)),t.push(" "),t.push(e.simpleName),r)switch(e.constantValueKind){case 1:t.push(" = "),t.push(i64_to_string(e.constantIntegerValue));break;case 2:t.push(" = "),t.push(e.constantFloatValue.toString());break;default:assert(!1)}t.push(";\n")},t.prototype.visitEnum=function(e){var t,r,n,p,l=this.sb;c.indent(l,this.indentLevel++),l.push("interface "),l.push(e.simpleName),l.push(" {\n");var u=e.members;if(u){try{for(var h=i(u),d=h.next();!d.done;d=h.next()){var _=a(d.value,2),m=_[0];if((E=_[1]).kind==o.ElementKind.ENUMVALUE){var y=E.is(s.CommonFlags.INLINED);c.indent(l,this.indentLevel),y?l.push("const "):l.push("readonly "),l.push("unsigned long "),l.push(m),y&&(l.push(" = "),l.push(E.constantValue.toString(10))),l.push(";\n")}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}try{for(var g=i(u.values()),T=g.next();!T.done;T=g.next()){var E;(E=T.value).kind!=o.ElementKind.ENUMVALUE&&this.visitElement(E)}}catch(e){n={error:e}}finally{try{T&&!T.done&&(p=g.return)&&p.call(g)}finally{if(n)throw n.error}}}c.indent(l,--this.indentLevel),l.push("}\n")},t.prototype.visitFunction=function(e){var t,r,n=this.sb,a=e.signature;c.indent(n,this.indentLevel),n.push(this.typeToString(a.returnType)),n.push(" "),n.push(e.simpleName),n.push("(");for(var s=a.parameterTypes,o=s.length,p=0;p<o;++p)p&&n.push(", "),n.push(this.typeToString(s[p])),n.push(" "),n.push(a.getParameterName(p));n.push(");\n");var l=e.members;if(l&&l.size){c.indent(n,this.indentLevel),n.push("interface "),n.push(e.simpleName),n.push(" {\n");try{for(var u=i(l.values()),h=u.next();!h.done;h=u.next()){var d=h.value;this.visitElement(d)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}c.indent(n,--this.indentLevel),n.push("}\n")}},t.prototype.visitClass=function(e){var t=this.sb;c.indent(t,this.indentLevel++),t.push("interface "),t.push(e.simpleName),t.push(" {\n"),c.indent(t,--this.indentLevel),t.push("}\n")},t.prototype.visitInterface=function(e){this.visitClass(e)},t.prototype.visitField=function(e){},t.prototype.visitNamespace=function(e){var t,r,n=this.sb;c.indent(n,this.indentLevel++),n.push("interface "),n.push(e.simpleName),n.push(" {\n");var a=e.members;if(a)try{for(var s=i(a.values()),o=s.next();!o.done;o=s.next()){var p=o.value;this.visitElement(p)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}c.indent(n,--this.indentLevel),n.push("}\n")},t.prototype.typeToString=function(e){switch(e.kind){case 0:return"byte";case 1:return"short";case 2:return"long";case 3:return"long long";case 4:return this.program.options.isWasm64?"long long":"long";case 5:return"octet";case 6:return"unsigned short";case 7:return"unsigned long";case 8:return"unsigned long long";case 9:return this.program.options.isWasm64?"unsigned long long":"unsigned long";case 10:return"boolean";case 11:return"unrestricted float";case 12:return"unrestricted double";case 13:return"void";default:return assert(!1),""}},t.prototype.build=function(){var e=this.sb;return e.push("interface ASModule {\n"),++this.indentLevel,this.walk(),--this.indentLevel,e.push("}\n"),e.join("")},t}(p);t.IDLBuilder=l;var u=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t,r)||this;return n.sb=[],n.indentLevel=0,n}return n(t,e),t.build=function(e){return new t(e).build()},t.prototype.visitGlobal=function(e){var t=this.sb,r=e.is(s.CommonFlags.INLINED);c.indent(t,this.indentLevel),e.is(s.CommonFlags.STATIC)?r?t.push("static readonly "):t.push("static "):r?t.push("const "):t.push("var "),t.push(e.simpleName),t.push(": "),t.push(this.typeToString(e.type)),t.push(";\n"),this.visitNamespace(e)},t.prototype.visitEnum=function(e){var t,r,n=this.sb;c.indent(n,this.indentLevel++),n.push("enum "),n.push(e.simpleName),n.push(" {\n");var p=e.members;if(p){var l=p.size;try{for(var u=i(p),h=u.next();!h.done;h=u.next()){var d=a(h.value,2),_=d[0],m=d[1];m.kind==o.ElementKind.ENUMVALUE&&(c.indent(n,this.indentLevel),n.push(_),m.is(s.CommonFlags.INLINED)&&(n.push(" = "),n.push(m.constantValue.toString(10))),n.push(",\n"),--l)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}l&&this.visitNamespace(e)}c.indent(n,--this.indentLevel),n.push("}\n")},t.prototype.visitFunction=function(e){if(!e.isAny(s.CommonFlags.PRIVATE|s.CommonFlags.SET)){var t=this.sb,r=e.signature;if(c.indent(t,this.indentLevel),e.is(s.CommonFlags.PROTECTED)&&t.push("protected "),e.is(s.CommonFlags.STATIC)&&t.push("static "),e.is(s.CommonFlags.GET))return t.push(e.prototype.declaration.name.text),t.push(": "),t.push(this.typeToString(r.returnType)),void t.push(";\n");e.isAny(s.CommonFlags.STATIC|s.CommonFlags.INSTANCE)||t.push("function "),t.push(e.simpleName),t.push("(");for(var n=r.parameterTypes,i=n.length,a=0;a<i;++a)a&&t.push(", "),t.push(r.getParameterName(a)),t.push(": "),t.push(this.typeToString(n[a]));e.isAny(s.CommonFlags.CONSTRUCTOR|s.CommonFlags.SET)?t.push(")"):(t.push("): "),t.push(this.typeToString(r.returnType))),t.push(";\n"),this.visitNamespace(e)}},t.prototype.visitClass=function(e){var t,r,n,a,p=this.sb,l=e.kind==o.ElementKind.INTERFACE;c.indent(p,this.indentLevel++),l?p.push("interface "):(e.is(s.CommonFlags.ABSTRACT)&&p.push("abstract "),p.push("class ")),p.push(e.simpleName);var u=e.base;u&&u.is(s.CommonFlags.COMPILED|s.CommonFlags.MODULE_EXPORT)&&(p.push(" extends "),p.push(u.simpleName)),p.push(" {\n");var h=e.prototype.members;if(h)try{for(var d=i(h.values()),_=d.next();!_.done;_=d.next()){var m=_.value;this.visitElement(m)}}catch(e){t={error:e}}finally{try{_&&!_.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}var y=e.constructorInstance;if(y&&this.visitFunction(y),h=e.members)try{for(var g=i(h.values()),T=g.next();!T.done;T=g.next()){m=T.value;this.visitElement(m)}}catch(e){n={error:e}}finally{try{T&&!T.done&&(a=g.return)&&a.call(g)}finally{if(n)throw n.error}}c.indent(p,--this.indentLevel),p.push("}\n")},t.prototype.visitInterface=function(e){this.visitClass(e)},t.prototype.visitField=function(e){if(!e.is(s.CommonFlags.PRIVATE)){var t=this.sb;c.indent(t,this.indentLevel),e.is(s.CommonFlags.PROTECTED)&&t.push("protected "),e.is(s.CommonFlags.STATIC)&&t.push("static "),e.is(s.CommonFlags.READONLY)&&t.push("readonly "),t.push(e.simpleName),t.push(": "),t.push(this.typeToString(e.type)),t.push(";\n")}},t.prototype.visitNamespace=function(e){var t,r,n=e.members;if(n&&n.size){var a=this.sb;c.indent(a,this.indentLevel++),a.push("namespace "),a.push(e.simpleName),a.push(" {\n");try{for(var s=i(n.values()),o=s.next();!o.done;o=s.next()){var p=o.value;this.visitElement(p)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}c.indent(a,--this.indentLevel),a.push("}\n")}},t.prototype.typeToString=function(e){switch(e.kind){case 0:return"i8";case 1:return"i16";case 2:return"i32";case 3:return"I64";case 4:return this.program.options.isWasm64?"I64":"i32";case 5:return"u8";case 6:return"u16";case 7:return"u32";case 8:return"U64";case 9:return this.program.options.isWasm64?"U64":"u32";case 10:return"bool";case 11:return"f32";case 12:return"f64";case 13:return"void";default:return assert(!1),""}},t.prototype.build=function(){var e=this.sb;return e.push("declare module ASModule {\n"),e.push("  type i8 = number;\n"),e.push("  type i16 = number;\n"),e.push("  type i32 = number;\n"),e.push("  type u8 = number;\n"),e.push("  type u16 = number;\n"),e.push("  type u32 = number;\n"),e.push("  type f32 = number;\n"),e.push("  type f64 = number;\n"),e.push("  type bool = any;\n"),++this.indentLevel,this.walk(),--this.indentLevel,e.push("}\n"),e.push("export default ASModule;\n"),this.sb.join("")},t}(p);t.TSDBuilder=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=function(){function e(){this.text=[],this.functionId=0}return e.decompile=function(t){var r=new e;return r.decompile(t),r.finish()},e.prototype.decompile=function(e){throw new Error("not implemented")},e.prototype.decompileFunction=function(e){var t=n.getFunctionName(e)||"$"+this.functionId.toString(10),r=n.getFunctionBody(e);this.push("function "),this.push(t),this.push("(");for(var i=0,s=n.getFunctionParamCount(e);i<s;++i)i>0&&this.push(", "),this.push("$"),this.push(i.toString(10)),this.push(": "),this.push(a(n.getFunctionParamType(e,i)));this.push("): "),this.push(a(n.getFunctionResultType(e))),this.push(" "),n.getExpressionId(r)!=n.ExpressionId.Block&&this.push("{\n"),this.decompileExpression(r),n.getExpressionId(r)!=n.ExpressionId.Block&&this.push("\n}\n"),++this.functionId},e.prototype.decompileExpression=function(e){var t,r,i,s,o=n.getExpressionId(e),c=n.getExpressionType(e);switch(o){case n.ExpressionId.Block:for(null!=(r=n.getBlockName(e))&&(this.push(r),this.push(": ")),this.push("{\n"),s=n.getBlockChildCount(e),i=0;i<s;++i)this.decompileExpression(n.getBlockChild(e,i));return void this.push("}\n");case n.ExpressionId.If:return void(c==n.NativeType.None?(this.push("if ("),this.decompileExpression(n.getIfCondition(e)),this.push(") "),this.decompileExpression(n.getIfTrue(e)),(t=n.getIfFalse(e))&&(this.push(" else "),this.decompileExpression(t))):(this.decompileExpression(n.getIfCondition(e)),this.push(" ? "),this.decompileExpression(n.getIfTrue(e)),this.push(" : "),this.decompileExpression(n.getIfFalse(e))));case n.ExpressionId.Loop:null!=(r=n.getLoopName(e))&&(this.push(r),this.push(": ")),this.push("do "),this.decompileExpression(n.getLoopBody(e)),this.push("while (0);\n");case n.ExpressionId.Break:return(t=n.getBreakCondition(e))&&(this.push("if ("),this.decompileExpression(t),this.push(") ")),void(null!=(r=n.getBreakName(e))?(this.push("break "),this.push(r),this.push(";\n")):this.push("break;\n"));case n.ExpressionId.Switch:case n.ExpressionId.Call:case n.ExpressionId.CallImport:case n.ExpressionId.CallIndirect:throw new Error("not implemented");case n.ExpressionId.GetLocal:return this.push("$"),void this.push(n.getGetLocalIndex(e).toString(10));case n.ExpressionId.SetLocal:return this.push("$"),this.push(n.getSetLocalIndex(e).toString(10)),this.push(" = "),void this.decompileExpression(n.getSetLocalValue(e));case n.ExpressionId.GetGlobal:case n.ExpressionId.SetGlobal:throw new Error("not implemented");case n.ExpressionId.Load:return this.push("load<"),this.push(a(c)),this.push(">("),this.push(n.getLoadOffset(e).toString(10)),this.push(" + "),this.decompileExpression(n.getLoadPtr(e)),void this.push(")");case n.ExpressionId.Store:return this.push("store<"),this.push(a(c)),this.push(">("),this.push(n.getStoreOffset(e).toString(10)),this.push(" + "),this.decompileExpression(n.getStorePtr(e)),this.push(", "),this.decompileExpression(n.getStoreValue(e)),void this.push(")");case n.ExpressionId.Const:switch(c){case n.NativeType.I32:return void this.push(n.getConstValueI32(e).toString(10));case n.NativeType.I64:return void this.push(i64_to_string(i64_new(n.getConstValueI64Low(e),n.getConstValueI64High(e))));case n.NativeType.F32:return void this.push(n.getConstValueF32(e).toString(10));case n.NativeType.F64:return void this.push(n.getConstValueF64(e).toString(10))}break;case n.ExpressionId.Unary:switch(n.getUnaryOp(e)){case n.UnaryOp.ClzI32:return this.push("clz<i32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.CtzI32:return this.push("ctz<i32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.PopcntI32:return this.push("popcnt<i32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.NegF32:case n.UnaryOp.NegF64:return this.push("-"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.AbsF32:return this.push("abs<f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.CeilF32:return this.push("ceil<f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.FloorF32:return this.push("floor<f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.TruncF32:return this.push("trunc<f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.NearestF32:return this.push("nearest<i32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.SqrtF32:return this.push("sqrt<f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.EqzI32:case n.UnaryOp.EqzI64:return this.push("!"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ClzI64:return this.push("clz<i64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.CtzI64:return this.push("ctz<i64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.PopcntI64:return this.push("popcnt<i64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.AbsF64:return this.push("abs<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.CeilF64:return this.push("ceil<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.FloorF64:return this.push("floor<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.TruncF64:return this.push("trunc<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.NearestF64:return this.push("nearest<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.SqrtF64:return this.push("sqrt<f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.ExtendI32:return this.push("<i64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ExtendU32:return this.push("<i64><u64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.WrapI64:case n.UnaryOp.TruncF32ToI32:return this.push("<i32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF32ToI64:return this.push("<i64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF32ToU32:return this.push("<i32><u32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF32ToU64:return this.push("<i64><u64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF64ToI32:return this.push("<i32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF64ToI64:return this.push("<i64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF64ToU32:return this.push("<i32><u32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.TruncF64ToU64:return this.push("<i64><u64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ReinterpretF32:return this.push("reinterpret<f32,i32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.ReinterpretF64:return this.push("reinterpret<f64,i64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.ConvertI32ToF32:return this.push("<f32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertI32ToF64:return this.push("<f64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertU32ToF32:return this.push("<f32><u32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertU32ToF64:return this.push("<f64><u32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertI64ToF32:return this.push("<f32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertI64ToF64:return this.push("<f64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertU64ToF32:return this.push("<f32><u64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ConvertU64ToF64:return this.push("<f64><u64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.PromoteF32:return this.push("<f64>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.DemoteF64:return this.push("<f32>"),void this.decompileExpression(n.getUnaryValue(e));case n.UnaryOp.ReinterpretI32:return this.push("reinterpret<i32,f32>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")");case n.UnaryOp.ReinterpretI64:return this.push("reinterpret<i64,f64>("),this.decompileExpression(n.getUnaryValue(e)),void this.push(")")}break;case n.ExpressionId.Binary:switch(n.getBinaryOp(e)){case n.BinaryOp.AddI32:case n.BinaryOp.AddI64:case n.BinaryOp.AddF32:case n.BinaryOp.AddF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" + "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.SubI32:case n.BinaryOp.SubI64:case n.BinaryOp.SubF32:case n.BinaryOp.SubF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" - "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.MulI32:case n.BinaryOp.MulI64:case n.BinaryOp.MulF32:case n.BinaryOp.MulF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" * "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.DivI32:case n.BinaryOp.DivI64:case n.BinaryOp.DivF32:case n.BinaryOp.DivF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" / "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.DivU32:return this.push("<i32>(<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" / <u32>"),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.RemI32:case n.BinaryOp.RemI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" % "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.RemU32:return this.push("<i32>(<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" / <u32>"),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.AndI32:case n.BinaryOp.AndI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" & "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.OrI32:case n.BinaryOp.OrI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" | "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.XorI32:case n.BinaryOp.XorI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" ^ "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.ShlI32:case n.BinaryOp.ShlI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" << "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.ShrU32:case n.BinaryOp.ShrU64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" >>> "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.ShrI32:case n.BinaryOp.ShrI64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" >> "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.RotlI32:return this.push("rotl<i32>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.RotrI32:return this.push("rotr<i32>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.EqI32:case n.BinaryOp.EqI64:case n.BinaryOp.EqF32:case n.BinaryOp.EqF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" == "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.NeI32:case n.BinaryOp.NeI64:case n.BinaryOp.NeF32:case n.BinaryOp.NeF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" != "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.LtI32:case n.BinaryOp.LtI64:case n.BinaryOp.LtF32:case n.BinaryOp.LtF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" < "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.LtU32:return this.push("<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" < <u32>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.LeI32:case n.BinaryOp.LeI64:case n.BinaryOp.LeF32:case n.BinaryOp.LeF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" <= "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.LeU32:return this.push("<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" <= <u32>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GtI32:case n.BinaryOp.GtI64:case n.BinaryOp.GtF32:case n.BinaryOp.GtF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" > "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GtU32:return this.push("<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" > <u32>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GeI32:case n.BinaryOp.GeI64:case n.BinaryOp.GeF32:case n.BinaryOp.GeF64:return this.decompileExpression(n.getBinaryLeft(e)),this.push(" >= "),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GeU32:return this.push("<u32>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" >= <u32>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.DivU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" / <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.RemU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" % <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.RotlI64:return this.push("rotl<i64>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.RotrI64:return this.push("rotr<i64>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.LtU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" < <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.LeU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" <= <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GtU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" > <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.GeU64:return this.push("<u64>"),this.decompileExpression(n.getBinaryLeft(e)),this.push(" >= <u64>"),void this.decompileExpression(n.getBinaryRight(e));case n.BinaryOp.CopysignF32:return this.push("copysign<f32>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.MinF32:return this.push("min<f32>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.MaxF32:return this.push("max<f32>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.CopysignF64:return this.push("copysign<f64>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.MinF64:return this.push("min<f64>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")");case n.BinaryOp.MaxF64:return this.push("max<f64>("),this.decompileExpression(n.getBinaryLeft(e)),this.push(", "),this.decompileExpression(n.getBinaryRight(e)),void this.push(")")}return;case n.ExpressionId.Select:return this.push("select<"),this.push(a(c)),this.push(">("),this.decompileExpression(n.getSelectThen(e)),this.push(", "),this.decompileExpression(n.getSelectElse(e)),this.push(", "),this.decompileExpression(n.getSelectCondition(e)),void this.push(")");case n.ExpressionId.Drop:return this.decompileExpression(n.getDropValue(e)),void this.push(";\n");case n.ExpressionId.Return:return void((t=n.getReturnValue(e))?(this.push("return "),this.decompileExpression(t),this.push(";\n")):this.push("return;\n"));case n.ExpressionId.Host:switch(n.getHostOp(e)){case n.HostOp.CurrentMemory:return void this.push("current_memory()");case n.HostOp.GrowMemory:return this.push("grow_memory("),this.decompileExpression(n.getHostOperand(e,0)),void this.push(")")}break;case n.ExpressionId.Nop:return void this.push(";\n");case n.ExpressionId.Unreachable:return void this.push("unreachable()");case n.ExpressionId.AtomicCmpxchg:case n.ExpressionId.AtomicRMW:case n.ExpressionId.AtomicWait:case n.ExpressionId.AtomicWake:}throw new Error("not implemented")},e.prototype.push=function(e){this.text.push(e)},e.prototype.finish=function(){var e=this.text.join("");return this.text=[],e},e}();function a(e){switch(e){case n.NativeType.None:return"void";case n.NativeType.I32:return"i32";case n.NativeType.I64:return"i64";case n.NativeType.F32:return"f32";case n.NativeType.F64:return"f64";case n.NativeType.Unreachable:throw new Error("unreachable type");case n.NativeType.Auto:throw new Error("auto type");default:throw new Error("unexpected type")}}t.Decompiler=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(13),a=r(12),s=r(2);t.formatDiagnostic=s.formatDiagnosticMessage;var o=r(11);t.parseFile=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=null),n||(n=new o.Parser),n.parseFile(e,t,r),n},t.nextFile=function(e){return e.nextFile()},t.nextDiagnostic=function(e){var t=e.program;return t.diagnosticsOffset<t.diagnostics.length?t.diagnostics[t.diagnosticsOffset++]:null},t.isInfo=function(e){return e.category==s.DiagnosticCategory.INFO},t.isWarning=function(e){return e.category==s.DiagnosticCategory.WARNING},t.isError=function(e){return e.category==s.DiagnosticCategory.ERROR},t.createOptions=function(){return new n.Options},t.setTarget=function(e,t){e.target=t},t.setNoTreeShaking=function(e,t){e.noTreeShaking=t},t.setNoAssert=function(e,t){e.noAssert=t},t.setImportMemory=function(e,t){e.importMemory=t},t.setImportTable=function(e,t){e.importTable=t},t.setSourceMap=function(e,t){e.sourceMap=t},t.setMemoryBase=function(e,t){e.memoryBase=t},t.setGlobalAlias=function(e,t,r){var n=e.globalAliases;n||(e.globalAliases=n=new Map),n.set(t,r)},t.FEATURE_SIGN_EXTENSION=1,t.FEATURE_MUTABLE_GLOBAL=2,t.enableFeature=function(e,t){e.features|=t},t.finishParsing=function(e){return e.finish()},t.compileProgram=function(e,t){return void 0===t&&(t=null),new n.Compiler(e,t).compile()},t.decompileModule=function(e){var t=new i.Decompiler;return t.decompile(e),t.finish()},t.buildIDL=function(e){return a.IDLBuilder.build(e)},t.buildTSD=function(e){return a.TSDBuilder.build(e)};var c=r(0);t.LIBRARY_PREFIX=c.LIBRARY_PREFIX},function(e,t,r){(function(e){const t=new Float64Array(1),r=new Float32Array(t.buffer),n=new Int32Array(t.buffer);e.f32_as_i32=function(e){return r[0]=e,n[0]},e.i32_as_f32=function(e){return n[0]=e,r[0]},e.f64_as_i64=function(e){return t[0]=e,i64_new(n[0],n[1])},e.i64_as_f64=function(e){return n[0]=i64_low(e),n[1]=i64_high(e),t[0]}}).call(this,r(6))},function(e,t){e.exports=n;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=i;var a={},s={};function o(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=s[e])?n:(r=p(e,(0|e)<0?-1:0,!0),i&&(s[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=a[e])?n:(r=p(e,e<0?-1:0,!1),i&&(a[e]=r),r)}function c(e,t){if(isNaN(e))return t?T:g;if(t){if(e<0)return T;if(e>=_)return A}else{if(e<=-m)return N;if(e+1>=m)return v}return e<0?c(-e,t).neg():p(e%d|0,e/d|0,t)}function p(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=c,n.fromBits=p;var l=Math.pow;function u(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(e.substring(1),t,r).neg();for(var i=c(l(r,8)),a=g,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),p=parseInt(e.substring(s,s+o),r);if(o<8){var h=c(l(r,o));a=a.mul(h).add(c(p))}else a=(a=a.mul(i)).add(c(p))}return a.unsigned=t,a}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?u(e,t):p(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=h;var d=4294967296,_=d*d,m=_/2,y=o(1<<24),g=o(0);n.ZERO=g;var T=o(0,!0);n.UZERO=T;var E=o(1);n.ONE=E;var f=o(1,!0);n.UONE=f;var I=o(-1);n.NEG_ONE=I;var v=p(-1,2147483647,!1);n.MAX_VALUE=v;var A=p(-1,-1,!0);n.MAX_UNSIGNED_VALUE=A;var N=p(0,-2147483648,!1);n.MIN_VALUE=N;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=c(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=c(l(e,6),this.unsigned),a=this,s="";;){var o=a.div(i),p=(a.sub(o.mul(i)).toInt()>>>0).toString(e);if((a=o).isZero())return p+s;for(;p.length<6;)p="0"+p;s=""+p+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return i(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(i(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(E)},C.neg=C.negate,C.add=function(e){i(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,a=65535&this.low,s=e.high>>>16,o=65535&e.high,c=e.low>>>16,l=0,u=0,d=0,_=0;return d+=(_+=a+(65535&e.low))>>>16,u+=(d+=n+c)>>>16,l+=(u+=r+o)>>>16,l+=t+s,p((d&=65535)<<16|(_&=65535),(l&=65535)<<16|(u&=65535),this.unsigned)},C.subtract=function(e){return i(e)||(e=h(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return g;if(i(e)||(e=h(e)),r)return p(r.mul(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(N))return e.isOdd()?N:g;if(e.eq(N))return this.isOdd()?N:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,s=65535&this.low,o=e.high>>>16,l=65535&e.high,u=e.low>>>16,d=65535&e.low,_=0,m=0,T=0,E=0;return T+=(E+=s*d)>>>16,m+=(T+=a*d)>>>16,T&=65535,m+=(T+=s*u)>>>16,_+=(m+=n*d)>>>16,m&=65535,_+=(m+=a*u)>>>16,m&=65535,_+=(m+=s*l)>>>16,_+=t*d+n*u+a*l+s*o,p((T&=65535)<<16|(E&=65535),(_&=65535)<<16|(m&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(i(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,n,a;if(r)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?p((this.unsigned?r.div_u:r.div_s)(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?T:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return T;if(e.gt(this.shru(1)))return f;a=T}else{if(this.eq(N))return e.eq(E)||e.eq(I)?N:e.eq(N)?E:(t=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?E:I:(n=this.sub(e.mul(t)),a=t.add(n.div(e)));else if(e.eq(N))return this.unsigned?T:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=g}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),o=s<=48?1:l(2,s-48),u=c(t),d=u.mul(e);d.isNegative()||d.gt(n);)d=(u=c(t-=o,this.unsigned)).mul(e);u.isZero()&&(u=E),a=a.add(u),n=n.sub(d)}return a},C.div=C.divide,C.modulo=function(e){return i(e)||(e=h(e)),r?p((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return p(~this.low,~this.high,this.unsigned)},C.and=function(e){return i(e)||(e=h(e)),p(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return i(e)||(e=h(e)),p(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return i(e)||(e=h(e)),p(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?p(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):p(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?p(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):p(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?p(this.low>>>e|t<<32-e,t>>>e,this.unsigned):p(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?p(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:p(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,r){(function(e){const t=e.Long||r(16);e.i64_zero=t.ZERO,e.i64_one=t.ONE,e.i64_new=function(e,r){return t.fromBits(e,r)},e.i64_low=function(e){return e.low},e.i64_high=function(e){return e.high},e.i64_add=function(e,t){return e.add(t)},e.i64_sub=function(e,t){return e.sub(t)},e.i64_mul=function(e,t){return e.mul(t)},e.i64_div=function(e,t){return e.div(t)},e.i64_div_u=function(e,t){return e.toUnsigned().div(t.toUnsigned()).toSigned()},e.i64_rem=function(e,t){return e.mod(t)},e.i64_rem_u=function(e,t){return e.toUnsigned().mod(t.toUnsigned()).toSigned()},e.i64_and=function(e,t){return e.and(t)},e.i64_or=function(e,t){return e.or(t)},e.i64_xor=function(e,t){return e.xor(t)},e.i64_shl=function(e,t){return e.shl(t)},e.i64_shr=function(e,t){return e.shr(t)},e.i64_shr_u=function(e,t){return e.shru(t)},e.i64_not=function(e){return e.not()},e.i64_eq=function(e,t){return e.eq(t)},e.i64_ne=function(e,t){return e.ne(t)},e.i64_align=function(e,r){assert(r&&0==(r&r-1));var n=t.fromInt(r-1);return e.add(n).and(n.not())},e.i64_is_i8=function(e){return 0===e.high&&e.low>=0&&e.low<=i8.MAX_VALUE||-1===e.high&&e.low>=i8.MIN_VALUE&&e.low<0},e.i64_is_i16=function(e){return 0===e.high&&e.low>=0&&e.low<=i16.MAX_VALUE||-1===e.high&&e.low>=i16.MIN_VALUE&&e.low<0},e.i64_is_i32=function(e){return 0===e.high&&e.low>=0||-1===e.high&&e.low<0},e.i64_is_u8=function(e){return 0===e.high&&e.low>=0&&e.low<=u8.MAX_VALUE},e.i64_is_u16=function(e){return 0===e.high&&e.low>=0&&e.low<=u16.MAX_VALUE},e.i64_is_u32=function(e){return 0===e.high},e.i64_is_bool=function(e){return 0===e.high&&(0===e.low||1===e.low)};const n=t.fromNumber(f32.MIN_SAFE_INTEGER),i=t.fromNumber(f32.MAX_SAFE_INTEGER);e.i64_is_f32=function(e){return e.gte(n)&&e.lte(i)};const a=t.fromNumber(f64.MIN_SAFE_INTEGER),s=t.fromNumber(f64.MAX_SAFE_INTEGER);e.i64_is_f64=function(e){return e.gte(a)&&e.lte(s)},e.i64_to_f32=function(t){return e.Math.fround(t.toNumber())},e.i64_to_f64=function(e){return e.toNumber()},e.i64_to_string=function(e,t){return(t?e.toUnsigned():e).toString(10)}}).call(this,r(6))},function(e,t,r){"use strict";function n(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function i(e,t,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function a(e,t){var r=n(e,t),i=n(e,t+4);return i64_new(r,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.readI32=n,t.writeI32=i,t.readI64=a,t.writeI64=function(e,t,r){i(i64_low(e),t,r),i(i64_high(e),t,r+4)},t.readF32=function(e,t){return i32_as_f32(n(e,t))},t.writeF32=function(e,t,r){i(f32_as_i32(e),t,r)},t.readF64=function(e,t){return i64_as_f64(a(e,t))},t.writeF64=function(e,t,r){var n=f64_as_i64(e);i(i64_low(n),t,r),i(i64_high(n),t,r+4)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="  ",i="    ",a="        ";t.indent=function(e,t){for(;t>=4;)e.push(a),t-=4;t>=2&&(e.push(i),t-=2),t&&e.push(n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=47;function i(e){for(var t,r=0,i=e.length;r+1<i&&46==e.charCodeAt(r)&&e.charCodeAt(r+1)==n;)r+=2;for((r>0||i<e.length)&&(e=e.substring(r,i),i-=r,r=0);r+1<i;){if(t=!1,e.charCodeAt(r)==n&&46==e.charCodeAt(r+1)){if((t=r+2==i)||r+2<i&&e.charCodeAt(r+2)==n){e=t?e.substring(0,r):e.substring(0,r)+e.substring(r+2),i-=2;continue}if((t=r+3==i)&&46==e.charCodeAt(r+2)||r+3<i&&46==e.charCodeAt(r+2)&&e.charCodeAt(r+3)==n){for(var a=r;--a>=0;)if(e.charCodeAt(a)==n){r-a==3&&46==e.charCodeAt(a+1)&&46==e.charCodeAt(a+2)||(e=t?e.substring(0,a):e.substring(0,a)+e.substring(r+3),i-=r+3-a,r=a-1);break}if(a<0&&r>0&&(2!=r||46!=e.charCodeAt(0)||46!=e.charCodeAt(1))){i=(e=e.substring(r+4)).length;continue}}}r++}return i>0?e:"."}function a(e){for(var t=e.length;--t>0;)if(e.charCodeAt(t)==n)return e.substring(0,t);return"."}t.normalizePath=i,t.resolvePath=function(e,t){return e.startsWith("std/")?e:i(a(t)+String.fromCharCode(n)+e)},t.dirname=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NULL=0]="NULL",e[e.LINEFEED=10]="LINEFEED",e[e.CARRIAGERETURN=13]="CARRIAGERETURN",e[e.LINESEPARATOR=8232]="LINESEPARATOR",e[e.PARAGRAPHSEPARATOR=8233]="PARAGRAPHSEPARATOR",e[e.NEXTLINE=133]="NEXTLINE",e[e.SPACE=32]="SPACE",e[e.NONBREAKINGSPACE=160]="NONBREAKINGSPACE",e[e.ENQUAD=8192]="ENQUAD",e[e.EMQUAD=8193]="EMQUAD",e[e.ENSPACE=8194]="ENSPACE",e[e.EMSPACE=8195]="EMSPACE",e[e.THREEPEREMSPACE=8196]="THREEPEREMSPACE",e[e.FOURPEREMSPACE=8197]="FOURPEREMSPACE",e[e.SIXPEREMSPACE=8198]="SIXPEREMSPACE",e[e.FIGURESPACE=8199]="FIGURESPACE",e[e.PUNCTUATIONSPACE=8200]="PUNCTUATIONSPACE",e[e.THINSPACE=8201]="THINSPACE",e[e.HAIRSPACE=8202]="HAIRSPACE",e[e.ZEROWIDTHSPACE=8203]="ZEROWIDTHSPACE",e[e.NARROWNOBREAKSPACE=8239]="NARROWNOBREAKSPACE",e[e.IDEOGRAPHICSPACE=12288]="IDEOGRAPHICSPACE",e[e.MATHEMATICALSPACE=8287]="MATHEMATICALSPACE",e[e.OGHAM=5760]="OGHAM",e[e._=95]="_",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.AMPERSAND=38]="AMPERSAND",e[e.ASTERISK=42]="ASTERISK",e[e.AT=64]="AT",e[e.BACKSLASH=92]="BACKSLASH",e[e.BACKTICK=96]="BACKTICK",e[e.BAR=124]="BAR",e[e.CARET=94]="CARET",e[e.CLOSEBRACE=125]="CLOSEBRACE",e[e.CLOSEBRACKET=93]="CLOSEBRACKET",e[e.CLOSEPAREN=41]="CLOSEPAREN",e[e.COLON=58]="COLON",e[e.COMMA=44]="COMMA",e[e.DOLLAR=36]="DOLLAR",e[e.DOT=46]="DOT",e[e.DOUBLEQUOTE=34]="DOUBLEQUOTE",e[e.EQUALS=61]="EQUALS",e[e.EXCLAMATION=33]="EXCLAMATION",e[e.GREATERTHAN=62]="GREATERTHAN",e[e.HASH=35]="HASH",e[e.LESSTHAN=60]="LESSTHAN",e[e.MINUS=45]="MINUS",e[e.OPENBRACE=123]="OPENBRACE",e[e.OPENBRACKET=91]="OPENBRACKET",e[e.OPENPAREN=40]="OPENPAREN",e[e.PERCENT=37]="PERCENT",e[e.PLUS=43]="PLUS",e[e.QUESTION=63]="QUESTION",e[e.SEMICOLON=59]="SEMICOLON",e[e.SINGLEQUOTE=39]="SINGLEQUOTE",e[e.SLASH=47]="SLASH",e[e.TILDE=126]="TILDE",e[e.BACKSPACE=8]="BACKSPACE",e[e.FORMFEED=12]="FORMFEED",e[e.BYTEORDERMARK=65279]="BYTEORDERMARK",e[e.TAB=9]="TAB",e[e.VERTICALTAB=11]="VERTICALTAB"}(t.CharCode||(t.CharCode={})),t.isLineBreak=function(e){switch(e){case 10:case 13:case 8232:case 8233:return!0;default:return!1}},t.isWhiteSpace=function(e){switch(e){case 32:case 9:case 11:case 12:case 160:case 133:case 5760:case 8239:case 8287:case 12288:case 65279:return!0;default:return e>=8192&&e<=8203}},t.isDecimalDigit=function(e){return e>=48&&e<=57},t.isOctalDigit=function(e){return e>=48&&e<=55},t.isIdentifierStart=function(e){return e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>127&&function(e){return!(e<0||e>65535)&&a(e,n)}(e)},t.isKeywordCharacter=function(e){return e>=97&&e<=122},t.isIdentifierPart=function(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36==e||95==e||e>127&&function(e){return!(e<0||e>65535)&&a(e,i)}(e)};var n=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){if(e<t[0])return!1;for(var r,n=0,i=t.length;n+1<i;){if(r=n+(i-n)/2,t[r-=r%2]<=e&&e<=t[r+1])return!0;e<t[r]?i=r:n=r+2}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(4),a=r(7),s=r(3),o=r(5);function c(e,t,r,c,h,d){var m,y,g,T,E=e.module;switch(t.internalName){case"isInteger":var f=l(e,r,c,d);return e.currentType=a.Type.bool,f?f.is(4)&&!f.is(256)?E.createI32(1):E.createI32(0):E.createUnreachable();case"isFloat":f=l(e,r,c,d);return e.currentType=a.Type.bool,f?f.is(8)?E.createI32(1):E.createI32(0):E.createUnreachable();case"isSigned":f=l(e,r,c,d);return e.currentType=a.Type.bool,f?f.is(1)?E.createI32(1):E.createI32(0):E.createUnreachable();case"isReference":f=l(e,r,c,d);return e.currentType=a.Type.bool,f?(e.currentType=a.Type.bool,f.is(256)?E.createI32(1):E.createI32(0)):E.createUnreachable();case"isString":f=l(e,r,c,d);if(e.currentType=a.Type.bool,!f)return E.createUnreachable();if(L=f.classReference){var I=e.program.stringInstance;if(I&&L.isAssignableTo(I))return E.createI32(1)}return E.createI32(0);case"isArray":f=l(e,r,c,d);return e.currentType=a.Type.bool,f?null!=(L=f.classReference)&&null!=L.lookupOverload(o.OperatorKind.INDEXED_GET)?E.createI32(1):E.createI32(0):E.createUnreachable();case"clz":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.i32,0,1);switch(e.currentType.kind){case 0:case 1:case 5:case 6:T=E.createUnary(s.UnaryOp.ClzI32,m);break;case 10:case 2:case 7:T=E.createUnary(s.UnaryOp.ClzI32,m);break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 4:T=E.createUnary(e.options.isWasm64?s.UnaryOp.ClzI64:s.UnaryOp.ClzI32,m);break;case 3:case 8:T=E.createUnary(s.UnaryOp.ClzI64,m);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"ctz":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],0,1)}else m=e.compileExpression(c[0],a.Type.i32,0,1);switch(e.currentType.kind){case 0:case 1:case 5:case 6:T=E.createUnary(s.UnaryOp.CtzI32,m);break;case 10:case 2:case 7:T=E.createUnary(s.UnaryOp.CtzI32,m);break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 4:T=E.createUnary(e.options.isWasm64?s.UnaryOp.CtzI64:s.UnaryOp.CtzI32,m);break;case 3:case 8:T=E.createUnary(s.UnaryOp.CtzI64,m);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"popcnt":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.i32,0,1);switch(e.currentType.kind){case 0:case 1:case 5:case 6:T=E.createUnary(s.UnaryOp.PopcntI32,m);break;case 10:case 2:case 7:T=E.createUnary(s.UnaryOp.PopcntI32,m);break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 4:T=E.createUnary(e.options.isWasm64?s.UnaryOp.PopcntI64:s.UnaryOp.PopcntI32,m);break;case 3:case 8:T=E.createUnary(s.UnaryOp.PopcntI64,m);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"rotl":if(2!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.i32,0,1);switch(y=e.compileExpression(c[1],e.currentType,1,0),e.currentType.kind){case 0:case 1:case 5:case 6:case 10:T=e.ensureSmallIntegerWrap(E.createBinary(s.BinaryOp.RotlI32,m,y),e.currentType);case 2:case 7:T=E.createBinary(s.BinaryOp.RotlI32,m,y);break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 4:T=E.createBinary(e.options.isWasm64?s.BinaryOp.RotlI64:s.BinaryOp.RotlI32,m,y);break;case 3:case 8:T=E.createBinary(s.BinaryOp.RotlI64,m,y);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"rotr":if(2!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.i32,0,1);switch(y=e.compileExpression(c[1],e.currentType,1,0),e.currentType.kind){case 0:case 1:case 5:case 6:case 10:T=e.ensureSmallIntegerWrap(E.createBinary(s.BinaryOp.RotrI32,m,y),e.currentType);break;case 2:case 7:T=E.createBinary(s.BinaryOp.RotrI32,m,y);break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 4:T=E.createBinary(e.options.isWasm64?s.BinaryOp.RotrI64:s.BinaryOp.RotrI32,m,y);break;case 3:case 8:T=E.createBinary(s.BinaryOp.RotrI64,m,y);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"abs":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.f64,0,1);switch(e.currentType.kind){case 0:case 1:case 2:var v=e.currentFunction.getAndFreeTempLocal(a.Type.i32,!1);T=E.createSelect(E.createTeeLocal(v.index,m),E.createBinary(s.BinaryOp.SubI32,E.createI32(0),E.createGetLocal(v.index,s.NativeType.I32)),E.createBinary(s.BinaryOp.GtI32,E.createGetLocal(v.index,s.NativeType.I32),E.createI32(0)));break;case 4:v=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);T=E.createSelect(E.createTeeLocal(v.index,m),E.createBinary(e.options.isWasm64?s.BinaryOp.SubI64:s.BinaryOp.SubI32,e.options.usizeType.toNativeZero(E),E.createGetLocal(v.index,e.options.nativeSizeType)),E.createBinary(e.options.isWasm64?s.BinaryOp.GtI64:s.BinaryOp.GtI32,E.createGetLocal(v.index,e.options.nativeSizeType),e.options.usizeType.toNativeZero(E)));break;case 3:v=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);T=E.createSelect(E.createTeeLocal(v.index,m),E.createBinary(s.BinaryOp.SubI64,E.createI64(0,0),E.createGetLocal(v.index,s.NativeType.I64)),E.createBinary(s.BinaryOp.GtI64,E.createGetLocal(v.index,s.NativeType.I64),E.createI64(0,0)));break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}case 5:case 6:case 7:case 8:case 10:T=m;break;case 11:T=E.createUnary(s.UnaryOp.AbsF32,m);break;case 12:T=E.createUnary(s.UnaryOp.AbsF64,m);break;case 13:T=E.createUnreachable();break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"max":if(2!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.f64,0,1);switch(y=e.compileExpression(c[1],e.currentType,1,1),e.currentType.kind){case 0:case 1:case 2:var A=e.currentFunction.flow,N=e.currentFunction.getTempLocal(e.currentType,!A.canOverflow(m,e.currentType)),C=e.currentFunction.getAndFreeTempLocal(e.currentType,!A.canOverflow(y,e.currentType));e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.GtI32,E.createGetLocal(N.index,s.NativeType.I32),E.createGetLocal(C.index,s.NativeType.I32)));break;case 5:case 6:case 7:case 10:A=e.currentFunction.flow,N=e.currentFunction.getTempLocal(e.currentType,!A.canOverflow(m,e.currentType)),C=e.currentFunction.getAndFreeTempLocal(e.currentType,!A.canOverflow(y,e.currentType));e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.GtU32,E.createGetLocal(N.index,s.NativeType.I32),E.createGetLocal(C.index,s.NativeType.I32)));break;case 3:N=e.currentFunction.getTempLocal(a.Type.i64,!1),C=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.GtI64,E.createGetLocal(N.index,s.NativeType.I64),E.createGetLocal(C.index,s.NativeType.I64)));break;case 8:N=e.currentFunction.getTempLocal(a.Type.i64,!1),C=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.GtU64,E.createGetLocal(N.index,s.NativeType.I64),E.createGetLocal(C.index,s.NativeType.I64)));break;case 4:N=e.currentFunction.getTempLocal(e.options.usizeType,!1),C=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(e.options.isWasm64?s.BinaryOp.GtI64:s.BinaryOp.GtI32,E.createGetLocal(N.index,e.options.nativeSizeType),E.createGetLocal(C.index,e.options.nativeSizeType)));break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}N=e.currentFunction.getTempLocal(e.options.usizeType,!1),C=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(e.options.isWasm64?s.BinaryOp.GtU64:s.BinaryOp.GtU32,E.createGetLocal(N.index,e.options.nativeSizeType),E.createGetLocal(C.index,e.options.nativeSizeType)));break;case 11:T=E.createBinary(s.BinaryOp.MaxF32,m,y);break;case 12:T=E.createBinary(s.BinaryOp.MaxF64,m,y);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"min":if(2!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpression(c[0],a.Type.f64,0,1);switch(y=e.compileExpression(c[1],e.currentType,1,1),e.currentType.kind){case 0:case 1:case 2:A=e.currentFunction.flow,N=e.currentFunction.getTempLocal(e.currentType,!A.canOverflow(m,e.currentType)),C=e.currentFunction.getAndFreeTempLocal(e.currentType,!A.canOverflow(y,e.currentType));e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.LtI32,E.createGetLocal(N.index,s.NativeType.I32),E.createGetLocal(C.index,s.NativeType.I32)));break;case 5:case 6:case 7:case 10:A=e.currentFunction.flow,N=e.currentFunction.getTempLocal(e.currentType,!A.canOverflow(m,e.currentType)),C=e.currentFunction.getAndFreeTempLocal(e.currentType,!A.canOverflow(y,e.currentType));e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.LtU32,E.createGetLocal(N.index,s.NativeType.I32),E.createGetLocal(C.index,s.NativeType.I32)));break;case 3:N=e.currentFunction.getTempLocal(a.Type.i64,!1),C=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.LtI64,E.createGetLocal(N.index,s.NativeType.I64),E.createGetLocal(C.index,s.NativeType.I64)));break;case 8:N=e.currentFunction.getTempLocal(a.Type.i64,!1),C=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(s.BinaryOp.LtU64,E.createGetLocal(N.index,s.NativeType.I64),E.createGetLocal(C.index,s.NativeType.I64)));break;case 4:N=e.currentFunction.getTempLocal(e.options.usizeType,!1),C=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(e.options.isWasm64?s.BinaryOp.LtI64:s.BinaryOp.LtI32,E.createGetLocal(N.index,e.options.nativeSizeType),E.createGetLocal(C.index,e.options.nativeSizeType)));break;case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}N=e.currentFunction.getTempLocal(e.options.usizeType,!1),C=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);e.currentFunction.freeTempLocal(N),T=E.createSelect(E.createTeeLocal(N.index,m),E.createTeeLocal(C.index,y),E.createBinary(e.options.isWasm64?s.BinaryOp.LtU64:s.BinaryOp.LtU32,E.createGetLocal(N.index,e.options.nativeSizeType),E.createGetLocal(C.index,e.options.nativeSizeType)));break;case 11:T=E.createBinary(s.BinaryOp.MinF32,m,y);break;case 12:T=E.createBinary(s.BinaryOp.MinF64,m,y);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"ceil":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(e.currentType.kind){case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}default:T=m;break;case 11:T=E.createUnary(s.UnaryOp.CeilF32,m);break;case 12:T=E.createUnary(s.UnaryOp.CeilF64,m);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"floor":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(e.currentType.kind){case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}default:T=m;break;case 11:T=E.createUnary(s.UnaryOp.FloorF32,m);break;case 12:T=E.createUnary(s.UnaryOp.FloorF64,m);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"copysign":if(2!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(y=e.compileExpression(c[1],e.currentType,1,0),e.currentType.kind){case 11:T=E.createBinary(s.BinaryOp.CopysignF32,m,y);break;case 12:T=E.createBinary(s.BinaryOp.CopysignF64,m,y);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"nearest":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(e.currentType.kind){case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}default:T=m;break;case 11:T=E.createUnary(s.UnaryOp.NearestF32,m);break;case 12:T=E.createUnary(s.UnaryOp.NearestF64,m);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"reinterpret":if(1!=c.length)return r&&1==r.length||(r&&r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0")),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(!r||1!=r.length)return r&&r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable();switch(r[0].kind){case 2:case 7:m=e.compileExpression(c[0],a.Type.f32,1,0),T=E.createUnary(s.UnaryOp.ReinterpretF32,m);break;case 3:case 8:m=e.compileExpression(c[0],a.Type.f64,1,0),T=E.createUnary(s.UnaryOp.ReinterpretF64,m);break;case 9:if(r[0].is(256))return e.error(n.DiagnosticCode.Operation_not_supported,d.range),e.currentType=r[0],E.createUnreachable();case 4:m=e.compileExpression(c[0],e.options.isWasm64?a.Type.f64:a.Type.f32,1,0),T=E.createUnary(e.options.isWasm64?s.UnaryOp.ReinterpretF64:s.UnaryOp.ReinterpretF32,m);break;case 11:m=e.compileExpression(c[0],a.Type.i32,1,0),T=E.createUnary(s.UnaryOp.ReinterpretI32,m);break;case 12:m=e.compileExpression(c[0],a.Type.i64,1,0),T=E.createUnary(s.UnaryOp.ReinterpretI64,m);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return e.currentType=r[0],T;case"sqrt":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(e.currentType.kind){case 11:T=E.createUnary(s.UnaryOp.SqrtF32,m);break;case 12:T=E.createUnary(s.UnaryOp.SqrtF64,m);break;default:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"trunc":if(1!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(r&&r.length){if(e.currentType=r[0],1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpression(c[0],a.Type.f64,0,0);switch(e.currentType.kind){case 9:if(e.currentType.is(256)){e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable();break}default:T=m;break;case 11:T=E.createUnary(s.UnaryOp.TruncF32,m);break;case 12:T=E.createUnary(s.UnaryOp.TruncF64,m);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"load":return c.length<1||c.length>2?(r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),c.length<1?e.error(n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,d.range,"1",c.length.toString(10)):e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable()):r&&1==r.length?(m=e.compileExpression(c[0],e.options.usizeType,1,0),(b=2==c.length?u(e,c[1]):0)<0?E.createUnreachable():(e.currentType=r[0],E.createLoad(r[0].byteSize,r[0].is(5),m,r[0].is(4)&&h.is(4)&&h.size>r[0].size?(e.currentType=h).toNativeType():(e.currentType=r[0]).toNativeType(),b))):(r&&r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable());case"store":if(e.currentType=a.Type.void,c.length<2||c.length>3)return r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),c.length<2?e.error(n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,d.range,"2",c.length.toString(10)):e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"3",c.length.toString(10)),E.createUnreachable();if(!r||1!=r.length)return e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable();m=e.compileExpression(c[0],e.options.usizeType,1,0),y=e.compileExpression(c[1],r[0],r[0].is(4)?0:1,0);f=void 0;return r[0].is(4)&&(!e.currentType.is(4)||e.currentType.size<r[0].size)?(y=e.convertExpression(y,e.currentType,r[0],1,0,c[1]),f=r[0]):f=e.currentType,(b=3==c.length?u(e,c[2]):0)<0?E.createUnreachable():(e.currentType=a.Type.void,E.createStore(r[0].byteSize,m,y,f.toNativeType(),b));case"sizeof":if(e.currentType=e.options.usizeType,0!=c.length)return r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"0",c.length.toString(10)),E.createUnreachable();r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0");var O=r[0].byteSize;return e.options.isWasm64?h.is(4)&&h.size<=32?(e.currentType=a.Type.u32,T=E.createI32(O)):T=E.createI64(O,0):h.is(4)&&64==h.size?(e.currentType=a.Type.u64,T=E.createI64(O,0)):T=E.createI32(O),T;case"alignof":if(e.currentType=e.options.usizeType,0!=c.length)return r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"0",c.length.toString(10)),E.createUnreachable();if(!r||1!=r.length)return e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable();var S=void 0;switch(O=r[0].byteSize){case 1:S=0;break;case 2:S=1;break;case 4:S=2;break;case 8:S=3;break;default:return assert(!1),E.createUnreachable()}return e.options.isWasm64?h.is(4)&&h.size<=32?(e.currentType=a.Type.u32,T=E.createI32(S)):T=E.createI64(S,0):h.is(4)&&64==h.size?(e.currentType=a.Type.u64,T=E.createI64(S,0)):T=E.createI32(S),T;case"offsetof":if(e.currentType=e.options.usizeType,c.length>1)return r&&1==r.length||e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();if(!r||1!=r.length)return e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable();var L;if(!(L=r[0].classReference))return e.error(n.DiagnosticCode.Operation_not_supported,d.range),E.createUnreachable();var b=void 0;if(c.length){if(c[0].kind!=i.NodeKind.LITERAL||c[0].literalKind!=i.LiteralKind.STRING)return e.error(n.DiagnosticCode.String_literal_expected,c[0].range),E.createUnreachable();var k=c[0].value,R=L.members?L.members.get(k):null;if(!R||R.kind!=o.ElementKind.FIELD)return e.error(n.DiagnosticCode.Type_0_has_no_property_1,c[0].range,L.internalName,k),E.createUnreachable();b=R.memoryOffset}else b=L.currentMemoryOffset;return e.options.isWasm64?h.is(4)&&h.size<=32?(e.currentType=a.Type.u32,E.createI32(b)):E.createI64(b):h.is(4)&&64==h.size?(e.currentType=a.Type.u64,E.createI64(b)):E.createI32(b);case"select":if(3!=c.length)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"3",c.length.toString(10)),E.createUnreachable();if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,0)}else m=e.compileExpressionRetainType(c[0],a.Type.i32,0);f=e.currentType;switch(y=e.compileExpression(c[1],f,1,0),g=e.makeIsTrueish(e.compileExpressionRetainType(c[2],a.Type.bool,0),e.currentType),e.currentType=f,e.currentType.kind){case 0:case 1:case 5:case 6:case 10:default:T=E.createSelect(m,y,g);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=E.createUnreachable()}return T;case"unreachable":return 0!=c.length&&e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"0",c.length.toString(10)),r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),E.createUnreachable();case"current_memory":return e.currentType=a.Type.i32,0!=c.length&&e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"0",c.length.toString(10)),r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),E.createHost(s.HostOp.CurrentMemory);case"grow_memory":return e.currentType=a.Type.i32,1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"0",c.length.toString(10)),m=E.createUnreachable()):m=e.compileExpression(c[0],a.Type.i32,1,0),r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),E.createHost(s.HostOp.GrowMemory,null,[m]);case"move_memory":if(r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),3!=c.length)return e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"3",c.length.toString(10)),e.currentType=a.Type.void,E.createUnreachable();throw m=e.compileExpression(c[0],e.options.usizeType,1,0),y=e.compileExpression(c[1],e.options.usizeType,1,0),g=e.compileExpression(c[2],e.options.usizeType,1,0),e.currentType=a.Type.void,new Error("not implemented");case"set_memory":if(r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),3!=c.length)return e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"3",c.length.toString(10)),e.currentType=a.Type.void,E.createUnreachable();throw m=e.compileExpression(c[0],e.options.usizeType,1,0),y=e.compileExpression(c[1],a.Type.u32,1,0),g=e.compileExpression(c[2],e.options.usizeType,1,0),e.currentType=a.Type.void,new Error("not implemented");case"changetype":return r&&1==r.length?1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=r[0],E.createUnreachable()):(m=e.compileExpressionRetainType(c[0],r[0],0),e.currentType=r[0],e.currentType.size!=r[0].size?(e.error(n.DiagnosticCode.Operation_not_supported,d.range),E.createUnreachable()):m):(r&&r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r?r.length.toString(10):"0"),E.createUnreachable());case"assert":if(c.length<1||c.length>2)return r&&(r.length&&(e.currentType=r[0].nonNullableType),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),c.length<1?e.error(n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,d.range,"1",c.length.toString(10)):c.length>2&&e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"2",c.length.toString(10)),E.createUnreachable();if(r){if(r.length&&(e.currentType=r[0].nonNullableType),1!=r.length)return e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();m=e.compileExpression(c[0],r[0],1,1)}else m=e.compileExpressionRetainType(c[0],a.Type.bool,1);f=e.currentType;if(e.currentType=f.nonNullableType,e.options.noAssert)return h==a.Type.void?(e.currentType=a.Type.void,E.createNop()):m;var x=_(e,2==c.length?c[1]:null,d);if(e.currentType=f.nonNullableType,h==a.Type.void){switch(e.currentType.kind){default:T=E.createIf(E.createUnary(s.UnaryOp.EqzI32,m),x);break;case 3:case 8:T=E.createIf(E.createUnary(s.UnaryOp.EqzI64,m),x);break;case 4:case 9:T=E.createIf(E.createUnary(e.options.isWasm64?s.UnaryOp.EqzI64:s.UnaryOp.EqzI32,m),x);break;case 11:T=E.createIf(E.createBinary(s.BinaryOp.EqF32,m,E.createF32(0)),x);break;case 12:T=E.createIf(E.createBinary(s.BinaryOp.EqF64,m,E.createF64(0)),x);break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=x}e.currentType=a.Type.void}else switch(e.currentType.kind){case 0:case 1:case 5:case 6:case 10:A=e.currentFunction.flow,v=e.currentFunction.getAndFreeTempLocal(e.currentType,!A.canOverflow(m,e.currentType));T=E.createIf(E.createTeeLocal(v.index,m),E.createGetLocal(v.index,s.NativeType.I32),x);break;case 2:case 7:default:v=e.currentFunction.getAndFreeTempLocal(a.Type.i32,!1);T=E.createIf(E.createTeeLocal(v.index,m),E.createGetLocal(v.index,s.NativeType.I32),x);break;case 3:case 8:v=e.currentFunction.getAndFreeTempLocal(a.Type.i64,!1);T=E.createIf(E.createUnary(s.UnaryOp.EqzI64,E.createTeeLocal(v.index,m)),x,E.createGetLocal(v.index,s.NativeType.I64));break;case 4:case 9:v=e.currentFunction.getAndFreeTempLocal(e.options.usizeType,!1);T=E.createIf(E.createUnary(e.options.isWasm64?s.UnaryOp.EqzI64:s.UnaryOp.EqzI32,E.createTeeLocal(v.index,m)),x,E.createGetLocal(v.index,e.options.nativeSizeType));break;case 11:v=e.currentFunction.getAndFreeTempLocal(a.Type.f32,!1);T=E.createIf(E.createBinary(s.BinaryOp.EqF32,E.createTeeLocal(v.index,m),E.createF32(0)),x,E.createGetLocal(v.index,s.NativeType.F32));break;case 12:v=e.currentFunction.getAndFreeTempLocal(a.Type.f64,!1);T=E.createIf(E.createBinary(s.BinaryOp.EqF64,E.createTeeLocal(v.index,m),E.createF64(0)),x,E.createGetLocal(v.index,s.NativeType.F64));break;case 13:e.error(n.DiagnosticCode.Operation_not_supported,d.range),T=x}return T;case"unchecked":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable()):((A=e.currentFunction.flow).set(4096),T=e.compileExpressionRetainType(c[0],h,0),A.unset(4096),T);case"call_indirect":if(c.length<1)return r&&(r.length&&(e.currentType=r[0]),1!=r.length&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10))),e.error(n.DiagnosticCode.Expected_at_least_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),E.createUnreachable();var F=void 0;if(r){if(1!=r.length)return r.length&&(e.currentType=r[0]),e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,d.range,"1",r.length.toString(10)),E.createUnreachable();F=r[0]}else F=h;if(m=e.compileExpressionRetainType(c[0],a.Type.u32,0),7!=e.currentType.kind)return e.error(n.DiagnosticCode.Operation_not_supported,c[0].range),E.createUnreachable();for(var B=c.length-1,U=new Array(B),D=new Array(B+1),P=F.toNativeType(),w=new Array(B),M=0;M<B;++M){U[M]=e.compileExpressionRetainType(c[1+M],a.Type.i32,0);var G=e.currentType;D[M]=G.toSignatureString(),w[M]=G.toNativeType()}D[B]=F.toSignatureString();var K=D.join(""),z=E.getFunctionTypeBySignature(P,w);return z||(z=E.addFunctionType(K,P,w)),e.currentType=F,E.createCallIndirect(m,U,K);case"i8":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.i8,E.createUnreachable()):e.compileExpression(c[0],a.Type.i8,2,0);case"i16":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.i16,E.createUnreachable()):e.compileExpression(c[0],a.Type.i16,2,0);case"i32":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.i32,E.createUnreachable()):e.compileExpression(c[0],a.Type.i32,2,0);case"i64":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.i64,E.createUnreachable()):e.compileExpression(c[0],a.Type.i64,2,0);case"isize":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=e.options.isWasm64?a.Type.isize64:a.Type.isize32,E.createUnreachable()):e.compileExpression(c[0],e.options.isWasm64?a.Type.isize64:a.Type.isize32,2,0);case"u8":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.u8,E.createUnreachable()):e.compileExpression(c[0],a.Type.u8,2,0);case"u16":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.u16,E.createUnreachable()):e.compileExpression(c[0],a.Type.u16,2,0);case"u32":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.u32,E.createUnreachable()):e.compileExpression(c[0],a.Type.u32,2,0);case"u64":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.u64,E.createUnreachable()):e.compileExpression(c[0],a.Type.u64,2,0);case"usize":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=e.options.usizeType,E.createUnreachable()):e.compileExpression(c[0],e.options.usizeType,2,0);case"bool":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.bool,E.createUnreachable()):e.compileExpression(c[0],a.Type.bool,2,0);case"f32":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.f32,E.createUnreachable()):e.compileExpression(c[0],a.Type.f32,2,0);case"f64":return r&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),1!=c.length?(e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,d.range,"1",c.length.toString(10)),e.currentType=a.Type.f64,E.createUnreachable()):e.compileExpression(c[0],a.Type.f64,2,0)}var V=function(e,t,r,n,i){switch(t.internalName){case"i32.clz":return p("clz",e,a.Type.i32,r,a.Type.i32,i);case"i64.clz":return p("clz",e,a.Type.i64,r,a.Type.i64,i);case"i32.ctz":return p("ctz",e,a.Type.i32,r,a.Type.i32,i);case"i64.ctz":return p("ctz",e,a.Type.i64,r,a.Type.i64,i);case"i32.popcnt":return p("popcnt",e,a.Type.i32,r,a.Type.i32,i);case"i64.popcnt":return p("popcnt",e,a.Type.i64,r,a.Type.i64,i);case"i32.rotl":return p("rotl",e,a.Type.i32,r,a.Type.i32,i);case"i64.rotl":return p("rotl",e,a.Type.i64,r,a.Type.i64,i);case"i32.rotr":return p("rotr",e,a.Type.i32,r,a.Type.i32,i);case"i64.rotr":return p("rotr",e,a.Type.i64,r,a.Type.i64,i);case"f32.abs":return p("abs",e,a.Type.f32,r,a.Type.f32,i);case"f64.abs":return p("abs",e,a.Type.f64,r,a.Type.f64,i);case"f32.max":return p("max",e,a.Type.f32,r,a.Type.f32,i);case"f64.max":return p("max",e,a.Type.f64,r,a.Type.f64,i);case"f32.min":return p("min",e,a.Type.f32,r,a.Type.f32,i);case"f64.min":return p("min",e,a.Type.f64,r,a.Type.f64,i);case"f32.ceil":return p("ceil",e,a.Type.f32,r,a.Type.f32,i);case"f64.ceil":return p("ceil",e,a.Type.f64,r,a.Type.f64,i);case"f32.floor":return p("floor",e,a.Type.f32,r,a.Type.f32,i);case"f64.floor":return p("floor",e,a.Type.f64,r,a.Type.f64,i);case"f32.copysign":return p("copysign",e,a.Type.f32,r,a.Type.f32,i);case"f64.copysign":return p("copysign",e,a.Type.f64,r,a.Type.f64,i);case"f32.nearest":return p("nearest",e,a.Type.f32,r,a.Type.f32,i);case"f64.nearest":return p("nearest",e,a.Type.f64,r,a.Type.f64,i);case"i32.reinterpret_f32":return p("reinterpret",e,a.Type.i32,r,a.Type.f32,i);case"i64.reinterpret_f64":return p("reinterpret",e,a.Type.i64,r,a.Type.f64,i);case"f32.reinterpret_i32":return p("reinterpret",e,a.Type.f32,r,a.Type.i32,i);case"f64.reinterpret_i64":return p("reinterpret",e,a.Type.f64,r,a.Type.i64,i);case"f32.sqrt":return p("sqrt",e,a.Type.f32,r,a.Type.f32,i);case"f64.sqrt":return p("sqrt",e,a.Type.f64,r,a.Type.f64,i);case"f32.trunc":return p("trunc",e,a.Type.f32,r,a.Type.f32,i);case"f64.trunc":return p("trunc",e,a.Type.f64,r,a.Type.f64,i);case"i32.load8_s":return p("load",e,a.Type.i8,r,a.Type.i32,i);case"i32.load8_u":return p("load",e,a.Type.u8,r,a.Type.u32,i);case"i32.load16_s":return p("load",e,a.Type.i16,r,a.Type.i32,i);case"i32.load16_u":return p("load",e,a.Type.u16,r,a.Type.u32,i);case"i32.load":return p("load",e,a.Type.i32,r,a.Type.i32,i);case"i64.load8_s":return p("load",e,a.Type.i8,r,a.Type.i64,i);case"i64.load8_u":return p("load",e,a.Type.u8,r,a.Type.u64,i);case"i64.load16_s":return p("load",e,a.Type.i16,r,a.Type.i64,i);case"i64.load16_u":return p("load",e,a.Type.u16,r,a.Type.u64,i);case"i64.load32_s":return p("load",e,a.Type.i32,r,a.Type.i64,i);case"i64.load32_u":return p("load",e,a.Type.u32,r,a.Type.u64,i);case"i64.load":return p("load",e,a.Type.i64,r,a.Type.i64,i);case"f32.load":return p("load",e,a.Type.f32,r,a.Type.f32,i);case"f64.load":return p("load",e,a.Type.f64,r,a.Type.f64,i);case"i32.store8":return p("store",e,a.Type.i8,r,a.Type.i32,i);case"i32.store16":return p("store",e,a.Type.i16,r,a.Type.i32,i);case"i32.store":return p("store",e,a.Type.i32,r,a.Type.i32,i);case"i64.store8":return p("store",e,a.Type.i8,r,a.Type.i64,i);case"i64.store16":return p("store",e,a.Type.i16,r,a.Type.i64,i);case"i64.store32":return p("store",e,a.Type.i32,r,a.Type.i64,i);case"i64.store":return p("store",e,a.Type.i64,r,a.Type.i64,i);case"f32.store":return p("store",e,a.Type.f32,r,a.Type.f32,i);case"f64.store":return p("store",e,a.Type.f64,r,a.Type.f64,i)}return 0}(e,t,c,0,d);return V?(r&&r.length&&e.error(n.DiagnosticCode.Type_0_is_not_generic,d.range,t.internalName),V):(e.error(n.DiagnosticCode.Operation_not_supported,d.range),E.createUnreachable())}function p(e,t,r,n,i,a){var s=assert(t.program.elementsLookup.get(e));return assert(s.kind==o.ElementKind.FUNCTION_PROTOTYPE),c(t,s,[r],n,i,a)}function l(e,t,r,i){if(0==r.length)return t&&1==t.length?t[0]:(e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,i.range,"1",t?t.length.toString(10):"0"),null);if(1==r.length){if(t)if(1==t.length)e.compileExpression(r[0],t[0],1,0);else{if(t.length)return e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,i.range,"1",t.length.toString(10)),null;e.compileExpressionRetainType(r[0],a.Type.i32,0)}else e.compileExpressionRetainType(r[0],a.Type.i32,0);return e.currentType}return t&&t.length>1&&e.error(n.DiagnosticCode.Expected_0_type_arguments_but_got_1,i.range,"1",t.length.toString(10)),e.error(n.DiagnosticCode.Expected_0_arguments_but_got_1,i.range,"1",r.length.toString(10)),null}function u(e,t){var r,i;return e.options.isWasm64?(r=e.precomputeExpression(t,a.Type.usize64,1,0),(s.getExpressionId(r)!=s.ExpressionId.Const||s.getExpressionType(r)!=s.NativeType.I64||0!=s.getConstValueI64High(r)||(i=s.getConstValueI64Low(r))<0)&&(e.error(n.DiagnosticCode.Operation_not_supported,t.range),i=-1)):(r=e.precomputeExpression(t,a.Type.usize32,1,0),(s.getExpressionId(r)!=s.ExpressionId.Const||s.getExpressionType(r)!=s.NativeType.I32||(i=s.getConstValueI32(r))<0)&&(e.error(n.DiagnosticCode.Operation_not_supported,t.range),i=-1)),i}t.compileCall=c;var h="allocate_memory";t.compileAllocate=function(e,t,r){var i=e.program;assert(t.program==i);var a=e.module,s=e.options,c=i.elementsLookup.get(h);if(!c)return i.error(n.DiagnosticCode.Cannot_find_name_0,r.range,h),i.info(n.DiagnosticCode.An_allocator_must_be_declared_to_allocate_memory_Try_importing_allocator_arena_or_allocator_tlsf,r.range),a.createUnreachable();if(c.kind!=o.ElementKind.FUNCTION_PROTOTYPE)return i.error(n.DiagnosticCode.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,r.range,c.internalName),a.createUnreachable();var p=c.resolve();return p&&e.compileFunction(p)?(e.currentType=t.type,a.createCall(p.internalName,[s.isWasm64?a.createI64(t.currentMemoryOffset):a.createI32(t.currentMemoryOffset)],s.nativeSizeType)):a.createUnreachable()};var d="abort";function _(e,t,r){var n=e.program,i=e.module,c=n.typesLookup.get("string");if(!c)return i.createUnreachable();var p=n.elementsLookup.get(d);if(!p||p.kind!=o.ElementKind.FUNCTION_PROTOTYPE)return i.createUnreachable();var l=p.resolve();if(!l||!e.compileFunction(l))return i.createUnreachable();var u=null!=t?e.compileExpression(t,c,1,0):c.toNativeZero(i),h=e.compileStaticString(r.range.source.normalizedPath);return e.currentType=a.Type.void,i.createBlock(null,[i.createCallImport(l.internalName,[u,h,i.createI32(r.range.line),i.createI32(r.range.column)],s.NativeType.None),i.createUnreachable()])}t.compileAbort=_},function(t,r){t.exports=e},function(e,t,r){(function(e){const t=e.Binaryen||r(23);for(var n in t)(n.startsWith("_Binaryen")||n.startsWith("_Relooper"))&&(e[n]=t[n]);e.allocate_memory=function(e){return e?t._malloc(e):0},e.free_memory=function(e){e&&t._free(e)},e.move_memory=function(e,r,n){return t._memmove(e,r,n)},e.store=function(e,r){t.HEAPU8[e]=r},e.load=function(e){return t.HEAPU8[e]};const i=r(3).Module;i.prototype.toText=function(){var e=t.print,r="";return t.print=function(e){r+=e+"\n"},_BinaryenModulePrint(this.ref),t.print=e,r},i.prototype.toAsmjs=function(){var e=t.print,r="";return t.print=function(e){r+=e+"\n"},_BinaryenModulePrintAsmjs(this.ref),t.print=e,r}}).call(this,r(6))},function(e,t){e.exports=(e=>{var t=new Uint8Array(0),r=0;e.allocate_memory=function(e){if(!(e>>>=0))return 0;if(r+e>t.length){var n=t;(t=new Uint8Array(Math.max(65536,t.length+e,2*t.length))).set(n)}var i=r;return 7&(r+=e)&&(r=1+(7|r)),i},e.free_memory=function(e){},e.move_memory=function(e,r,n){t.copyWithin(e,r,r+n)},e.store=function(e,r,n){t[e+(0|n)]=r},e.load=function(e,r){return t[e+(0|r)]}})},function(e,t){e.exports=(e=>{e.JSMath=Math})},function(e,t,r){(function(e){var t="undefined"!=typeof window&&window||void 0!==e&&e||self;function n(){Error.captureStackTrace?Error.captureStackTrace(this,n):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}function i(e){this.message=e||"assertion failed",Error.captureStackTrace?Error.captureStackTrace(this,i):this.stack=this.name+": "+this.message+"\n"+(new Error).stack}Object.defineProperties(t.i8=function(e){return e<<24>>24},{MIN_VALUE:{value:-128,writable:!1},MAX_VALUE:{value:127,writable:!1}}),Object.defineProperties(t.i16=function(e){return e<<16>>16},{MIN_VALUE:{value:-32768,writable:!1},MAX_VALUE:{value:32767,writable:!1}}),Object.defineProperties(t.i32=t.isize=function(e){return 0|e},{MIN_VALUE:{value:-2147483648,writable:!1},MAX_VALUE:{value:2147483647,writable:!1}}),Object.defineProperties(t.u8=function(e){return 255&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:255,writable:!1}}),Object.defineProperties(t.u16=function(e){return 65535&e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:65535,writable:!1}}),Object.defineProperties(t.u32=t.usize=function(e){return e>>>0},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:4294967295,writable:!1}}),Object.defineProperties(t.bool=function(e){return!!e},{MIN_VALUE:{value:0,writable:!1},MAX_VALUE:{value:1,writable:!1}}),Object.defineProperties(t.f32=function(e){return Math.fround(e)},{MIN_VALUE:{value:Math.fround(-3.40282347e38),writable:!1},MAX_VALUE:{value:Math.fround(3.40282347e38),writable:!1},MIN_POSITIVE_VALUE:{value:Math.fround(1.175494351e-38),writable:!1},MIN_SAFE_INTEGER:{value:-16777215,writable:!1},MAX_SAFE_INTEGER:{value:16777215,writable:!1},EPSILON:{value:Math.fround(1.1920929e-7),writable:!1}}),Object.defineProperties(t.f64=function(e){return+e},{MIN_VALUE:{value:-1.7976931348623157e308,writable:!1},MAX_VALUE:{value:1.7976931348623157e308,writable:!1},MIN_POSITIVE_VALUE:{value:2.2250738585072014e-308,writable:!1},MIN_SAFE_INTEGER:{value:-9007199254740991,writable:!1},MAX_SAFE_INTEGER:{value:9007199254740991,writable:!1},EPSILON:{value:2.220446049250313e-16,writable:!1}}),t.clz=Math.clz32,t.ctz=function(e){var t=Math.clz32(e&-e);return e?31-t:t},t.popcnt=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.rotl=function(e,t){return e<<(t&=31)|e>>>32-t},t.rotr=function(e,t){return e>>>(t&=31)|e<<32-t},t.abs=Math.abs,t.max=Math.max,t.min=Math.min,t.ceil=Math.ceil,t.floor=Math.floor,t.nearest=function(e){return.5===Math.abs(e-Math.trunc(e))?2*Math.round(.5*e):Math.round(e)},t.select=function(e,t,r){return r?e:t},t.sqrt=Math.sqrt,t.trunc=Math.trunc,t.copysign=function(e,t){return Math.abs(e)*Math.sign(t)},t.bswap=function(e){var t=e>>8&16711935,r=(16711935&e)<<8;return(t=(e=t|r)>>16&65535)|(r=(65535&e)<<16)},t.bswap16=function(e){return e<<8&65280|e>>8&255|4294901760&e},n.prototype=Object.create(Error.prototype),n.prototype.name="UnreachableError",n.prototype.message="unreachable",t.unreachable=function(){throw new n},i.prototype=Object.create(Error.prototype),i.prototype.name="AssertionError",t.assert=function(e,t){if(e)return e;throw new i(t)},t.changetype=function(e){return e},t.parseI32=function(e,t){return 0|parseInt(e,void 0)},String.fromCharCodes=function(e){return String.fromCharCode.apply(String,e)},String.fromCodePoints=function(e){return String.fromCodePoint.apply(String,e)},t.isInteger=Number.isInteger,t.isFloat=function(e){return"number"==typeof e},t.isReference=function(e){return"object"==typeof e||"string"==typeof e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isArray=Array.isArray,t.unchecked=function(e){return e},t.fmod=function(e,t){return e%t},t.fmodf=function(e,t){return Math.fround(e%t)},r(26)(t),r(25)(t)}).call(this,r(6))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(27),r(24),r(17),r(15)},function(e,t,r){r(28),e.exports=r(14)}])});
//# sourceMappingURL=assemblyscript.js.map